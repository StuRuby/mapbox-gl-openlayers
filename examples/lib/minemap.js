/* 最后修改时间：7/1/2020, 5:24:09 PM；软件版本：MineMap for 2D v2.1.0 */
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
        typeof define === 'function' && define.amd ? define(factory) :
        (global = global || self, global.minemap = factory());
}(this, (function () {
    'use strict';

    /* eslint-disable */

    var shared, worker, minemap;
    // define gets called three times: one for each chunk. we rely on the order
    // they're imported to know which is which
    function define(_, chunk) {
        if (!shared) {
            shared = chunk;
        } else if (!worker) {
            worker = chunk;
        } else {
            var workerBundleString = 'var sharedChunk = {}; (' + shared + ')(sharedChunk); (' + worker + ')(sharedChunk);'

            var sharedChunk = {};
            shared(sharedChunk);
            minemap = chunk(sharedChunk);
            minemap.workerUrl = window.URL.createObjectURL(new Blob([workerBundleString], {
                type: 'text/javascript'
            }));
        }
    }


    define(["exports"], (function (t) {
        "use strict";

        function e(t, e) {
            return t(e = {
                exports: {}
            }, e.exports), e.exports
        }
        var r = n;

        function n(t, e, r, n) {
            this.cx = 3 * t, this.bx = 3 * (r - t) - this.cx, this.ax = 1 - this.cx - this.bx, this.cy = 3 * e, this.by = 3 * (n - e) - this.cy, this.ay = 1 - this.cy - this.by, this.p1x = t, this.p1y = n, this.p2x = r, this.p2y = n;
        }
        n.prototype.sampleCurveX = function (t) {
            return ((this.ax * t + this.bx) * t + this.cx) * t
        }, n.prototype.sampleCurveY = function (t) {
            return ((this.ay * t + this.by) * t + this.cy) * t
        }, n.prototype.sampleCurveDerivativeX = function (t) {
            return (3 * this.ax * t + 2 * this.bx) * t + this.cx
        }, n.prototype.solveCurveX = function (t, e) {
            var r, n, i, a, o;
            for (void 0 === e && (e = 1e-6), i = t, o = 0; o < 8; o++) {
                if (a = this.sampleCurveX(i) - t, Math.abs(a) < e) return i;
                var s = this.sampleCurveDerivativeX(i);
                if (Math.abs(s) < 1e-6) break;
                i -= a / s;
            }
            if ((i = t) < (r = 0)) return r;
            if (i > (n = 1)) return n;
            for (; r < n;) {
                if (a = this.sampleCurveX(i), Math.abs(a - t) < e) return i;
                t > a ? r = i : n = i, i = .5 * (n - r) + r;
            }
            return i
        }, n.prototype.solve = function (t, e) {
            return this.sampleCurveY(this.solveCurveX(t, e))
        };
        var i = a;

        function a(t, e) {
            this.x = t, this.y = e;
        }

        function o(t, e, n, i) {
            var a = new r(t, e, n, i);
            return function (t) {
                return a.solve(t)
            }
        }
        a.prototype = {
            clone: function () {
                return new a(this.x, this.y)
            },
            add: function (t) {
                return this.clone()._add(t)
            },
            sub: function (t) {
                return this.clone()._sub(t)
            },
            multByPoint: function (t) {
                return this.clone()._multByPoint(t)
            },
            divByPoint: function (t) {
                return this.clone()._divByPoint(t)
            },
            mult: function (t) {
                return this.clone()._mult(t)
            },
            div: function (t) {
                return this.clone()._div(t)
            },
            rotate: function (t) {
                return this.clone()._rotate(t)
            },
            rotateAround: function (t, e) {
                return this.clone()._rotateAround(t, e)
            },
            matMult: function (t) {
                return this.clone()._matMult(t)
            },
            unit: function () {
                return this.clone()._unit()
            },
            perp: function () {
                return this.clone()._perp()
            },
            round: function () {
                return this.clone()._round()
            },
            mag: function () {
                return Math.sqrt(this.x * this.x + this.y * this.y)
            },
            equals: function (t) {
                return this.x === t.x && this.y === t.y
            },
            dist: function (t) {
                return Math.sqrt(this.distSqr(t))
            },
            distSqr: function (t) {
                var e = t.x - this.x,
                    r = t.y - this.y;
                return e * e + r * r
            },
            angle: function () {
                return Math.atan2(this.y, this.x)
            },
            angleTo: function (t) {
                return Math.atan2(this.y - t.y, this.x - t.x)
            },
            angleWith: function (t) {
                return this.angleWithSep(t.x, t.y)
            },
            angleWithSep: function (t, e) {
                return Math.atan2(this.x * e - this.y * t, this.x * t + this.y * e)
            },
            _matMult: function (t) {
                var e = t[2] * this.x + t[3] * this.y;
                return this.x = t[0] * this.x + t[1] * this.y, this.y = e, this
            },
            _add: function (t) {
                return this.x += t.x, this.y += t.y, this
            },
            _sub: function (t) {
                return this.x -= t.x, this.y -= t.y, this
            },
            _mult: function (t) {
                return this.x *= t, this.y *= t, this
            },
            _div: function (t) {
                return this.x /= t, this.y /= t, this
            },
            _multByPoint: function (t) {
                return this.x *= t.x, this.y *= t.y, this
            },
            _divByPoint: function (t) {
                return this.x /= t.x, this.y /= t.y, this
            },
            _unit: function () {
                return this._div(this.mag()), this
            },
            _perp: function () {
                var t = this.y;
                return this.y = this.x, this.x = -t, this
            },
            _rotate: function (t) {
                var e = Math.cos(t),
                    r = Math.sin(t),
                    n = r * this.x + e * this.y;
                return this.x = e * this.x - r * this.y, this.y = n, this
            },
            _rotateAround: function (t, e) {
                var r = Math.cos(t),
                    n = Math.sin(t),
                    i = e.y + n * (this.x - e.x) + r * (this.y - e.y);
                return this.x = e.x + r * (this.x - e.x) - n * (this.y - e.y), this.y = i, this
            },
            _round: function () {
                return this.x = Math.round(this.x), this.y = Math.round(this.y), this
            }
        }, a.convert = function (t) {
            return t instanceof a ? t : Array.isArray(t) ? new a(t[0], t[1]) : t
        };
        var s = o(.25, .1, .25, 1);

        function u(t, e, r) {
            return Math.min(r, Math.max(e, t))
        }

        function l(t, e, r) {
            var n = r - e,
                i = ((t - e) % n + n) % n + e;
            return i === e ? r : i
        }

        function p(t) {
            for (var e = [], r = arguments.length - 1; r-- > 0;) e[r] = arguments[r + 1];
            for (var n = 0, i = e; n < i.length; n += 1) {
                var a = i[n];
                for (var o in a) t[o] = a[o];
            }
            return t
        }
        var c = 1;

        function h() {
            return c++
        }

        function y(t, e) {
            t.forEach((function (t) {
                e[t] && (e[t] = e[t].bind(e));
            }));
        }

        function f(t, e) {
            return -1 !== t.indexOf(e, t.length - e.length)
        }

        function d(t, e, r) {
            var n = {};
            for (var i in t) n[i] = e.call(r || this, t[i], i, t);
            return n
        }

        function m(t, e, r) {
            var n = {};
            for (var i in t) e.call(r || this, t[i], i, t) && (n[i] = t[i]);
            return n
        }

        function g(t) {
            return Array.isArray(t) ? t.map(g) : "object" == typeof t && t ? d(t, g) : t
        }
        var v = {};

        function x(t) {
            v[t] || ("undefined" != typeof console && console.warn(t), v[t] = !0);
        }

        function b(t, e, r) {
            return (r.y - t.y) * (e.x - t.x) > (e.y - t.y) * (r.x - t.x)
        }

        function _(t) {
            for (var e = 0, r = 0, n = t.length, i = n - 1, a = void 0, o = void 0; r < n; i = r++) e += ((o = t[i]).x - (a = t[r]).x) * (a.y + o.y);
            return e
        }

        function w() {
            return "undefined" != typeof WorkerGlobalScope && "undefined" != typeof self && self instanceof WorkerGlobalScope
        }

        function k(t) {
            var e = {};
            if (t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g, (function (t, r, n, i) {
                    var a = n || i;
                    return e[r] = !a || a.toLowerCase(), ""
                })), e["max-age"]) {
                var r = parseInt(e["max-age"], 10);
                isNaN(r) ? delete e["max-age"] : e["max-age"] = r;
            }
            return e
        }
        var A = null;

        function S(t) {
            if (null == A) {
                var e = t.navigator ? t.navigator.userAgent : null;
                A = !!t.safari || !(!e || !(/\b(iPad|iPhone|iPod)\b/.test(e) || e.match("Safari") && !e.match("Chrome")));
            }
            return A
        }
        var I, z, B, V, C = self.performance && self.performance.now ? self.performance.now.bind(self.performance) : Date.now.bind(Date),
            M = self.requestAnimationFrame || self.mozRequestAnimationFrame || self.webkitRequestAnimationFrame || self.msRequestAnimationFrame,
            P = self.cancelAnimationFrame || self.mozCancelAnimationFrame || self.webkitCancelAnimationFrame || self.msCancelAnimationFrame,
            L = {
                now: C,
                frame: function (t) {
                    var e = M(t);
                    return {
                        cancel: function () {
                            return P(e)
                        }
                    }
                },
                getImageData: function (t, e) {
                    void 0 === e && (e = 0);
                    var r = self.document.createElement("canvas"),
                        n = r.getContext("2d");
                    if (!n) throw new Error("failed to create canvas 2d context");
                    return r.width = t.width, r.height = t.height, n.drawImage(t, 0, 0, t.width, t.height), n.getImageData(-e, -e, t.width + 2 * e, t.height + 2 * e)
                },
                resolveURL: function (t) {
                    return I || (I = self.document.createElement("a")), I.href = t, I.href
                },
                hardwareConcurrency: self.navigator.hardwareConcurrency || 4,
                get devicePixelRatio() {
                    return self.devicePixelRatio
                },
                get prefersReducedMotion() {
                    return !!self.matchMedia && (null == z && (z = self.matchMedia("(prefers-reduced-motion: reduce)")), z.matches)
                }
            },
            T = {
                MAX_PARALLEL_IMAGE_REQUESTS: 16,
                DOMAIN: "//minedata.cn",
                DATA_DOMAIN: "//datahive.minedata.cn",
                API_BASE: "/data/",
                API_URL: "//datahive.minedata.cn/data/",
                DYN_BASE: "/dynamicdata/",
                DYN_URL: "//datahive.minedata.cn/dynamicdata/",
                MERGE_BASE: "/mergeddata/",
                MERGE_URL: "//datahive.minedata.cn/mergeddata/",
                OTHER_BASE: "/otherdata/",
                OTHER_URL: "//datahive.minedata.cn/otherdata/",
                SRC_BASE: "/minemapapi/v2.0.0/",
                SRC_URL: "//minedata.cn/minemapapi/v2.0.0/",
                SERVICE_BASE: "/service",
                SERVICE_URL: "//minedata.cn/service",
                REQUIRE_ACCESS_TOKEN: !0,
                ACCESS_TOKEN: null,
                APP_KEY: null,
                OFFLINE: !1,
                SOLU: null,
                spriteUrl: null,
                fontsUrl: null,
                DATA_VERSION: null,
                EVENTS_URL: null,
                FEEDBACK_URL: null
            },
            D = 500,
            E = 50;

        function F() {
            self.caches && !B && (B = self.caches.open("minemap-tiles"));
        }
        var q, O, U, R = 1 / 0,
            j = {
                supported: !1,
                testSupport: function (t) {
                    !N && O && (K ? X(t) : q = t);
                }
            },
            N = !1,
            K = !1;

        function X(t) {
            var e = t.createTexture();
            t.bindTexture(t.TEXTURE_2D, e);
            try {
                if (t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.RGBA, t.UNSIGNED_BYTE, O), t.isContextLost()) return;
                j.supported = !0;
            } catch (t) {}
            t.deleteTexture(e), N = !0;
        }

        function G() {
            return null == U && (U = self.OffscreenCanvas && new self.OffscreenCanvas(1, 1).getContext("2d") && "function" == typeof self.createImageBitmap), U
        }

        function H(t, e) {
            if (e && -1 !== e.indexOf("?")) {
                var r = e.split("?")[1],
                    n = new RegExp("(^|&)" + t + "=([^&]*)(&|$)"),
                    i = r.match(n);
                if (null != i) return unescape(i[2])
            }
            return null
        }
        self.document && ((O = self.document.createElement("img")).onload = function () {
            q && X(q), q = null, K = !0;
        }, O.onerror = function () {
            N = !0, q = null;
        }, O.src = "data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");
        var Y = function (t, e) {
                void 0 === e && (e = {});
                var r = t.responseURL || t.__responseURL || e.url,
                    n = t.response ? t.response : t,
                    i = n ? n.byteLength : 0,
                    a = H("token", r) || "",
                    o = H("appKey", r) || "",
                    s = o.length > 0 ? o : a;
                if (s.length > 0 && i > 8) {
                    var u = new Uint8Array(n);
                    if ("minedata" === function (t, e, r) {
                            for (var n = "", i = e; i < r;) {
                                var a = t[i],
                                    o = null,
                                    s = a > 239 ? 4 : a > 223 ? 3 : a > 191 ? 2 : 1;
                                if (i + s > r) break;
                                var u = void 0,
                                    l = void 0,
                                    p = void 0;
                                1 === s ? a < 128 && (o = a) : 2 === s ? 128 == (192 & (u = t[i + 1])) && (o = (31 & a) << 6 | 63 & u) <= 127 && (o = null) : 3 === s ? (l = t[i + 2], 128 == (192 & (u = t[i + 1])) && 128 == (192 & l) && ((o = (15 & a) << 12 | (63 & u) << 6 | 63 & l) <= 2047 || o >= 55296 && o <= 57343) && (o = null)) : 4 === s && (l = t[i + 2], p = t[i + 3], 128 == (192 & (u = t[i + 1])) && 128 == (192 & l) && 128 == (192 & p) && ((o = (15 & a) << 18 | (63 & u) << 12 | (63 & l) << 6 | 63 & p) <= 65535 || o >= 1114112) && (o = null)), null === o ? (o = 65533, s = 1) : o > 65535 && (o -= 65536, n += String.fromCharCode(o >>> 10 & 1023 | 55296), o = 56320 | 1023 & o), n += String.fromCharCode(o), i += s;
                            }
                            return n
                        }(u, i - 8, i).toLowerCase()) return function (t, e) {
                        var r = t.length - 8;
                        if (r <= e)
                            for (var n = 0; n < r / 2; n++) {
                                var i = t[n];
                                t[n] = t[r - n - 1], t[r - n - 1] = i;
                            } else
                                for (var a = parseInt(r / e), o = parseInt(e / 2), s = 0; s < a; s++)
                                    for (var u = s * e, l = (s + 1) * e - 1, p = u, c = 0; p < u + o; p++, c++) {
                                        var h = l - c,
                                            y = t[p];
                                        t[p] = t[h], t[h] = y;
                                    }
                    }(u, function (t) {
                        for (var e = 0, r = t.length, n = 0; n < r; n++) e += t.charCodeAt(n);
                        return parseInt(e / r)
                    }(s)), u.slice(0, i - 8)
                }
                return n
            },
            Z = {
                Unknown: "Unknown",
                Style: "Style",
                Source: "Source",
                Tile: "Tile",
                Glyphs: "Glyphs",
                SpriteImage: "SpriteImage",
                SpriteJSON: "SpriteJSON",
                Image: "Image"
            };
        "function" == typeof Object.freeze && Object.freeze(Z);
        var J, $, W = function (t) {
                function e(e, r, n) {
                    t.call(this, e), this.status = r, this.url = n, this.name = this.constructor.name, this.message = e;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.toString = function () {
                    return this.name + ": " + this.message + " (" + this.status + "): " + this.url
                }, e
            }(Error),
            Q = w() ? function () {
                return self.worker && self.worker.referrer
            } : function () {
                return ("blob:" === self.location.protocol ? self.parent : self).location.href
            },
            tt = function (t, e) {
                if (!(/^file:/.test(r = t.url) || /^file:/.test(Q()) && !/^\w+:/.test(r))) {
                    if (self.fetch && self.Request && self.AbortController && self.Request.prototype.hasOwnProperty("signal")) return function (t, e) {
                        var r = new self.AbortController,
                            n = new self.Request(t.url, {
                                method: t.method || "GET",
                                body: t.body,
                                credentials: t.credentials,
                                headers: t.headers,
                                referrer: Q(),
                                signal: r.signal
                            }),
                            i = !1,
                            a = !1;
                        "json" === t.type && n.headers.set("Accept", "application/json");
                        return function (r, o, s) {
                            if (!a) {
                                var u = Date.now();
                                self.fetch(n).then((function (r) {
                                    return r.ok ? function (r, o, s) {
                                        ("arrayBuffer" === t.type ? r.arrayBuffer() : "json" === t.type ? r.json() : r.text()).then((function (u) {
                                            a || (o && s && function (t, e, r) {
                                                if (F(), B) {
                                                    var n = {
                                                        status: e.status,
                                                        statusText: e.statusText,
                                                        headers: new self.Headers
                                                    };
                                                    e.headers.forEach((function (t, e) {
                                                        return n.headers.set(e, t)
                                                    }));
                                                    var i = k(e.headers.get("Cache-Control") || "");
                                                    i["no-store"] || (i["max-age"] && n.headers.set("Expires", new Date(r + 1e3 * i["max-age"]).toUTCString()), new Date(n.headers.get("Expires")).getTime() - r < 42e4 || function (t, e) {
                                                        if (void 0 === V) try {
                                                            new Response(new ReadableStream), V = !0;
                                                        } catch (t) {
                                                            V = !1;
                                                        }
                                                        V ? e(t.body) : t.blob().then(e);
                                                    }(e, (function (e) {
                                                        var r = new self.Response(e, n);
                                                        F(), B && B.then((function (e) {
                                                            return e.put((i = (n = t.url).indexOf("?")) < 0 ? n : n.slice(0, i), r);
                                                            var n, i;
                                                        })).catch((function (t) {
                                                            return x(t.message)
                                                        }));
                                                    })));
                                                }
                                            }(n, o, s), i = !0, "json" !== t.type && (u = Y(u, r)), e(null, u, r.headers.get("Cache-Control"), r.headers.get("Expires"), r.headers.get("ETag")));
                                        })).catch((function (t) {
                                            a || e(new Error(t.message));
                                        }));
                                    }(r, null, u) : e(new W(r.statusText, r.status, t.url))
                                })).catch((function (t) {
                                    20 !== t.code && e(new Error(t.message));
                                }));
                            }
                        }(), {
                            cancel: function () {
                                a = !0, i || r.abort();
                            }
                        }
                    }(t, e);
                    if (w() && self.worker && self.worker.actor) return self.worker.actor.send("getResource", t, e, void 0, !0)
                }
                var r;
                return function (t, e) {
                    var r = new self.XMLHttpRequest;
                    for (var n in r.__responseURL = t.url, r.open(t.method || "GET", t.url, !0), "arrayBuffer" === t.type && (r.responseType = "arraybuffer"), t.headers) r.setRequestHeader(n, t.headers[n]);
                    return "json" === t.type && (r.responseType = "text", r.setRequestHeader("Accept", "application/json")), r.withCredentials = "include" === t.credentials, r.onerror = function () {
                        e(new Error(r.statusText));
                    }, r.onload = function () {
                        if ((r.status >= 200 && r.status < 300 || 0 === r.status) && null !== r.response)
                            if ("json" === t.type) {
                                var n = r.response;
                                try {
                                    n = JSON.parse(r.response);
                                } catch (t) {
                                    return e(t)
                                }
                                e(null, n, r.getResponseHeader("Cache-Control"), r.getResponseHeader("Expires"), r.getResponseHeader("ETag"));
                            } else {
                                var i = Y(r);
                                e(null, i, r.getResponseHeader("Cache-Control"), r.getResponseHeader("Expires"), r.getResponseHeader("ETag"));
                            }
                        else e(new W(r.statusText, r.status, t.url));
                    }, r.send(t.body), {
                        cancel: function () {
                            return r.abort()
                        }
                    }
                }(t, e)
            },
            et = function (t, e) {
                return tt(p(t, {
                    type: "arrayBuffer"
                }), e)
            };
        J = [], $ = 0;
        var rt = function (t, e) {
            if (j.supported && (t.headers || (t.headers = {}), t.headers.accept = "image/webp,*/*"), $ >= T.MAX_PARALLEL_IMAGE_REQUESTS) {
                var r = {
                    requestParameters: t,
                    callback: e,
                    cancelled: !1,
                    cancel: function () {
                        this.cancelled = !0;
                    }
                };
                return J.push(r), r
            }
            $++;
            var n = !1,
                i = function () {
                    if (!n)
                        for (n = !0, $--; J.length && $ < T.MAX_PARALLEL_IMAGE_REQUESTS;) {
                            var t = J.shift();
                            t.cancelled || (t.cancel = rt(t.requestParameters, t.callback).cancel);
                        }
                },
                a = et(t, (function (t, r, n, a) {
                    i(), t ? e(t) : r && (G() ? function (t, e) {
                        var r = new self.Blob([new Uint8Array(t)], {
                            type: "image/png"
                        });
                        self.createImageBitmap(r).then((function (t) {
                            e(null, t);
                        })).catch((function (t) {
                            e(new Error("Could not load image because of " + t.message + ". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));
                        }));
                    }(r, e) : function (t, e, r, n) {
                        var i = new self.Image,
                            a = self.URL;
                        i.onload = function () {
                            e(null, i), a.revokeObjectURL(i.src);
                        }, i.onerror = function () {
                            return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))
                        };
                        var o = new self.Blob([new Uint8Array(t)], {
                            type: "image/png"
                        });
                        i.cacheControl = r, i.expires = n, i.src = t.byteLength ? a.createObjectURL(o) : "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";
                    }(r, e, n, a));
                }));
            return {
                cancel: function () {
                    a.cancel(), i();
                }
            }
        };

        function nt(t, e, r) {
            r[t] && -1 !== r[t].indexOf(e) || (r[t] = r[t] || [], r[t].push(e));
        }

        function it(t, e, r) {
            if (r && r[t]) {
                var n = r[t].indexOf(e); - 1 !== n && r[t].splice(n, 1);
            }
        }
        var at = function (t, e) {
                void 0 === e && (e = {}), p(this, e), this.type = t;
            },
            ot = function (t) {
                function e(e, r) {
                    void 0 === r && (r = {}), t.call(this, "error", p({
                        error: e
                    }, r));
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
            }(at),
            st = function () {};
        st.prototype.on = function (t, e) {
            return this._listeners = this._listeners || {}, nt(t, e, this._listeners), this
        }, st.prototype.off = function (t, e) {
            return it(t, e, this._listeners), it(t, e, this._oneTimeListeners), this
        }, st.prototype.once = function (t, e) {
            return this._oneTimeListeners = this._oneTimeListeners || {}, nt(t, e, this._oneTimeListeners), this
        }, st.prototype.fire = function (t, e) {
            "string" == typeof t && (t = new at(t, e || {}));
            var r = t.type;
            if (this.listens(r)) {
                t.target = this;
                for (var n = 0, i = this._listeners && this._listeners[r] ? this._listeners[r].slice() : []; n < i.length; n += 1) i[n].call(this, t);
                for (var a = 0, o = this._oneTimeListeners && this._oneTimeListeners[r] ? this._oneTimeListeners[r].slice() : []; a < o.length; a += 1) {
                    var s = o[a];
                    it(r, s, this._oneTimeListeners), s.call(this, t);
                }
                var u = this._eventedParent;
                u && (p(t, "function" == typeof this._eventedParentData ? this._eventedParentData() : this._eventedParentData), u.fire(t));
            } else t instanceof ot && console.error(t.error);
            return this
        }, st.prototype.listens = function (t) {
            return this._listeners && this._listeners[t] && this._listeners[t].length > 0 || this._oneTimeListeners && this._oneTimeListeners[t] && this._oneTimeListeners[t].length > 0 || this._eventedParent && this._eventedParent.listens(t)
        }, st.prototype.setEventedParent = function (t, e) {
            return this._eventedParent = t, this._eventedParentData = e, this
        };
        var ut = {
                $version: 8,
                $root: {
                    version: {
                        required: !0,
                        type: "enum",
                        values: [8]
                    },
                    name: {
                        type: "string"
                    },
                    metadata: {
                        type: "*"
                    },
                    center: {
                        type: "array",
                        value: "number"
                    },
                    zoom: {
                        type: "number"
                    },
                    bearing: {
                        type: "number",
                        default: 0,
                        period: 360,
                        units: "degrees"
                    },
                    pitch: {
                        type: "number",
                        default: 0,
                        units: "degrees"
                    },
                    light: {
                        type: "light"
                    },
                    sources: {
                        required: !0,
                        type: "sources"
                    },
                    sprite: {
                        type: "string"
                    },
                    glyphs: {
                        type: "string"
                    },
                    transition: {
                        type: "transition"
                    },
                    layers: {
                        required: !0,
                        type: "array",
                        value: "layer"
                    }
                },
                sources: {
                    "*": {
                        type: "source"
                    }
                },
                source: ["source_vector", "source_raster", "source_raster_dem", "source_geojson", "source_video", "source_image"],
                source_vector: {
                    type: {
                        required: !0,
                        type: "enum",
                        values: {
                            vector: {}
                        }
                    },
                    url: {
                        type: "string"
                    },
                    tiles: {
                        type: "array",
                        value: "string"
                    },
                    bounds: {
                        type: "array",
                        value: "number",
                        length: 4,
                        default: [-180, -85.051129, 180, 85.051129]
                    },
                    scheme: {
                        type: "enum",
                        values: {
                            xyz: {},
                            tms: {}
                        },
                        default: "xyz"
                    },
                    minzoom: {
                        type: "number",
                        default: 0
                    },
                    maxzoom: {
                        type: "number",
                        default: 22
                    },
                    attribution: {
                        type: "string"
                    },
                    promoteId: {
                        type: "promoteId"
                    },
                    "*": {
                        type: "*"
                    }
                },
                source_raster: {
                    type: {
                        required: !0,
                        type: "enum",
                        values: {
                            raster: {}
                        }
                    },
                    url: {
                        type: "string"
                    },
                    tiles: {
                        type: "array",
                        value: "string"
                    },
                    bounds: {
                        type: "array",
                        value: "number",
                        length: 4,
                        default: [-180, -85.051129, 180, 85.051129]
                    },
                    minzoom: {
                        type: "number",
                        default: 0
                    },
                    maxzoom: {
                        type: "number",
                        default: 22
                    },
                    tileSize: {
                        type: "number",
                        default: 512,
                        units: "pixels"
                    },
                    scheme: {
                        type: "enum",
                        values: {
                            xyz: {},
                            tms: {}
                        },
                        default: "xyz"
                    },
                    attribution: {
                        type: "string"
                    },
                    "*": {
                        type: "*"
                    }
                },
                source_raster_dem: {
                    type: {
                        required: !0,
                        type: "enum",
                        values: {
                            "raster-dem": {}
                        },
                        expose: !1
                    },
                    url: {
                        type: "string",
                        expose: !1
                    },
                    tiles: {
                        type: "array",
                        value: "string",
                        expose: !1
                    },
                    bounds: {
                        type: "array",
                        value: "number",
                        length: 4,
                        default: [-180, -85.051129, 180, 85.051129],
                        expose: !1
                    },
                    minzoom: {
                        type: "number",
                        default: 0,
                        expose: !1
                    },
                    maxzoom: {
                        type: "number",
                        default: 22,
                        expose: !1
                    },
                    tileSize: {
                        type: "number",
                        default: 512,
                        units: "pixels",
                        expose: !1
                    },
                    attribution: {
                        type: "string",
                        expose: !1
                    },
                    encoding: {
                        type: "enum",
                        values: {
                            terrarium: {},
                            minemap: {}
                        },
                        default: "minemap",
                        expose: !1
                    },
                    "*": {
                        type: "*",
                        expose: !1
                    }
                },
                source_geojson: {
                    type: {
                        required: !0,
                        type: "enum",
                        values: {
                            geojson: {}
                        }
                    },
                    data: {
                        type: "*"
                    },
                    maxzoom: {
                        type: "number",
                        default: 18
                    },
                    attribution: {
                        type: "string"
                    },
                    buffer: {
                        type: "number",
                        default: 128,
                        maximum: 512,
                        minimum: 0
                    },
                    tolerance: {
                        type: "number",
                        default: .375
                    },
                    cluster: {
                        type: "boolean",
                        default: !1
                    },
                    clusterRadius: {
                        type: "number",
                        default: 50,
                        minimum: 0
                    },
                    clusterMaxZoom: {
                        type: "number"
                    },
                    clusterProperties: {
                        type: "*"
                    },
                    lineMetrics: {
                        type: "boolean",
                        default: !1
                    },
                    generateId: {
                        type: "boolean",
                        default: !1
                    },
                    promoteId: {
                        type: "promoteId"
                    }
                },
                source_video: {
                    type: {
                        required: !0,
                        type: "enum",
                        values: {
                            video: {}
                        }
                    },
                    urls: {
                        required: !0,
                        type: "array",
                        value: "string"
                    },
                    coordinates: {
                        required: !0,
                        type: "array",
                        length: 4,
                        value: {
                            type: "array",
                            length: 2,
                            value: "number"
                        }
                    }
                },
                source_image: {
                    type: {
                        required: !0,
                        type: "enum",
                        values: {
                            image: {}
                        }
                    },
                    url: {
                        required: !0,
                        type: "string"
                    },
                    coordinates: {
                        required: !0,
                        type: "array",
                        length: 4,
                        value: {
                            type: "array",
                            length: 2,
                            value: "number"
                        }
                    },
                    wms: {
                        type: "boolean",
                        default: !1
                    }
                },
                layer: {
                    id: {
                        type: "string",
                        required: !0
                    },
                    type: {
                        type: "enum",
                        values: {
                            fill: {},
                            line: {},
                            symbol: {},
                            circle: {},
                            heatmap: {},
                            extrusion: {},
                            raster: {},
                            hillshade: {
                                expose: !1
                            },
                            airline: {},
                            dynamicLine: {},
                            sprite: {},
                            histogram: {},
                            tracking: {},
                            symtracking: {},
                            background: {}
                        },
                        required: !0
                    },
                    metadata: {
                        type: "*"
                    },
                    source: {
                        type: "string"
                    },
                    "source-layer": {
                        type: "string"
                    },
                    minzoom: {
                        type: "number",
                        minimum: 0,
                        maximum: 24
                    },
                    maxzoom: {
                        type: "number",
                        minimum: 0,
                        maximum: 24
                    },
                    filter: {
                        type: "filter"
                    },
                    layout: {
                        type: "layout"
                    },
                    paint: {
                        type: "paint"
                    }
                },
                layout: ["layout_fill", "layout_line", "layout_circle", "layout_heatmap", "layout_extrusion", "layout_symbol", "layout_raster", "layout_hillshade", "layout_background", "layout_airline", "layout_dynamicLine", "layout_sprite", "layout_histogram", "layout_tracking", "layout_symtracking"],
                layout_background: {
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_fill: {
                    "fill-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_circle: {
                    "circle-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_heatmap: {
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_extrusion: {
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_airline: {
                    "airline-cap": {
                        type: "enum",
                        values: {
                            butt: {},
                            round: {},
                            square: {}
                        },
                        default: "butt",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "airline-join": {
                        type: "enum",
                        values: {
                            bevel: {},
                            round: {},
                            miter: {}
                        },
                        default: "miter",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "airline-miter-limit": {
                        type: "number",
                        default: 2,
                        requires: [{
                            "airline-join": "miter"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "airline-round-limit": {
                        type: "number",
                        default: 1.05,
                        requires: [{
                            "airline-join": "round"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "airline-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_symbol: {
                    "symbol-placement": {
                        type: "enum",
                        values: {
                            point: {},
                            line: {},
                            "line-center": {}
                        },
                        default: "point",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "symbol-spacing": {
                        type: "number",
                        default: 250,
                        minimum: 1,
                        units: "pixels",
                        requires: [{
                            "symbol-placement": "line"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "symbol-avoid-edges": {
                        type: "boolean",
                        default: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "symbol-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "symbol-z-order": {
                        type: "enum",
                        values: {
                            auto: {},
                            "viewport-y": {},
                            source: {}
                        },
                        default: "auto",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-allow-overlap": {
                        type: "boolean",
                        default: !1,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-ignore-placement": {
                        type: "boolean",
                        default: !1,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-optional": {
                        type: "boolean",
                        default: !1,
                        requires: ["icon-image", "text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-rotation-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "auto",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-size": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        units: "factor of the original icon size",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-text-fit": {
                        type: "enum",
                        values: {
                            none: {},
                            width: {},
                            height: {},
                            both: {}
                        },
                        default: "none",
                        requires: ["icon-image", "text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-text-fit-padding": {
                        type: "array",
                        value: "number",
                        length: 4,
                        default: [0, 0, 0, 0],
                        units: "pixels",
                        requires: ["icon-image", "text-field", {
                            "icon-text-fit": ["both", "width", "height"]
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-image": {
                        type: "resolvedImage",
                        tokens: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-rotate": {
                        type: "number",
                        default: 0,
                        period: 360,
                        units: "degrees",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-padding": {
                        type: "number",
                        default: 2,
                        minimum: 0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-keep-upright": {
                        type: "boolean",
                        default: !1,
                        requires: ["icon-image", {
                            "icon-rotation-alignment": "map"
                        }, {
                            "symbol-placement": ["line", "line-center"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-offset": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-anchor": {
                        type: "enum",
                        values: {
                            center: {},
                            left: {},
                            right: {},
                            top: {},
                            bottom: {},
                            "top-left": {},
                            "top-right": {},
                            "bottom-left": {},
                            "bottom-right": {}
                        },
                        default: "center",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-pitch-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "auto",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-pitch-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "auto",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-rotation-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "auto",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-field": {
                        type: "formatted",
                        default: "",
                        tokens: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-font": {
                        type: "array",
                        value: "string",
                        default: ["Open Sans Regular", "Arial Unicode MS Regular"],
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-size": {
                        type: "number",
                        default: 16,
                        minimum: 0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-max-width": {
                        type: "number",
                        default: 10,
                        minimum: 0,
                        units: "ems",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-line-height": {
                        type: "number",
                        default: 1.2,
                        units: "ems",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-letter-spacing": {
                        type: "number",
                        default: 0,
                        units: "ems",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-justify": {
                        type: "enum",
                        values: {
                            auto: {},
                            left: {},
                            center: {},
                            right: {}
                        },
                        default: "center",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-radial-offset": {
                        type: "number",
                        units: "ems",
                        default: 0,
                        requires: ["text-field"],
                        "property-type": "data-driven",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        }
                    },
                    "text-variable-anchor": {
                        type: "array",
                        value: "enum",
                        values: {
                            center: {},
                            left: {},
                            right: {},
                            top: {},
                            bottom: {},
                            "top-left": {},
                            "top-right": {},
                            "bottom-left": {},
                            "bottom-right": {}
                        },
                        requires: ["text-field", {
                            "symbol-placement": ["point"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-anchor": {
                        type: "enum",
                        values: {
                            center: {},
                            left: {},
                            right: {},
                            top: {},
                            bottom: {},
                            "top-left": {},
                            "top-right": {},
                            "bottom-left": {},
                            "bottom-right": {}
                        },
                        default: "center",
                        requires: ["text-field", {
                            "!": "text-variable-anchor"
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-max-angle": {
                        type: "number",
                        default: 45,
                        units: "degrees",
                        requires: ["text-field", {
                            "symbol-placement": ["line", "line-center"]
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-writing-mode": {
                        type: "array",
                        value: "enum",
                        values: {
                            horizontal: {},
                            vertical: {}
                        },
                        requires: ["text-field", {
                            "symbol-placement": ["point"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-rotate": {
                        type: "number",
                        default: 0,
                        period: 360,
                        units: "degrees",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-padding": {
                        type: "number",
                        default: 2,
                        minimum: 0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-keep-upright": {
                        type: "boolean",
                        default: !0,
                        requires: ["text-field", {
                            "text-rotation-alignment": "map"
                        }, {
                            "symbol-placement": ["line", "line-center"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-transform": {
                        type: "enum",
                        values: {
                            none: {},
                            uppercase: {},
                            lowercase: {}
                        },
                        default: "none",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-offset": {
                        type: "array",
                        value: "number",
                        units: "ems",
                        length: 2,
                        default: [0, 0],
                        requires: ["text-field", {
                            "!": "text-radial-offset"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "text-allow-overlap": {
                        type: "boolean",
                        default: !1,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-ignore-placement": {
                        type: "boolean",
                        default: !1,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-optional": {
                        type: "boolean",
                        default: !1,
                        requires: ["text-field", "icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_raster: {
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_hillshade: {
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant",
                        expose: !1
                    }
                },
                layout_line: {
                    "line-cap": {
                        type: "enum",
                        values: {
                            butt: {},
                            round: {},
                            square: {}
                        },
                        default: "butt",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "line-join": {
                        type: "enum",
                        values: {
                            bevel: {},
                            round: {},
                            miter: {}
                        },
                        default: "miter",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-miter-limit": {
                        type: "number",
                        default: 2,
                        requires: [{
                            "line-join": "miter"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "line-round-limit": {
                        type: "number",
                        default: 1.05,
                        requires: [{
                            "line-join": "round"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "line-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    },
                    "border-visibility": {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "none",
                        "property-type": "constant"
                    }
                },
                layout_dynamicLine: {
                    "dynamicLine-cap": {
                        type: "enum",
                        values: {
                            butt: {},
                            round: {},
                            square: {}
                        },
                        default: "butt",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "dynamicLine-join": {
                        type: "enum",
                        values: {
                            bevel: {},
                            round: {},
                            miter: {}
                        },
                        default: "miter",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "dynamicLine-miter-limit": {
                        type: "number",
                        default: 2,
                        requires: [{
                            "dynamicLine-join": "miter"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "dynamicLine-round-limit": {
                        type: "number",
                        default: 1.05,
                        requires: [{
                            "dynamicLine-join": "round"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "dynamicLine-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_sprite: {
                    "sprite-cap": {
                        type: "enum",
                        values: {
                            butt: {},
                            round: {},
                            square: {}
                        },
                        default: "butt",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "sprite-join": {
                        type: "enum",
                        values: {
                            bevel: {},
                            round: {},
                            miter: {}
                        },
                        default: "miter",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "sprite-miter-limit": {
                        type: "number",
                        default: 2,
                        requires: [{
                            "sprite-join": "miter"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "sprite-round-limit": {
                        type: "number",
                        default: 1.05,
                        requires: [{
                            "sprite-join": "round"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "sprite-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                layout_histogram: {
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    },
                    "histogram-max-height-render": {
                        type: "boolean",
                        default: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "histogram-color-render": {
                        type: "boolean",
                        default: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    }
                },
                layout_tracking: {
                    "tracking-cap": {
                        type: "enum",
                        values: {
                            butt: {},
                            round: {},
                            square: {}
                        },
                        default: "butt",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "tracking-join": {
                        type: "enum",
                        values: {
                            bevel: {},
                            round: {},
                            miter: {}
                        },
                        default: "miter",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "tracking-miter-limit": {
                        type: "number",
                        default: 2,
                        requires: [{
                            "tracking-join": "miter"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "tracking-round-limit": {
                        type: "number",
                        default: 1.05,
                        requires: [{
                            "tracking-join": "round"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "tracking-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    },
                    "tracking-display-mode": {
                        type: "enum",
                        values: ["loop", "reverse", "loop-reserve", "reverse-reserve"],
                        default: "loop",
                        "property-type": "constant"
                    }
                },
                layout_symtracking: {
                    "symtracking-time-segment": {
                        type: "number",
                        default: 20,
                        minimum: 1,
                        units: "second",
                        "property-type": "constant"
                    },
                    "symtracking-fps": {
                        type: "number",
                        default: 1,
                        minimum: 1,
                        "property-type": "constant"
                    },
                    "compatible-mode": {
                        type: "boolean",
                        default: !0,
                        "property-type": "constant"
                    },
                    "symbol-spacing": {
                        type: "number",
                        default: 250,
                        minimum: 1,
                        units: "pixels",
                        requires: [{
                            "symbol-placement": "line"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "symbol-sort-key": {
                        type: "number",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "symbol-z-order": {
                        type: "enum",
                        values: {
                            auto: {},
                            "viewport-y": {},
                            source: {}
                        },
                        default: "auto",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "symbol-placement": {
                        type: "enum",
                        values: {
                            point: {},
                            line: {},
                            "line-center": {}
                        },
                        default: "point",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "symbol-avoid-edges": {
                        type: "boolean",
                        default: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-allow-overlap": {
                        type: "boolean",
                        default: !1,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-ignore-placement": {
                        type: "boolean",
                        default: !0,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-optional": {
                        type: "boolean",
                        default: !1,
                        requires: ["icon-image", "text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-rotation-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "map",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-size": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        units: "图标原始大小的倍数因子",
                        "units-en": "factor of the original icon size",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-text-fit": {
                        type: "enum",
                        values: {
                            none: {},
                            width: {},
                            height: {},
                            both: {}
                        },
                        default: "none",
                        requires: ["icon-image", "text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-text-fit-padding": {
                        type: "array",
                        value: "number",
                        length: 4,
                        default: [0, 0, 0, 0],
                        units: "pixels",
                        requires: ["icon-image", "text-field", {
                            "icon-text-fit": ["both", "width", "height"]
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-image": {
                        type: "resolvedImage",
                        tokens: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-rotate": {
                        type: "number",
                        default: 0,
                        period: 360,
                        units: "degrees",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "icon-padding": {
                        type: "number",
                        default: 2,
                        minimum: 0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-keep-upright": {
                        type: "boolean",
                        default: !1,
                        requires: ["icon-image", {
                            "icon-rotation-alignment": "map"
                        }, {
                            "symbol-placement": ["line", "line-center"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-offset": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "icon-anchor": {
                        type: "enum",
                        values: {
                            center: {},
                            left: {},
                            right: {},
                            top: {},
                            bottom: {},
                            "top-left": {},
                            "top-right": {},
                            "bottom-left": {},
                            "bottom-right": {}
                        },
                        default: "center",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "icon-pitch-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "auto",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-pitch-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "auto",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-rotation-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {},
                            auto: {}
                        },
                        default: "auto",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-field": {
                        type: "formatted",
                        default: "",
                        tokens: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-font": {
                        type: "array",
                        value: "string",
                        default: ["Open Sans Regular", "Arial Unicode MS Regular"],
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-size": {
                        type: "number",
                        default: 16,
                        minimum: 0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-max-width": {
                        type: "number",
                        default: 10,
                        minimum: 0,
                        units: "ems",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-line-height": {
                        type: "number",
                        default: 1.2,
                        units: "ems",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-letter-spacing": {
                        type: "number",
                        default: 0,
                        units: "ems",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-justify": {
                        type: "enum",
                        values: {
                            auto: {},
                            left: {},
                            center: {},
                            right: {}
                        },
                        default: "center",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-radial-offset": {
                        type: "number",
                        units: "ems",
                        default: 0,
                        requires: ["text-field"],
                        "property-type": "data-driven",
                        expose: !1,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        }
                    },
                    "text-variable-anchor": {
                        type: "array",
                        value: "enum",
                        values: {
                            center: {},
                            left: {},
                            right: {},
                            top: {},
                            bottom: {},
                            "top-left": {},
                            "top-right": {},
                            "bottom-left": {},
                            "bottom-right": {}
                        },
                        requires: ["text-field", {
                            "symbol-placement": ["point"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-anchor": {
                        type: "enum",
                        values: {
                            center: {},
                            left: {},
                            right: {},
                            top: {},
                            bottom: {},
                            "top-left": {},
                            "top-right": {},
                            "bottom-left": {},
                            "bottom-right": {}
                        },
                        default: "center",
                        requires: ["text-field", {
                            "!": "text-variable-anchor"
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-max-angle": {
                        type: "number",
                        default: 45,
                        units: "degrees",
                        requires: ["text-field", {
                            "symbol-placement": ["line", "line-center"]
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-writing-mode": {
                        type: "array",
                        value: "enum",
                        values: {
                            horizontal: {},
                            vertical: {}
                        },
                        requires: ["text-field", {
                            "symbol-placement": ["point"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-rotate": {
                        type: "number",
                        default: 0,
                        period: 360,
                        units: "degrees",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-padding": {
                        type: "number",
                        default: 2,
                        minimum: 0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-keep-upright": {
                        type: "boolean",
                        default: !0,
                        requires: ["text-field", {
                            "text-rotation-alignment": "map"
                        }, {
                            "symbol-placement": ["line", "line-center"]
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-transform": {
                        type: "enum",
                        values: {
                            none: {},
                            uppercase: {},
                            lowercase: {}
                        },
                        default: "none",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-offset": {
                        type: "array",
                        value: "number",
                        units: "ems",
                        length: 2,
                        default: [0, 0],
                        requires: ["text-field", {
                            "!": "text-radial-offset"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-allow-overlap": {
                        type: "boolean",
                        default: !1,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-ignore-placement": {
                        type: "boolean",
                        default: !1,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-optional": {
                        type: "boolean",
                        default: !1,
                        requires: ["text-field", "icon-image"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    visibility: {
                        type: "enum",
                        values: {
                            visible: {},
                            none: {}
                        },
                        default: "visible",
                        "property-type": "constant"
                    }
                },
                filter: {
                    type: "array",
                    value: "*"
                },
                filter_operator: {
                    type: "enum",
                    values: {
                        "==": {},
                        "!=": {},
                        ">": {},
                        ">=": {},
                        "<": {},
                        "<=": {},
                        like: {},
                        start: {},
                        end: {},
                        in: {},
                        "!in": {},
                        arrin: {},
                        "!arrin": {},
                        all: {},
                        any: {},
                        none: {},
                        has: {},
                        "!has": {},
                        within: {}
                    }
                },
                geometry_type: {
                    type: "enum",
                    values: {
                        Point: {},
                        LineString: {},
                        Polygon: {}
                    }
                },
                function: {
                    expression: {
                        type: "expression"
                    },
                    stops: {
                        type: "array",
                        value: "function_stop"
                    },
                    base: {
                        type: "number",
                        default: 1,
                        minimum: 0
                    },
                    property: {
                        type: "string",
                        default: "$zoom"
                    },
                    type: {
                        type: "enum",
                        values: {
                            identity: {},
                            exponential: {},
                            interval: {},
                            categorical: {}
                        },
                        default: "exponential"
                    },
                    colorSpace: {
                        type: "enum",
                        values: {
                            rgb: {},
                            lab: {},
                            hcl: {}
                        },
                        default: "rgb"
                    },
                    default: {
                        type: "*",
                        required: !1
                    }
                },
                function_stop: {
                    type: "array",
                    minimum: 0,
                    maximum: 24,
                    value: ["number", "color"],
                    length: 2
                },
                expression: {
                    type: "array",
                    value: "*",
                    minimum: 1
                },
                expression_name: {
                    type: "enum",
                    values: {
                        let: {
                            group: "Variable binding"
                        },
                        var: {
                            group: "Variable binding"
                        },
                        literal: {
                            group: "Types"
                        },
                        array: {
                            group: "Types"
                        },
                        at: {
                            group: "Lookup"
                        },
                        in: {
                            group: "Lookup"
                        },
                        "index-of": {
                            group: "Lookup"
                        },
                        slice: {
                            group: "Lookup"
                        },
                        case: {
                            group: "Decision"
                        },
                        match: {
                            group: "Decision"
                        },
                        coalesce: {
                            group: "Decision"
                        },
                        step: {
                            group: "Ramps, scales, curves"
                        },
                        interpolate: {
                            group: "Ramps, scales, curves"
                        },
                        "interpolate-hcl": {
                            group: "Ramps, scales, curves"
                        },
                        "interpolate-lab": {
                            group: "Ramps, scales, curves"
                        },
                        ln2: {
                            group: "Math"
                        },
                        pi: {
                            group: "Math"
                        },
                        e: {
                            group: "Math"
                        },
                        typeof: {
                            group: "Types"
                        },
                        string: {
                            group: "Types"
                        },
                        number: {
                            group: "Types"
                        },
                        boolean: {
                            group: "Types"
                        },
                        object: {
                            group: "Types"
                        },
                        collator: {
                            group: "Types"
                        },
                        format: {
                            group: "Types"
                        },
                        image: {
                            group: "Types"
                        },
                        "number-format": {
                            group: "Types"
                        },
                        "to-string": {
                            group: "Types"
                        },
                        "to-number": {
                            group: "Types"
                        },
                        "to-boolean": {
                            group: "Types"
                        },
                        "to-rgba": {
                            group: "Color"
                        },
                        "to-color": {
                            group: "Types"
                        },
                        rgb: {
                            group: "Color"
                        },
                        rgba: {
                            group: "Color"
                        },
                        get: {
                            group: "Lookup"
                        },
                        has: {
                            group: "Lookup"
                        },
                        length: {
                            group: "Lookup"
                        },
                        properties: {
                            group: "Feature data"
                        },
                        "feature-state": {
                            group: "Feature data"
                        },
                        "geometry-type": {
                            group: "Feature data"
                        },
                        id: {
                            group: "Feature data"
                        },
                        zoom: {
                            group: "Zoom"
                        },
                        "heatmap-density": {
                            group: "Heatmap"
                        },
                        "line-progress": {
                            group: "Feature data"
                        },
                        accumulated: {
                            group: "Feature data"
                        },
                        "+": {
                            group: "Math"
                        },
                        "*": {
                            group: "Math"
                        },
                        "-": {
                            group: "Math"
                        },
                        "/": {
                            group: "Math"
                        },
                        "%": {
                            group: "Math"
                        },
                        "^": {
                            group: "Math"
                        },
                        sqrt: {
                            group: "Math"
                        },
                        log10: {
                            group: "Math"
                        },
                        ln: {
                            group: "Math"
                        },
                        log2: {
                            group: "Math"
                        },
                        sin: {
                            group: "Math"
                        },
                        cos: {
                            group: "Math"
                        },
                        tan: {
                            group: "Math"
                        },
                        asin: {
                            group: "Math"
                        },
                        acos: {
                            group: "Math"
                        },
                        atan: {
                            group: "Math"
                        },
                        min: {
                            group: "Math"
                        },
                        max: {
                            group: "Math"
                        },
                        round: {
                            group: "Math"
                        },
                        abs: {
                            group: "Math"
                        },
                        ceil: {
                            group: "Math"
                        },
                        floor: {
                            group: "Math"
                        },
                        distance: {
                            group: "Math"
                        },
                        "==": {
                            group: "Decision"
                        },
                        "!=": {
                            group: "Decision"
                        },
                        ">": {
                            group: "Decision"
                        },
                        "<": {
                            group: "Decision"
                        },
                        ">=": {
                            group: "Decision"
                        },
                        "<=": {
                            group: "Decision"
                        },
                        all: {
                            group: "Decision"
                        },
                        any: {
                            group: "Decision"
                        },
                        "!": {
                            group: "Decision"
                        },
                        within: {
                            group: "Decision"
                        },
                        "is-supported-script": {
                            group: "String"
                        },
                        upcase: {
                            group: "String"
                        },
                        downcase: {
                            group: "String"
                        },
                        concat: {
                            group: "String"
                        },
                        "resolved-locale": {
                            group: "String"
                        }
                    }
                },
                light: {
                    anchor: {
                        type: "enum",
                        default: "viewport",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        "property-type": "data-constant",
                        transition: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        }
                    },
                    position: {
                        type: "array",
                        default: [1.15, 210, 30],
                        length: 3,
                        value: "number",
                        "property-type": "data-constant",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        }
                    },
                    color: {
                        type: "color",
                        "property-type": "data-constant",
                        default: "#ffffff",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        transition: !0
                    },
                    intensity: {
                        type: "number",
                        "property-type": "data-constant",
                        default: .5,
                        minimum: 0,
                        maximum: 1,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        transition: !0
                    }
                },
                paint: ["paint_fill", "paint_line", "paint_circle", "paint_heatmap", "paint_extrusion", "paint_symbol", "paint_raster", "paint_hillshade", "paint_background", "paint_airline", "paint_dynamicLine", "paint_sprite", "paint_symtracking", "paint_histogram"],
                paint_fill: {
                    "fill-antialias": {
                        type: "boolean",
                        default: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "fill-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "fill-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "fill-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "fill-outline-color": {
                        type: "color",
                        transition: !0,
                        requires: [{
                            "!": "fill-pattern"
                        }, {
                            "fill-antialias": !0
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "fill-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "fill-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["fill-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "fill-pattern": {
                        type: "resolvedImage",
                        transition: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "cross-faded-data-driven"
                    },
                    "fill-water": {
                        type: "enum",
                        values: {
                            water: {},
                            none: {}
                        },
                        default: "none",
                        "zoom-function": !1,
                        "property-function": !1,
                        "property-type": "data-constant",
                        transition: !1
                    }
                },
                paint_extrusion: {
                    "extrusion-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "extrusion-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "extrusion-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "extrusion-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "extrusion-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["extrusion-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "extrusion-pattern": {
                        type: "resolvedImage",
                        transition: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "cross-faded-data-driven"
                    },
                    "extrusion-height": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        units: "meters",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "extrusion-base": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        units: "meters",
                        transition: !0,
                        requires: ["extrusion-height"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "extrusion-vertical-gradient": {
                        type: "boolean",
                        default: !0,
                        transition: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    }
                },
                paint_airline: {
                    "airline-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "airline-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "airline-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "airline-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "airline-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["airline-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "airline-width": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "airline-gap-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "airline-offset": {
                        type: "number",
                        default: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "airline-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "airline-seg-group": {
                        type: "number",
                        default: 1,
                        requires: [{
                            "airline-type": "history"
                        }],
                        minimum: 1,
                        maximum: 600,
                        "property-type": "constant"
                    },
                    "airline-speed": {
                        type: "number",
                        default: 1,
                        requires: [{
                            "airline-type": "history"
                        }],
                        minimum: 1,
                        maximum: 500,
                        "property-type": "constant"
                    },
                    "airline-type": {
                        type: "enum",
                        values: {
                            history: {},
                            none: {}
                        },
                        default: "none",
                        "property-type": "constant"
                    }
                },
                paint_circle: {
                    "circle-radius": {
                        type: "number",
                        default: 5,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "circle-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "circle-blur": {
                        type: "number",
                        default: 0,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "circle-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "circle-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "circle-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["circle-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "circle-pitch-scale": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "circle-pitch-alignment": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "viewport",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "circle-stroke-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "circle-stroke-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "circle-stroke-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    }
                },
                paint_heatmap: {
                    "heatmap-radius": {
                        type: "number",
                        default: 30,
                        minimum: 1,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "heatmap-weight": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        transition: !1,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "heatmap-intensity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "heatmap-color": {
                        type: "color",
                        default: ["interpolate", ["linear"],
                            ["heatmap-density"], 0, "rgba(0, 0, 255, 0)", .1, "royalblue", .3, "cyan", .5, "lime", .7, "yellow", 1, "red"
                        ],
                        transition: !1,
                        expression: {
                            interpolated: !0,
                            parameters: ["heatmap-density"]
                        },
                        "property-type": "color-ramp"
                    },
                    "heatmap-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    }
                },
                paint_symbol: {
                    "icon-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-halo-color": {
                        type: "color",
                        default: "rgba(0, 0, 0, 0)",
                        transition: !0,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-halo-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-halo-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "icon-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["icon-image", "icon-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "text-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        overridable: !0,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-halo-color": {
                        type: "color",
                        default: "rgba(0, 0, 0, 0)",
                        transition: !0,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-halo-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-halo-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["text-field", "text-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    }
                },
                paint_raster: {
                    "raster-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "raster-hue-rotate": {
                        type: "number",
                        default: 0,
                        period: 360,
                        transition: !0,
                        units: "degrees",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "raster-brightness-min": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "raster-brightness-max": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "raster-saturation": {
                        type: "number",
                        default: 0,
                        minimum: -1,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "raster-contrast": {
                        type: "number",
                        default: 0,
                        minimum: -1,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "raster-resampling": {
                        type: "enum",
                        values: {
                            linear: {},
                            nearest: {}
                        },
                        default: "linear",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "raster-fade-duration": {
                        type: "number",
                        default: 300,
                        minimum: 0,
                        transition: !1,
                        units: "milliseconds",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    }
                },
                paint_hillshade: {
                    "hillshade-illumination-direction": {
                        type: "number",
                        default: 335,
                        minimum: 0,
                        maximum: 359,
                        transition: !1,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "hillshade-illumination-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "viewport",
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "hillshade-exaggeration": {
                        type: "number",
                        default: .5,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "hillshade-shadow-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "hillshade-highlight-color": {
                        type: "color",
                        default: "#FFFFFF",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "hillshade-accent-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    }
                },
                paint_background: {
                    "background-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "background-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "background-pattern": {
                        type: "resolvedImage",
                        transition: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "cross-faded"
                    },
                    "background-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    }
                },
                paint_line: {
                    "line-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "line-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "line-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["line-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "line-width": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-border-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-border-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "line-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-border-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-gap-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-offset": {
                        type: "number",
                        default: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "line-dasharray": {
                        type: "array",
                        value: "number",
                        minimum: 0,
                        transition: !0,
                        units: "line widths",
                        requires: [{
                            "!": "line-pattern"
                        }],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "cross-faded"
                    },
                    "line-pattern": {
                        type: "resolvedImage",
                        transition: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "cross-faded-data-driven"
                    },
                    "line-gradient": {
                        type: "color",
                        transition: !1,
                        requires: [{
                            "!": "line-dasharray"
                        }, {
                            "!": "line-pattern"
                        }, {
                            source: "geojson",
                            has: {
                                lineMetrics: !0
                            }
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["line-progress"]
                        },
                        "property-type": "color-ramp"
                    },
                    "half-render": {
                        type: "boolean",
                        default: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "line-normal-direction": {
                        type: "boolean",
                        default: !0,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom", "feature"]
                        },
                        "property-type": "data-driven"
                    }
                },
                paint_dynamicLine: {
                    "dynamicLine-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "dynamicLine-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "dynamicLine-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "dynamicLine-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "dynamicLine-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["dynamicLine-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "dynamicLine-width": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "dynamicLine-gap-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "dynamicLine-offset": {
                        type: "number",
                        default: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "dynamicLine-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "dynamicLine-seg-group": {
                        type: "number",
                        default: 20,
                        minimum: 1,
                        maximum: 600,
                        "property-type": "constant"
                    },
                    "dynamicLine-speed": {
                        type: "number",
                        default: 1,
                        minimum: 1,
                        maximum: 500,
                        "property-type": "constant"
                    }
                },
                paint_sprite: {
                    "sprite-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "sprite-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "sprite-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "sprite-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "sprite-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["sprite-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "sprite-width": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "sprite-gap-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "sprite-offset": {
                        type: "number",
                        default: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "sprite-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "sprite-speed-factor": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 4,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "sprite-speed": {
                        type: "number",
                        default: 60,
                        minimum: 1,
                        maximum: 2e3,
                        transition: !0,
                        "property-type": "data-constant"
                    }
                },
                paint_histogram: {
                    "histogram-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "histogram-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "histogram-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "histogram-colors": {
                        type: "array",
                        value: "string",
                        length: 5,
                        default: ["#ffc1e0", "#bbffff", "#00e3e3", "#005757", "#ea0000"],
                        "property-type": "data-constant"
                    },
                    "histogram-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "histogram-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["histogram-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "histogram-height": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        units: "meters",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "histogram-base": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        units: "meters",
                        transition: !0,
                        requires: ["histogram-height"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "histogram-vertical-gradient": {
                        type: "boolean",
                        default: !0,
                        transition: !1,
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "histogram-dynamic": {
                        type: "boolean",
                        default: !1,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        expose: !1,
                        "property-type": "data-constant"
                    },
                    "histogram-heightArr1": {
                        type: "color",
                        default: [0, 0, 0, 0],
                        transition: !0,
                        units: "x-color",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        expose: !1,
                        "property-type": "data-driven"
                    },
                    "histogram-heightArr2": {
                        type: "color",
                        default: [0, 0, 0, 0],
                        transition: !0,
                        units: "x-color",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        expose: !1,
                        "property-type": "data-driven"
                    },
                    "histogram-heightArr3": {
                        type: "color",
                        default: [0, 0, 0, 0],
                        transition: !0,
                        units: "x-color",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        expose: !1,
                        "property-type": "data-driven"
                    },
                    "histogram-speed": {
                        type: "number",
                        default: 1,
                        minimum: 1,
                        maximum: 1e3,
                        transition: !0,
                        "property-type": "data-constant"
                    },
                    "histogram-count": {
                        type: "number",
                        default: 12,
                        minimum: 1,
                        maximum: 12,
                        units: "millisecond",
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "histogram-max-height": {
                        type: "number",
                        default: 200,
                        minimum: 0,
                        units: "meters",
                        "property-type": "data-constant"
                    },
                    "depth-change": {
                        type: "boolean",
                        default: !1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-constant"
                    }
                },
                paint_tracking: {
                    "tracking-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "tracking-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: [{
                            "!": "tracking-pattern"
                        }],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "tracking-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "tracking-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["tracking-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant"
                    },
                    "tracking-width": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "tracking-gap-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "tracking-offset": {
                        type: "number",
                        default: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "tracking-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "tracking-seg-count": {
                        type: "number",
                        default: 700,
                        minimum: 0,
                        maximum: 1e4,
                        transition: !0,
                        "property-type": "data-constant"
                    },
                    "tracking-seg-group": {
                        type: "number",
                        default: 20,
                        minimum: 1,
                        maximum: 600,
                        transition: !0,
                        "property-type": "data-constant"
                    },
                    "tracking-speed": {
                        type: "number",
                        default: 1,
                        minimum: 1,
                        maximum: 500,
                        transition: !0,
                        "property-type": "data-constant"
                    }
                },
                paint_symtracking: {
                    "icon-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-halo-color": {
                        type: "color",
                        default: "rgba(0, 0, 0, 0)",
                        transition: !0,
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-halo-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-halo-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven"
                    },
                    "icon-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        requires: ["icon-image"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "icon-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["icon-image", "icon-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-opacity": {
                        type: "number",
                        default: 1,
                        minimum: 0,
                        maximum: 1,
                        transition: !0,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-color": {
                        type: "color",
                        default: "#000000",
                        transition: !0,
                        overridable: !0,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-halo-color": {
                        type: "color",
                        default: "rgba(0, 0, 0, 0)",
                        transition: !0,
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-halo-width": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-halo-blur": {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        transition: !0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom", "feature", "feature-state"]
                        },
                        "property-type": "data-driven",
                        expose: !1
                    },
                    "text-translate": {
                        type: "array",
                        value: "number",
                        length: 2,
                        default: [0, 0],
                        transition: !0,
                        units: "pixels",
                        requires: ["text-field"],
                        expression: {
                            interpolated: !0,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "text-translate-anchor": {
                        type: "enum",
                        values: {
                            map: {},
                            viewport: {}
                        },
                        default: "map",
                        requires: ["text-field", "text-translate"],
                        expression: {
                            interpolated: !1,
                            parameters: ["zoom"]
                        },
                        "property-type": "data-constant",
                        expose: !1
                    },
                    "symtracking-delay": {
                        type: "number",
                        default: 10,
                        minimum: 0,
                        maximum: 120,
                        "property-type": "constant"
                    }
                },
                transition: {
                    duration: {
                        type: "number",
                        default: 300,
                        minimum: 0,
                        units: "milliseconds"
                    },
                    delay: {
                        type: "number",
                        default: 0,
                        minimum: 0,
                        units: "milliseconds"
                    }
                },
                "property-type": {
                    "data-driven": {
                        type: "property-type"
                    },
                    "cross-faded": {
                        type: "property-type"
                    },
                    "cross-faded-data-driven": {
                        type: "property-type"
                    },
                    "color-ramp": {
                        type: "property-type"
                    },
                    "data-constant": {
                        type: "property-type"
                    },
                    constant: {
                        type: "property-type"
                    }
                },
                promoteId: {
                    "*": {
                        type: "string"
                    }
                }
            },
            lt = function (t, e, r, n) {
                this.message = (t ? t + ": " : "") + r, n && (this.identifier = n), null != e && e.__line__ && (this.line = e.__line__);
            };

        function pt(t) {
            var e = t.value;
            return e ? [new lt(t.key, e, "constants have been deprecated as of v8")] : []
        }

        function ct(t) {
            for (var e = [], r = arguments.length - 1; r-- > 0;) e[r] = arguments[r + 1];
            for (var n = 0, i = e; n < i.length; n += 1) {
                var a = i[n];
                for (var o in a) t[o] = a[o];
            }
            return t
        }

        function ht(t) {
            return t instanceof Number || t instanceof String || t instanceof Boolean ? t.valueOf() : t
        }

        function yt(t) {
            if (Array.isArray(t)) return t.map(yt);
            if (t instanceof Object && !(t instanceof Number || t instanceof String || t instanceof Boolean)) {
                var e = {};
                for (var r in t) e[r] = yt(t[r]);
                return e
            }
            return ht(t)
        }
        var ft = function (t) {
                function e(e, r) {
                    t.call(this, r), this.message = r, this.key = e;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
            }(Error),
            dt = function (t, e) {
                void 0 === e && (e = []), this.parent = t, this.bindings = {};
                for (var r = 0, n = e; r < n.length; r += 1) {
                    var i = n[r];
                    this.bindings[i[0]] = i[1];
                }
            };
        dt.prototype.concat = function (t) {
            return new dt(this, t)
        }, dt.prototype.get = function (t) {
            if (this.bindings[t]) return this.bindings[t];
            if (this.parent) return this.parent.get(t);
            throw new Error(t + " not found in scope.")
        }, dt.prototype.has = function (t) {
            return !!this.bindings[t] || !!this.parent && this.parent.has(t)
        };
        var mt = {
                kind: "null"
            },
            gt = {
                kind: "number"
            },
            vt = {
                kind: "string"
            },
            xt = {
                kind: "boolean"
            },
            bt = {
                kind: "color"
            },
            _t = {
                kind: "object"
            },
            wt = {
                kind: "value"
            },
            kt = {
                kind: "collator"
            },
            At = {
                kind: "formatted"
            },
            St = {
                kind: "resolvedImage"
            };

        function It(t, e) {
            return {
                kind: "array",
                itemType: t,
                N: e
            }
        }

        function zt(t) {
            if ("array" === t.kind) {
                var e = zt(t.itemType);
                return "number" == typeof t.N ? "array<" + e + ", " + t.N + ">" : "value" === t.itemType.kind ? "array" : "array<" + e + ">"
            }
            return t.kind
        }
        var Bt = [mt, gt, vt, xt, bt, At, _t, It(wt), St];

        function Vt(t, e) {
            if ("error" === e.kind) return null;
            if ("array" === t.kind) {
                if ("array" === e.kind && (0 === e.N && "value" === e.itemType.kind || !Vt(t.itemType, e.itemType)) && ("number" != typeof t.N || t.N === e.N)) return null
            } else {
                if (t.kind === e.kind) return null;
                if ("value" === t.kind)
                    for (var r = 0, n = Bt; r < n.length; r += 1)
                        if (!Vt(n[r], e)) return null
            }
            return "Expected " + zt(t) + " but found " + zt(e) + " instead."
        }

        function Ct(t, e) {
            return e.some((function (e) {
                return e.kind === t.kind
            }))
        }

        function Mt(t, e) {
            return e.some((function (e) {
                return "null" === e ? null === t : "array" === e ? Array.isArray(t) : "object" === e ? t && !Array.isArray(t) && "object" == typeof t : e === typeof t
            }))
        }
        var Pt = e((function (t, e) {
                var r = {
                    transparent: [0, 0, 0, 0],
                    aliceblue: [240, 248, 255, 1],
                    antiquewhite: [250, 235, 215, 1],
                    aqua: [0, 255, 255, 1],
                    aquamarine: [127, 255, 212, 1],
                    azure: [240, 255, 255, 1],
                    beige: [245, 245, 220, 1],
                    bisque: [255, 228, 196, 1],
                    black: [0, 0, 0, 1],
                    blanchedalmond: [255, 235, 205, 1],
                    blue: [0, 0, 255, 1],
                    blueviolet: [138, 43, 226, 1],
                    brown: [165, 42, 42, 1],
                    burlywood: [222, 184, 135, 1],
                    cadetblue: [95, 158, 160, 1],
                    chartreuse: [127, 255, 0, 1],
                    chocolate: [210, 105, 30, 1],
                    coral: [255, 127, 80, 1],
                    cornflowerblue: [100, 149, 237, 1],
                    cornsilk: [255, 248, 220, 1],
                    crimson: [220, 20, 60, 1],
                    cyan: [0, 255, 255, 1],
                    darkblue: [0, 0, 139, 1],
                    darkcyan: [0, 139, 139, 1],
                    darkgoldenrod: [184, 134, 11, 1],
                    darkgray: [169, 169, 169, 1],
                    darkgreen: [0, 100, 0, 1],
                    darkgrey: [169, 169, 169, 1],
                    darkkhaki: [189, 183, 107, 1],
                    darkmagenta: [139, 0, 139, 1],
                    darkolivegreen: [85, 107, 47, 1],
                    darkorange: [255, 140, 0, 1],
                    darkorchid: [153, 50, 204, 1],
                    darkred: [139, 0, 0, 1],
                    darksalmon: [233, 150, 122, 1],
                    darkseagreen: [143, 188, 143, 1],
                    darkslateblue: [72, 61, 139, 1],
                    darkslategray: [47, 79, 79, 1],
                    darkslategrey: [47, 79, 79, 1],
                    darkturquoise: [0, 206, 209, 1],
                    darkviolet: [148, 0, 211, 1],
                    deeppink: [255, 20, 147, 1],
                    deepskyblue: [0, 191, 255, 1],
                    dimgray: [105, 105, 105, 1],
                    dimgrey: [105, 105, 105, 1],
                    dodgerblue: [30, 144, 255, 1],
                    firebrick: [178, 34, 34, 1],
                    floralwhite: [255, 250, 240, 1],
                    forestgreen: [34, 139, 34, 1],
                    fuchsia: [255, 0, 255, 1],
                    gainsboro: [220, 220, 220, 1],
                    ghostwhite: [248, 248, 255, 1],
                    gold: [255, 215, 0, 1],
                    goldenrod: [218, 165, 32, 1],
                    gray: [128, 128, 128, 1],
                    green: [0, 128, 0, 1],
                    greenyellow: [173, 255, 47, 1],
                    grey: [128, 128, 128, 1],
                    honeydew: [240, 255, 240, 1],
                    hotpink: [255, 105, 180, 1],
                    indianred: [205, 92, 92, 1],
                    indigo: [75, 0, 130, 1],
                    ivory: [255, 255, 240, 1],
                    khaki: [240, 230, 140, 1],
                    lavender: [230, 230, 250, 1],
                    lavenderblush: [255, 240, 245, 1],
                    lawngreen: [124, 252, 0, 1],
                    lemonchiffon: [255, 250, 205, 1],
                    lightblue: [173, 216, 230, 1],
                    lightcoral: [240, 128, 128, 1],
                    lightcyan: [224, 255, 255, 1],
                    lightgoldenrodyellow: [250, 250, 210, 1],
                    lightgray: [211, 211, 211, 1],
                    lightgreen: [144, 238, 144, 1],
                    lightgrey: [211, 211, 211, 1],
                    lightpink: [255, 182, 193, 1],
                    lightsalmon: [255, 160, 122, 1],
                    lightseagreen: [32, 178, 170, 1],
                    lightskyblue: [135, 206, 250, 1],
                    lightslategray: [119, 136, 153, 1],
                    lightslategrey: [119, 136, 153, 1],
                    lightsteelblue: [176, 196, 222, 1],
                    lightyellow: [255, 255, 224, 1],
                    lime: [0, 255, 0, 1],
                    limegreen: [50, 205, 50, 1],
                    linen: [250, 240, 230, 1],
                    magenta: [255, 0, 255, 1],
                    maroon: [128, 0, 0, 1],
                    mediumaquamarine: [102, 205, 170, 1],
                    mediumblue: [0, 0, 205, 1],
                    mediumorchid: [186, 85, 211, 1],
                    mediumpurple: [147, 112, 219, 1],
                    mediumseagreen: [60, 179, 113, 1],
                    mediumslateblue: [123, 104, 238, 1],
                    mediumspringgreen: [0, 250, 154, 1],
                    mediumturquoise: [72, 209, 204, 1],
                    mediumvioletred: [199, 21, 133, 1],
                    midnightblue: [25, 25, 112, 1],
                    mintcream: [245, 255, 250, 1],
                    mistyrose: [255, 228, 225, 1],
                    moccasin: [255, 228, 181, 1],
                    navajowhite: [255, 222, 173, 1],
                    navy: [0, 0, 128, 1],
                    oldlace: [253, 245, 230, 1],
                    olive: [128, 128, 0, 1],
                    olivedrab: [107, 142, 35, 1],
                    orange: [255, 165, 0, 1],
                    orangered: [255, 69, 0, 1],
                    orchid: [218, 112, 214, 1],
                    palegoldenrod: [238, 232, 170, 1],
                    palegreen: [152, 251, 152, 1],
                    paleturquoise: [175, 238, 238, 1],
                    palevioletred: [219, 112, 147, 1],
                    papayawhip: [255, 239, 213, 1],
                    peachpuff: [255, 218, 185, 1],
                    peru: [205, 133, 63, 1],
                    pink: [255, 192, 203, 1],
                    plum: [221, 160, 221, 1],
                    powderblue: [176, 224, 230, 1],
                    purple: [128, 0, 128, 1],
                    rebeccapurple: [102, 51, 153, 1],
                    red: [255, 0, 0, 1],
                    rosybrown: [188, 143, 143, 1],
                    royalblue: [65, 105, 225, 1],
                    saddlebrown: [139, 69, 19, 1],
                    salmon: [250, 128, 114, 1],
                    sandybrown: [244, 164, 96, 1],
                    seagreen: [46, 139, 87, 1],
                    seashell: [255, 245, 238, 1],
                    sienna: [160, 82, 45, 1],
                    silver: [192, 192, 192, 1],
                    skyblue: [135, 206, 235, 1],
                    slateblue: [106, 90, 205, 1],
                    slategray: [112, 128, 144, 1],
                    slategrey: [112, 128, 144, 1],
                    snow: [255, 250, 250, 1],
                    springgreen: [0, 255, 127, 1],
                    steelblue: [70, 130, 180, 1],
                    tan: [210, 180, 140, 1],
                    teal: [0, 128, 128, 1],
                    thistle: [216, 191, 216, 1],
                    tomato: [255, 99, 71, 1],
                    turquoise: [64, 224, 208, 1],
                    violet: [238, 130, 238, 1],
                    wheat: [245, 222, 179, 1],
                    white: [255, 255, 255, 1],
                    whitesmoke: [245, 245, 245, 1],
                    yellow: [255, 255, 0, 1],
                    yellowgreen: [154, 205, 50, 1]
                };

                function n(t) {
                    return (t = Math.round(t)) < 0 ? 0 : t > 255 ? 255 : t
                }

                function i(t) {
                    return n("%" === t[t.length - 1] ? parseFloat(t) / 100 * 255 : parseInt(t))
                }

                function a(t) {
                    return (e = "%" === t[t.length - 1] ? parseFloat(t) / 100 : parseFloat(t)) < 0 ? 0 : e > 1 ? 1 : e;
                    var e;
                }

                function o(t, e, r) {
                    return r < 0 ? r += 1 : r > 1 && (r -= 1), 6 * r < 1 ? t + (e - t) * r * 6 : 2 * r < 1 ? e : 3 * r < 2 ? t + (e - t) * (2 / 3 - r) * 6 : t
                }
                try {
                    e.parseCSSColor = function (t) {
                        var e, s = t.replace(/ /g, "").toLowerCase();
                        if (s in r) return r[s].slice();
                        if ("#" === s[0]) return 4 === s.length ? (e = parseInt(s.substr(1), 16)) >= 0 && e <= 4095 ? [(3840 & e) >> 4 | (3840 & e) >> 8, 240 & e | (240 & e) >> 4, 15 & e | (15 & e) << 4, 1] : null : 7 === s.length && (e = parseInt(s.substr(1), 16)) >= 0 && e <= 16777215 ? [(16711680 & e) >> 16, (65280 & e) >> 8, 255 & e, 1] : null;
                        var u = s.indexOf("("),
                            l = s.indexOf(")");
                        if (-1 !== u && l + 1 === s.length) {
                            var p = s.substr(0, u),
                                c = s.substr(u + 1, l - (u + 1)).split(","),
                                h = 1;
                            switch (p) {
                                case "rgba":
                                    if (4 !== c.length) return null;
                                    h = a(c.pop());
                                case "rgb":
                                    return 3 !== c.length ? null : [i(c[0]), i(c[1]), i(c[2]), h];
                                case "hsla":
                                    if (4 !== c.length) return null;
                                    h = a(c.pop());
                                case "hsl":
                                    if (3 !== c.length) return null;
                                    var y = (parseFloat(c[0]) % 360 + 360) % 360 / 360,
                                        f = a(c[1]),
                                        d = a(c[2]),
                                        m = d <= .5 ? d * (f + 1) : d + f - d * f,
                                        g = 2 * d - m;
                                    return [n(255 * o(g, m, y + 1 / 3)), n(255 * o(g, m, y)), n(255 * o(g, m, y - 1 / 3)), h];
                                default:
                                    return null
                            }
                        }
                        return null
                    };
                } catch (t) {}
            })),
            Lt = Pt.parseCSSColor,
            Tt = function (t, e, r, n) {
                void 0 === n && (n = 1), this.r = t, this.g = e, this.b = r, this.a = n;
            };
        Tt.parse = function (t) {
            if (t) {
                if (t instanceof Tt) return t;
                if ("string" == typeof t) {
                    var e = Lt(t);
                    if (e) return new Tt(e[0] / 255 * e[3], e[1] / 255 * e[3], e[2] / 255 * e[3], e[3])
                }
            }
        }, Tt.prototype.toString = function () {
            var t = this.toArray(),
                e = t[1],
                r = t[2],
                n = t[3];
            return "rgba(" + Math.round(t[0]) + "," + Math.round(e) + "," + Math.round(r) + "," + n + ")"
        }, Tt.prototype.toArray = function () {
            var t = this.a;
            return 0 === t ? [0, 0, 0, 0] : [255 * this.r / t, 255 * this.g / t, 255 * this.b / t, t]
        }, Tt.black = new Tt(0, 0, 0, 1), Tt.white = new Tt(1, 1, 1, 1), Tt.transparent = new Tt(0, 0, 0, 0), Tt.red = new Tt(1, 0, 0, 1);
        var Dt = function (t, e, r) {
            this.sensitivity = t ? e ? "variant" : "case" : e ? "accent" : "base", this.locale = r, this.collator = new Intl.Collator(this.locale ? this.locale : [], {
                sensitivity: this.sensitivity,
                usage: "search"
            });
        };
        Dt.prototype.compare = function (t, e) {
            return this.collator.compare(t, e)
        }, Dt.prototype.resolvedLocale = function () {
            return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale
        };
        var Et = function (t, e, r, n, i) {
                this.text = t, this.image = e, this.scale = r, this.fontStack = n, this.textColor = i;
            },
            Ft = function (t) {
                this.sections = t;
            };
        Ft.fromString = function (t) {
            return new Ft([new Et(t, null, null, null, null)])
        }, Ft.prototype.isEmpty = function () {
            return 0 === this.sections.length || !this.sections.some((function (t) {
                return 0 !== t.text.length || t.image && 0 !== t.image.name.length
            }))
        }, Ft.factory = function (t) {
            return t instanceof Ft ? t : Ft.fromString(t)
        }, Ft.prototype.toString = function () {
            return 0 === this.sections.length ? "" : this.sections.map((function (t) {
                return t.text
            })).join("")
        }, Ft.prototype.serialize = function () {
            for (var t = ["format"], e = 0, r = this.sections; e < r.length; e += 1) {
                var n = r[e];
                if (n.image) t.push(["image", n.image.name]);
                else {
                    t.push(n.text);
                    var i = {};
                    n.fontStack && (i["text-font"] = ["literal", n.fontStack.split(",")]), n.scale && (i["font-scale"] = n.scale), n.textColor && (i["text-color"] = ["rgba"].concat(n.textColor.toArray())), t.push(i);
                }
            }
            return t
        };
        var qt = function (t) {
            this.name = t.name, this.available = t.available;
        };

        function Ot(t, e, r, n) {
            return "number" == typeof t && t >= 0 && t <= 255 && "number" == typeof e && e >= 0 && e <= 255 && "number" == typeof r && r >= 0 && r <= 255 ? void 0 === n || "number" == typeof n && n >= 0 && n <= 1 ? null : "Invalid rgba value [" + [t, e, r, n].join(", ") + "]: 'a' must be between 0 and 1." : "Invalid rgba value [" + ("number" == typeof n ? [t, e, r, n] : [t, e, r]).join(", ") + "]: 'r', 'g', and 'b' must be between 0 and 255."
        }

        function Ut(t) {
            if (null === t) return !0;
            if ("string" == typeof t) return !0;
            if ("boolean" == typeof t) return !0;
            if ("number" == typeof t) return !0;
            if (t instanceof Tt) return !0;
            if (t instanceof Dt) return !0;
            if (t instanceof Ft) return !0;
            if (t instanceof qt) return !0;
            if (Array.isArray(t)) {
                for (var e = 0, r = t; e < r.length; e += 1)
                    if (!Ut(r[e])) return !1;
                return !0
            }
            if ("object" == typeof t) {
                for (var n in t)
                    if (!Ut(t[n])) return !1;
                return !0
            }
            return !1
        }

        function Rt(t) {
            if (null === t) return mt;
            if ("string" == typeof t) return vt;
            if ("boolean" == typeof t) return xt;
            if ("number" == typeof t) return gt;
            if (t instanceof Tt) return bt;
            if (t instanceof Dt) return kt;
            if (t instanceof Ft) return At;
            if (t instanceof qt) return St;
            if (Array.isArray(t)) {
                for (var e, r = t.length, n = 0, i = t; n < i.length; n += 1) {
                    var a = Rt(i[n]);
                    if (e) {
                        if (e === a) continue;
                        e = wt;
                        break
                    }
                    e = a;
                }
                return It(e || wt, r)
            }
            return _t
        }

        function jt(t) {
            var e = typeof t;
            return null === t ? "" : "string" === e || "number" === e || "boolean" === e ? String(t) : t instanceof Tt || t instanceof Ft || t instanceof qt ? t.toString() : JSON.stringify(t)
        }
        qt.prototype.toString = function () {
            return this.name
        }, qt.fromString = function (t) {
            return t ? new qt({
                name: t,
                available: !1
            }) : null
        }, qt.prototype.serialize = function () {
            return ["image", this.name]
        };
        var Nt = function (t, e) {
            this.type = t, this.value = e;
        };
        Nt.parse = function (t, e) {
            if (2 !== t.length) return e.error("'literal' expression requires exactly one argument, but found " + (t.length - 1) + " instead.");
            if (!Ut(t[1])) return e.error("invalid value");
            var r = t[1],
                n = Rt(r),
                i = e.expectedType;
            return "array" !== n.kind || 0 !== n.N || !i || "array" !== i.kind || "number" == typeof i.N && 0 !== i.N || (n = i), new Nt(n, r)
        }, Nt.prototype.evaluate = function () {
            return this.value
        }, Nt.prototype.eachChild = function () {}, Nt.prototype.outputDefined = function () {
            return !0
        }, Nt.prototype.serialize = function () {
            return "array" === this.type.kind || "object" === this.type.kind ? ["literal", this.value] : this.value instanceof Tt ? ["rgba"].concat(this.value.toArray()) : this.value instanceof Ft ? this.value.serialize() : this.value
        };
        var Kt = function (t) {
            this.name = "ExpressionEvaluationError", this.message = t;
        };
        Kt.prototype.toJSON = function () {
            return this.message
        };
        var Xt = {
                string: vt,
                number: gt,
                boolean: xt,
                object: _t
            },
            Gt = function (t, e) {
                this.type = t, this.args = e;
            };
        Gt.parse = function (t, e) {
            if (t.length < 2) return e.error("Expected at least one argument.");
            var r, n = 1,
                i = t[0];
            if ("array" === i) {
                var a, o;
                if (t.length > 2) {
                    var s = t[1];
                    if ("string" != typeof s || !(s in Xt) || "object" === s) return e.error('The item type argument of "array" must be one of string, number, boolean', 1);
                    a = Xt[s], n++;
                } else a = wt;
                if (t.length > 3) {
                    if (null !== t[2] && ("number" != typeof t[2] || t[2] < 0 || t[2] !== Math.floor(t[2]))) return e.error('The length argument to "array" must be a positive integer literal', 2);
                    o = t[2], n++;
                }
                r = It(a, o);
            } else r = Xt[i];
            for (var u = []; n < t.length; n++) {
                var l = e.parse(t[n], n, wt);
                if (!l) return null;
                u.push(l);
            }
            return new Gt(r, u)
        }, Gt.prototype.evaluate = function (t) {
            for (var e = 0; e < this.args.length; e++) {
                var r = this.args[e].evaluate(t);
                if (!Vt(this.type, Rt(r))) return r;
                if (e === this.args.length - 1) throw new Kt("Expected value to be of type " + zt(this.type) + ", but found " + zt(Rt(r)) + " instead.")
            }
            return null
        }, Gt.prototype.eachChild = function (t) {
            this.args.forEach(t);
        }, Gt.prototype.outputDefined = function () {
            return this.args.every((function (t) {
                return t.outputDefined()
            }))
        }, Gt.prototype.serialize = function () {
            var t = this.type,
                e = [t.kind];
            if ("array" === t.kind) {
                var r = t.itemType;
                if ("string" === r.kind || "number" === r.kind || "boolean" === r.kind) {
                    e.push(r.kind);
                    var n = t.N;
                    ("number" == typeof n || this.args.length > 1) && e.push(n);
                }
            }
            return e.concat(this.args.map((function (t) {
                return t.serialize()
            })))
        };
        var Ht = function (t) {
            this.type = At, this.sections = t;
        };
        Ht.parse = function (t, e) {
            if (t.length < 2) return e.error("Expected at least one argument.");
            var r = t[1];
            if (!Array.isArray(r) && "object" == typeof r) return e.error("First argument must be an image or text section.");
            for (var n = [], i = !1, a = 1; a <= t.length - 1; ++a) {
                var o = t[a];
                if (i && "object" == typeof o && !Array.isArray(o)) {
                    i = !1;
                    var s = null;
                    if (o["font-scale"] && !(s = e.parse(o["font-scale"], 1, gt))) return null;
                    var u = null;
                    if (o["text-font"] && !(u = e.parse(o["text-font"], 1, It(vt)))) return null;
                    var l = null;
                    if (o["text-color"] && !(l = e.parse(o["text-color"], 1, bt))) return null;
                    var p = n[n.length - 1];
                    p.scale = s, p.font = u, p.textColor = l;
                } else {
                    var c = e.parse(t[a], 1, wt);
                    if (!c) return null;
                    var h = c.type.kind;
                    if ("string" !== h && "value" !== h && "null" !== h && "resolvedImage" !== h) return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");
                    i = !0, n.push({
                        content: c,
                        scale: null,
                        font: null,
                        textColor: null
                    });
                }
            }
            return new Ht(n)
        }, Ht.prototype.evaluate = function (t) {
            return new Ft(this.sections.map((function (e) {
                var r = e.content.evaluate(t);
                return Rt(r) === St ? new Et("", r, null, null, null) : new Et(jt(r), null, e.scale ? e.scale.evaluate(t) : null, e.font ? e.font.evaluate(t).join(",") : null, e.textColor ? e.textColor.evaluate(t) : null)
            })))
        }, Ht.prototype.eachChild = function (t) {
            for (var e = 0, r = this.sections; e < r.length; e += 1) {
                var n = r[e];
                t(n.content), n.scale && t(n.scale), n.font && t(n.font), n.textColor && t(n.textColor);
            }
        }, Ht.prototype.outputDefined = function () {
            return !1
        }, Ht.prototype.serialize = function () {
            for (var t = ["format"], e = 0, r = this.sections; e < r.length; e += 1) {
                var n = r[e];
                t.push(n.content.serialize());
                var i = {};
                n.scale && (i["font-scale"] = n.scale.serialize()), n.font && (i["text-font"] = n.font.serialize()), n.textColor && (i["text-color"] = n.textColor.serialize()), t.push(i);
            }
            return t
        };
        var Yt = function (t) {
            this.type = St, this.input = t;
        };
        Yt.parse = function (t, e) {
            if (2 !== t.length) return e.error("Expected two arguments.");
            var r = e.parse(t[1], 1, vt);
            return r ? new Yt(r) : e.error("No image name provided.")
        }, Yt.prototype.evaluate = function (t) {
            var e = this.input.evaluate(t),
                r = qt.fromString(e);
            return r && t.availableImages && (r.available = t.availableImages.indexOf(e) > -1), r
        }, Yt.prototype.eachChild = function (t) {
            t(this.input);
        }, Yt.prototype.outputDefined = function () {
            return !1
        }, Yt.prototype.serialize = function () {
            return ["image", this.input.serialize()]
        };
        var Zt = {
                "to-boolean": xt,
                "to-color": bt,
                "to-number": gt,
                "to-string": vt
            },
            Jt = function (t, e) {
                this.type = t, this.args = e;
            };
        Jt.parse = function (t, e) {
            if (t.length < 2) return e.error("Expected at least one argument.");
            var r = t[0];
            if (("to-boolean" === r || "to-string" === r) && 2 !== t.length) return e.error("Expected one argument.");
            for (var n = Zt[r], i = [], a = 1; a < t.length; a++) {
                var o = e.parse(t[a], a, wt);
                if (!o) return null;
                i.push(o);
            }
            return new Jt(n, i)
        }, Jt.prototype.evaluate = function (t) {
            if ("boolean" === this.type.kind) return Boolean(this.args[0].evaluate(t));
            if ("color" === this.type.kind) {
                for (var e, r, n = 0, i = this.args; n < i.length; n += 1) {
                    if (r = null, (e = i[n].evaluate(t)) instanceof Tt) return e;
                    if ("string" == typeof e) {
                        var a = t.parseColor(e);
                        if (a) return a
                    } else if (Array.isArray(e) && !(r = e.length < 3 || e.length > 4 ? "Invalid rbga value " + JSON.stringify(e) + ": expected an array containing either three or four numeric values." : Ot(e[0], e[1], e[2], e[3]))) return new Tt(e[0] / 255, e[1] / 255, e[2] / 255, e[3])
                }
                throw new Kt(r || "Could not parse color from value '" + ("string" == typeof e ? e : String(JSON.stringify(e))) + "'")
            }
            if ("number" === this.type.kind) {
                for (var o = null, s = 0, u = this.args; s < u.length; s += 1) {
                    if (null === (o = u[s].evaluate(t))) return 0;
                    var l = Number(o);
                    if (!isNaN(l)) return l
                }
                throw new Kt("Could not convert " + JSON.stringify(o) + " to number.")
            }
            return "formatted" === this.type.kind ? Ft.fromString(jt(this.args[0].evaluate(t))) : "resolvedImage" === this.type.kind ? qt.fromString(jt(this.args[0].evaluate(t))) : jt(this.args[0].evaluate(t))
        }, Jt.prototype.eachChild = function (t) {
            this.args.forEach(t);
        }, Jt.prototype.outputDefined = function () {
            return this.args.every((function (t) {
                return t.outputDefined()
            }))
        }, Jt.prototype.serialize = function () {
            if ("formatted" === this.type.kind) return new Ht([{
                content: this.args[0],
                scale: null,
                font: null,
                textColor: null
            }]).serialize();
            if ("resolvedImage" === this.type.kind) return new Yt(this.args[0]).serialize();
            var t = ["to-" + this.type.kind];
            return this.eachChild((function (e) {
                t.push(e.serialize());
            })), t
        };
        var $t = ["Unknown", "Point", "LineString", "Polygon"],
            Wt = function () {
                this.globals = null, this.feature = null, this.featureState = null, this.formattedSection = null, this._parseColorCache = {}, this.availableImages = null, this.canonical = null;
            };
        Wt.prototype.id = function () {
            return this.feature && "id" in this.feature ? this.feature.id : null
        }, Wt.prototype.geometryType = function () {
            return this.feature ? "number" == typeof this.feature.type ? $t[this.feature.type] : this.feature.type : null
        }, Wt.prototype.geometry = function () {
            return this.feature && "geometry" in this.feature ? this.feature.geometry : null
        }, Wt.prototype.canonicalID = function () {
            return this.canonical
        }, Wt.prototype.properties = function () {
            return this.feature && this.feature.properties || {}
        }, Wt.prototype.parseColor = function (t) {
            var e = this._parseColorCache[t];
            return e || (e = this._parseColorCache[t] = Tt.parse(t)), e
        };
        var Qt = function (t, e, r, n) {
            this.name = t, this.type = e, this._evaluate = r, this.args = n;
        };
        Qt.prototype.evaluate = function (t) {
            return this._evaluate(t, this.args)
        }, Qt.prototype.eachChild = function (t) {
            this.args.forEach(t);
        }, Qt.prototype.outputDefined = function () {
            return !1
        }, Qt.prototype.serialize = function () {
            return [this.name].concat(this.args.map((function (t) {
                return t.serialize()
            })))
        }, Qt.parse = function (t, e) {
            var r, n = t[0],
                i = Qt.definitions[n];
            if (!i) return e.error('Unknown expression "' + n + '". If you wanted a literal array, use ["literal", [...]].', 0);
            for (var a = Array.isArray(i) ? i[0] : i.type, o = Array.isArray(i) ? [
                    [i[1], i[2]]
                ] : i.overloads, s = o.filter((function (e) {
                    var r = e[0];
                    return !Array.isArray(r) || r.length === t.length - 1
                })), u = null, l = 0, p = s; l < p.length; l += 1) {
                var c = p[l],
                    h = c[0],
                    y = c[1];
                u = new _e(e.registry, e.path, null, e.scope);
                for (var f = [], d = !1, m = 1; m < t.length; m++) {
                    var g = t[m],
                        v = Array.isArray(h) ? h[m - 1] : h.type,
                        x = u.parse(g, 1 + f.length, v);
                    if (!x) {
                        d = !0;
                        break
                    }
                    f.push(x);
                }
                if (!d)
                    if (Array.isArray(h) && h.length !== f.length) u.error("Expected " + h.length + " arguments, but found " + f.length + " instead.");
                    else {
                        for (var b = 0; b < f.length; b++) {
                            var _ = Array.isArray(h) ? h[b] : h.type,
                                w = f[b];
                            u.concat(b + 1).checkSubtype(_, w.type);
                        }
                        if (0 === u.errors.length) return new Qt(n, a, y, f)
                    }
            }
            if (1 === s.length)(r = e.errors).push.apply(r, u.errors);
            else {
                for (var k = (s.length ? s : o).map((function (t) {
                        var e;
                        return e = t[0], Array.isArray(e) ? "(" + e.map(zt).join(", ") + ")" : "(" + zt(e.type) + "...)"
                    })).join(" | "), A = [], S = 1; S < t.length; S++) {
                    var I = e.parse(t[S], 1 + A.length);
                    if (!I) return null;
                    A.push(zt(I.type));
                }
                e.error("Expected arguments of type " + k + ", but found (" + A.join(", ") + ") instead.");
            }
            return null
        }, Qt.register = function (t, e) {
            for (var r in Qt.definitions = e, e) t[r] = Qt;
        };
        var te = function (t, e, r) {
            this.type = kt, this.locale = r, this.caseSensitive = t, this.diacriticSensitive = e;
        };

        function ee(t, e) {
            t[0] = Math.min(t[0], e[0]), t[1] = Math.min(t[1], e[1]), t[2] = Math.max(t[2], e[0]), t[3] = Math.max(t[3], e[1]);
        }

        function re(t, e) {
            return !(t[0] <= e[0] || t[2] >= e[2] || t[1] <= e[1] || t[3] >= e[3])
        }

        function ne(t, e) {
            var r = (180 + t[0]) / 360,
                n = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t[1] * Math.PI / 360))) / 360,
                i = Math.pow(2, e.z);
            return [Math.round(r * i * 8192), Math.round(n * i * 8192)]
        }

        function ie(t, e, r) {
            return e[1] > t[1] != r[1] > t[1] && t[0] < (r[0] - e[0]) * (t[1] - e[1]) / (r[1] - e[1]) + e[0]
        }

        function ae(t, e) {
            for (var r, n, i, a, o, s, u, l = !1, p = 0, c = e.length; p < c; p++)
                for (var h = e[p], y = 0, f = h.length; y < f - 1; y++) {
                    if ((a = (r = t)[0] - (n = h[y])[0]) * (u = r[1] - (i = h[y + 1])[1]) - (s = r[0] - i[0]) * (o = r[1] - n[1]) == 0 && a * s <= 0 && o * u <= 0) return !1;
                    ie(t, h[y], h[y + 1]) && (l = !l);
                }
            return l
        }

        function oe(t, e) {
            for (var r = 0; r < e.length; r++)
                if (ae(t, e[r])) return !0;
            return !1
        }

        function se(t, e, r, n) {
            var i = n[0] - r[0],
                a = n[1] - r[1],
                o = (t[0] - r[0]) * a - i * (t[1] - r[1]),
                s = (e[0] - r[0]) * a - i * (e[1] - r[1]);
            return o > 0 && s < 0 || o < 0 && s > 0
        }

        function ue(t, e, r) {
            for (var n = 0, i = r; n < i.length; n += 1)
                for (var a = i[n], o = 0; o < a.length - 1; ++o)
                    if (0 != (c = [(p = a[o + 1])[0] - (l = a[o])[0], p[1] - l[1]])[0] * (h = [(u = e)[0] - (s = t)[0], u[1] - s[1]])[1] - c[1] * h[0] && se(s, u, l, p) && se(l, p, s, u)) return !0;
            var s, u, l, p, c, h;
            return !1
        }

        function le(t, e) {
            for (var r = 0; r < t.length; ++r)
                if (!ae(t[r], e)) return !1;
            for (var n = 0; n < t.length - 1; ++n)
                if (ue(t[n], t[n + 1], e)) return !1;
            return !0
        }

        function pe(t, e) {
            for (var r = 0; r < e.length; r++)
                if (le(t, e[r])) return !0;
            return !1
        }

        function ce(t, e, r) {
            for (var n = [], i = 0; i < t.length; i++) {
                for (var a = [], o = 0; o < t[i].length; o++) {
                    var s = ne(t[i][o], r);
                    ee(e, s), a.push(s);
                }
                n.push(a);
            }
            return n
        }

        function he(t, e, r) {
            for (var n = [], i = 0; i < t.length; i++) {
                var a = ce(t[i], e, r);
                n.push(a);
            }
            return n
        }

        function ye(t, e, r, n) {
            if (t[0] < r[0] || t[0] > r[2]) {
                var i = .5 * n,
                    a = t[0] - r[0] > i ? -n : r[0] - t[0] > i ? n : 0;
                0 === a && (a = t[0] - r[2] > i ? -n : r[2] - t[0] > i ? n : 0), t[0] += a;
            }
            ee(e, t);
        }

        function fe(t, e, r, n) {
            for (var i = 8192 * Math.pow(2, n.z), a = [8192 * n.x, 8192 * n.y], o = [], s = 0, u = t; s < u.length; s += 1)
                for (var l = 0, p = u[s]; l < p.length; l += 1) {
                    var c = p[l],
                        h = [c.x + a[0], c.y + a[1]];
                    ye(h, e, r, i), o.push(h);
                }
            return o
        }

        function de(t, e, r, n) {
            for (var i, a = 8192 * Math.pow(2, n.z), o = [8192 * n.x, 8192 * n.y], s = [], u = 0, l = t; u < l.length; u += 1) {
                for (var p = [], c = 0, h = l[u]; c < h.length; c += 1) {
                    var y = h[c],
                        f = [y.x + o[0], y.y + o[1]];
                    ee(e, f), p.push(f);
                }
                s.push(p);
            }
            if (e[2] - e[0] <= a / 2) {
                (i = e)[0] = i[1] = 1 / 0, i[2] = i[3] = -1 / 0;
                for (var d = 0, m = s; d < m.length; d += 1)
                    for (var g = 0, v = m[d]; g < v.length; g += 1) ye(v[g], e, r, a);
            }
            return s
        }
        te.parse = function (t, e) {
            if (2 !== t.length) return e.error("Expected one argument.");
            var r = t[1];
            if ("object" != typeof r || Array.isArray(r)) return e.error("Collator options argument must be an object.");
            var n = e.parse(void 0 !== r["case-sensitive"] && r["case-sensitive"], 1, xt);
            if (!n) return null;
            var i = e.parse(void 0 !== r["diacritic-sensitive"] && r["diacritic-sensitive"], 1, xt);
            if (!i) return null;
            var a = null;
            return r.locale && !(a = e.parse(r.locale, 1, vt)) ? null : new te(n, i, a)
        }, te.prototype.evaluate = function (t) {
            return new Dt(this.caseSensitive.evaluate(t), this.diacriticSensitive.evaluate(t), this.locale ? this.locale.evaluate(t) : null)
        }, te.prototype.eachChild = function (t) {
            t(this.caseSensitive), t(this.diacriticSensitive), this.locale && t(this.locale);
        }, te.prototype.outputDefined = function () {
            return !1
        }, te.prototype.serialize = function () {
            var t = {};
            return t["case-sensitive"] = this.caseSensitive.serialize(), t["diacritic-sensitive"] = this.diacriticSensitive.serialize(), this.locale && (t.locale = this.locale.serialize()), ["collator", t]
        };
        var me = function (t, e) {
            this.type = xt, this.geojson = t, this.geometries = e;
        };

        function ge(t) {
            if (t instanceof Qt) {
                if ("get" === t.name && 1 === t.args.length) return !1;
                if ("feature-state" === t.name) return !1;
                if ("has" === t.name && 1 === t.args.length) return !1;
                if ("properties" === t.name || "geometry-type" === t.name || "id" === t.name) return !1;
                if (/^filter-/.test(t.name)) return !1
            }
            if (t instanceof me) return !1;
            var e = !0;
            return t.eachChild((function (t) {
                e && !ge(t) && (e = !1);
            })), e
        }

        function ve(t) {
            if (t instanceof Qt && "feature-state" === t.name) return !1;
            var e = !0;
            return t.eachChild((function (t) {
                e && !ve(t) && (e = !1);
            })), e
        }

        function xe(t, e) {
            if (t instanceof Qt && e.indexOf(t.name) >= 0) return !1;
            var r = !0;
            return t.eachChild((function (t) {
                r && !xe(t, e) && (r = !1);
            })), r
        }
        me.parse = function (t, e) {
            if (2 !== t.length) return e.error("'within' expression requires exactly one argument, but found " + (t.length - 1) + " instead.");
            if (Ut(t[1])) {
                var r = t[1];
                if ("FeatureCollection" === r.type)
                    for (var n = 0; n < r.features.length; ++n) {
                        var i = r.features[n].geometry.type;
                        if ("Polygon" === i || "MultiPolygon" === i) return new me(r, r.features[n].geometry)
                    } else if ("Feature" === r.type) {
                        var a = r.geometry.type;
                        if ("Polygon" === a || "MultiPolygon" === a) return new me(r, r.geometry)
                    } else if ("Polygon" === r.type || "MultiPolygon" === r.type) return new me(r, r)
            }
            return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")
        }, me.prototype.evaluate = function (t) {
            if (null != t.geometry() && null != t.canonicalID()) {
                if ("Point" === t.geometryType()) return function (t, e) {
                    var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                        n = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                        i = t.canonicalID();
                    if ("Polygon" === e.type) {
                        var a = ce(e.coordinates, n, i),
                            o = fe(t.geometry(), r, n, i);
                        if (!re(r, n)) return !1;
                        for (var s = 0, u = o; s < u.length; s += 1)
                            if (!ae(u[s], a)) return !1
                    }
                    if ("MultiPolygon" === e.type) {
                        var l = he(e.coordinates, n, i),
                            p = fe(t.geometry(), r, n, i);
                        if (!re(r, n)) return !1;
                        for (var c = 0, h = p; c < h.length; c += 1)
                            if (!oe(h[c], l)) return !1
                    }
                    return !0
                }(t, this.geometries);
                if ("LineString" === t.geometryType()) return function (t, e) {
                    var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                        n = [1 / 0, 1 / 0, -1 / 0, -1 / 0],
                        i = t.canonicalID();
                    if ("Polygon" === e.type) {
                        var a = ce(e.coordinates, n, i),
                            o = de(t.geometry(), r, n, i);
                        if (!re(r, n)) return !1;
                        for (var s = 0, u = o; s < u.length; s += 1)
                            if (!le(u[s], a)) return !1
                    }
                    if ("MultiPolygon" === e.type) {
                        var l = he(e.coordinates, n, i),
                            p = de(t.geometry(), r, n, i);
                        if (!re(r, n)) return !1;
                        for (var c = 0, h = p; c < h.length; c += 1)
                            if (!pe(h[c], l)) return !1
                    }
                    return !0
                }(t, this.geometries)
            }
            return !1
        }, me.prototype.eachChild = function () {}, me.prototype.outputDefined = function () {
            return !0
        }, me.prototype.serialize = function () {
            return ["within", this.geojson]
        };
        var be = function (t, e) {
            this.type = e.type, this.name = t, this.boundExpression = e;
        };
        be.parse = function (t, e) {
            if (2 !== t.length || "string" != typeof t[1]) return e.error("'var' expression requires exactly one string literal argument.");
            var r = t[1];
            return e.scope.has(r) ? new be(r, e.scope.get(r)) : e.error('Unknown variable "' + r + '". Make sure "' + r + '" has been bound in an enclosing "let" expression before using it.', 1)
        }, be.prototype.evaluate = function (t) {
            return this.boundExpression.evaluate(t)
        }, be.prototype.eachChild = function () {}, be.prototype.outputDefined = function () {
            return !1
        }, be.prototype.serialize = function () {
            return ["var", this.name]
        };
        var _e = function (t, e, r, n, i) {
            void 0 === e && (e = []), void 0 === n && (n = new dt), void 0 === i && (i = []), this.registry = t, this.path = e, this.key = e.map((function (t) {
                return "[" + t + "]"
            })).join(""), this.scope = n, this.errors = i, this.expectedType = r;
        };

        function we(t, e) {
            for (var r, n = t.length - 1, i = 0, a = n, o = 0; i <= a;)
                if ((r = t[o = Math.floor((i + a) / 2)]) <= e) {
                    if (o === n || e < t[o + 1]) return o;
                    i = o + 1;
                } else {
                    if (!(r > e)) throw new Kt("Input is not a number.");
                    a = o - 1;
                } return 0
        }
        _e.prototype.parse = function (t, e, r, n, i) {
            return void 0 === i && (i = {}), e ? this.concat(e, r, n)._parse(t, i) : this._parse(t, i)
        }, _e.prototype._parse = function (t, e) {
            function r(t, e, r) {
                return "assert" === r ? new Gt(e, [t]) : "coerce" === r ? new Jt(e, [t]) : t
            }
            if (null !== t && "string" != typeof t && "boolean" != typeof t && "number" != typeof t || (t = ["literal", t]), Array.isArray(t)) {
                if (0 === t.length) return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');
                var n = t[0];
                if ("string" != typeof n) return this.error("Expression name must be a string, but found " + typeof n + ' instead. If you wanted a literal array, use ["literal", [...]].', 0), null;
                var i = this.registry[n];
                if (i) {
                    var a = i.parse(t, this);
                    if (!a) return null;
                    if (this.expectedType) {
                        var o = this.expectedType,
                            s = a.type;
                        if ("string" !== o.kind && "number" !== o.kind && "boolean" !== o.kind && "object" !== o.kind && "array" !== o.kind || "value" !== s.kind)
                            if ("color" !== o.kind && "formatted" !== o.kind && "resolvedImage" !== o.kind || "value" !== s.kind && "string" !== s.kind) {
                                if (this.checkSubtype(o, s)) return null
                            } else a = r(a, o, e.typeAnnotation || "coerce");
                        else a = r(a, o, e.typeAnnotation || "assert");
                    }
                    if (!(a instanceof Nt) && "resolvedImage" !== a.type.kind && function t(e) {
                            if (e instanceof be) return t(e.boundExpression);
                            if (e instanceof Qt && "error" === e.name) return !1;
                            if (e instanceof te) return !1;
                            if (e instanceof me) return !1;
                            var r = e instanceof Jt || e instanceof Gt,
                                n = !0;
                            return e.eachChild((function (e) {
                                n = r ? n && t(e) : n && e instanceof Nt;
                            })), !!n && ge(e) && xe(e, ["zoom", "heatmap-density", "line-progress", "accumulated", "is-supported-script"])
                        }(a)) {
                        var u = new Wt;
                        try {
                            a = new Nt(a.type, a.evaluate(u));
                        } catch (t) {
                            return this.error(t.message), null
                        }
                    }
                    return a
                }
                return this.error('Unknown expression "' + n + '". If you wanted a literal array, use ["literal", [...]].', 0)
            }
            return this.error(void 0 === t ? "'undefined' value invalid. Use null instead." : "object" == typeof t ? 'Bare objects invalid. Use ["literal", {...}] instead.' : "Expected an array, but found " + typeof t + " instead.")
        }, _e.prototype.concat = function (t, e, r) {
            var n = "number" == typeof t ? this.path.concat(t) : this.path,
                i = r ? this.scope.concat(r) : this.scope;
            return new _e(this.registry, n, e || null, i, this.errors)
        }, _e.prototype.error = function (t) {
            for (var e = [], r = arguments.length - 1; r-- > 0;) e[r] = arguments[r + 1];
            var n = "" + this.key + e.map((function (t) {
                return "[" + t + "]"
            })).join("");
            this.errors.push(new ft(n, t));
        }, _e.prototype.checkSubtype = function (t, e) {
            var r = Vt(t, e);
            return r && this.error(r), r
        };
        var ke = function (t, e, r) {
            this.type = t, this.input = e, this.labels = [], this.outputs = [];
            for (var n = 0, i = r; n < i.length; n += 1) {
                var a = i[n],
                    o = a[1];
                this.labels.push(a[0]), this.outputs.push(o);
            }
        };

        function Ae(t, e, r) {
            return t * (1 - r) + e * r
        }
        ke.parse = function (t, e) {
            if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only " + (t.length - 1) + ".");
            if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
            var r = e.parse(t[1], 1, gt);
            if (!r) return null;
            var n = [],
                i = null;
            e.expectedType && "value" !== e.expectedType.kind && (i = e.expectedType);
            for (var a = 1; a < t.length; a += 2) {
                var o = 1 === a ? -1 / 0 : t[a],
                    s = t[a + 1],
                    u = a,
                    l = a + 1;
                if ("number" != typeof o) return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.', u);
                if (n.length && n[n.length - 1][0] >= o) return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.', u);
                var p = e.parse(s, l, i);
                if (!p) return null;
                i = i || p.type, n.push([o, p]);
            }
            return new ke(i, r, n)
        }, ke.prototype.evaluate = function (t) {
            var e = this.labels,
                r = this.outputs;
            if (1 === e.length) return r[0].evaluate(t);
            var n = this.input.evaluate(t);
            if (n <= e[0]) return r[0].evaluate(t);
            var i = e.length;
            return n >= e[i - 1] ? r[i - 1].evaluate(t) : r[we(e, n)].evaluate(t)
        }, ke.prototype.eachChild = function (t) {
            t(this.input);
            for (var e = 0, r = this.outputs; e < r.length; e += 1) t(r[e]);
        }, ke.prototype.outputDefined = function () {
            return this.outputs.every((function (t) {
                return t.outputDefined()
            }))
        }, ke.prototype.serialize = function () {
            for (var t = ["step", this.input.serialize()], e = 0; e < this.labels.length; e++) e > 0 && t.push(this.labels[e]), t.push(this.outputs[e].serialize());
            return t
        };
        var Se = Object.freeze({
                __proto__: null,
                number: Ae,
                color: function (t, e, r) {
                    return new Tt(Ae(t.r, e.r, r), Ae(t.g, e.g, r), Ae(t.b, e.b, r), Ae(t.a, e.a, r))
                },
                array: function (t, e, r) {
                    return t.map((function (t, n) {
                        return Ae(t, e[n], r)
                    }))
                }
            }),
            Ie = 6 / 29 * 3 * (6 / 29),
            ze = Math.PI / 180,
            Be = 180 / Math.PI;

        function Ve(t) {
            return t > .008856451679035631 ? Math.pow(t, 1 / 3) : t / Ie + 4 / 29
        }

        function Ce(t) {
            return t > 6 / 29 ? t * t * t : Ie * (t - 4 / 29)
        }

        function Me(t) {
            return 255 * (t <= .0031308 ? 12.92 * t : 1.055 * Math.pow(t, 1 / 2.4) - .055)
        }

        function Pe(t) {
            return (t /= 255) <= .04045 ? t / 12.92 : Math.pow((t + .055) / 1.055, 2.4)
        }

        function Le(t) {
            var e = Pe(t.r),
                r = Pe(t.g),
                n = Pe(t.b),
                i = Ve((.4124564 * e + .3575761 * r + .1804375 * n) / .95047),
                a = Ve((.2126729 * e + .7151522 * r + .072175 * n) / 1);
            return {
                l: 116 * a - 16,
                a: 500 * (i - a),
                b: 200 * (a - Ve((.0193339 * e + .119192 * r + .9503041 * n) / 1.08883)),
                alpha: t.a
            }
        }

        function Te(t) {
            var e = (t.l + 16) / 116,
                r = isNaN(t.a) ? e : e + t.a / 500,
                n = isNaN(t.b) ? e : e - t.b / 200;
            return e = 1 * Ce(e), r = .95047 * Ce(r), n = 1.08883 * Ce(n), new Tt(Me(3.2404542 * r - 1.5371385 * e - .4985314 * n), Me(-.969266 * r + 1.8760108 * e + .041556 * n), Me(.0556434 * r - .2040259 * e + 1.0572252 * n), t.alpha)
        }

        function De(t, e, r) {
            var n = e - t;
            return t + r * (n > 180 || n < -180 ? n - 360 * Math.round(n / 360) : n)
        }
        var Ee = {
                forward: Le,
                reverse: Te,
                interpolate: function (t, e, r) {
                    return {
                        l: Ae(t.l, e.l, r),
                        a: Ae(t.a, e.a, r),
                        b: Ae(t.b, e.b, r),
                        alpha: Ae(t.alpha, e.alpha, r)
                    }
                }
            },
            Fe = {
                forward: function (t) {
                    var e = Le(t),
                        r = e.l,
                        n = e.a,
                        i = e.b,
                        a = Math.atan2(i, n) * Be;
                    return {
                        h: a < 0 ? a + 360 : a,
                        c: Math.sqrt(n * n + i * i),
                        l: r,
                        alpha: t.a
                    }
                },
                reverse: function (t) {
                    var e = t.h * ze,
                        r = t.c;
                    return Te({
                        l: t.l,
                        a: Math.cos(e) * r,
                        b: Math.sin(e) * r,
                        alpha: t.alpha
                    })
                },
                interpolate: function (t, e, r) {
                    return {
                        h: De(t.h, e.h, r),
                        c: Ae(t.c, e.c, r),
                        l: Ae(t.l, e.l, r),
                        alpha: Ae(t.alpha, e.alpha, r)
                    }
                }
            },
            qe = Object.freeze({
                __proto__: null,
                lab: Ee,
                hcl: Fe
            }),
            Oe = function (t, e, r, n, i) {
                this.type = t, this.operator = e, this.interpolation = r, this.input = n, this.labels = [], this.outputs = [];
                for (var a = 0, o = i; a < o.length; a += 1) {
                    var s = o[a],
                        u = s[1];
                    this.labels.push(s[0]), this.outputs.push(u);
                }
            };

        function Ue(t, e, r, n) {
            var i = n - r,
                a = t - r;
            return 0 === i ? 0 : 1 === e ? a / i : (Math.pow(e, a) - 1) / (Math.pow(e, i) - 1)
        }
        Oe.interpolationFactor = function (t, e, n, i) {
            var a = 0;
            if ("exponential" === t.name) a = Ue(e, t.base, n, i);
            else if ("linear" === t.name) a = Ue(e, 1, n, i);
            else if ("cubic-bezier" === t.name) {
                var o = t.controlPoints;
                a = new r(o[0], o[1], o[2], o[3]).solve(Ue(e, 1, n, i));
            }
            return a
        }, Oe.parse = function (t, e) {
            var r = t[0],
                n = t[1],
                i = t[2],
                a = t.slice(3);
            if (!Array.isArray(n) || 0 === n.length) return e.error("Expected an interpolation type expression.", 1);
            if ("linear" === n[0]) n = {
                name: "linear"
            };
            else if ("exponential" === n[0]) {
                var o = n[1];
                if ("number" != typeof o) return e.error("Exponential interpolation requires a numeric base.", 1, 1);
                n = {
                    name: "exponential",
                    base: o
                };
            } else {
                if ("cubic-bezier" !== n[0]) return e.error("Unknown interpolation type " + String(n[0]), 1, 0);
                var s = n.slice(1);
                if (4 !== s.length || s.some((function (t) {
                        return "number" != typeof t || t < 0 || t > 1
                    }))) return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.", 1);
                n = {
                    name: "cubic-bezier",
                    controlPoints: s
                };
            }
            if (t.length - 1 < 4) return e.error("Expected at least 4 arguments, but found only " + (t.length - 1) + ".");
            if ((t.length - 1) % 2 != 0) return e.error("Expected an even number of arguments.");
            if (!(i = e.parse(i, 2, gt))) return null;
            var u = [],
                l = null;
            "interpolate-hcl" === r || "interpolate-lab" === r ? l = bt : e.expectedType && "value" !== e.expectedType.kind && (l = e.expectedType);
            for (var p = 0; p < a.length; p += 2) {
                var c = a[p],
                    h = a[p + 1],
                    y = p + 3,
                    f = p + 4;
                if ("number" != typeof c) return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.', y);
                if (u.length && u[u.length - 1][0] >= c) return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.', y);
                var d = e.parse(h, f, l);
                if (!d) return null;
                l = l || d.type, u.push([c, d]);
            }
            return "number" === l.kind || "color" === l.kind || "array" === l.kind && "number" === l.itemType.kind && "number" == typeof l.N ? new Oe(l, r, n, i, u) : e.error("Type " + zt(l) + " is not interpolatable.")
        }, Oe.prototype.evaluate = function (t) {
            var e = this.labels,
                r = this.outputs;
            if (1 === e.length) return r[0].evaluate(t);
            var n = this.input.evaluate(t);
            if (n <= e[0]) return r[0].evaluate(t);
            var i = e.length;
            if (n >= e[i - 1]) return r[i - 1].evaluate(t);
            var a = we(e, n),
                o = Oe.interpolationFactor(this.interpolation, n, e[a], e[a + 1]),
                s = r[a].evaluate(t),
                u = r[a + 1].evaluate(t);
            return "interpolate" === this.operator ? Se[this.type.kind.toLowerCase()](s, u, o) : "interpolate-hcl" === this.operator ? Fe.reverse(Fe.interpolate(Fe.forward(s), Fe.forward(u), o)) : Ee.reverse(Ee.interpolate(Ee.forward(s), Ee.forward(u), o))
        }, Oe.prototype.eachChild = function (t) {
            t(this.input);
            for (var e = 0, r = this.outputs; e < r.length; e += 1) t(r[e]);
        }, Oe.prototype.outputDefined = function () {
            return this.outputs.every((function (t) {
                return t.outputDefined()
            }))
        }, Oe.prototype.serialize = function () {
            var t;
            t = "linear" === this.interpolation.name ? ["linear"] : "exponential" === this.interpolation.name ? 1 === this.interpolation.base ? ["linear"] : ["exponential", this.interpolation.base] : ["cubic-bezier"].concat(this.interpolation.controlPoints);
            for (var e = [this.operator, t, this.input.serialize()], r = 0; r < this.labels.length; r++) e.push(this.labels[r], this.outputs[r].serialize());
            return e
        };
        var Re = function (t, e) {
            this.type = t, this.args = e;
        };
        Re.parse = function (t, e) {
            if (t.length < 2) return e.error("Expectected at least one argument.");
            var r = null,
                n = e.expectedType;
            n && "value" !== n.kind && (r = n);
            for (var i = [], a = 0, o = t.slice(1); a < o.length; a += 1) {
                var s = e.parse(o[a], 1 + i.length, r, void 0, {
                    typeAnnotation: "omit"
                });
                if (!s) return null;
                r = r || s.type, i.push(s);
            }
            var u = n && i.some((function (t) {
                return Vt(n, t.type)
            }));
            return new Re(u ? wt : r, i)
        }, Re.prototype.evaluate = function (t) {
            for (var e, r = null, n = 0, i = 0, a = this.args; i < a.length && (n++, (r = a[i].evaluate(t)) && r instanceof qt && !r.available && (e || (e = r.name), r = null, n === this.args.length && (r = e)), null === r); i += 1);
            return r
        }, Re.prototype.eachChild = function (t) {
            this.args.forEach(t);
        }, Re.prototype.outputDefined = function () {
            return this.args.every((function (t) {
                return t.outputDefined()
            }))
        }, Re.prototype.serialize = function () {
            var t = ["coalesce"];
            return this.eachChild((function (e) {
                t.push(e.serialize());
            })), t
        };
        var je = function (t, e) {
            this.type = e.type, this.bindings = [].concat(t), this.result = e;
        };
        je.prototype.evaluate = function (t) {
            return this.result.evaluate(t)
        }, je.prototype.eachChild = function (t) {
            for (var e = 0, r = this.bindings; e < r.length; e += 1) t(r[e][1]);
            t(this.result);
        }, je.parse = function (t, e) {
            if (t.length < 4) return e.error("Expected at least 3 arguments, but found " + (t.length - 1) + " instead.");
            for (var r = [], n = 1; n < t.length - 1; n += 2) {
                var i = t[n];
                if ("string" != typeof i) return e.error("Expected string, but found " + typeof i + " instead.", n);
                if (/[^a-zA-Z0-9_]/.test(i)) return e.error("Variable names must contain only alphanumeric characters or '_'.", n);
                var a = e.parse(t[n + 1], n + 1);
                if (!a) return null;
                r.push([i, a]);
            }
            var o = e.parse(t[t.length - 1], t.length - 1, e.expectedType, r);
            return o ? new je(r, o) : null
        }, je.prototype.outputDefined = function () {
            return this.result.outputDefined()
        }, je.prototype.serialize = function () {
            for (var t = ["let"], e = 0, r = this.bindings; e < r.length; e += 1) {
                var n = r[e];
                t.push(n[0], n[1].serialize());
            }
            return t.push(this.result.serialize()), t
        };
        var Ne = function (t, e, r) {
            this.type = t, this.index = e, this.input = r;
        };
        Ne.parse = function (t, e) {
            if (3 !== t.length) return e.error("Expected 2 arguments, but found " + (t.length - 1) + " instead.");
            var r = e.parse(t[1], 1, gt),
                n = e.parse(t[2], 2, It(e.expectedType || wt));
            return r && n ? new Ne(n.type.itemType, r, n) : null
        }, Ne.prototype.evaluate = function (t) {
            var e = this.index.evaluate(t),
                r = this.input.evaluate(t);
            if (e < 0) throw new Kt("Array index out of bounds: " + e + " < 0.");
            if (e >= r.length) throw new Kt("Array index out of bounds: " + e + " > " + (r.length - 1) + ".");
            if (e !== Math.floor(e)) throw new Kt("Array index must be an integer, but found " + e + " instead.");
            return r[e]
        }, Ne.prototype.eachChild = function (t) {
            t(this.index), t(this.input);
        }, Ne.prototype.outputDefined = function () {
            return !1
        }, Ne.prototype.serialize = function () {
            return ["at", this.index.serialize(), this.input.serialize()]
        };
        var Ke = function (t, e) {
            this.type = xt, this.needle = t, this.haystack = e;
        };
        Ke.parse = function (t, e) {
            if (3 !== t.length) return e.error("Expected 2 arguments, but found " + (t.length - 1) + " instead.");
            var r = e.parse(t[1], 1, wt),
                n = e.parse(t[2], 2, wt);
            return r && n ? Ct(r.type, [xt, vt, gt, mt, wt]) ? new Ke(r, n) : e.error("Expected first argument to be of type boolean, string, number or null, but found " + zt(r.type) + " instead") : null
        }, Ke.prototype.evaluate = function (t) {
            var e = this.needle.evaluate(t),
                r = this.haystack.evaluate(t);
            if (!r) return !1;
            if (!Mt(e, ["boolean", "string", "number", "null"])) throw new Kt("Expected first argument to be of type boolean, string, number or null, but found " + zt(Rt(e)) + " instead.");
            if (!Mt(r, ["string", "array"])) throw new Kt("Expected second argument to be of type array or string, but found " + zt(Rt(r)) + " instead.");
            return r.indexOf(e) >= 0
        }, Ke.prototype.eachChild = function (t) {
            t(this.needle), t(this.haystack);
        }, Ke.prototype.outputDefined = function () {
            return !0
        }, Ke.prototype.serialize = function () {
            return ["in", this.needle.serialize(), this.haystack.serialize()]
        };
        var Xe = function (t, e, r) {
            this.type = gt, this.needle = t, this.haystack = e, this.fromIndex = r;
        };
        Xe.parse = function (t, e) {
            if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found " + (t.length - 1) + " instead.");
            var r = e.parse(t[1], 1, wt),
                n = e.parse(t[2], 2, wt);
            if (!r || !n) return null;
            if (!Ct(r.type, [xt, vt, gt, mt, wt])) return e.error("Expected first argument to be of type boolean, string, number or null, but found " + zt(r.type) + " instead");
            if (4 === t.length) {
                var i = e.parse(t[3], 3, gt);
                return i ? new Xe(r, n, i) : null
            }
            return new Xe(r, n)
        }, Xe.prototype.evaluate = function (t) {
            var e = this.needle.evaluate(t),
                r = this.haystack.evaluate(t);
            if (!Mt(e, ["boolean", "string", "number", "null"])) throw new Kt("Expected first argument to be of type boolean, string, number or null, but found " + zt(Rt(e)) + " instead.");
            if (!Mt(r, ["string", "array"])) throw new Kt("Expected second argument to be of type array or string, but found " + zt(Rt(r)) + " instead.");
            if (this.fromIndex) {
                var n = this.fromIndex.evaluate(t);
                return r.indexOf(e, n)
            }
            return r.indexOf(e)
        }, Xe.prototype.eachChild = function (t) {
            t(this.needle), t(this.haystack), this.fromIndex && t(this.fromIndex);
        }, Xe.prototype.outputDefined = function () {
            return !1
        }, Xe.prototype.serialize = function () {
            if (null != this.fromIndex && void 0 !== this.fromIndex) {
                var t = this.fromIndex.serialize();
                return ["index-of", this.needle.serialize(), this.haystack.serialize(), t]
            }
            return ["index-of", this.needle.serialize(), this.haystack.serialize()]
        };
        var Ge = function (t, e, r, n, i, a) {
            this.inputType = t, this.type = e, this.input = r, this.cases = n, this.outputs = i, this.otherwise = a;
        };
        Ge.parse = function (t, e) {
            if (t.length < 5) return e.error("Expected at least 4 arguments, but found only " + (t.length - 1) + ".");
            if (t.length % 2 != 1) return e.error("Expected an even number of arguments.");
            var r, n;
            e.expectedType && "value" !== e.expectedType.kind && (n = e.expectedType);
            for (var i = {}, a = [], o = 2; o < t.length - 1; o += 2) {
                var s = t[o],
                    u = t[o + 1];
                Array.isArray(s) || (s = [s]);
                var l = e.concat(o);
                if (0 === s.length) return l.error("Expected at least one branch label.");
                for (var p = 0, c = s; p < c.length; p += 1) {
                    var h = c[p];
                    if ("number" != typeof h && "string" != typeof h) return l.error("Branch labels must be numbers or strings.");
                    if ("number" == typeof h && Math.abs(h) > Number.MAX_SAFE_INTEGER) return l.error("Branch labels must be integers no larger than " + Number.MAX_SAFE_INTEGER + ".");
                    if ("number" == typeof h && Math.floor(h) !== h) return l.error("Numeric branch labels must be integer values.");
                    if (r) {
                        if (l.checkSubtype(r, Rt(h))) return null
                    } else r = Rt(h);
                    if (void 0 !== i[String(h)]) return l.error("Branch labels must be unique.");
                    i[String(h)] = a.length;
                }
                var y = e.parse(u, o, n);
                if (!y) return null;
                n = n || y.type, a.push(y);
            }
            var f = e.parse(t[1], 1, wt);
            if (!f) return null;
            var d = e.parse(t[t.length - 1], t.length - 1, n);
            return d ? "value" !== f.type.kind && e.concat(1).checkSubtype(r, f.type) ? null : new Ge(r, n, f, i, a, d) : null
        }, Ge.prototype.evaluate = function (t) {
            var e = this.input.evaluate(t);
            return (Rt(e) === this.inputType && this.outputs[this.cases[e]] || this.otherwise).evaluate(t)
        }, Ge.prototype.eachChild = function (t) {
            t(this.input), this.outputs.forEach(t), t(this.otherwise);
        }, Ge.prototype.outputDefined = function () {
            return this.outputs.every((function (t) {
                return t.outputDefined()
            })) && this.otherwise.outputDefined()
        }, Ge.prototype.serialize = function () {
            for (var t = this, e = ["match", this.input.serialize()], r = [], n = {}, i = 0, a = Object.keys(this.cases).sort(); i < a.length; i += 1) {
                var o = a[i];
                void 0 === (c = n[this.cases[o]]) ? (n[this.cases[o]] = r.length, r.push([this.cases[o],
                    [o]
                ])) : r[c][1].push(o);
            }
            for (var s = function (e) {
                    return "number" === t.inputType.kind ? Number(e) : e
                }, u = 0, l = r; u < l.length; u += 1) {
                var p = l[u],
                    c = p[0],
                    h = p[1];
                e.push(1 === h.length ? s(h[0]) : h.map(s)), e.push(this.outputs[outputIndex$1].serialize());
            }
            return e.push(this.otherwise.serialize()), e
        };
        var He = function (t, e, r) {
            this.type = t, this.branches = e, this.otherwise = r;
        };
        He.parse = function (t, e) {
            if (t.length < 4) return e.error("Expected at least 3 arguments, but found only " + (t.length - 1) + ".");
            if (t.length % 2 != 0) return e.error("Expected an odd number of arguments.");
            var r;
            e.expectedType && "value" !== e.expectedType.kind && (r = e.expectedType);
            for (var n = [], i = 1; i < t.length - 1; i += 2) {
                var a = e.parse(t[i], i, xt);
                if (!a) return null;
                var o = e.parse(t[i + 1], i + 1, r);
                if (!o) return null;
                n.push([a, o]), r = r || o.type;
            }
            var s = e.parse(t[t.length - 1], t.length - 1, r);
            return s ? new He(r, n, s) : null
        }, He.prototype.evaluate = function (t) {
            for (var e = 0, r = this.branches; e < r.length; e += 1) {
                var n = r[e],
                    i = n[1];
                if (n[0].evaluate(t)) return i.evaluate(t)
            }
            return this.otherwise.evaluate(t)
        }, He.prototype.eachChild = function (t) {
            for (var e = 0, r = this.branches; e < r.length; e += 1) {
                var n = r[e],
                    i = n[1];
                t(n[0]), t(i);
            }
            t(this.otherwise);
        }, He.prototype.outputDefined = function () {
            return this.branches.every((function (t) {
                return t[1].outputDefined()
            })) && this.otherwise.outputDefined()
        }, He.prototype.serialize = function () {
            var t = ["case"];
            return this.eachChild((function (e) {
                t.push(e.serialize());
            })), t
        };
        var Ye = function (t, e, r, n) {
            this.type = t, this.input = e, this.beginIndex = r, this.endIndex = n;
        };

        function Ze(t, e) {
            return "==" === t || "!=" === t ? "boolean" === e.kind || "string" === e.kind || "number" === e.kind || "null" === e.kind || "value" === e.kind : "string" === e.kind || "number" === e.kind || "value" === e.kind
        }

        function Je(t, e, r, n) {
            return 0 === n.compare(e, r)
        }

        function $e(t, e, r) {
            var n = "==" !== t && "!=" !== t;
            return function () {
                function i(t, e, r) {
                    this.type = xt, this.lhs = t, this.rhs = e, this.collator = r, this.hasUntypedArgument = "value" === t.type.kind || "value" === e.type.kind;
                }
                return i.parse = function (t, e) {
                    if (3 !== t.length && 4 !== t.length) return e.error("Expected two or three arguments.");
                    var r = t[0],
                        a = e.parse(t[1], 1, wt);
                    if (!a) return null;
                    if (!Ze(r, a.type)) return e.concat(1).error('"' + r + "\" comparisons are not supported for type '" + zt(a.type) + "'.");
                    var o = e.parse(t[2], 2, wt);
                    if (!o) return null;
                    if (!Ze(r, o.type)) return e.concat(2).error('"' + r + "\" comparisons are not supported for type '" + zt(o.type) + "'.");
                    if (a.type.kind !== o.type.kind && "value" !== a.type.kind && "value" !== o.type.kind) return e.error("Cannot compare types '" + zt(a.type) + "' and '" + zt(o.type) + "'.");
                    n && ("value" === a.type.kind && "value" !== o.type.kind ? a = new Gt(o.type, [a]) : "value" !== a.type.kind && "value" === o.type.kind && (o = new Gt(a.type, [o])));
                    var s = null;
                    if (4 === t.length) {
                        if ("string" !== a.type.kind && "string" !== o.type.kind && "value" !== a.type.kind && "value" !== o.type.kind) return e.error("Cannot use collator to compare non-string types.");
                        if (!(s = e.parse(t[3], 3, kt))) return null
                    }
                    return new i(a, o, s)
                }, i.prototype.evaluate = function (i) {
                    var a = this.lhs.evaluate(i),
                        o = this.rhs.evaluate(i);
                    if (n && this.hasUntypedArgument) {
                        var s = Rt(a),
                            u = Rt(o);
                        if (s.kind !== u.kind || "string" !== s.kind && "number" !== s.kind) throw new Kt('Expected arguments for "' + t + '" to be (string, string) or (number, number), but found (' + s.kind + ", " + u.kind + ") instead.")
                    }
                    if (this.collator && !n && this.hasUntypedArgument) {
                        var l = Rt(a),
                            p = Rt(o);
                        if ("string" !== l.kind || "string" !== p.kind) return e(i, a, o)
                    }
                    return this.collator ? r(i, a, o, this.collator.evaluate(i)) : e(i, a, o)
                }, i.prototype.eachChild = function (t) {
                    t(this.lhs), t(this.rhs), this.collator && t(this.collator);
                }, i.prototype.outputDefined = function () {
                    return !0
                }, i.prototype.serialize = function () {
                    var e = [t];
                    return this.eachChild((function (t) {
                        e.push(t.serialize());
                    })), e
                }, i
            }()
        }
        Ye.parse = function (t, e) {
            if (t.length <= 2 || t.length >= 5) return e.error("Expected 3 or 4 arguments, but found " + (t.length - 1) + " instead.");
            var r = e.parse(t[1], 1, wt),
                n = e.parse(t[2], 2, gt);
            if (!r || !n) return null;
            if (!Ct(r.type, [It(wt), vt, wt])) return e.error("Expected first argument to be of type array or string, but found " + zt(r.type) + " instead");
            if (4 === t.length) {
                var i = e.parse(t[3], 3, gt);
                return i ? new Ye(r.type, r, n, i) : null
            }
            return new Ye(r.type, r, n)
        }, Ye.prototype.evaluate = function (t) {
            var e = this.input.evaluate(t),
                r = this.beginIndex.evaluate(t);
            if (!Mt(e, ["string", "array"])) throw new Kt("Expected first argument to be of type array or string, but found " + zt(Rt(e)) + " instead.");
            if (this.endIndex) {
                var n = this.endIndex.evaluate(t);
                return e.slice(r, n)
            }
            return e.slice(r)
        }, Ye.prototype.eachChild = function (t) {
            t(this.input), t(this.beginIndex), this.endIndex && t(this.endIndex);
        }, Ye.prototype.outputDefined = function () {
            return !1
        }, Ye.prototype.serialize = function () {
            if (null != this.endIndex && void 0 !== this.endIndex) {
                var t = this.endIndex.serialize();
                return ["slice", this.input.serialize(), this.beginIndex.serialize(), t]
            }
            return ["slice", this.input.serialize(), this.beginIndex.serialize()]
        };
        var We = $e("==", (function (t, e, r) {
                return e === r
            }), Je),
            Qe = $e("!=", (function (t, e, r) {
                return e !== r
            }), (function (t, e, r, n) {
                return !Je(0, e, r, n)
            })),
            tr = $e("<", (function (t, e, r) {
                return e < r
            }), (function (t, e, r, n) {
                return n.compare(e, r) < 0
            })),
            er = $e(">", (function (t, e, r) {
                return e > r
            }), (function (t, e, r, n) {
                return n.compare(e, r) > 0
            })),
            rr = $e("<=", (function (t, e, r) {
                return e <= r
            }), (function (t, e, r, n) {
                return n.compare(e, r) <= 0
            })),
            nr = $e(">=", (function (t, e, r) {
                return e >= r
            }), (function (t, e, r, n) {
                return n.compare(e, r) >= 0
            })),
            ir = function (t, e, r, n, i) {
                this.type = vt, this.number = t, this.locale = e, this.currency = r, this.minFractionDigits = n, this.maxFractionDigits = i;
            };
        ir.parse = function (t, e) {
            if (3 !== t.length) return e.error("Expected two arguments.");
            var r = e.parse(t[1], 1, gt);
            if (!r) return null;
            var n = t[2];
            if ("object" != typeof n || Array.isArray(n)) return e.error("NumberFormat options argument must be an object.");
            var i = null;
            if (n.locale && !(i = e.parse(n.locale, 1, vt))) return null;
            var a = null;
            if (n.currency && !(a = e.parse(n.currency, 1, vt))) return null;
            var o = null;
            if (n["min-fraction-digits"] && !(o = e.parse(n["min-fraction-digits"], 1, gt))) return null;
            var s = null;
            return n["max-fraction-digits"] && !(s = e.parse(n["max-fraction-digits"], 1, gt)) ? null : new ir(r, i, a, o, s)
        }, ir.prototype.evaluate = function (t) {
            return new Intl.NumberFormat(this.locale ? this.locale.evaluate(t) : [], {
                style: this.currency ? "currency" : "decimal",
                currency: this.currency ? this.currency.evaluate(t) : void 0,
                minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(t) : void 0,
                maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(t) : void 0
            }).format(this.number.evaluate(t))
        }, ir.prototype.eachChild = function (t) {
            t(this.number), this.locale && t(this.locale), this.currency && t(this.currency), this.minFractionDigits && t(this.minFractionDigits), this.maxFractionDigits && t(this.maxFractionDigits);
        }, ir.prototype.outputDefined = function () {
            return !1
        }, ir.prototype.serialize = function () {
            var t = {};
            return this.locale && (t.locale = this.locale.serialize()), this.currency && (t.currency = this.currency.serialize()), this.minFractionDigits && (t["min-fraction-digits"] = this.minFractionDigits.serialize()), this.maxFractionDigits && (t["max-fraction-digits"] = this.maxFractionDigits.serialize()), ["number-format", this.number.serialize(), t]
        };
        var ar = function (t) {
            this.type = gt, this.input = t;
        };
        ar.parse = function (t, e) {
            if (2 !== t.length) return e.error("Expected 1 argument, but found " + (t.length - 1) + " instead.");
            var r = e.parse(t[1], 1);
            return r ? "array" !== r.type.kind && "string" !== r.type.kind && "value" !== r.type.kind ? e.error("Expected argument of type string or array, but found " + zt(r.type) + " instead.") : new ar(r) : null
        }, ar.prototype.evaluate = function (t) {
            var e = this.input.evaluate(t);
            if ("string" == typeof e) return e.length;
            if (Array.isArray(e)) return e.length;
            throw new Kt("Expected value to be of type string or array, but found " + zt(Rt(e)) + " instead.")
        }, ar.prototype.eachChild = function (t) {
            t(this.input);
        }, ar.prototype.outputDefined = function () {
            return !1
        }, ar.prototype.serialize = function () {
            var t = ["length"];
            return this.eachChild((function (e) {
                t.push(e.serialize());
            })), t
        };
        var or = {
            "==": We,
            "!=": Qe,
            ">": er,
            "<": tr,
            ">=": nr,
            "<=": rr,
            array: Gt,
            at: Ne,
            boolean: Gt,
            case: He,
            coalesce: Re,
            collator: te,
            format: Ht,
            image: Yt,
            in: Ke,
            "index-of": Xe,
            interpolate: Oe,
            "interpolate-hcl": Oe,
            "interpolate-lab": Oe,
            length: ar,
            let: je,
            literal: Nt,
            match: Ge,
            number: Gt,
            "number-format": ir,
            object: Gt,
            slice: Ye,
            step: ke,
            string: Gt,
            "to-boolean": Jt,
            "to-color": Jt,
            "to-number": Jt,
            "to-string": Jt,
            var: be,
            within: me
        };

        function sr(t, e) {
            var r = e[0],
                n = e[1],
                i = e[2],
                a = e[3];
            r = r.evaluate(t), n = n.evaluate(t), i = i.evaluate(t);
            var o = a ? a.evaluate(t) : 1,
                s = Ot(r, n, i, o);
            if (s) throw new Kt(s);
            return new Tt(r / 255 * o, n / 255 * o, i / 255 * o, o)
        }

        function ur(t, e) {
            return t in e
        }

        function lr(t, e) {
            var r = e[t];
            return void 0 === r ? null : r
        }

        function pr(t) {
            return {
                type: t
            }
        }

        function cr(t) {
            return {
                result: "success",
                value: t
            }
        }

        function hr(t) {
            return {
                result: "error",
                value: t
            }
        }

        function yr(t) {
            return "data-driven" === t["property-type"] || "cross-faded-data-driven" === t["property-type"]
        }

        function fr(t) {
            return !!t.expression && t.expression.parameters.indexOf("zoom") > -1
        }

        function dr(t) {
            return !!t.expression && t.expression.interpolated
        }

        function mr(t) {
            return t instanceof Number ? "number" : t instanceof String ? "string" : t instanceof Boolean ? "boolean" : Array.isArray(t) ? "array" : null === t ? "null" : typeof t
        }

        function gr(t) {
            return "object" == typeof t && null !== t && !Array.isArray(t)
        }

        function vr(t) {
            return t
        }

        function xr(t, e, r) {
            return void 0 !== t ? t : void 0 !== e ? e : void 0 !== r ? r : void 0
        }

        function br(t, e, r, n, i) {
            return xr(typeof r === i ? n[r] : void 0, t.default, e.default)
        }

        function _r(t, e, r) {
            if ("number" !== mr(r)) return xr(t.default, e.default);
            var n = t.stops.length;
            if (1 === n) return t.stops[0][1];
            if (r <= t.stops[0][0]) return t.stops[0][1];
            if (r >= t.stops[n - 1][0]) return t.stops[n - 1][1];
            var i = we(t.stops.map((function (t) {
                return t[0]
            })), r);
            return t.stops[i][1]
        }

        function wr(t, e, r) {
            var n = void 0 !== t.base ? t.base : 1;
            if ("number" !== mr(r)) return xr(t.default, e.default);
            var i = t.stops.length;
            if (1 === i) return t.stops[0][1];
            if (r <= t.stops[0][0]) return t.stops[0][1];
            if (r >= t.stops[i - 1][0]) return t.stops[i - 1][1];
            var a = we(t.stops.map((function (t) {
                    return t[0]
                })), r),
                o = function (t, e, r, n) {
                    var i = n - r,
                        a = t - r;
                    return 0 === i ? 0 : 1 === e ? a / i : (Math.pow(e, a) - 1) / (Math.pow(e, i) - 1)
                }(r, n, t.stops[a][0], t.stops[a + 1][0]),
                s = t.stops[a][1],
                u = t.stops[a + 1][1],
                l = Se[e.type] || vr;
            if (t.colorSpace && "rgb" !== t.colorSpace) {
                var p = qe[t.colorSpace];
                l = function (t, e) {
                    return p.reverse(p.interpolate(p.forward(t), p.forward(e), o))
                };
            }
            return "function" == typeof s.evaluate ? {
                evaluate: function () {
                    for (var t = [], e = arguments.length; e--;) t[e] = arguments[e];
                    var r = s.evaluate.apply(void 0, t),
                        n = u.evaluate.apply(void 0, t);
                    if (void 0 !== r && void 0 !== n) return l(r, n, o)
                }
            } : l(s, u, o)
        }

        function kr(t, e, r) {
            return "color" === e.type ? r = Tt.parse(r) : "formatted" === e.type ? r = Ft.fromString(r.toString()) : "resolvedImage" === e.type ? r = qt.fromString(r.toString()) : mr(r) === e.type || "enum" === e.type && e.values[r] || (r = void 0), xr(r, t.default, e.default)
        }
        Qt.register(or, {
            error: [{
                    kind: "error"
                },
                [vt],
                function (t, e) {
                    throw new Kt(e[0].evaluate(t))
                }
            ],
            typeof: [vt, [wt], function (t, e) {
                return zt(Rt(e[0].evaluate(t)))
            }],
            "to-rgba": [It(gt, 4), [bt], function (t, e) {
                return e[0].evaluate(t).toArray()
            }],
            rgb: [bt, [gt, gt, gt], sr],
            rgba: [bt, [gt, gt, gt, gt], sr],
            has: {
                type: xt,
                overloads: [
                    [
                        [vt],
                        function (t, e) {
                            return ur(e[0].evaluate(t), t.properties())
                        }
                    ],
                    [
                        [vt, _t],
                        function (t, e) {
                            var r = e[1];
                            return ur(e[0].evaluate(t), r.evaluate(t))
                        }
                    ]
                ]
            },
            get: {
                type: wt,
                overloads: [
                    [
                        [vt],
                        function (t, e) {
                            return lr(e[0].evaluate(t), t.properties())
                        }
                    ],
                    [
                        [vt, _t],
                        function (t, e) {
                            var r = e[1];
                            return lr(e[0].evaluate(t), r.evaluate(t))
                        }
                    ]
                ]
            },
            "feature-state": [wt, [vt], function (t, e) {
                return lr(e[0].evaluate(t), t.featureState || {})
            }],
            properties: [_t, [], function (t) {
                return t.properties()
            }],
            "geometry-type": [vt, [], function (t) {
                return t.geometryType()
            }],
            id: [wt, [], function (t) {
                return t.id()
            }],
            zoom: [gt, [], function (t) {
                return t.globals.zoom
            }],
            "heatmap-density": [gt, [], function (t) {
                return t.globals.heatmapDensity || 0
            }],
            "line-progress": [gt, [], function (t) {
                return t.globals.lineProgress || 0
            }],
            accumulated: [wt, [], function (t) {
                return void 0 === t.globals.accumulated ? null : t.globals.accumulated
            }],
            "+": [gt, pr(gt), function (t, e) {
                for (var r = 0, n = 0, i = e; n < i.length; n += 1) r += i[n].evaluate(t);
                return r
            }],
            "*": [gt, pr(gt), function (t, e) {
                for (var r = 1, n = 0, i = e; n < i.length; n += 1) r *= i[n].evaluate(t);
                return r
            }],
            "-": {
                type: gt,
                overloads: [
                    [
                        [gt, gt],
                        function (t, e) {
                            var r = e[1];
                            return e[0].evaluate(t) - r.evaluate(t)
                        }
                    ],
                    [
                        [gt],
                        function (t, e) {
                            return -e[0].evaluate(t)
                        }
                    ]
                ]
            },
            "/": [gt, [gt, gt], function (t, e) {
                var r = e[1];
                return e[0].evaluate(t) / r.evaluate(t)
            }],
            "%": [gt, [gt, gt], function (t, e) {
                var r = e[1];
                return e[0].evaluate(t) % r.evaluate(t)
            }],
            ln2: [gt, [], function () {
                return Math.LN2
            }],
            pi: [gt, [], function () {
                return Math.PI
            }],
            e: [gt, [], function () {
                return Math.E
            }],
            "^": [gt, [gt, gt], function (t, e) {
                var r = e[1];
                return Math.pow(e[0].evaluate(t), r.evaluate(t))
            }],
            sqrt: [gt, [gt], function (t, e) {
                return Math.sqrt(e[0].evaluate(t))
            }],
            log10: [gt, [gt], function (t, e) {
                return Math.log(e[0].evaluate(t)) / Math.LN10
            }],
            ln: [gt, [gt], function (t, e) {
                return Math.log(e[0].evaluate(t))
            }],
            log2: [gt, [gt], function (t, e) {
                return Math.log(e[0].evaluate(t)) / Math.LN2
            }],
            sin: [gt, [gt], function (t, e) {
                return Math.sin(e[0].evaluate(t))
            }],
            cos: [gt, [gt], function (t, e) {
                return Math.cos(e[0].evaluate(t))
            }],
            tan: [gt, [gt], function (t, e) {
                return Math.tan(e[0].evaluate(t))
            }],
            asin: [gt, [gt], function (t, e) {
                return Math.asin(e[0].evaluate(t))
            }],
            acos: [gt, [gt], function (t, e) {
                return Math.acos(e[0].evaluate(t))
            }],
            atan: [gt, [gt], function (t, e) {
                return Math.atan(e[0].evaluate(t))
            }],
            min: [gt, pr(gt), function (t, e) {
                return Math.min.apply(Math, e.map((function (e) {
                    return e.evaluate(t)
                })))
            }],
            max: [gt, pr(gt), function (t, e) {
                return Math.max.apply(Math, e.map((function (e) {
                    return e.evaluate(t)
                })))
            }],
            abs: [gt, [gt], function (t, e) {
                return Math.abs(e[0].evaluate(t))
            }],
            round: [gt, [gt], function (t, e) {
                var r = e[0].evaluate(t);
                return r < 0 ? -Math.round(-r) : Math.round(r)
            }],
            floor: [gt, [gt], function (t, e) {
                return Math.floor(e[0].evaluate(t))
            }],
            ceil: [gt, [gt], function (t, e) {
                return Math.ceil(e[0].evaluate(t))
            }],
            "filter-==": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1];
                return t.properties()[r.value] === n.value
            }],
            "filter-id-==": [xt, [wt], function (t, e) {
                var r = e[0];
                return t.id() === r.value
            }],
            "filter-type-==": [xt, [vt], function (t, e) {
                var r = e[0];
                return t.geometryType() === r.value
            }],
            "filter-<": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1],
                    i = t.properties()[r.value],
                    a = n.value;
                return typeof i == typeof a && i < a
            }],
            "filter-id-<": [xt, [wt], function (t, e) {
                var r = e[0],
                    n = t.id(),
                    i = r.value;
                return typeof n == typeof i && n < i
            }],
            "filter->": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1],
                    i = t.properties()[r.value],
                    a = n.value;
                return typeof i == typeof a && i > a
            }],
            "filter-id->": [xt, [wt], function (t, e) {
                var r = e[0],
                    n = t.id(),
                    i = r.value;
                return typeof n == typeof i && n > i
            }],
            "filter-<=": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1],
                    i = t.properties()[r.value],
                    a = n.value;
                return typeof i == typeof a && i <= a
            }],
            "filter-id-<=": [xt, [wt], function (t, e) {
                var r = e[0],
                    n = t.id(),
                    i = r.value;
                return typeof n == typeof i && n <= i
            }],
            "filter->=": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1],
                    i = t.properties()[r.value],
                    a = n.value;
                return typeof i == typeof a && i >= a
            }],
            "filter-id->=": [xt, [wt], function (t, e) {
                var r = e[0],
                    n = t.id(),
                    i = r.value;
                return typeof n == typeof i && n >= i
            }],
            "filter-like": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1];
                return t.properties()[r.value].indexOf(n.value) >= 0
            }],
            "filter-id-like": [xt, [wt], function (t, e) {
                var r = e[0];
                return t.id().indexOf(r.value) >= 0
            }],
            "filter-type-like": [xt, [vt], function (t, e) {
                var r = e[0];
                return t.geometryType().indexOf(r.value) >= 0
            }],
            "filter-start": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1];
                return 0 === t.properties()[r.value].indexOf(n.value)
            }],
            "filter-id-start": [xt, [wt], function (t, e) {
                var r = e[0];
                return 0 === t.id().indexOf(r.value)
            }],
            "filter-type-start": [xt, [vt], function (t, e) {
                var r = e[0];
                return 0 === t.geometryType().indexOf(r.value)
            }],
            "filter-end": [xt, [vt, wt], function (t, e) {
                var r = e[0],
                    n = e[1],
                    i = t.properties()[r.value],
                    a = n.value;
                return i.slice(-a.length) === a
            }],
            "filter-id-end": [xt, [wt], function (t, e) {
                var r = e[0],
                    n = t.id(),
                    i = r.value;
                return n.slice(-i.length) === i
            }],
            "filter-type-end": [xt, [vt], function (t, e) {
                var r = e[0],
                    n = t.geometryType(),
                    i = r.value;
                return n.slice(-i.length) === i
            }],
            "filter-has": [xt, [wt], function (t, e) {
                return e[0].value in t.properties()
            }],
            "filter-has-id": [xt, [], function (t) {
                return null !== t.id() && void 0 !== t.id()
            }],
            "filter-type-in": [xt, [It(vt)], function (t, e) {
                return e[0].value.indexOf(t.geometryType()) >= 0
            }],
            "filter-type-arrin": [xt, [It(vt)], function (t, e) {
                return e[0].value.indexOf(t.geometryType()) >= 0
            }],
            "filter-arrin": [xt, [vt, It(wt)], function (t, e) {
                var r = e[0],
                    n = e[1];
                return function (t, e, r, n) {
                    for (; r <= n;) {
                        if (!t) return !1;
                        if (t.indexOf(e[r]) > -1) return !0;
                        r += 1;
                    }
                    return !1
                }(t.properties()[r.value], n.value, 0, n.value.length - 1)
            }],
            "filter-id-in": [xt, [It(wt)], function (t, e) {
                return e[0].value.indexOf(t.id()) >= 0
            }],
            "filter-in-small": [xt, [vt, It(wt)], function (t, e) {
                var r = e[0];
                return e[1].value.indexOf(t.properties()[r.value]) >= 0
            }],
            "filter-in-large": [xt, [vt, It(wt)], function (t, e) {
                var r = e[0],
                    n = e[1];
                return function (t, e, r, n) {
                    for (; r <= n;) {
                        var i = r + n >> 1;
                        if (e[i] === t) return !0;
                        e[i] > t ? n = i - 1 : r = i + 1;
                    }
                    return !1
                }(t.properties()[r.value], n.value, 0, n.value.length - 1)
            }],
            all: {
                type: xt,
                overloads: [
                    [
                        [xt, xt],
                        function (t, e) {
                            var r = e[1];
                            return e[0].evaluate(t) && r.evaluate(t)
                        }
                    ],
                    [pr(xt), function (t, e) {
                        for (var r = 0, n = e; r < n.length; r += 1)
                            if (!n[r].evaluate(t)) return !1;
                        return !0
                    }]
                ]
            },
            any: {
                type: xt,
                overloads: [
                    [
                        [xt, xt],
                        function (t, e) {
                            var r = e[1];
                            return e[0].evaluate(t) || r.evaluate(t)
                        }
                    ],
                    [pr(xt), function (t, e) {
                        for (var r = 0, n = e; r < n.length; r += 1)
                            if (n[r].evaluate(t)) return !0;
                        return !1
                    }]
                ]
            },
            "!": [xt, [xt], function (t, e) {
                return !e[0].evaluate(t)
            }],
            "is-supported-script": [xt, [vt], function (t, e) {
                var r = t.globals && t.globals.isSupportedScript;
                return !r || r(e[0].evaluate(t))
            }],
            upcase: [vt, [vt], function (t, e) {
                return e[0].evaluate(t).toUpperCase()
            }],
            downcase: [vt, [vt], function (t, e) {
                return e[0].evaluate(t).toLowerCase()
            }],
            concat: [vt, pr(wt), function (t, e) {
                return e.map((function (e) {
                    return jt(e.evaluate(t))
                })).join("")
            }],
            "resolved-locale": [vt, [kt], function (t, e) {
                return e[0].evaluate(t).resolvedLocale()
            }]
        });
        var Ar = function (t, e) {
            this.expression = t, this._warningHistory = {}, this._evaluator = new Wt, this._defaultValue = e ? function (t) {
                return "color" === t.type && gr(t.default) ? new Tt(0, 0, 0, 0) : "color" === t.type ? Tt.parse(t.default) || null : void 0 === t.default ? null : t.default
            }(e) : null, this._enumValues = e && "enum" === e.type ? e.values : null;
        };

        function Sr(t) {
            return Array.isArray(t) && t.length > 0 && "string" == typeof t[0] && t[0] in or
        }

        function Ir(t, e) {
            var r = new _e(or, [], e ? function (t) {
                    var e = {
                        color: bt,
                        string: vt,
                        number: gt,
                        enum: vt,
                        boolean: xt,
                        formatted: At,
                        resolvedImage: St
                    };
                    return "array" === t.type ? It(e[t.value] || wt, t.length) : e[t.type]
                }(e) : void 0),
                n = r.parse(t, void 0, void 0, void 0, e && "string" === e.type ? {
                    typeAnnotation: "coerce"
                } : void 0);
            return n ? cr(new Ar(n, e)) : hr(r.errors)
        }
        Ar.prototype.evaluateWithoutErrorHandling = function (t, e, r, n, i, a) {
            return this._evaluator.globals = t, this._evaluator.feature = e, this._evaluator.featureState = r, this._evaluator.canonical = n, this._evaluator.availableImages = i || null, this._evaluator.formattedSection = a, this.expression.evaluate(this._evaluator)
        }, Ar.prototype.evaluate = function (t, e, r, n, i, a) {
            this._evaluator.globals = t, this._evaluator.feature = e || null, this._evaluator.featureState = r || null, this._evaluator.canonical = n, this._evaluator.availableImages = i || null, this._evaluator.formattedSection = a || null;
            try {
                var o = this.expression.evaluate(this._evaluator);
                if (null == o || "number" == typeof o && o != o) return this._defaultValue;
                if (this._enumValues && !(o in this._enumValues)) throw new Kt("Expected value to be one of " + Object.keys(this._enumValues).map((function (t) {
                    return JSON.stringify(t)
                })).join(", ") + ", but found " + JSON.stringify(o) + " instead.");
                return o
            } catch (t) {
                return this._warningHistory[t.message] || (this._warningHistory[t.message] = !0, "undefined" != typeof console && console.warn(t.message)), this._defaultValue
            }
        };
        var zr = function (t, e) {
            this.kind = t, this._styleExpression = e, this.isStateDependent = "constant" !== t && !ve(e.expression);
        };
        zr.prototype.evaluateWithoutErrorHandling = function (t, e, r, n, i, a) {
            return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, n, i, a)
        }, zr.prototype.evaluate = function (t, e, r, n, i, a) {
            return this._styleExpression.evaluate(t, e, r, n, i, a)
        };
        var Br = function (t, e, r, n) {
            this.kind = t, this.zoomStops = r, this._styleExpression = e, this.isStateDependent = "camera" !== t && !ve(e.expression), this.interpolationType = n;
        };

        function Vr(t, e) {
            if ("error" === (t = Ir(t, e)).result) return t;
            var r = t.value.expression,
                n = ge(r);
            if (!n && !yr(e)) return hr([new ft("", "data expressions not supported")]);
            var i = xe(r, ["zoom"]);
            if (!i && !fr(e)) return hr([new ft("", "zoom expressions not supported")]);
            var a = function t(e) {
                var r = null;
                if (e instanceof je) r = t(e.result);
                else if (e instanceof Re)
                    for (var n = 0, i = e.args; n < i.length && !(r = t(i[n])); n += 1);
                else(e instanceof ke || e instanceof Oe) && e.input instanceof Qt && "zoom" === e.input.name && (r = e);
                return r instanceof ft || e.eachChild((function (e) {
                    var n = t(e);
                    n instanceof ft ? r = n : !r && n ? r = new ft("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.') : r && n && r !== n && (r = new ft("", 'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'));
                })), r
            }(r);
            return a || i ? a instanceof ft ? hr([a]) : a instanceof Oe && !dr(e) ? hr([new ft("", '"interpolate" expressions cannot be used with this property')]) : cr(a ? new Br(n ? "camera" : "composite", t.value, a.labels, a instanceof Oe ? a.interpolation : void 0) : new zr(n ? "constant" : "source", t.value)) : hr([new ft("", '"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])
        }
        Br.prototype.evaluateWithoutErrorHandling = function (t, e, r, n, i, a) {
            return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, n, i, a)
        }, Br.prototype.evaluate = function (t, e, r, n, i, a) {
            return this._styleExpression.evaluate(t, e, r, n, i, a)
        }, Br.prototype.interpolationFactor = function (t, e, r) {
            return this.interpolationType ? Oe.interpolationFactor(this.interpolationType, t, e, r) : 0
        };
        var Cr = function (t, e) {
            this._parameters = t, this._specification = e, ct(this, function t(e, r) {
                var n, i, a, o = "color" === r.type,
                    s = e.stops && "object" == typeof e.stops[0][0],
                    u = s || !(s || void 0 !== e.property),
                    l = e.type || (dr(r) ? "exponential" : "interval");
                if (o && ((e = ct({}, e)).stops && (e.stops = e.stops.map((function (t) {
                        return [t[0], Tt.parse(t[1])]
                    }))), e.default = Tt.parse(e.default ? e.default : r.default)), e.colorSpace && "rgb" !== e.colorSpace && !qe[e.colorSpace]) throw new Error("Unknown color space: " + e.colorSpace);
                if ("exponential" === l) n = wr;
                else if ("interval" === l) n = _r;
                else if ("categorical" === l) {
                    n = br, i = Object.create(null);
                    for (var p = 0, c = e.stops; p < c.length; p += 1) {
                        var h = c[p];
                        i[h[0]] = h[1];
                    }
                    a = typeof e.stops[0][0];
                } else {
                    if ("identity" !== l) throw new Error('Unknown function type "' + l + '"');
                    n = kr;
                }
                if (s) {
                    for (var y = {}, f = [], d = 0; d < e.stops.length; d++) {
                        var m = e.stops[d],
                            g = m[0].zoom;
                        void 0 === y[g] && (y[g] = {
                            zoom: g,
                            type: e.type,
                            property: e.property,
                            default: e.default,
                            stops: []
                        }, f.push(g)), y[g].stops.push([m[0].value, m[1]]);
                    }
                    for (var v = [], x = 0, b = f; x < b.length; x += 1) {
                        var _ = b[x];
                        v.push([y[_].zoom, t(y[_], r)]);
                    }
                    var w = {
                        name: "linear"
                    };
                    return {
                        kind: "composite",
                        interpolationType: w,
                        interpolationFactor: Oe.interpolationFactor.bind(void 0, w),
                        zoomStops: v.map((function (t) {
                            return t[0]
                        })),
                        evaluate: function (t, n) {
                            var i = t.zoom;
                            return wr({
                                stops: v,
                                base: e.base
                            }, r, i).evaluate(i, n)
                        }
                    }
                }
                if (u) {
                    var k = "exponential" === l ? {
                        name: "exponential",
                        base: void 0 !== e.base ? e.base : 1
                    } : null;
                    return {
                        kind: "camera",
                        interpolationType: k,
                        interpolationFactor: Oe.interpolationFactor.bind(void 0, k),
                        zoomStops: e.stops.map((function (t) {
                            return t[0]
                        })),
                        evaluate: function (t) {
                            return n(e, r, t.zoom, i, a)
                        }
                    }
                }
                return {
                    kind: "source",
                    evaluate: function (t, o) {
                        var s = o && o.properties ? o.properties[e.property] : void 0;
                        return void 0 === s ? xr(e.default, r.default) : n(e, r, s, i, a)
                    }
                }
            }(this._parameters, this._specification));
        };

        function Mr(t) {
            var e = t.key,
                r = t.value,
                n = t.valueSpec || {},
                i = t.objectElementValidators || {},
                a = t.style,
                o = t.styleSpec,
                s = [],
                u = mr(r);
            if ("object" !== u) return [new lt(e, r, "object expected, " + u + " found")];
            for (var l in r) {
                var p = l.split(".")[0],
                    c = n[p] || n["*"],
                    h = void 0;
                if (i[p]) h = i[p];
                else if (n[p]) h = nn;
                else if (i["*"]) h = i["*"];
                else {
                    if (!n["*"]) {
                        s.push(new lt(e, r[l], 'unknown property "' + l + '"'));
                        continue
                    }
                    h = nn;
                }
                s = s.concat(h({
                    key: (e ? e + "." : e) + l,
                    value: r[l],
                    valueSpec: c,
                    style: a,
                    styleSpec: o,
                    object: r,
                    objectKey: l
                }, r));
            }
            for (var y in n) i[y] || n[y].required && void 0 === n[y].default && void 0 === r[y] && s.push(new lt(e, r, 'missing required property "' + y + '"'));
            return s
        }

        function Pr(t) {
            var e = t.value,
                r = t.valueSpec,
                n = t.style,
                i = t.styleSpec,
                a = t.key,
                o = t.arrayElementValidator || nn;
            if ("array" !== mr(e)) return [new lt(a, e, "array expected, " + mr(e) + " found")];
            if (r.length && e.length !== r.length) return [new lt(a, e, "array length " + r.length + " expected, length " + e.length + " found")];
            if (r["min-length"] && e.length < r["min-length"]) return [new lt(a, e, "array length at least " + r["min-length"] + " expected, length " + e.length + " found")];
            var s = {
                type: r.value,
                values: r.values
            };
            i.$version < 7 && (s.function = r.function), "object" === mr(r.value) && (s = r.value);
            for (var u = [], l = 0; l < e.length; l++) u = u.concat(o({
                array: e,
                arrayIndex: l,
                value: e[l],
                valueSpec: s,
                style: n,
                styleSpec: i,
                key: a + "[" + l + "]"
            }));
            return u
        }

        function Lr(t) {
            var e = t.key,
                r = t.value,
                n = t.valueSpec,
                i = mr(r);
            return "number" === i && r != r && (i = "NaN"), "number" !== i ? [new lt(e, r, "number expected, " + i + " found")] : "minimum" in n && r < n.minimum ? [new lt(e, r, r + " is less than the minimum value " + n.minimum)] : "maximum" in n && r > n.maximum ? [new lt(e, r, r + " is greater than the maximum value " + n.maximum)] : []
        }

        function Tr(t) {
            var e, r, n, i = t.valueSpec,
                a = ht(t.value.type),
                o = {},
                s = "categorical" !== a && void 0 === t.value.property,
                u = !s,
                l = "array" === mr(t.value.stops) && "array" === mr(t.value.stops[0]) && "object" === mr(t.value.stops[0][0]),
                p = Mr({
                    key: t.key,
                    value: t.value,
                    valueSpec: t.styleSpec.function,
                    style: t.style,
                    styleSpec: t.styleSpec,
                    objectElementValidators: {
                        stops: function (t) {
                            if ("identity" === a) return [new lt(t.key, t.value, 'identity function may not have a "stops" property')];
                            var e = [],
                                r = t.value;
                            return e = e.concat(Pr({
                                key: t.key,
                                value: r,
                                valueSpec: t.valueSpec,
                                style: t.style,
                                styleSpec: t.styleSpec,
                                arrayElementValidator: c
                            })), "array" === mr(r) && 0 === r.length && e.push(new lt(t.key, r, "array must have at least one stop")), e
                        },
                        default: function (t) {
                            return nn({
                                key: t.key,
                                value: t.value,
                                valueSpec: i,
                                style: t.style,
                                styleSpec: t.styleSpec
                            })
                        }
                    }
                });
            return "identity" === a && s && p.push(new lt(t.key, t.value, 'missing required property "property"')), "identity" === a || t.value.stops || p.push(new lt(t.key, t.value, 'missing required property "stops"')), "exponential" === a && t.valueSpec.expression && !dr(t.valueSpec) && p.push(new lt(t.key, t.value, "exponential functions not supported")), t.styleSpec.$version >= 8 && (u && !yr(t.valueSpec) ? p.push(new lt(t.key, t.value, "property functions not supported")) : s && !fr(t.valueSpec) && p.push(new lt(t.key, t.value, "zoom functions not supported"))), "categorical" !== a && !l || void 0 !== t.value.property || p.push(new lt(t.key, t.value, '"property" property is required')), p;

            function c(t) {
                var e = [],
                    a = t.value,
                    s = t.key;
                if ("array" !== mr(a)) return [new lt(s, a, "array expected, " + mr(a) + " found")];
                if (2 !== a.length) return [new lt(s, a, "array length 2 expected, length " + a.length + " found")];
                if (l) {
                    if ("object" !== mr(a[0])) return [new lt(s, a, "object expected, " + mr(a[0]) + " found")];
                    if (void 0 === a[0].zoom) return [new lt(s, a, "object stop key must have zoom")];
                    if (void 0 === a[0].value) return [new lt(s, a, "object stop key must have value")];
                    if (n && n > ht(a[0].zoom)) return [new lt(s, a[0].zoom, "stop zoom values must appear in ascending order")];
                    ht(a[0].zoom) !== n && (n = ht(a[0].zoom), r = void 0, o = {}), e = e.concat(Mr({
                        key: s + "[0]",
                        value: a[0],
                        valueSpec: {
                            zoom: {}
                        },
                        style: t.style,
                        styleSpec: t.styleSpec,
                        objectElementValidators: {
                            zoom: Lr,
                            value: h
                        }
                    }));
                } else e = e.concat(h({
                    key: s + "[0]",
                    value: a[0],
                    valueSpec: {},
                    style: t.style,
                    styleSpec: t.styleSpec
                }, a));
                return Sr(yt(a[1])) ? e.concat([new lt(s + "[1]", a[1], "expressions are not allowed in function stops.")]) : e.concat(nn({
                    key: s + "[1]",
                    value: a[1],
                    valueSpec: i,
                    style: t.style,
                    styleSpec: t.styleSpec
                }))
            }

            function h(t, n) {
                var s = mr(t.value),
                    u = ht(t.value),
                    l = null !== t.value ? t.value : n;
                if (e) {
                    if (s !== e) return [new lt(t.key, l, s + " stop domain type must match previous stop domain type " + e)]
                } else e = s;
                if ("number" !== s && "string" !== s && "boolean" !== s) return [new lt(t.key, l, "stop domain value must be a number, string, or boolean")];
                if ("number" !== s && "categorical" !== a) {
                    var p = "number expected, " + s + " found";
                    return yr(i) && void 0 === a && (p += '\nIf you intended to use a categorical function, specify `"type": "categorical"`.'), [new lt(t.key, l, p)]
                }
                return "categorical" !== a || "number" !== s || isFinite(u) && Math.floor(u) === u ? "categorical" !== a && "number" === s && void 0 !== r && u < r ? [new lt(t.key, l, "stop domain values must appear in ascending order")] : (r = u, "categorical" === a && u in o ? [new lt(t.key, l, "stop domain values must be unique")] : (o[u] = !0, [])) : [new lt(t.key, l, "integer expected, found " + u)]
            }
        }

        function Dr(t) {
            var e = ("property" === t.expressionContext ? Vr : Ir)(yt(t.value), t.valueSpec);
            if ("error" === e.result) return e.value.map((function (e) {
                return new lt("" + t.key + e.key, t.value, e.message)
            }));
            var r = e.value.expression || e.value._styleExpression.expression;
            if ("property" === t.expressionContext && "text-font" === t.propertyKey && !r.outputDefined()) return [new lt(t.key, t.value, 'Invalid data expression for "' + t.propertyKey + '". Output values must be contained as literals within the expression.')];
            if ("property" === t.expressionContext && "layout" === t.propertyType && !ve(r)) return [new lt(t.key, t.value, '"feature-state" data expressions are not supported with layout properties.')];
            if ("filter" === t.expressionContext && !ve(r)) return [new lt(t.key, t.value, '"feature-state" data expressions are not supported with filters.')];
            if (t.expressionContext && 0 === t.expressionContext.indexOf("cluster")) {
                if (!xe(r, ["zoom", "feature-state"])) return [new lt(t.key, t.value, '"zoom" and "feature-state" expressions are not supported with cluster properties.')];
                if ("cluster-initial" === t.expressionContext && !ge(r)) return [new lt(t.key, t.value, "Feature data expressions are not supported with initial expression part of cluster properties.")]
            }
            return []
        }

        function Er(t) {
            var e = t.key,
                r = t.value,
                n = t.valueSpec,
                i = [];
            return Array.isArray(n.values) ? -1 === n.values.indexOf(ht(r)) && i.push(new lt(e, r, "expected one of [" + n.values.join(", ") + "], " + JSON.stringify(r) + " found")) : -1 === Object.keys(n.values).indexOf(ht(r)) && i.push(new lt(e, r, "expected one of [" + Object.keys(n.values).join(", ") + "], " + JSON.stringify(r) + " found")), i
        }

        function Fr(t) {
            if (!0 === t || !1 === t) return !0;
            if (!Array.isArray(t) || 0 === t.length) return !1;
            switch (t[0]) {
                case "has":
                    return t.length >= 2 && "$id" !== t[1] && "$type" !== t[1];
                case "in":
                    return t.length >= 3 && ("string" != typeof t[1] || Array.isArray(t[2]));
                case "!in":
                case "!has":
                case "none":
                case "!arrin":
                case "arrin":
                    return !1;
                case "==":
                case "!=":
                case ">":
                case ">=":
                case "<":
                case "<=":
                case "like":
                case "start":
                case "end":
                    return 3 !== t.length || Array.isArray(t[1]) || Array.isArray(t[2]);
                case "any":
                case "all":
                    for (var e = 0, r = t.slice(1); e < r.length; e += 1) {
                        var n = r[e];
                        if (!Fr(n) && "boolean" != typeof n) return !1
                    }
                    return !0;
                default:
                    return !0
            }
        }
        Cr.deserialize = function (t) {
            return new Cr(t._parameters, t._specification)
        }, Cr.serialize = function (t) {
            return {
                _parameters: t._parameters,
                _specification: t._specification
            }
        };
        var qr = {
            type: "boolean",
            default: !1,
            transition: !1,
            "property-type": "data-driven",
            expression: {
                interpolated: !1,
                parameters: ["zoom", "feature"]
            }
        };

        function Or(t) {
            if (null == t) return {
                filter: function () {
                    return !0
                },
                needGeometry: !1
            };
            Fr(t) || (t = Rr(t));
            var e = Ir(t, qr);
            if ("error" === e.result) throw new Error(e.value.map((function (t) {
                return t.key + ": " + t.message
            })).join(", "));
            return {
                filter: function (t, r, n) {
                    return e.value.evaluate(t, r, {}, n)
                },
                needGeometry: function t(e) {
                    if (!Array.isArray(e)) return !1;
                    if ("within" === e[0]) return !0;
                    for (var r = 1; r < e.length; r++)
                        if (t(e[r])) return !0;
                    return !1
                }(t)
            }
        }

        function Ur(t, e) {
            return t < e ? -1 : t > e ? 1 : 0
        }

        function Rr(t) {
            if (!t) return !0;
            var e, r = t[0];
            return t.length <= 1 ? "any" !== r : "==" === r ? jr(t[1], t[2], "==") : "!=" === r ? Gr(jr(t[1], t[2], "==")) : "<" === r || ">" === r || "<=" === r || ">=" === r || "like" === r || "start" === r || "end" === r ? jr(t[1], t[2], r) : "any" === r ? (e = t.slice(1), ["any"].concat(e.map(Rr))) : "all" === r ? ["all"].concat(t.slice(1).map(Rr)) : "none" === r ? ["all"].concat(t.slice(1).map(Rr).map(Gr)) : "in" === r ? Nr(t[1], t.slice(2)) : "!in" === r ? Gr(Nr(t[1], t.slice(2))) : "has" === r ? Xr(t[1]) : "!has" === r ? Gr(Xr(t[1])) : "arrin" === r ? Kr(t[1], t.slice(2)) : "!arrin" === r ? Gr(Kr(t[1], t.slice(2))) : "within" !== r || t
        }

        function jr(t, e, r) {
            switch (t) {
                case "$type":
                    return ["filter-type-" + r, e];
                case "$id":
                    return ["filter-id-" + r, e];
                default:
                    return ["filter-" + r, t, e]
            }
        }

        function Nr(t, e) {
            if (0 === e.length) return !1;
            switch (t) {
                case "$type":
                    return ["filter-type-in", ["literal", e]];
                case "$id":
                    return ["filter-id-in", ["literal", e]];
                default:
                    return e.length > 200 && !e.some((function (t) {
                        return typeof t != typeof e[0]
                    })) ? ["filter-in-large", t, ["literal", e.sort(Ur)]] : ["filter-in-small", t, ["literal", e]]
            }
        }

        function Kr(t, e) {
            if (0 === e.length) return !1;
            switch (t) {
                case "$type":
                    return ["filter-type-arrin", ["literal", e]];
                default:
                    return ["filter-arrin", t, ["literal", e]]
            }
        }

        function Xr(t) {
            switch (t) {
                case "$type":
                    return !0;
                case "$id":
                    return ["filter-has-id"];
                default:
                    return ["filter-has", t]
            }
        }

        function Gr(t) {
            return ["!", t]
        }

        function Hr(t) {
            return Fr(yt(t.value)) ? Dr(ct({}, t, {
                expressionContext: "filter",
                valueSpec: {
                    value: "boolean"
                }
            })) : function t(e) {
                var r = e.value,
                    n = e.key;
                if ("array" !== mr(r)) return [new lt(n, r, "array expected, " + mr(r) + " found")];
                var i, a = e.styleSpec,
                    o = [];
                if (r.length < 1) return [new lt(n, r, "filter array must have at least 1 element")];
                switch (o = o.concat(Er({
                    key: n + "[0]",
                    value: r[0],
                    valueSpec: a.filter_operator,
                    style: e.style,
                    styleSpec: e.styleSpec
                })), ht(r[0])) {
                    case "<":
                    case "<=":
                    case ">":
                    case ">=":
                        r.length >= 2 && "$type" === ht(r[1]) && o.push(new lt(n, r, '"$type" cannot be use with operator "' + r[0] + '"'));
                    case "==":
                    case "!=":
                        3 !== r.length && o.push(new lt(n, r, 'filter array for operator "' + r[0] + '" must have 3 elements'));
                    case "in":
                    case "!in":
                        r.length >= 2 && "string" !== (i = mr(r[1])) && o.push(new lt(n + "[1]", r[1], "string expected, " + i + " found"));
                        for (var s = 2; s < r.length; s++) i = mr(r[s]), "$type" === ht(r[1]) ? o = o.concat(Er({
                            key: n + "[" + s + "]",
                            value: r[s],
                            valueSpec: a.geometry_type,
                            style: e.style,
                            styleSpec: e.styleSpec
                        })) : "string" !== i && "number" !== i && "boolean" !== i && o.push(new lt(n + "[" + s + "]", r[s], "string, number, or boolean expected, " + i + " found"));
                        break;
                    case "any":
                    case "all":
                    case "none":
                        for (var u = 1; u < r.length; u++) o = o.concat(t({
                            key: n + "[" + u + "]",
                            value: r[u],
                            style: e.style,
                            styleSpec: e.styleSpec
                        }));
                        break;
                    case "has":
                    case "!has":
                        i = mr(r[1]), 2 !== r.length ? o.push(new lt(n, r, 'filter array for "' + r[0] + '" operator must have 2 elements')) : "string" !== i && o.push(new lt(n + "[1]", r[1], "string expected, " + i + " found"));
                        break;
                    case "within":
                        i = mr(r[1]), 2 !== r.length ? o.push(new lt(n, r, 'filter array for "' + r[0] + '" operator must have 2 elements')) : "object" !== i && o.push(new lt(n + "[1]", r[1], "object expected, " + i + " found"));
                }
                return o
            }(t)
        }

        function Yr(t, e) {
            var r = t.key,
                n = t.style,
                i = t.styleSpec,
                a = t.value,
                o = t.objectKey,
                s = i[e + "_" + t.layerType];
            if (!s) return [];
            var u = o.match(/^(.*)-transition$/);
            if ("paint" === e && u && s[u[1]] && s[u[1]].transition) return nn({
                key: r,
                value: a,
                valueSpec: i.transition,
                style: n,
                styleSpec: i
            });
            var l, p = t.valueSpec || s[o];
            if (!p) return [new lt(r, a, 'unknown property "' + o + '"')];
            if ("string" === mr(a) && yr(p) && !p.tokens && (l = /^{([^}]+)}$/.exec(a))) return [new lt(r, a, '"' + o + '" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ' + JSON.stringify(l[1]) + " }`.")];
            var c = [];
            return "symbol" === t.layerType && ("text-field" === o && n && !n.glyphs && c.push(new lt(r, a, 'use of "text-field" requires a style "glyphs" property')), "text-font" === o && gr(yt(a)) && "identity" === ht(a.type) && c.push(new lt(r, a, '"text-font" does not support identity functions'))), c.concat(nn({
                key: t.key,
                value: a,
                valueSpec: p,
                style: n,
                styleSpec: i,
                expressionContext: "property",
                propertyType: e,
                propertyKey: o
            }))
        }

        function Zr(t) {
            return Yr(t, "paint")
        }

        function Jr(t) {
            return Yr(t, "layout")
        }

        function $r(t) {
            var e = [],
                r = t.value,
                n = t.key,
                i = t.style,
                a = t.styleSpec;
            r.type || r.ref || e.push(new lt(n, r, 'either "type" or "ref" is required'));
            var o, s = ht(r.type),
                u = ht(r.ref);
            if (r.id)
                for (var l = ht(r.id), p = 0; p < t.arrayIndex; p++) {
                    var c = i.layers[p];
                    ht(c.id) === l && e.push(new lt(n, r.id, 'duplicate layer id "' + r.id + '", previously used at line ' + c.id.__line__));
                }
            if ("ref" in r)["type", "source", "source-layer", "filter", "layout"].forEach((function (t) {
                t in r && e.push(new lt(n, r[t], '"' + t + '" is prohibited for ref layers'));
            })), i.layers.forEach((function (t) {
                ht(t.id) === u && (o = t);
            })), o ? o.ref ? e.push(new lt(n, r.ref, "ref cannot reference another ref layer")) : s = ht(o.type) : e.push(new lt(n, r.ref, 'ref layer "' + u + '" not found'));
            else if ("background" !== s)
                if (r.source) {
                    var h = i.sources && i.sources[r.source],
                        y = h && ht(h.type);
                    h ? "vector" === y && "raster" === s ? e.push(new lt(n, r.source, 'layer "' + r.id + '" requires a raster source')) : "raster" === y && "raster" !== s ? e.push(new lt(n, r.source, 'layer "' + r.id + '" requires a vector source')) : "vector" !== y || r["source-layer"] ? "raster-dem" === y && "hillshade" !== s ? e.push(new lt(n, r.source, "raster-dem source can only be used with layer type 'hillshade'.")) : "line" !== s || !r.paint || !r.paint["line-gradient"] || "geojson" === y && h.lineMetrics || e.push(new lt(n, r, 'layer "' + r.id + '" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')) : e.push(new lt(n, r, 'layer "' + r.id + '" must specify a "source-layer"')) : e.push(new lt(n, r.source, 'source "' + r.source + '" not found'));
                } else e.push(new lt(n, r, 'missing required property "source"'));
            return e = e.concat(Mr({
                key: n,
                value: r,
                valueSpec: a.layer,
                style: t.style,
                styleSpec: t.styleSpec,
                objectElementValidators: {
                    "*": function () {
                        return []
                    },
                    type: function () {
                        return nn({
                            key: n + ".type",
                            value: r.type,
                            valueSpec: a.layer.type,
                            style: t.style,
                            styleSpec: t.styleSpec,
                            object: r,
                            objectKey: "type"
                        })
                    },
                    filter: Hr,
                    layout: function (t) {
                        return Mr({
                            layer: r,
                            key: t.key,
                            value: t.value,
                            style: t.style,
                            styleSpec: t.styleSpec,
                            objectElementValidators: {
                                "*": function (t) {
                                    return Jr(ct({
                                        layerType: s
                                    }, t))
                                }
                            }
                        })
                    },
                    paint: function (t) {
                        return Mr({
                            layer: r,
                            key: t.key,
                            value: t.value,
                            style: t.style,
                            styleSpec: t.styleSpec,
                            objectElementValidators: {
                                "*": function (t) {
                                    return Zr(ct({
                                        layerType: s
                                    }, t))
                                }
                            }
                        })
                    }
                }
            }))
        }

        function Wr(t) {
            var e = t.value,
                r = t.key,
                n = mr(e);
            return "string" !== n ? [new lt(r, e, "string expected, " + n + " found")] : []
        }
        var Qr = {
            promoteId: function (t) {
                var e = t.key,
                    r = t.value;
                if ("string" === mr(r)) return Wr({
                    key: e,
                    value: r
                });
                var n = [];
                for (var i in r) n.push.apply(n, Wr({
                    key: e + "." + i,
                    value: r[i]
                }));
                return n
            }
        };

        function tn(t) {
            var e = t.value,
                r = t.key,
                n = t.styleSpec,
                i = t.style;
            if (!e.type) return [new lt(r, e, '"type" is required')];
            var a, o = ht(e.type);
            switch (o) {
                case "vector":
                case "raster":
                case "raster-dem":
                    return Mr({
                        key: r,
                        value: e,
                        valueSpec: n["source_" + o.replace("-", "_")],
                        style: t.style,
                        styleSpec: n,
                        objectElementValidators: Qr
                    });
                case "geojson":
                    if (a = Mr({
                            key: r,
                            value: e,
                            valueSpec: n.source_geojson,
                            style: i,
                            styleSpec: n,
                            objectElementValidators: Qr
                        }), e.cluster)
                        for (var s in e.clusterProperties) {
                            var u = e.clusterProperties[s],
                                l = u[0],
                                p = "string" == typeof l ? [l, ["accumulated"],
                                    ["get", s]
                                ] : l;
                            a.push.apply(a, Dr({
                                key: r + "." + s + ".map",
                                value: u[1],
                                expressionContext: "cluster-map"
                            })), a.push.apply(a, Dr({
                                key: r + "." + s + ".reduce",
                                value: p,
                                expressionContext: "cluster-reduce"
                            }));
                        }
                    return a;
                case "video":
                    return Mr({
                        key: r,
                        value: e,
                        valueSpec: n.source_video,
                        style: i,
                        styleSpec: n
                    });
                case "image":
                    return Mr({
                        key: r,
                        value: e,
                        valueSpec: n.source_image,
                        style: i,
                        styleSpec: n
                    });
                case "canvas":
                    return [new lt(r, null, "Please use runtime APIs to add canvas sources, rather than including them in stylesheets.", "source.canvas")];
                default:
                    return Er({
                        key: r + ".type",
                        value: e.type,
                        valueSpec: {
                            values: ["vector", "raster", "raster-dem", "geojson", "video", "image"]
                        },
                        style: i,
                        styleSpec: n
                    })
            }
        }

        function en(t) {
            var e = t.value,
                r = t.styleSpec,
                n = r.light,
                i = t.style,
                a = [],
                o = mr(e);
            if (void 0 === e) return a;
            if ("object" !== o) return a.concat([new lt("light", e, "object expected, " + o + " found")]);
            for (var s in e) {
                var u = s.match(/^(.*)-transition$/);
                a = a.concat(u && n[u[1]] && n[u[1]].transition ? nn({
                    key: s,
                    value: e[s],
                    valueSpec: r.transition,
                    style: i,
                    styleSpec: r
                }) : n[s] ? nn({
                    key: s,
                    value: e[s],
                    valueSpec: n[s],
                    style: i,
                    styleSpec: r
                }) : [new lt(s, e[s], 'unknown property "' + s + '"')]);
            }
            return a
        }
        var rn = {
            "*": function () {
                return []
            },
            array: Pr,
            boolean: function (t) {
                var e = t.value,
                    r = t.key,
                    n = mr(e);
                return "boolean" !== n ? [new lt(r, e, "boolean expected, " + n + " found")] : []
            },
            number: Lr,
            color: function (t) {
                var e = t.key,
                    r = t.value,
                    n = mr(r);
                return "string" !== n ? [new lt(e, r, "color expected, " + n + " found")] : null === Lt(r) ? [new lt(e, r, 'color expected, "' + r + '" found')] : []
            },
            constants: pt,
            enum: Er,
            filter: Hr,
            function: Tr,
            layer: $r,
            object: Mr,
            source: tn,
            light: en,
            string: Wr,
            formatted: function (t) {
                return 0 === Wr(t).length ? [] : Dr(t)
            },
            resolvedImage: function (t) {
                return 0 === Wr(t).length ? [] : Dr(t)
            }
        };

        function nn(t) {
            var e = t.value,
                r = t.valueSpec,
                n = t.styleSpec;
            return r.expression && gr(ht(e)) ? Tr(t) : r.expression && Sr(yt(e)) ? Dr(t) : r.type && rn[r.type] ? rn[r.type](t) : Mr(ct({}, t, {
                valueSpec: r.type ? n[r.type] : r
            }))
        }

        function an(t) {
            var e = t.value,
                r = t.key,
                n = Wr(t);
            return n.length || (-1 === e.indexOf("{fontstack}") && n.push(new lt(r, e, '"glyphs" url must include a "{fontstack}" token')), -1 === e.indexOf("{range}") && n.push(new lt(r, e, '"glyphs" url must include a "{range}" token'))), n
        }

        function on(t, e) {
            void 0 === e && (e = ut);
            var r = [];
            return r = r.concat(nn({
                key: "",
                value: t,
                valueSpec: e.$root,
                styleSpec: e,
                style: t,
                objectElementValidators: {
                    glyphs: an,
                    "*": function () {
                        return []
                    }
                }
            })), t.constants && (r = r.concat(pt({
                key: "constants",
                value: t.constants,
                style: t,
                styleSpec: e
            }))), sn(r)
        }

        function sn(t) {
            return [].concat(t).sort((function (t, e) {
                return t.line - e.line
            }))
        }

        function un(t) {
            return function () {
                for (var e = [], r = arguments.length; r--;) e[r] = arguments[r];
                return sn(t.apply(this, e))
            }
        }
        on.source = un(tn), on.light = un(en), on.layer = un($r), on.filter = un(Hr), on.paintProperty = un(Zr), on.layoutProperty = un(Jr);
        var ln = on,
            pn = ln.light,
            cn = ln.paintProperty,
            hn = ln.layoutProperty;

        function yn(t, e) {
            var r = !1;
            if (e && e.length)
                for (var n = 0, i = e; n < i.length; n += 1) t.fire(new ot(new Error(i[n].message))), r = !0;
            return r
        }
        var fn = dn;

        function dn(t, e, r) {
            var n = this.cells = [];
            if (t instanceof ArrayBuffer) {
                this.arrayBuffer = t;
                var i = new Int32Array(this.arrayBuffer);
                t = i[0], this.d = (e = i[1]) + 2 * (r = i[2]);
                for (var a = 0; a < this.d * this.d; a++) {
                    var o = i[3 + a],
                        s = i[3 + a + 1];
                    n.push(o === s ? null : i.subarray(o, s));
                }
                var u = i[3 + n.length + 1];
                this.keys = i.subarray(i[3 + n.length], u), this.bboxes = i.subarray(u), this.insert = this._insertReadonly;
            } else {
                this.d = e + 2 * r;
                for (var l = 0; l < this.d * this.d; l++) n.push([]);
                this.keys = [], this.bboxes = [];
            }
            this.n = e, this.extent = t, this.padding = r, this.scale = e / t, this.uid = 0;
            var p = r / e * t;
            this.min = -p, this.max = t + p;
        }
        dn.prototype.insert = function (t, e, r, n, i) {
            this._forEachCell(e, r, n, i, this._insertCell, this.uid++), this.keys.push(t), this.bboxes.push(e), this.bboxes.push(r), this.bboxes.push(n), this.bboxes.push(i);
        }, dn.prototype._insertReadonly = function () {
            throw "Cannot insert into a GridIndex created from an ArrayBuffer."
        }, dn.prototype._insertCell = function (t, e, r, n, i, a) {
            this.cells[i].push(a);
        }, dn.prototype.query = function (t, e, r, n, i) {
            var a = this.min,
                o = this.max;
            if (t <= a && e <= a && o <= r && o <= n && !i) return Array.prototype.slice.call(this.keys);
            var s = [];
            return this._forEachCell(t, e, r, n, this._queryCell, s, {}, i), s
        }, dn.prototype._queryCell = function (t, e, r, n, i, a, o, s) {
            var u = this.cells[i];
            if (null !== u)
                for (var l = this.keys, p = this.bboxes, c = 0; c < u.length; c++) {
                    var h = u[c];
                    if (void 0 === o[h]) {
                        var y = 4 * h;
                        (s ? s(p[y + 0], p[y + 1], p[y + 2], p[y + 3]) : t <= p[y + 2] && e <= p[y + 3] && r >= p[y + 0] && n >= p[y + 1]) ? (o[h] = !0, a.push(l[h])) : o[h] = !1;
                    }
                }
        }, dn.prototype._forEachCell = function (t, e, r, n, i, a, o, s) {
            for (var u = this._convertToCellCoord(t), l = this._convertToCellCoord(e), p = this._convertToCellCoord(r), c = this._convertToCellCoord(n), h = u; h <= p; h++)
                for (var y = l; y <= c; y++) {
                    var f = this.d * y + h;
                    if ((!s || s(this._convertFromCellCoord(h), this._convertFromCellCoord(y), this._convertFromCellCoord(h + 1), this._convertFromCellCoord(y + 1))) && i.call(this, t, e, r, n, f, a, o, s)) return
                }
        }, dn.prototype._convertFromCellCoord = function (t) {
            return (t - this.padding) / this.scale
        }, dn.prototype._convertToCellCoord = function (t) {
            return Math.max(0, Math.min(this.d - 1, Math.floor(t * this.scale) + this.padding))
        }, dn.prototype.toArrayBuffer = function () {
            if (this.arrayBuffer) return this.arrayBuffer;
            for (var t = this.cells, e = 3 + this.cells.length + 1 + 1, r = 0, n = 0; n < this.cells.length; n++) r += this.cells[n].length;
            var i = new Int32Array(e + r + this.keys.length + this.bboxes.length);
            i[0] = this.extent, i[1] = this.n, i[2] = this.padding;
            for (var a = e, o = 0; o < t.length; o++) {
                var s = t[o];
                i[3 + o] = a, i.set(s, a), a += s.length;
            }
            return i[3 + t.length] = a, i.set(this.keys, a), i[3 + t.length + 1] = a += this.keys.length, i.set(this.bboxes, a), a += this.bboxes.length, i.buffer
        };
        var mn = self.ImageData,
            gn = self.ImageBitmap,
            vn = {};

        function xn(t, e, r) {
            void 0 === r && (r = {}), Object.defineProperty(e, "_classRegistryKey", {
                value: t,
                writeable: !1
            }), vn[t] = {
                klass: e,
                omit: r.omit || [],
                shallow: r.shallow || []
            };
        }
        for (var bn in xn("Object", Object), fn.serialize = function (t, e) {
                var r = t.toArrayBuffer();
                return e && e.push(r), {
                    buffer: r
                }
            }, fn.deserialize = function (t) {
                return new fn(t.buffer)
            }, xn("Grid", fn), xn("Color", Tt), xn("Error", Error), xn("ResolvedImage", qt), xn("StylePropertyFunction", Cr), xn("StyleExpression", Ar, {
                omit: ["_evaluator"]
            }), xn("ZoomDependentExpression", Br), xn("ZoomConstantExpression", zr), xn("CompoundExpression", Qt, {
                omit: ["_evaluate"]
            }), or) or[bn]._classRegistryKey || xn("Expression_" + bn, or[bn]);

        function _n(t) {
            return t && "undefined" != typeof ArrayBuffer && (t instanceof ArrayBuffer || t.constructor && "ArrayBuffer" === t.constructor.name)
        }

        function wn(t) {
            return gn && t instanceof gn
        }

        function kn(t, e) {
            if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp) return t;
            if (_n(t) || wn(t)) return e && e.push(t), t;
            if (ArrayBuffer.isView(t)) {
                var r = t;
                return e && e.push(r.buffer), r
            }
            if (t instanceof mn) return e && e.push(t.data.buffer), t;
            if (Array.isArray(t)) {
                for (var n = [], i = 0, a = t; i < a.length; i += 1) n.push(kn(a[i], e));
                return n
            }
            if ("object" == typeof t) {
                var o = t.constructor,
                    s = o._classRegistryKey;
                if (!s) throw new Error("can't serialize object of unregistered class");
                var u = o.serialize ? o.serialize(t, e) : {};
                if (!o.serialize) {
                    for (var l in t)
                        if (t.hasOwnProperty(l) && !(vn[s].omit.indexOf(l) >= 0)) {
                            var p = t[l];
                            u[l] = vn[s].shallow.indexOf(l) >= 0 ? p : kn(p, e);
                        } t instanceof Error && (u.message = t.message);
                }
                if (u.$name) throw new Error("$name property is reserved for worker serialization logic.");
                return "Object" !== s && (u.$name = s), u
            }
            throw new Error("can't serialize object of type " + typeof t)
        }

        function An(t) {
            if (null == t || "boolean" == typeof t || "number" == typeof t || "string" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp || _n(t) || wn(t) || ArrayBuffer.isView(t) || t instanceof mn) return t;
            if (Array.isArray(t)) return t.map(An);
            if ("object" == typeof t) {
                var e = t.$name || "Object",
                    r = vn[e].klass;
                if (!r) throw new Error("can't deserialize unregistered class " + e);
                if (r.deserialize) return r.deserialize(t);
                for (var n = Object.create(r.prototype), i = 0, a = Object.keys(t); i < a.length; i += 1) {
                    var o = a[i];
                    if ("$name" !== o) {
                        var s = t[o];
                        n[o] = vn[e].shallow.indexOf(o) >= 0 ? s : An(s);
                    }
                }
                return n
            }
            throw new Error("can't deserialize object of type " + typeof t)
        }
        var Sn = function () {
            this.first = !0;
        };
        Sn.prototype.update = function (t, e) {
            var r = Math.floor(t);
            return this.first ? (this.first = !1, this.lastIntegerZoom = r, this.lastIntegerZoomTime = 0, this.lastZoom = t, this.lastFloorZoom = r, !0) : (this.lastFloorZoom > r ? (this.lastIntegerZoom = r + 1, this.lastIntegerZoomTime = e) : this.lastFloorZoom < r && (this.lastIntegerZoom = r, this.lastIntegerZoomTime = e), t !== this.lastZoom && (this.lastZoom = t, this.lastFloorZoom = r, !0))
        };
        var In = {
            "Latin-1 Supplement": function (t) {
                return t >= 128 && t <= 255
            },
            Arabic: function (t) {
                return t >= 1536 && t <= 1791
            },
            "Arabic Supplement": function (t) {
                return t >= 1872 && t <= 1919
            },
            "Arabic Extended-A": function (t) {
                return t >= 2208 && t <= 2303
            },
            "Hangul Jamo": function (t) {
                return t >= 4352 && t <= 4607
            },
            "Unified Canadian Aboriginal Syllabics": function (t) {
                return t >= 5120 && t <= 5759
            },
            Khmer: function (t) {
                return t >= 6016 && t <= 6143
            },
            "Unified Canadian Aboriginal Syllabics Extended": function (t) {
                return t >= 6320 && t <= 6399
            },
            "General Punctuation": function (t) {
                return t >= 8192 && t <= 8303
            },
            "Letterlike Symbols": function (t) {
                return t >= 8448 && t <= 8527
            },
            "Number Forms": function (t) {
                return t >= 8528 && t <= 8591
            },
            "Miscellaneous Technical": function (t) {
                return t >= 8960 && t <= 9215
            },
            "Control Pictures": function (t) {
                return t >= 9216 && t <= 9279
            },
            "Optical Character Recognition": function (t) {
                return t >= 9280 && t <= 9311
            },
            "Enclosed Alphanumerics": function (t) {
                return t >= 9312 && t <= 9471
            },
            "Geometric Shapes": function (t) {
                return t >= 9632 && t <= 9727
            },
            "Miscellaneous Symbols": function (t) {
                return t >= 9728 && t <= 9983
            },
            "Miscellaneous Symbols and Arrows": function (t) {
                return t >= 11008 && t <= 11263
            },
            "CJK Radicals Supplement": function (t) {
                return t >= 11904 && t <= 12031
            },
            "Kangxi Radicals": function (t) {
                return t >= 12032 && t <= 12255
            },
            "Ideographic Description Characters": function (t) {
                return t >= 12272 && t <= 12287
            },
            "CJK Symbols and Punctuation": function (t) {
                return t >= 12288 && t <= 12351
            },
            Hiragana: function (t) {
                return t >= 12352 && t <= 12447
            },
            Katakana: function (t) {
                return t >= 12448 && t <= 12543
            },
            Bopomofo: function (t) {
                return t >= 12544 && t <= 12591
            },
            "Hangul Compatibility Jamo": function (t) {
                return t >= 12592 && t <= 12687
            },
            Kanbun: function (t) {
                return t >= 12688 && t <= 12703
            },
            "Bopomofo Extended": function (t) {
                return t >= 12704 && t <= 12735
            },
            "CJK Strokes": function (t) {
                return t >= 12736 && t <= 12783
            },
            "Katakana Phonetic Extensions": function (t) {
                return t >= 12784 && t <= 12799
            },
            "Enclosed CJK Letters and Months": function (t) {
                return t >= 12800 && t <= 13055
            },
            "CJK Compatibility": function (t) {
                return t >= 13056 && t <= 13311
            },
            "CJK Unified Ideographs Extension A": function (t) {
                return t >= 13312 && t <= 19903
            },
            "Yijing Hexagram Symbols": function (t) {
                return t >= 19904 && t <= 19967
            },
            "CJK Unified Ideographs": function (t) {
                return t >= 19968 && t <= 40959
            },
            "Yi Syllables": function (t) {
                return t >= 40960 && t <= 42127
            },
            "Yi Radicals": function (t) {
                return t >= 42128 && t <= 42191
            },
            "Hangul Jamo Extended-A": function (t) {
                return t >= 43360 && t <= 43391
            },
            "Hangul Syllables": function (t) {
                return t >= 44032 && t <= 55215
            },
            "Hangul Jamo Extended-B": function (t) {
                return t >= 55216 && t <= 55295
            },
            "Private Use Area": function (t) {
                return t >= 57344 && t <= 63743
            },
            "CJK Compatibility Ideographs": function (t) {
                return t >= 63744 && t <= 64255
            },
            "Arabic Presentation Forms-A": function (t) {
                return t >= 64336 && t <= 65023
            },
            "Vertical Forms": function (t) {
                return t >= 65040 && t <= 65055
            },
            "CJK Compatibility Forms": function (t) {
                return t >= 65072 && t <= 65103
            },
            "Small Form Variants": function (t) {
                return t >= 65104 && t <= 65135
            },
            "Arabic Presentation Forms-B": function (t) {
                return t >= 65136 && t <= 65279
            },
            "Halfwidth and Fullwidth Forms": function (t) {
                return t >= 65280 && t <= 65519
            }
        };

        function zn(t) {
            for (var e = 0, r = t; e < r.length; e += 1)
                if (Bn(r[e].charCodeAt(0))) return !0;
            return !1
        }

        function Bn(t) {
            return !(746 !== t && 747 !== t && (t < 4352 || !(In["Bopomofo Extended"](t) || In.Bopomofo(t) || In["CJK Compatibility Forms"](t) && !(t >= 65097 && t <= 65103) || In["CJK Compatibility Ideographs"](t) || In["CJK Compatibility"](t) || In["CJK Radicals Supplement"](t) || In["CJK Strokes"](t) || !(!In["CJK Symbols and Punctuation"](t) || t >= 12296 && t <= 12305 || t >= 12308 && t <= 12319 || 12336 === t) || In["CJK Unified Ideographs Extension A"](t) || In["CJK Unified Ideographs"](t) || In["Enclosed CJK Letters and Months"](t) || In["Hangul Compatibility Jamo"](t) || In["Hangul Jamo Extended-A"](t) || In["Hangul Jamo Extended-B"](t) || In["Hangul Jamo"](t) || In["Hangul Syllables"](t) || In.Hiragana(t) || In["Ideographic Description Characters"](t) || In.Kanbun(t) || In["Kangxi Radicals"](t) || In["Katakana Phonetic Extensions"](t) || In.Katakana(t) && 12540 !== t || !(!In["Halfwidth and Fullwidth Forms"](t) || 65288 === t || 65289 === t || 65293 === t || t >= 65306 && t <= 65310 || 65339 === t || 65341 === t || 65343 === t || t >= 65371 && t <= 65503 || 65507 === t || t >= 65512 && t <= 65519) || !(!In["Small Form Variants"](t) || t >= 65112 && t <= 65118 || t >= 65123 && t <= 65126) || In["Unified Canadian Aboriginal Syllabics"](t) || In["Unified Canadian Aboriginal Syllabics Extended"](t) || In["Vertical Forms"](t) || In["Yijing Hexagram Symbols"](t) || In["Yi Syllables"](t) || In["Yi Radicals"](t))))
        }

        function Vn(t) {
            return !(Bn(t) || function (t) {
                return !!(In["Latin-1 Supplement"](t) && (167 === t || 169 === t || 174 === t || 177 === t || 188 === t || 189 === t || 190 === t || 215 === t || 247 === t) || In["General Punctuation"](t) && (8214 === t || 8224 === t || 8225 === t || 8240 === t || 8241 === t || 8251 === t || 8252 === t || 8258 === t || 8263 === t || 8264 === t || 8265 === t || 8273 === t) || In["Letterlike Symbols"](t) || In["Number Forms"](t) || In["Miscellaneous Technical"](t) && (t >= 8960 && t <= 8967 || t >= 8972 && t <= 8991 || t >= 8996 && t <= 9e3 || 9003 === t || t >= 9085 && t <= 9114 || t >= 9150 && t <= 9165 || 9167 === t || t >= 9169 && t <= 9179 || t >= 9186 && t <= 9215) || In["Control Pictures"](t) && 9251 !== t || In["Optical Character Recognition"](t) || In["Enclosed Alphanumerics"](t) || In["Geometric Shapes"](t) || In["Miscellaneous Symbols"](t) && !(t >= 9754 && t <= 9759) || In["Miscellaneous Symbols and Arrows"](t) && (t >= 11026 && t <= 11055 || t >= 11088 && t <= 11097 || t >= 11192 && t <= 11243) || In["CJK Symbols and Punctuation"](t) || In.Katakana(t) || In["Private Use Area"](t) || In["CJK Compatibility Forms"](t) || In["Small Form Variants"](t) || In["Halfwidth and Fullwidth Forms"](t) || 8734 === t || 8756 === t || 8757 === t || t >= 9984 && t <= 10087 || t >= 10102 && t <= 10131 || 65532 === t || 65533 === t)
            }(t))
        }

        function Cn(t) {
            return t >= 1424 && t <= 2303 || In["Arabic Presentation Forms-A"](t) || In["Arabic Presentation Forms-B"](t)
        }

        function Mn(t, e) {
            return !(!e && Cn(t) || t >= 2304 && t <= 3583 || t >= 3840 && t <= 4255 || In.Khmer(t))
        }

        function Pn(t) {
            for (var e = 0, r = t; e < r.length; e += 1)
                if (Cn(r[e].charCodeAt(0))) return !0;
            return !1
        }
        var Ln = null,
            Tn = "unavailable",
            Dn = null,
            En = function (t) {
                t && "string" == typeof t && t.indexOf("NetworkError") > -1 && (Tn = "error"), Ln && Ln(t);
            };

        function Fn() {
            qn.fire(new at("pluginStateChange", {
                pluginStatus: Tn,
                pluginURL: Dn
            }));
        }
        var qn = new st,
            On = function () {
                return Tn
            },
            Un = function () {
                if ("deferred" !== Tn || !Dn) throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");
                Tn = "loading", Fn(), Dn && et({
                    url: Dn
                }, (function (t) {
                    t ? En(t) : (Tn = "loaded", Fn());
                }));
            },
            Rn = {
                applyArabicShaping: null,
                processBidirectionalText: null,
                processStyledBidirectionalText: null,
                isLoaded: function () {
                    return "loaded" === Tn || null != Rn.applyArabicShaping
                },
                isLoading: function () {
                    return "loading" === Tn
                },
                setState: function (t) {
                    Tn = t.pluginStatus, Dn = t.pluginURL;
                },
                isParsed: function () {
                    return null != Rn.applyArabicShaping && null != Rn.processBidirectionalText && null != Rn.processStyledBidirectionalText
                },
                getPluginURL: function () {
                    return Dn
                }
            },
            jn = function (t, e) {
                this.zoom = t, e ? (this.now = e.now, this.fadeDuration = e.fadeDuration, this.zoomHistory = e.zoomHistory, this.transition = e.transition) : (this.now = 0, this.fadeDuration = 0, this.zoomHistory = new Sn, this.transition = {});
            };
        jn.prototype.isSupportedScript = function (t) {
            return function (t, e) {
                for (var r = 0, n = t; r < n.length; r += 1)
                    if (!Mn(n[r].charCodeAt(0), e)) return !1;
                return !0
            }(t, Rn.isLoaded())
        }, jn.prototype.crossFadingFactor = function () {
            return 0 === this.fadeDuration ? 1 : Math.min((this.now - this.zoomHistory.lastIntegerZoomTime) / this.fadeDuration, 1)
        }, jn.prototype.getCrossfadeParameters = function () {
            var t = this.zoom,
                e = t - Math.floor(t),
                r = this.crossFadingFactor();
            return t > this.zoomHistory.lastIntegerZoom ? {
                fromScale: 2,
                toScale: 1,
                t: e + (1 - e) * r
            } : {
                fromScale: .5,
                toScale: 1,
                t: 1 - (1 - r) * e
            }
        };
        var Nn = function (t, e) {
            this.property = t, this.value = e, this.expression = function (t, e) {
                if (gr(t)) return new Cr(t, e);
                if (Sr(t)) {
                    var r = Vr(t, e);
                    if ("error" === r.result) throw new Error(r.value.map((function (t) {
                        return t.key + ": " + t.message
                    })).join(", "));
                    return r.value
                }
                var n = t;
                return "string" == typeof t && "color" === e.type && (n = Tt.parse(t)), {
                    kind: "constant",
                    evaluate: function () {
                        return n
                    }
                }
            }(void 0 === e ? t.specification.default : e, t.specification);
        };
        Nn.prototype.isDataDriven = function () {
            return "source" === this.expression.kind || "composite" === this.expression.kind
        }, Nn.prototype.possiblyEvaluate = function (t, e, r) {
            return this.property.possiblyEvaluate(this, t, e, r)
        };
        var Kn = function (t) {
            this.property = t, this.value = new Nn(t, void 0);
        };
        Kn.prototype.transitioned = function (t, e) {
            return new Gn(this.property, this.value, e, p({}, t.transition, this.transition), t.now)
        }, Kn.prototype.untransitioned = function () {
            return new Gn(this.property, this.value, null, {}, 0)
        };
        var Xn = function (t) {
            this._properties = t, this._values = Object.create(t.defaultTransitionablePropertyValues);
        };
        Xn.prototype.getValue = function (t) {
            return g(this._values[t].value.value)
        }, Xn.prototype.setValue = function (t, e) {
            this._values.hasOwnProperty(t) || (this._values[t] = new Kn(this._values[t].property)), this._values[t].value = new Nn(this._values[t].property, null === e ? void 0 : g(e));
        }, Xn.prototype.getTransition = function (t) {
            return g(this._values[t].transition)
        }, Xn.prototype.setTransition = function (t, e) {
            this._values.hasOwnProperty(t) || (this._values[t] = new Kn(this._values[t].property)), this._values[t].transition = g(e) || void 0;
        }, Xn.prototype.serialize = function () {
            for (var t = {}, e = 0, r = Object.keys(this._values); e < r.length; e += 1) {
                var n = r[e],
                    i = this.getValue(n);
                void 0 !== i && (t[n] = i);
                var a = this.getTransition(n);
                void 0 !== a && (t[n + "-transition"] = a);
            }
            return t
        }, Xn.prototype.transitioned = function (t, e) {
            for (var r = new Hn(this._properties), n = 0, i = Object.keys(this._values); n < i.length; n += 1) {
                var a = i[n];
                r._values[a] = this._values[a].transitioned(t, e._values[a]);
            }
            return r
        }, Xn.prototype.untransitioned = function () {
            for (var t = new Hn(this._properties), e = 0, r = Object.keys(this._values); e < r.length; e += 1) {
                var n = r[e];
                t._values[n] = this._values[n].untransitioned();
            }
            return t
        };
        var Gn = function (t, e, r, n, i) {
            this.property = t, this.value = e, this.begin = i + n.delay || 0, this.end = this.begin + n.duration || 0, t.specification.transition && (n.delay || n.duration) && (this.prior = r);
        };
        Gn.prototype.possiblyEvaluate = function (t, e, r) {
            var n = t.now || 0,
                i = this.value.possiblyEvaluate(t, e, r),
                a = this.prior;
            if (a) {
                if (n > this.end) return this.prior = null, i;
                if (this.value.isDataDriven()) return this.prior = null, i;
                if (n < this.begin) return a.possiblyEvaluate(t, e, r);
                var o = (n - this.begin) / (this.end - this.begin);
                return this.property.interpolate(a.possiblyEvaluate(t, e, r), i, function (t) {
                    if (t <= 0) return 0;
                    if (t >= 1) return 1;
                    var e = t * t,
                        r = e * t;
                    return 4 * (t < .5 ? r : 3 * (t - e) + r - .75)
                }(o))
            }
            return i
        };
        var Hn = function (t) {
            this._properties = t, this._values = Object.create(t.defaultTransitioningPropertyValues);
        };
        Hn.prototype.possiblyEvaluate = function (t, e) {
            for (var r = new Jn(this._properties), n = 0, i = Object.keys(this._values); n < i.length; n += 1) {
                var a = i[n];
                r._values[a] = this._values[a].possiblyEvaluate(t, e);
            }
            return r
        }, Hn.prototype.hasTransition = function () {
            for (var t = 0, e = Object.keys(this._values); t < e.length; t += 1)
                if (this._values[e[t]].prior) return !0;
            return !1
        };
        var Yn = function (t) {
            this._properties = t, this._values = Object.create(t.defaultPropertyValues);
        };
        Yn.prototype.getValue = function (t) {
            return g(this._values[t].value)
        }, Yn.prototype.setValue = function (t, e) {
            this._values[t] = new Nn(this._values[t].property, null === e ? void 0 : g(e));
        }, Yn.prototype.serialize = function () {
            for (var t = {}, e = 0, r = Object.keys(this._values); e < r.length; e += 1) {
                var n = r[e],
                    i = this.getValue(n);
                void 0 !== i && (t[n] = i);
            }
            return t
        }, Yn.prototype.possiblyEvaluate = function (t, e) {
            for (var r = new Jn(this._properties), n = 0, i = Object.keys(this._values); n < i.length; n += 1) {
                var a = i[n];
                r._values[a] = this._values[a].possiblyEvaluate(t, e);
            }
            return r
        };
        var Zn = function (t, e, r) {
            this.property = t, this.value = e, this.parameters = r;
        };
        Zn.prototype.isConstant = function () {
            return "constant" === this.value.kind
        }, Zn.prototype.constantOr = function (t) {
            return "constant" === this.value.kind ? this.value.value : t
        }, Zn.prototype.evaluate = function (t, e, r, n) {
            return this.property.evaluate(this.value, this.parameters, t, e, r, n)
        };
        var Jn = function (t) {
            this._properties = t, this._values = Object.create(t.defaultPossiblyEvaluatedValues);
        };
        Jn.prototype.get = function (t) {
            return this._values[t]
        };
        var $n = function (t) {
            this.specification = t;
        };
        $n.prototype.possiblyEvaluate = function (t, e) {
            return t.expression.evaluate(e)
        }, $n.prototype.interpolate = function (t, e, r) {
            var n = Se[this.specification.type];
            return n ? n(t, e, r) : t
        };
        var Wn = function (t, e) {
            this.specification = t, this.overrides = e;
        };
        Wn.prototype.possiblyEvaluate = function (t, e, r, n) {
            return new Zn(this, "constant" === t.expression.kind || "camera" === t.expression.kind ? {
                kind: "constant",
                value: t.expression.evaluate(e, null, {}, r, n)
            } : t.expression, e)
        }, Wn.prototype.interpolate = function (t, e, r) {
            if ("constant" !== t.value.kind || "constant" !== e.value.kind) return t;
            if (void 0 === t.value.value || void 0 === e.value.value) return new Zn(this, {
                kind: "constant",
                value: void 0
            }, t.parameters);
            var n = Se[this.specification.type];
            return n ? new Zn(this, {
                kind: "constant",
                value: n(t.value.value, e.value.value, r)
            }, t.parameters) : t
        }, Wn.prototype.evaluate = function (t, e, r, n, i, a) {
            return "constant" === t.kind ? t.value : t.evaluate(e, r, n, i, a)
        };
        var Qn = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.possiblyEvaluate = function (t, e, r, n) {
                    if (void 0 === t.value) return new Zn(this, {
                        kind: "constant",
                        value: void 0
                    }, e);
                    if ("constant" === t.expression.kind) {
                        var i = t.expression.evaluate(e, null, {}, r, n),
                            a = "resolvedImage" === t.property.specification.type && "string" != typeof i ? i.name : i,
                            o = this._calculate(a, a, a, e);
                        return new Zn(this, {
                            kind: "constant",
                            value: o
                        }, e)
                    }
                    if ("camera" === t.expression.kind) {
                        var s = this._calculate(t.expression.evaluate({
                            zoom: e.zoom - 1
                        }), t.expression.evaluate({
                            zoom: e.zoom
                        }), t.expression.evaluate({
                            zoom: e.zoom + 1
                        }), e);
                        return new Zn(this, {
                            kind: "constant",
                            value: s
                        }, e)
                    }
                    return new Zn(this, t.expression, e)
                }, e.prototype.evaluate = function (t, e, r, n, i, a) {
                    if ("source" === t.kind) {
                        var o = t.evaluate(e, r, n, i, a);
                        return this._calculate(o, o, o, e)
                    }
                    return "composite" === t.kind ? this._calculate(t.evaluate({
                        zoom: Math.floor(e.zoom) - 1
                    }, r, n), t.evaluate({
                        zoom: Math.floor(e.zoom)
                    }, r, n), t.evaluate({
                        zoom: Math.floor(e.zoom) + 1
                    }, r, n), e) : t.value
                }, e.prototype._calculate = function (t, e, r, n) {
                    return n.zoom > n.zoomHistory.lastIntegerZoom ? {
                        from: t,
                        to: e
                    } : {
                        from: r,
                        to: e
                    }
                }, e.prototype.interpolate = function (t) {
                    return t
                }, e
            }(Wn),
            ti = function (t) {
                this.specification = t;
            };
        ti.prototype.possiblyEvaluate = function (t, e, r, n) {
            if (void 0 !== t.value) {
                if ("constant" === t.expression.kind) {
                    var i = t.expression.evaluate(e, null, {}, r, n);
                    return this._calculate(i, i, i, e)
                }
                return this._calculate(t.expression.evaluate(new jn(Math.floor(e.zoom - 1), e)), t.expression.evaluate(new jn(Math.floor(e.zoom), e)), t.expression.evaluate(new jn(Math.floor(e.zoom + 1), e)), e)
            }
        }, ti.prototype._calculate = function (t, e, r, n) {
            return n.zoom > n.zoomHistory.lastIntegerZoom ? {
                from: t,
                to: e
            } : {
                from: r,
                to: e
            }
        }, ti.prototype.interpolate = function (t) {
            return t
        };
        var ei = function (t) {
            this.specification = t;
        };
        ei.prototype.possiblyEvaluate = function (t, e, r, n) {
            return !!t.expression.evaluate(e, null, {}, r, n)
        }, ei.prototype.interpolate = function () {
            return !1
        };
        var ri = function (t) {
            for (var e in this.properties = t, this.defaultPropertyValues = {}, this.defaultTransitionablePropertyValues = {}, this.defaultTransitioningPropertyValues = {}, this.defaultPossiblyEvaluatedValues = {}, this.overridableProperties = [], t) {
                var r = t[e];
                r.specification.overridable && this.overridableProperties.push(e);
                var n = this.defaultPropertyValues[e] = new Nn(r, void 0),
                    i = this.defaultTransitionablePropertyValues[e] = new Kn(r);
                this.defaultTransitioningPropertyValues[e] = i.untransitioned(), this.defaultPossiblyEvaluatedValues[e] = n.possiblyEvaluate({});
            }
        };
        xn("DataDrivenProperty", Wn), xn("DataConstantProperty", $n), xn("CrossFadedDataDrivenProperty", Qn), xn("CrossFadedProperty", ti), xn("ColorRampProperty", ei);
        var ni = function (t) {
                function e(e, r) {
                    if (t.call(this), this.id = e.id, this.type = e.type, this._featureFilter = {
                            filter: function () {
                                return !0
                            },
                            needGeometry: !1
                        }, "custom" !== e.type && (this.metadata = (e = e).metadata, this.minzoom = e.minzoom, this.maxzoom = e.maxzoom, "background" !== e.type && (this.source = e.source, this.sourceLayer = e["source-layer"], this.filter = e.filter), r.layout && (this._unevaluatedLayout = new Yn(r.layout)), r.paint)) {
                        for (var n in this._transitionablePaint = new Xn(r.paint), e.paint) this.setPaintProperty(n, e.paint[n], {
                            validate: !1
                        });
                        for (var i in e.layout) this.setLayoutProperty(i, e.layout[i], {
                            validate: !1
                        });
                        this._transitioningPaint = this._transitionablePaint.untransitioned();
                    }
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getCrossfadeParameters = function () {
                    return this._crossfadeParameters
                }, e.prototype.getLayoutProperty = function (t) {
                    return "visibility" === t ? this.visibility : this._unevaluatedLayout.getValue(t)
                }, e.prototype.setLayoutProperty = function (t, e, r) {
                    void 0 === r && (r = {}), null != e && this._validate(hn, "layers." + this.id + ".layout." + t, t, e, r) || ("visibility" !== t ? this._unevaluatedLayout.setValue(t, e) : this.visibility = e);
                }, e.prototype.getPaintProperty = function (t) {
                    return f(t, "-transition") ? this._transitionablePaint.getTransition(t.slice(0, -"-transition".length)) : this._transitionablePaint.getValue(t)
                }, e.prototype.setPaintProperty = function (t, e, r) {
                    if (void 0 === r && (r = {}), null != e && this._validate(cn, "layers." + this.id + ".paint." + t, t, e, r)) return !1;
                    if (f(t, "-transition")) return this._transitionablePaint.setTransition(t.slice(0, -"-transition".length), e || void 0), !1;
                    var n = this._transitionablePaint._values[t],
                        i = "cross-faded-data-driven" === n.property.specification["property-type"],
                        a = n.value.isDataDriven(),
                        o = n.value;
                    this._transitionablePaint.setValue(t, e), this._handleSpecialPaintPropertyUpdate(t);
                    var s = this._transitionablePaint._values[t].value;
                    return s.isDataDriven() || a || i || this._handleOverridablePaintPropertyUpdate(t, o, s)
                }, e.prototype._handleSpecialPaintPropertyUpdate = function (t) {}, e.prototype._handleOverridablePaintPropertyUpdate = function (t, e, r) {
                    return !1
                }, e.prototype.isHidden = function (t) {
                    return !!(this.minzoom && t < this.minzoom) || !!(this.maxzoom && t >= this.maxzoom) || "none" === this.visibility
                }, e.prototype.updateTransitions = function (t) {
                    this._transitioningPaint = this._transitionablePaint.transitioned(t, this._transitioningPaint);
                }, e.prototype.hasTransition = function () {
                    return this._transitioningPaint.hasTransition()
                }, e.prototype.recalculate = function (t, e) {
                    t.getCrossfadeParameters && (this._crossfadeParameters = t.getCrossfadeParameters()), this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(t, e)), this.paint = this._transitioningPaint.possiblyEvaluate(t, e);
                }, e.prototype.serialize = function () {
                    var t = {
                        id: this.id,
                        type: this.type,
                        source: this.source,
                        "source-layer": this.sourceLayer,
                        metadata: this.metadata,
                        minzoom: this.minzoom,
                        maxzoom: this.maxzoom,
                        filter: this.filter,
                        layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(),
                        paint: this._transitionablePaint && this._transitionablePaint.serialize(),
                        _originalStyle: this._originalStyle
                    };
                    return this.visibility && (t.layout = t.layout || {}, t.layout.visibility = this.visibility), m(t, (function (t, e) {
                        return !(void 0 === t || "layout" === e && !Object.keys(t).length || "paint" === e && !Object.keys(t).length)
                    }))
                }, e.prototype._validate = function (t, e, r, n, i) {
                    return void 0 === i && (i = {}), (!i || !1 !== i.validate) && yn(this, t.call(ln, {
                        key: e,
                        layerType: this.type,
                        objectKey: r,
                        value: n,
                        styleSpec: ut,
                        style: {
                            glyphs: !0,
                            sprite: !0
                        }
                    }))
                }, e.prototype.is3D = function () {
                    return !1
                }, e.prototype.isTileClipped = function () {
                    return !1
                }, e.prototype.hasOffscreenPass = function () {
                    return !1
                }, e.prototype.resize = function () {}, e.prototype.isStateDependent = function () {
                    for (var t in this.paint._values) {
                        var e = this.paint.get(t);
                        if (e instanceof Zn && yr(e.property.specification) && ("source" === e.value.kind || "composite" === e.value.kind) && e.value.isStateDependent) return !0
                    }
                    return !1
                }, e
            }(st),
            ii = {
                Int8: Int8Array,
                Uint8: Uint8Array,
                Int16: Int16Array,
                Uint16: Uint16Array,
                Int32: Int32Array,
                Uint32: Uint32Array,
                Float32: Float32Array
            },
            ai = function (t, e) {
                this._structArray = t, this._pos1 = e * this.size, this._pos2 = this._pos1 / 2, this._pos4 = this._pos1 / 4, this._pos8 = this._pos1 / 8;
            },
            oi = function () {
                this.isTransferred = !1, this.capacity = -1, this.resize(0);
            };

        function si(t, e) {
            void 0 === e && (e = 1);
            var r = 0,
                n = 0;
            return {
                members: t.map((function (t) {
                    var i = ii[t.type].BYTES_PER_ELEMENT,
                        a = r = ui(r, Math.max(e, i)),
                        o = t.components || 1;
                    return n = Math.max(n, i), r += i * o, {
                        name: t.name,
                        type: t.type,
                        components: o,
                        offset: a
                    }
                })),
                size: ui(r, Math.max(n, e)),
                alignment: e
            }
        }

        function ui(t, e) {
            return Math.ceil(t / e) * e
        }
        oi.serialize = function (t, e) {
            return t._trim(), e && (t.isTransferred = !0, e.push(t.arrayBuffer)), {
                length: t.length,
                arrayBuffer: t.arrayBuffer
            }
        }, oi.deserialize = function (t) {
            var e = Object.create(this.prototype);
            return e.arrayBuffer = t.arrayBuffer, e.length = t.length, e.capacity = t.arrayBuffer.byteLength / e.bytesPerElement, e._refreshViews(), e
        }, oi.prototype._trim = function () {
            this.length !== this.capacity && (this.capacity = this.length, this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement), this._refreshViews());
        }, oi.prototype.clear = function () {
            this.length = 0;
        }, oi.prototype.resize = function (t) {
            this.reserve(t), this.length = t;
        }, oi.prototype.reserve = function (t) {
            if (t > this.capacity) {
                this.capacity = Math.max(t, Math.floor(5 * this.capacity), 128), this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);
                var e = this.uint8;
                this._refreshViews(), e && this.uint8.set(e);
            }
        }, oi.prototype._refreshViews = function () {
            throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")
        };
        var li = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e) {
                var r = this.length;
                return this.resize(r + 1), this.emplace(r, t, e)
            }, e.prototype.emplace = function (t, e, r) {
                var n = 2 * t;
                return this.int16[n + 0] = e, this.int16[n + 1] = r, t
            }, e
        }(oi);
        li.prototype.bytesPerElement = 4, xn("StructArrayLayout2i4", li);
        var pi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n) {
                var i = this.length;
                return this.resize(i + 1), this.emplace(i, t, e, r, n)
            }, e.prototype.emplace = function (t, e, r, n, i) {
                var a = 4 * t;
                return this.int16[a + 0] = e, this.int16[a + 1] = r, this.int16[a + 2] = n, this.int16[a + 3] = i, t
            }, e
        }(oi);
        pi.prototype.bytesPerElement = 8, xn("StructArrayLayout4i8", pi);
        var ci = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a) {
                var o = this.length;
                return this.resize(o + 1), this.emplace(o, t, e, r, n, i, a)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o) {
                var s = 6 * t;
                return this.int16[s + 0] = e, this.int16[s + 1] = r, this.int16[s + 2] = n, this.int16[s + 3] = i, this.int16[s + 4] = a, this.int16[s + 5] = o, t
            }, e
        }(oi);
        ci.prototype.bytesPerElement = 12, xn("StructArrayLayout2i4i12", ci);
        var hi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a) {
                var o = this.length;
                return this.resize(o + 1), this.emplace(o, t, e, r, n, i, a)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o) {
                var s = 4 * t,
                    u = 8 * t;
                return this.int16[s + 0] = e, this.int16[s + 1] = r, this.uint8[u + 4] = n, this.uint8[u + 5] = i, this.uint8[u + 6] = a, this.uint8[u + 7] = o, t
            }, e
        }(oi);
        hi.prototype.bytesPerElement = 8, xn("StructArrayLayout2i4ub8", hi);
        var yi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u, l) {
                var p = this.length;
                return this.resize(p + 1), this.emplace(p, t, e, r, n, i, a, o, s, u, l)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l, p) {
                var c = 9 * t,
                    h = 18 * t;
                return this.uint16[c + 0] = e, this.uint16[c + 1] = r, this.uint16[c + 2] = n, this.uint16[c + 3] = i, this.uint16[c + 4] = a, this.uint16[c + 5] = o, this.uint16[c + 6] = s, this.uint16[c + 7] = u, this.uint8[h + 16] = l, this.uint8[h + 17] = p, t
            }, e
        }(oi);
        yi.prototype.bytesPerElement = 18, xn("StructArrayLayout8ui2ub18", yi);
        var fi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u) {
                var l = this.length;
                return this.resize(l + 1), this.emplace(l, t, e, r, n, i, a, o, s, u)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l) {
                var p = 8 * t,
                    c = 16 * t,
                    h = 4 * t;
                return this.int16[p + 0] = e, this.int16[p + 1] = r, this.uint8[c + 4] = n, this.uint8[c + 5] = i, this.uint8[c + 6] = a, this.uint8[c + 7] = o, this.float32[h + 2] = s, this.uint16[p + 6] = u, this.uint16[p + 7] = l, t
            }, e
        }(oi);
        fi.prototype.bytesPerElement = 16, xn("StructArrayLayout2i4ub1f2ui16", fi);
        var di = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u) {
                var l = this.length;
                return this.resize(l + 1), this.emplace(l, t, e, r, n, i, a, o, s, u)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l) {
                var p = 8 * t,
                    c = 16 * t;
                return this.int16[p + 0] = e, this.int16[p + 1] = r, this.uint8[c + 4] = n, this.uint8[c + 5] = i, this.uint8[c + 6] = a, this.uint8[c + 7] = o, this.uint16[p + 4] = s, this.uint16[p + 6] = u, this.uint16[p + 7] = l, t
            }, e
        }(oi);
        di.prototype.bytesPerElement = 16, xn("StructArrayLayout2i4ub1ui2ui16", di);
        var mi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u, l, p) {
                var c = this.length;
                return this.resize(c + 1), this.emplace(c, t, e, r, n, i, a, o, s, u, l, p)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l, p, c) {
                var h = 8 * t,
                    y = 16 * t;
                return this.int16[h + 0] = e, this.int16[h + 1] = r, this.uint8[y + 4] = n, this.uint8[y + 5] = i, this.uint8[y + 6] = a, this.uint8[y + 7] = o, this.uint8[y + 8] = s, this.uint8[y + 9] = u, this.uint8[y + 10] = l, this.uint16[h + 6] = p, this.uint16[h + 7] = c, t
            }, e
        }(oi);
        mi.prototype.bytesPerElement = 16, xn("StructArrayLayout2i4ub3ub2ui16", mi);
        var gi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o) {
                var s = this.length;
                return this.resize(s + 1), this.emplace(s, t, e, r, n, i, a, o)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s) {
                var u = 6 * t,
                    l = 12 * t;
                return this.int16[u + 0] = e, this.int16[u + 1] = r, this.uint8[l + 4] = n, this.uint8[l + 5] = i, this.uint8[l + 6] = a, this.uint8[l + 7] = o, this.uint16[u + 4] = s, t
            }, e
        }(oi);
        gi.prototype.bytesPerElement = 12, xn("StructArrayLayout2i4ub1ui12", gi);
        var vi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u, l, p, c) {
                var h = this.length;
                return this.resize(h + 1), this.emplace(h, t, e, r, n, i, a, o, s, u, l, p, c)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l, p, c, h) {
                var y = 12 * t;
                return this.int16[y + 0] = e, this.int16[y + 1] = r, this.int16[y + 2] = n, this.int16[y + 3] = i, this.uint16[y + 4] = a, this.uint16[y + 5] = o, this.uint16[y + 6] = s, this.uint16[y + 7] = u, this.int16[y + 8] = l, this.int16[y + 9] = p, this.int16[y + 10] = c, this.int16[y + 11] = h, t
            }, e
        }(oi);
        vi.prototype.bytesPerElement = 24, xn("StructArrayLayout4i4ui4i24", vi);
        var xi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r) {
                var n = this.length;
                return this.resize(n + 1), this.emplace(n, t, e, r)
            }, e.prototype.emplace = function (t, e, r, n) {
                var i = 3 * t;
                return this.float32[i + 0] = e, this.float32[i + 1] = r, this.float32[i + 2] = n, t
            }, e
        }(oi);
        xi.prototype.bytesPerElement = 12, xn("StructArrayLayout3f12", xi);
        var bi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t) {
                var e = this.length;
                return this.resize(e + 1), this.emplace(e, t)
            }, e.prototype.emplace = function (t, e) {
                return this.uint32[1 * t + 0] = e, t
            }, e
        }(oi);
        bi.prototype.bytesPerElement = 4, xn("StructArrayLayout1ul4", bi);
        var _i = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u) {
                var l = this.length;
                return this.resize(l + 1), this.emplace(l, t, e, r, n, i, a, o, s, u)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l) {
                var p = 10 * t,
                    c = 5 * t;
                return this.int16[p + 0] = e, this.int16[p + 1] = r, this.int16[p + 2] = n, this.int16[p + 3] = i, this.int16[p + 4] = a, this.int16[p + 5] = o, this.uint32[c + 3] = s, this.uint16[p + 8] = u, this.uint16[p + 9] = l, t
            }, e
        }(oi);
        _i.prototype.bytesPerElement = 20, xn("StructArrayLayout6i1ul2ui20", _i);
        var wi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a) {
                var o = this.length;
                return this.resize(o + 1), this.emplace(o, t, e, r, n, i, a)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o) {
                var s = 6 * t;
                return this.int16[s + 0] = e, this.int16[s + 1] = r, this.int16[s + 2] = n, this.int16[s + 3] = i, this.int16[s + 4] = a, this.int16[s + 5] = o, t
            }, e
        }(oi);
        wi.prototype.bytesPerElement = 12, xn("StructArrayLayout2i2i2i12", wi);
        var ki = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i) {
                var a = this.length;
                return this.resize(a + 1), this.emplace(a, t, e, r, n, i)
            }, e.prototype.emplace = function (t, e, r, n, i, a) {
                var o = 4 * t,
                    s = 8 * t;
                return this.float32[o + 0] = e, this.float32[o + 1] = r, this.float32[o + 2] = n, this.int16[s + 6] = i, this.int16[s + 7] = a, t
            }, e
        }(oi);
        ki.prototype.bytesPerElement = 16, xn("StructArrayLayout2f1f2i16", ki);
        var Ai = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n) {
                var i = this.length;
                return this.resize(i + 1), this.emplace(i, t, e, r, n)
            }, e.prototype.emplace = function (t, e, r, n, i) {
                var a = 12 * t,
                    o = 3 * t;
                return this.uint8[a + 0] = e, this.uint8[a + 1] = r, this.float32[o + 1] = n, this.float32[o + 2] = i, t
            }, e
        }(oi);
        Ai.prototype.bytesPerElement = 12, xn("StructArrayLayout2ub2f12", Ai);
        var Si = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r) {
                var n = this.length;
                return this.resize(n + 1), this.emplace(n, t, e, r)
            }, e.prototype.emplace = function (t, e, r, n) {
                var i = 3 * t;
                return this.uint16[i + 0] = e, this.uint16[i + 1] = r, this.uint16[i + 2] = n, t
            }, e
        }(oi);
        Si.prototype.bytesPerElement = 6, xn("StructArrayLayout3ui6", Si);
        var Ii = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d, m) {
                var g = this.length;
                return this.resize(g + 1), this.emplace(g, t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d, m)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d, m, g) {
                var v = 24 * t,
                    x = 12 * t,
                    b = 48 * t;
                return this.int16[v + 0] = e, this.int16[v + 1] = r, this.uint16[v + 2] = n, this.uint16[v + 3] = i, this.uint32[x + 2] = a, this.uint32[x + 3] = o, this.uint32[x + 4] = s, this.uint16[v + 10] = u, this.uint16[v + 11] = l, this.uint16[v + 12] = p, this.float32[x + 7] = c, this.float32[x + 8] = h, this.uint8[b + 36] = y, this.uint8[b + 37] = f, this.uint8[b + 38] = d, this.uint32[x + 10] = m, this.int16[v + 22] = g, t
            }, e
        }(oi);
        Ii.prototype.bytesPerElement = 48, xn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48", Ii);
        var zi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d, m, g, v, x, b, _, w, k, A, S, I, z) {
                var B = this.length;
                return this.resize(B + 1), this.emplace(B, t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d, m, g, v, x, b, _, w, k, A, S, I, z)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d, m, g, v, x, b, _, w, k, A, S, I, z, B) {
                var V = 34 * t,
                    C = 17 * t;
                return this.int16[V + 0] = e, this.int16[V + 1] = r, this.int16[V + 2] = n, this.int16[V + 3] = i, this.int16[V + 4] = a, this.int16[V + 5] = o, this.int16[V + 6] = s, this.int16[V + 7] = u, this.uint16[V + 8] = l, this.uint16[V + 9] = p, this.uint16[V + 10] = c, this.uint16[V + 11] = h, this.uint16[V + 12] = y, this.uint16[V + 13] = f, this.uint16[V + 14] = d, this.uint16[V + 15] = m, this.uint16[V + 16] = g, this.uint16[V + 17] = v, this.uint16[V + 18] = x, this.uint16[V + 19] = b, this.uint16[V + 20] = _, this.uint16[V + 21] = w, this.uint16[V + 22] = k, this.uint32[C + 12] = A, this.float32[C + 13] = S, this.float32[C + 14] = I, this.float32[C + 15] = z, this.float32[C + 16] = B, t
            }, e
        }(oi);
        zi.prototype.bytesPerElement = 68, xn("StructArrayLayout8i15ui1ul4f68", zi);
        var Bi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t) {
                var e = this.length;
                return this.resize(e + 1), this.emplace(e, t)
            }, e.prototype.emplace = function (t, e) {
                return this.float32[1 * t + 0] = e, t
            }, e
        }(oi);
        Bi.prototype.bytesPerElement = 4, xn("StructArrayLayout1f4", Bi);
        var Vi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r) {
                var n = this.length;
                return this.resize(n + 1), this.emplace(n, t, e, r)
            }, e.prototype.emplace = function (t, e, r, n) {
                var i = 3 * t;
                return this.int16[i + 0] = e, this.int16[i + 1] = r, this.int16[i + 2] = n, t
            }, e
        }(oi);
        Vi.prototype.bytesPerElement = 6, xn("StructArrayLayout3i6", Vi);
        var Ci = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n, i, a, o, s, u, l, p, c, h) {
                var y = this.length;
                return this.resize(y + 1), this.emplace(y, t, e, r, n, i, a, o, s, u, l, p, c, h)
            }, e.prototype.emplace = function (t, e, r, n, i, a, o, s, u, l, p, c, h, y) {
                var f = 14 * t;
                return this.int16[f + 0] = e, this.int16[f + 1] = r, this.int16[f + 2] = n, this.int16[f + 3] = i, this.uint16[f + 4] = a, this.uint16[f + 5] = o, this.uint16[f + 6] = s, this.uint16[f + 7] = u, this.int16[f + 8] = l, this.int16[f + 9] = p, this.int16[f + 10] = c, this.int16[f + 11] = h, this.uint16[f + 12] = y, t
            }, e
        }(oi);
        Ci.prototype.bytesPerElement = 28, xn("StructArrayLayout4i4ui4i1ui28", Ci);
        var Mi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r) {
                var n = this.length;
                return this.resize(n + 1), this.emplace(n, t, e, r)
            }, e.prototype.emplace = function (t, e, r, n) {
                var i = 4 * t;
                return this.uint32[2 * t + 0] = e, this.uint16[i + 2] = r, this.uint16[i + 3] = n, t
            }, e
        }(oi);
        Mi.prototype.bytesPerElement = 8, xn("StructArrayLayout1ul2ui8", Mi);
        var Pi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e) {
                var r = this.length;
                return this.resize(r + 1), this.emplace(r, t, e)
            }, e.prototype.emplace = function (t, e, r) {
                var n = 2 * t;
                return this.uint16[n + 0] = e, this.uint16[n + 1] = r, t
            }, e
        }(oi);
        Pi.prototype.bytesPerElement = 4, xn("StructArrayLayout2ui4", Pi);
        var Li = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t) {
                var e = this.length;
                return this.resize(e + 1), this.emplace(e, t)
            }, e.prototype.emplace = function (t, e) {
                return this.uint16[1 * t + 0] = e, t
            }, e
        }(oi);
        Li.prototype.bytesPerElement = 2, xn("StructArrayLayout1ui2", Li);
        var Ti = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e) {
                var r = this.length;
                return this.resize(r + 1), this.emplace(r, t, e)
            }, e.prototype.emplace = function (t, e, r) {
                var n = 2 * t;
                return this.float32[n + 0] = e, this.float32[n + 1] = r, t
            }, e
        }(oi);
        Ti.prototype.bytesPerElement = 8, xn("StructArrayLayout2f8", Ti);
        var Di = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._refreshViews = function () {
                this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);
            }, e.prototype.emplaceBack = function (t, e, r, n) {
                var i = this.length;
                return this.resize(i + 1), this.emplace(i, t, e, r, n)
            }, e.prototype.emplace = function (t, e, r, n, i) {
                var a = 4 * t;
                return this.float32[a + 0] = e, this.float32[a + 1] = r, this.float32[a + 2] = n, this.float32[a + 3] = i, t
            }, e
        }(oi);
        Di.prototype.bytesPerElement = 16, xn("StructArrayLayout4f16", Di);
        var Ei = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
            var r = {
                anchorPointX: {
                    configurable: !0
                },
                anchorPointY: {
                    configurable: !0
                },
                x1: {
                    configurable: !0
                },
                y1: {
                    configurable: !0
                },
                x2: {
                    configurable: !0
                },
                y2: {
                    configurable: !0
                },
                featureIndex: {
                    configurable: !0
                },
                sourceLayerIndex: {
                    configurable: !0
                },
                bucketIndex: {
                    configurable: !0
                },
                anchorPoint: {
                    configurable: !0
                }
            };
            return r.anchorPointX.get = function () {
                return this._structArray.int16[this._pos2 + 0]
            }, r.anchorPointY.get = function () {
                return this._structArray.int16[this._pos2 + 1]
            }, r.x1.get = function () {
                return this._structArray.int16[this._pos2 + 2]
            }, r.y1.get = function () {
                return this._structArray.int16[this._pos2 + 3]
            }, r.x2.get = function () {
                return this._structArray.int16[this._pos2 + 4]
            }, r.y2.get = function () {
                return this._structArray.int16[this._pos2 + 5]
            }, r.featureIndex.get = function () {
                return this._structArray.uint32[this._pos4 + 3]
            }, r.sourceLayerIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 8]
            }, r.bucketIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 9]
            }, r.anchorPoint.get = function () {
                return new i(this.anchorPointX, this.anchorPointY)
            }, Object.defineProperties(e.prototype, r), e
        }(ai);
        Ei.prototype.size = 20;
        var Fi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                return new Ei(this, t)
            }, e
        }(_i);
        xn("CollisionBoxArray", Fi);
        var qi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
            var r = {
                anchorX: {
                    configurable: !0
                },
                anchorY: {
                    configurable: !0
                },
                glyphStartIndex: {
                    configurable: !0
                },
                numGlyphs: {
                    configurable: !0
                },
                vertexStartIndex: {
                    configurable: !0
                },
                lineStartIndex: {
                    configurable: !0
                },
                lineLength: {
                    configurable: !0
                },
                segment: {
                    configurable: !0
                },
                lowerSize: {
                    configurable: !0
                },
                upperSize: {
                    configurable: !0
                },
                lineOffsetX: {
                    configurable: !0
                },
                lineOffsetY: {
                    configurable: !0
                },
                writingMode: {
                    configurable: !0
                },
                placedOrientation: {
                    configurable: !0
                },
                hidden: {
                    configurable: !0
                },
                crossTileID: {
                    configurable: !0
                },
                associatedIconIndex: {
                    configurable: !0
                }
            };
            return r.anchorX.get = function () {
                return this._structArray.int16[this._pos2 + 0]
            }, r.anchorY.get = function () {
                return this._structArray.int16[this._pos2 + 1]
            }, r.glyphStartIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 2]
            }, r.numGlyphs.get = function () {
                return this._structArray.uint16[this._pos2 + 3]
            }, r.vertexStartIndex.get = function () {
                return this._structArray.uint32[this._pos4 + 2]
            }, r.lineStartIndex.get = function () {
                return this._structArray.uint32[this._pos4 + 3]
            }, r.lineLength.get = function () {
                return this._structArray.uint32[this._pos4 + 4]
            }, r.segment.get = function () {
                return this._structArray.uint16[this._pos2 + 10]
            }, r.lowerSize.get = function () {
                return this._structArray.uint16[this._pos2 + 11]
            }, r.upperSize.get = function () {
                return this._structArray.uint16[this._pos2 + 12]
            }, r.lineOffsetX.get = function () {
                return this._structArray.float32[this._pos4 + 7]
            }, r.lineOffsetY.get = function () {
                return this._structArray.float32[this._pos4 + 8]
            }, r.writingMode.get = function () {
                return this._structArray.uint8[this._pos1 + 36]
            }, r.placedOrientation.get = function () {
                return this._structArray.uint8[this._pos1 + 37]
            }, r.placedOrientation.set = function (t) {
                this._structArray.uint8[this._pos1 + 37] = t;
            }, r.hidden.get = function () {
                return this._structArray.uint8[this._pos1 + 38]
            }, r.hidden.set = function (t) {
                this._structArray.uint8[this._pos1 + 38] = t;
            }, r.crossTileID.get = function () {
                return this._structArray.uint32[this._pos4 + 10]
            }, r.crossTileID.set = function (t) {
                this._structArray.uint32[this._pos4 + 10] = t;
            }, r.associatedIconIndex.get = function () {
                return this._structArray.int16[this._pos2 + 22]
            }, Object.defineProperties(e.prototype, r), e
        }(ai);
        qi.prototype.size = 48;
        var Oi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                return new qi(this, t)
            }, e
        }(Ii);
        xn("PlacedSymbolArray", Oi);
        var Ui = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
            var r = {
                anchorX: {
                    configurable: !0
                },
                anchorY: {
                    configurable: !0
                },
                rightJustifiedTextSymbolIndex: {
                    configurable: !0
                },
                centerJustifiedTextSymbolIndex: {
                    configurable: !0
                },
                leftJustifiedTextSymbolIndex: {
                    configurable: !0
                },
                verticalPlacedTextSymbolIndex: {
                    configurable: !0
                },
                placedIconSymbolIndex: {
                    configurable: !0
                },
                verticalPlacedIconSymbolIndex: {
                    configurable: !0
                },
                key: {
                    configurable: !0
                },
                textBoxStartIndex: {
                    configurable: !0
                },
                textBoxEndIndex: {
                    configurable: !0
                },
                verticalTextBoxStartIndex: {
                    configurable: !0
                },
                verticalTextBoxEndIndex: {
                    configurable: !0
                },
                iconBoxStartIndex: {
                    configurable: !0
                },
                iconBoxEndIndex: {
                    configurable: !0
                },
                verticalIconBoxStartIndex: {
                    configurable: !0
                },
                verticalIconBoxEndIndex: {
                    configurable: !0
                },
                featureIndex: {
                    configurable: !0
                },
                numHorizontalGlyphVertices: {
                    configurable: !0
                },
                numVerticalGlyphVertices: {
                    configurable: !0
                },
                numIconVertices: {
                    configurable: !0
                },
                numVerticalIconVertices: {
                    configurable: !0
                },
                useRuntimeCollisionCircles: {
                    configurable: !0
                },
                crossTileID: {
                    configurable: !0
                },
                textBoxScale: {
                    configurable: !0
                },
                textOffset0: {
                    configurable: !0
                },
                textOffset1: {
                    configurable: !0
                },
                collisionCircleDiameter: {
                    configurable: !0
                }
            };
            return r.anchorX.get = function () {
                return this._structArray.int16[this._pos2 + 0]
            }, r.anchorY.get = function () {
                return this._structArray.int16[this._pos2 + 1]
            }, r.rightJustifiedTextSymbolIndex.get = function () {
                return this._structArray.int16[this._pos2 + 2]
            }, r.centerJustifiedTextSymbolIndex.get = function () {
                return this._structArray.int16[this._pos2 + 3]
            }, r.leftJustifiedTextSymbolIndex.get = function () {
                return this._structArray.int16[this._pos2 + 4]
            }, r.verticalPlacedTextSymbolIndex.get = function () {
                return this._structArray.int16[this._pos2 + 5]
            }, r.placedIconSymbolIndex.get = function () {
                return this._structArray.int16[this._pos2 + 6]
            }, r.verticalPlacedIconSymbolIndex.get = function () {
                return this._structArray.int16[this._pos2 + 7]
            }, r.key.get = function () {
                return this._structArray.uint16[this._pos2 + 8]
            }, r.textBoxStartIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 9]
            }, r.textBoxEndIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 10]
            }, r.verticalTextBoxStartIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 11]
            }, r.verticalTextBoxEndIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 12]
            }, r.iconBoxStartIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 13]
            }, r.iconBoxEndIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 14]
            }, r.verticalIconBoxStartIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 15]
            }, r.verticalIconBoxEndIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 16]
            }, r.featureIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 17]
            }, r.numHorizontalGlyphVertices.get = function () {
                return this._structArray.uint16[this._pos2 + 18]
            }, r.numVerticalGlyphVertices.get = function () {
                return this._structArray.uint16[this._pos2 + 19]
            }, r.numIconVertices.get = function () {
                return this._structArray.uint16[this._pos2 + 20]
            }, r.numVerticalIconVertices.get = function () {
                return this._structArray.uint16[this._pos2 + 21]
            }, r.useRuntimeCollisionCircles.get = function () {
                return this._structArray.uint16[this._pos2 + 22]
            }, r.crossTileID.get = function () {
                return this._structArray.uint32[this._pos4 + 12]
            }, r.crossTileID.set = function (t) {
                this._structArray.uint32[this._pos4 + 12] = t;
            }, r.textBoxScale.get = function () {
                return this._structArray.float32[this._pos4 + 13]
            }, r.textOffset0.get = function () {
                return this._structArray.float32[this._pos4 + 14]
            }, r.textOffset1.get = function () {
                return this._structArray.float32[this._pos4 + 15]
            }, r.collisionCircleDiameter.get = function () {
                return this._structArray.float32[this._pos4 + 16]
            }, Object.defineProperties(e.prototype, r), e
        }(ai);
        Ui.prototype.size = 68;
        var Ri = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                return new Ui(this, t)
            }, e
        }(zi);
        xn("SymbolInstanceArray", Ri);
        var ji = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getoffsetX = function (t) {
                return this.float32[1 * t + 0]
            }, e
        }(Bi);
        xn("GlyphOffsetArray", ji);
        var Ni = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getx = function (t) {
                return this.int16[3 * t + 0]
            }, e.prototype.gety = function (t) {
                return this.int16[3 * t + 1]
            }, e.prototype.gettileUnitDistanceFromAnchor = function (t) {
                return this.int16[3 * t + 2]
            }, e
        }(Vi);
        xn("SymbolLineVertexArray", Ni);
        var Ki = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
            var r = {
                featureIndex: {
                    configurable: !0
                },
                sourceLayerIndex: {
                    configurable: !0
                },
                bucketIndex: {
                    configurable: !0
                }
            };
            return r.featureIndex.get = function () {
                return this._structArray.uint32[this._pos4 + 0]
            }, r.sourceLayerIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 2]
            }, r.bucketIndex.get = function () {
                return this._structArray.uint16[this._pos2 + 3]
            }, Object.defineProperties(e.prototype, r), e
        }(ai);
        Ki.prototype.size = 8;
        var Xi = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.get = function (t) {
                return new Ki(this, t)
            }, e
        }(Mi);
        xn("FeatureIndexArray", Xi);
        var Gi = si([{
                name: "a_pos",
                components: 2,
                type: "Int16"
            }], 4).members,
            Hi = function (t) {
                void 0 === t && (t = []), this.segments = t;
            };

        function Yi(t, e) {
            return 256 * (t = u(Math.floor(t), 0, 255)) + u(Math.floor(e), 0, 255)
        }
        Hi.prototype.prepareSegment = function (t, e, r, n) {
            var i = this.segments[this.segments.length - 1];
            return t > Hi.MAX_VERTEX_ARRAY_LENGTH && x("Max vertices per segment is " + Hi.MAX_VERTEX_ARRAY_LENGTH + ": bucket requested " + t), (!i || i.vertexLength + t > Hi.MAX_VERTEX_ARRAY_LENGTH || i.sortKey !== n) && (i = {
                vertexOffset: e.length,
                primitiveOffset: r.length,
                vertexLength: 0,
                primitiveLength: 0
            }, void 0 !== n && (i.sortKey = n), this.segments.push(i)), i
        }, Hi.prototype.get = function () {
            return this.segments
        }, Hi.prototype.destroy = function () {
            for (var t = 0, e = this.segments; t < e.length; t += 1) {
                var r = e[t];
                for (var n in r.vaos) r.vaos[n].destroy();
            }
        }, Hi.simpleSegment = function (t, e, r, n) {
            return new Hi([{
                vertexOffset: t,
                primitiveOffset: e,
                vertexLength: r,
                primitiveLength: n,
                vaos: {},
                sortKey: 0
            }])
        }, Hi.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1, xn("SegmentVector", Hi);
        var Zi = si([{
                name: "a_pattern_from",
                components: 4,
                type: "Uint16"
            }, {
                name: "a_pattern_to",
                components: 4,
                type: "Uint16"
            }, {
                name: "a_pixel_ratio_from",
                components: 1,
                type: "Uint8"
            }, {
                name: "a_pixel_ratio_to",
                components: 1,
                type: "Uint8"
            }]),
            Ji = e((function (t) {
                t.exports = function (t, e) {
                    var r, n, i, a, o, s, u, l;
                    for (n = t.length - (r = 3 & t.length), i = e, o = 3432918353, s = 461845907, l = 0; l < n;) u = 255 & t.charCodeAt(l) | (255 & t.charCodeAt(++l)) << 8 | (255 & t.charCodeAt(++l)) << 16 | (255 & t.charCodeAt(++l)) << 24, ++l, i = 27492 + (65535 & (a = 5 * (65535 & (i = (i ^= u = (65535 & (u = (u = (65535 & u) * o + (((u >>> 16) * o & 65535) << 16) & 4294967295) << 15 | u >>> 17)) * s + (((u >>> 16) * s & 65535) << 16) & 4294967295) << 13 | i >>> 19)) + ((5 * (i >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (a >>> 16) & 65535) << 16);
                    switch (u = 0, r) {
                        case 3:
                            u ^= (255 & t.charCodeAt(l + 2)) << 16;
                        case 2:
                            u ^= (255 & t.charCodeAt(l + 1)) << 8;
                        case 1:
                            i ^= u = (65535 & (u = (u = (65535 & (u ^= 255 & t.charCodeAt(l))) * o + (((u >>> 16) * o & 65535) << 16) & 4294967295) << 15 | u >>> 17)) * s + (((u >>> 16) * s & 65535) << 16) & 4294967295;
                    }
                    return i ^= t.length, i = 2246822507 * (65535 & (i ^= i >>> 16)) + ((2246822507 * (i >>> 16) & 65535) << 16) & 4294967295, i = 3266489909 * (65535 & (i ^= i >>> 13)) + ((3266489909 * (i >>> 16) & 65535) << 16) & 4294967295, (i ^= i >>> 16) >>> 0
                };
            })),
            $i = e((function (t) {
                t.exports = function (t, e) {
                    for (var r, n = t.length, i = e ^ n, a = 0; n >= 4;) r = 1540483477 * (65535 & (r = 255 & t.charCodeAt(a) | (255 & t.charCodeAt(++a)) << 8 | (255 & t.charCodeAt(++a)) << 16 | (255 & t.charCodeAt(++a)) << 24)) + ((1540483477 * (r >>> 16) & 65535) << 16), i = 1540483477 * (65535 & i) + ((1540483477 * (i >>> 16) & 65535) << 16) ^ (r = 1540483477 * (65535 & (r ^= r >>> 24)) + ((1540483477 * (r >>> 16) & 65535) << 16)), n -= 4, ++a;
                    switch (n) {
                        case 3:
                            i ^= (255 & t.charCodeAt(a + 2)) << 16;
                        case 2:
                            i ^= (255 & t.charCodeAt(a + 1)) << 8;
                        case 1:
                            i = 1540483477 * (65535 & (i ^= 255 & t.charCodeAt(a))) + ((1540483477 * (i >>> 16) & 65535) << 16);
                    }
                    return i = 1540483477 * (65535 & (i ^= i >>> 13)) + ((1540483477 * (i >>> 16) & 65535) << 16), (i ^= i >>> 15) >>> 0
                };
            })),
            Wi = Ji,
            Qi = $i;
        Wi.murmur3 = Ji, Wi.murmur2 = Qi;
        var ta = function () {
            this.ids = [], this.positions = [], this.indexed = !1;
        };
        ta.prototype.add = function (t, e, r, n) {
            this.ids.push(ra(t)), this.positions.push(e, r, n);
        }, ta.prototype.getPositions = function (t) {
            for (var e = ra(t), r = 0, n = this.ids.length - 1; r < n;) {
                var i = r + n >> 1;
                this.ids[i] >= e ? n = i : r = i + 1;
            }
            for (var a = []; this.ids[r] === e;) a.push({
                index: this.positions[3 * r],
                start: this.positions[3 * r + 1],
                end: this.positions[3 * r + 2]
            }), r++;
            return a
        }, ta.serialize = function (t, e) {
            var r = new Float64Array(t.ids),
                n = new Uint32Array(t.positions);
            return function t(e, r, n, i) {
                for (; n < i;) {
                    for (var a = e[n + i >> 1], o = n - 1, s = i + 1;;) {
                        do {
                            o++;
                        } while (e[o] < a);
                        do {
                            s--;
                        } while (e[s] > a);
                        if (o >= s) break;
                        na(e, o, s), na(r, 3 * o, 3 * s), na(r, 3 * o + 1, 3 * s + 1), na(r, 3 * o + 2, 3 * s + 2);
                    }
                    s - n < i - s ? (t(e, r, n, s), n = s + 1) : (t(e, r, s + 1, i), i = s);
                }
            }(r, n, 0, r.length - 1), e && e.push(r.buffer, n.buffer), {
                ids: r,
                positions: n
            }
        }, ta.deserialize = function (t) {
            var e = new ta;
            return e.ids = t.ids, e.positions = t.positions, e.indexed = !0, e
        };
        var ea = Math.pow(2, 53) - 1;

        function ra(t) {
            var e = +t;
            return !isNaN(e) && e <= ea ? e : Wi(String(t))
        }

        function na(t, e, r) {
            var n = t[e];
            t[e] = t[r], t[r] = n;
        }
        xn("FeaturePositionMap", ta);
        var ia = function (t, e) {
                this.gl = t.gl, this.location = e;
            },
            aa = function (t) {
                function e(e, r) {
                    t.call(this, e, r), this.current = 0;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    this.current !== t && (this.current = t, this.gl.uniform1i(this.location, t));
                }, e
            }(ia),
            oa = function (t) {
                function e(e, r) {
                    t.call(this, e, r), this.current = 0;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    this.current !== t && (this.current = t, this.gl.uniform1f(this.location, t));
                }, e
            }(ia),
            sa = function (t) {
                function e(e, r) {
                    t.call(this, e, r), this.current = [0, 0];
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    t[0] === this.current[0] && t[1] === this.current[1] || (this.current = t, this.gl.uniform2f(this.location, t[0], t[1]));
                }, e
            }(ia),
            ua = function (t) {
                function e(e, r) {
                    t.call(this, e, r), this.current = [0, 0, 0];
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] || (this.current = t, this.gl.uniform3f(this.location, t[0], t[1], t[2]));
                }, e
            }(ia),
            la = function (t) {
                function e(e, r) {
                    t.call(this, e, r), this.current = [0, 0, 0, 0];
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    t[0] === this.current[0] && t[1] === this.current[1] && t[2] === this.current[2] && t[3] === this.current[3] || (this.current = t, this.gl.uniform4f(this.location, t[0], t[1], t[2], t[3]));
                }, e
            }(ia),
            pa = function (t) {
                function e(e, r) {
                    t.call(this, e, r), this.current = Tt.transparent;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    t.r === this.current.r && t.g === this.current.g && t.b === this.current.b && t.a === this.current.a || (this.current = t, this.gl.uniform4f(this.location, t.r, t.g, t.b, t.a));
                }, e
            }(ia),
            ca = new Float32Array(16),
            ha = function (t) {
                function e(e, r) {
                    t.call(this, e, r), this.current = ca;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    if (t[12] !== this.current[12] || t[0] !== this.current[0]) return this.current = t, void this.gl.uniformMatrix4fv(this.location, !1, t);
                    for (var e = 1; e < 16; e++)
                        if (t[e] !== this.current[e]) {
                            this.current = t, this.gl.uniformMatrix4fv(this.location, !1, t);
                            break
                        }
                }, e
            }(ia);

        function ya(t) {
            return [Yi(255 * t.r, 255 * t.g), Yi(255 * t.b, 255 * t.a)]
        }
        var fa = function (t, e, r) {
            this.value = t, this.uniformNames = e.map((function (t) {
                return "u_" + t
            })), this.type = r;
        };
        fa.prototype.setUniform = function (t, e, r) {
            t.set(r.constantOr(this.value));
        }, fa.prototype.getBinding = function (t, e, r) {
            return "color" === this.type ? new pa(t, e) : new oa(t, e)
        };
        var da = function (t, e) {
            this.uniformNames = e.map((function (t) {
                return "u_" + t
            })), this.patternFrom = null, this.patternTo = null, this.pixelRatioFrom = 1, this.pixelRatioTo = 1;
        };
        da.prototype.setConstantPatternPositions = function (t, e) {
            this.pixelRatioFrom = e.pixelRatio, this.pixelRatioTo = t.pixelRatio, this.patternFrom = e.tlbr, this.patternTo = t.tlbr;
        }, da.prototype.setUniform = function (t, e, r, n) {
            var i = "u_pattern_to" === n ? this.patternTo : "u_pattern_from" === n ? this.patternFrom : "u_pixel_ratio_to" === n ? this.pixelRatioTo : "u_pixel_ratio_from" === n ? this.pixelRatioFrom : null;
            i && t.set(i);
        }, da.prototype.getBinding = function (t, e, r) {
            return "u_pattern" === r.substr(0, 9) ? new la(t, e) : new oa(t, e)
        };
        var ma = function (t, e, r, n) {
            this.expression = t, this.type = r, this.maxValue = 0, this.paintVertexAttributes = e.map((function (t) {
                return {
                    name: "a_" + t,
                    type: "Float32",
                    components: "color" === r ? 2 : 1,
                    offset: 0
                }
            })), this.paintVertexArray = new n;
        };
        ma.prototype.populatePaintArray = function (t, e, r, n, i) {
            var a = this.paintVertexArray.length,
                o = this.expression.evaluate(new jn(0), e, {}, n, [], i);
            this.paintVertexArray.resize(t), this._setPaintValue(a, t, o);
        }, ma.prototype.updatePaintArray = function (t, e, r, n) {
            var i = this.expression.evaluate({
                zoom: 0
            }, r, n);
            this._setPaintValue(t, e, i);
        }, ma.prototype._setPaintValue = function (t, e, r) {
            if ("color" === this.type)
                for (var n = ya(r), i = t; i < e; i++) this.paintVertexArray.emplace(i, n[0], n[1]);
            else {
                for (var a = t; a < e; a++) this.paintVertexArray.emplace(a, r);
                this.maxValue = Math.max(this.maxValue, Math.abs(r));
            }
        }, ma.prototype.upload = function (t) {
            this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }, ma.prototype.destroy = function () {
            this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        };
        var ga = function (t, e, r, n, i, a) {
            this.expression = t, this.uniformNames = e.map((function (t) {
                return "u_" + t + "_t"
            })), this.type = r, this.useIntegerZoom = n, this.zoom = i, this.maxValue = 0, this.paintVertexAttributes = e.map((function (t) {
                return {
                    name: "a_" + t,
                    type: "Float32",
                    components: "color" === r ? 4 : 2,
                    offset: 0
                }
            })), this.paintVertexArray = new a;
        };
        ga.prototype.populatePaintArray = function (t, e, r, n, i) {
            var a = this.expression.evaluate(new jn(this.zoom), e, {}, n, [], i),
                o = this.expression.evaluate(new jn(this.zoom + 1), e, {}, n, [], i),
                s = this.paintVertexArray.length;
            this.paintVertexArray.resize(t), this._setPaintValue(s, t, a, o);
        }, ga.prototype.updatePaintArray = function (t, e, r, n) {
            var i = this.expression.evaluate({
                    zoom: this.zoom
                }, r, n),
                a = this.expression.evaluate({
                    zoom: this.zoom + 1
                }, r, n);
            this._setPaintValue(t, e, i, a);
        }, ga.prototype._setPaintValue = function (t, e, r, n) {
            if ("color" === this.type)
                for (var i = ya(r), a = ya(n), o = t; o < e; o++) this.paintVertexArray.emplace(o, i[0], i[1], a[0], a[1]);
            else {
                for (var s = t; s < e; s++) this.paintVertexArray.emplace(s, r, n);
                this.maxValue = Math.max(this.maxValue, Math.abs(r), Math.abs(n));
            }
        }, ga.prototype.upload = function (t) {
            this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));
        }, ga.prototype.destroy = function () {
            this.paintVertexBuffer && this.paintVertexBuffer.destroy();
        }, ga.prototype.setUniform = function (t, e) {
            var r = this.useIntegerZoom ? Math.floor(e.zoom) : e.zoom,
                n = u(this.expression.interpolationFactor(r, this.zoom, this.zoom + 1), 0, 1);
            t.set(n);
        }, ga.prototype.getBinding = function (t, e, r) {
            return new oa(t, e)
        };
        var va = function (t, e, r, n, i, a) {
            this.expression = t, this.type = e, this.useIntegerZoom = r, this.zoom = n, this.layerId = a, this.zoomInPaintVertexArray = new i, this.zoomOutPaintVertexArray = new i;
        };
        va.prototype.populatePaintArray = function (t, e, r) {
            var n = this.zoomInPaintVertexArray.length;
            this.zoomInPaintVertexArray.resize(t), this.zoomOutPaintVertexArray.resize(t), this._setPaintValues(n, t, e.patterns && e.patterns[this.layerId], r);
        }, va.prototype.updatePaintArray = function (t, e, r, n, i) {
            this._setPaintValues(t, e, r.patterns && r.patterns[this.layerId], i);
        }, va.prototype._setPaintValues = function (t, e, r, n) {
            if (n && r) {
                var i = n[r.min],
                    a = n[r.mid],
                    o = n[r.max];
                if (i && a && o)
                    for (var s = t; s < e; s++) this.zoomInPaintVertexArray.emplace(s, a.tl[0], a.tl[1], a.br[0], a.br[1], i.tl[0], i.tl[1], i.br[0], i.br[1], a.pixelRatio, i.pixelRatio), this.zoomOutPaintVertexArray.emplace(s, a.tl[0], a.tl[1], a.br[0], a.br[1], o.tl[0], o.tl[1], o.br[0], o.br[1], a.pixelRatio, o.pixelRatio);
            }
        }, va.prototype.upload = function (t) {
            this.zoomInPaintVertexArray && this.zoomInPaintVertexArray.arrayBuffer && this.zoomOutPaintVertexArray && this.zoomOutPaintVertexArray.arrayBuffer && (this.zoomInPaintVertexBuffer = t.createVertexBuffer(this.zoomInPaintVertexArray, Zi.members, this.expression.isStateDependent), this.zoomOutPaintVertexBuffer = t.createVertexBuffer(this.zoomOutPaintVertexArray, Zi.members, this.expression.isStateDependent));
        }, va.prototype.destroy = function () {
            this.zoomOutPaintVertexBuffer && this.zoomOutPaintVertexBuffer.destroy(), this.zoomInPaintVertexBuffer && this.zoomInPaintVertexBuffer.destroy();
        };
        var xa = function (t, e, r) {
            this.binders = {}, this._buffers = [];
            var n = [];
            for (var i in t.paint._values)
                if (r(i)) {
                    var a = t.paint.get(i);
                    if (a instanceof Zn && yr(a.property.specification)) {
                        var o = _a(i, t.type),
                            s = a.value,
                            u = a.property.specification.type,
                            l = a.property.useIntegerZoom,
                            p = a.property.specification["property-type"],
                            c = "cross-faded" === p || "cross-faded-data-driven" === p;
                        if ("constant" === s.kind) this.binders[i] = c ? new da(s.value, o) : new fa(s.value, o, u), n.push("/u_" + i);
                        else if ("source" === s.kind || c) {
                            var h = wa(i, u, "source");
                            this.binders[i] = c ? new va(s, u, l, e, h, t.id) : new ma(s, o, u, h), n.push("/a_" + i);
                        } else {
                            var y = wa(i, u, "composite");
                            this.binders[i] = new ga(s, o, u, l, e, y), n.push("/z_" + i);
                        }
                    }
                } this.cacheKey = n.sort().join("");
        };
        xa.prototype.getMaxValue = function (t) {
            var e = this.binders[t];
            return e instanceof ma || e instanceof ga ? e.maxValue : 0
        }, xa.prototype.populatePaintArrays = function (t, e, r, n, i) {
            for (var a in this.binders) {
                var o = this.binders[a];
                (o instanceof ma || o instanceof ga || o instanceof va) && o.populatePaintArray(t, e, r, n, i);
            }
        }, xa.prototype.setConstantPatternPositions = function (t, e) {
            for (var r in this.binders) {
                var n = this.binders[r];
                n instanceof da && n.setConstantPatternPositions(t, e);
            }
        }, xa.prototype.updatePaintArrays = function (t, e, r, n, i) {
            var a = !1;
            for (var o in t)
                for (var s = 0, u = e.getPositions(o); s < u.length; s += 1) {
                    var l = u[s],
                        p = r.feature(l.index);
                    for (var c in this.binders) {
                        var h = this.binders[c];
                        if ((h instanceof ma || h instanceof ga || h instanceof va) && !0 === h.expression.isStateDependent) {
                            var y = n.paint.get(c);
                            h.expression = y.value, h.updatePaintArray(l.start, l.end, p, t[o], i), a = !0;
                        }
                    }
                }
            return a
        }, xa.prototype.defines = function () {
            var t = [];
            for (var e in this.binders) {
                var r = this.binders[e];
                (r instanceof fa || r instanceof da) && t.push.apply(t, r.uniformNames.map((function (t) {
                    return "#define HAS_UNIFORM_" + t
                })));
            }
            return t
        }, xa.prototype.getBinderAttributes = function () {
            var t = [];
            for (var e in this.binders) {
                var r = this.binders[e];
                if (r instanceof ma || r instanceof ga)
                    for (var n = 0; n < r.paintVertexAttributes.length; n++) t.push(r.paintVertexAttributes[n].name);
                else if (r instanceof va)
                    for (var i = 0; i < Zi.members.length; i++) t.push(Zi.members[i].name);
            }
            return t
        }, xa.prototype.getBinderUniforms = function () {
            var t = [];
            for (var e in this.binders) {
                var r = this.binders[e];
                if (r instanceof fa || r instanceof da || r instanceof ga)
                    for (var n = 0, i = r.uniformNames; n < i.length; n += 1) t.push(i[n]);
            }
            return t
        }, xa.prototype.getPaintVertexBuffers = function () {
            return this._buffers
        }, xa.prototype.getUniforms = function (t, e) {
            var r = [];
            for (var n in this.binders) {
                var i = this.binders[n];
                if (i instanceof fa || i instanceof da || i instanceof ga)
                    for (var a = 0, o = i.uniformNames; a < o.length; a += 1) {
                        var s = o[a];
                        if (e[s]) {
                            var u = i.getBinding(t, e[s], s);
                            r.push({
                                name: s,
                                property: n,
                                binding: u
                            });
                        }
                    }
            }
            return r
        }, xa.prototype.setUniforms = function (t, e, r, n) {
            for (var i = 0, a = e; i < a.length; i += 1) {
                var o = a[i],
                    s = o.name,
                    u = o.property;
                this.binders[u].setUniform(o.binding, n, r.get(u), s);
            }
        }, xa.prototype.updatePaintBuffers = function (t) {
            for (var e in this._buffers = [], this.binders) {
                var r = this.binders[e];
                if (t && r instanceof va) {
                    var n = 2 === t.fromScale ? r.zoomInPaintVertexBuffer : r.zoomOutPaintVertexBuffer;
                    n && this._buffers.push(n);
                } else(r instanceof ma || r instanceof ga) && r.paintVertexBuffer && this._buffers.push(r.paintVertexBuffer);
            }
        }, xa.prototype.upload = function (t) {
            for (var e in this.binders) {
                var r = this.binders[e];
                (r instanceof ma || r instanceof ga || r instanceof va) && r.upload(t);
            }
            this.updatePaintBuffers();
        }, xa.prototype.destroy = function () {
            for (var t in this.binders) {
                var e = this.binders[t];
                (e instanceof ma || e instanceof ga || e instanceof va) && e.destroy();
            }
        };
        var ba = function (t, e, r) {
            void 0 === r && (r = function () {
                return !0
            }), this.programConfigurations = {};
            for (var n = 0, i = t; n < i.length; n += 1) {
                var a = i[n];
                this.programConfigurations[a.id] = new xa(a, e, r);
            }
            this.needsUpload = !1, this._featureMap = new ta, this._bufferOffset = 0;
        };

        function _a(t, e) {
            return {
                "text-opacity": ["opacity"],
                "icon-opacity": ["opacity"],
                "text-color": ["fill_color"],
                "icon-color": ["fill_color"],
                "text-halo-color": ["halo_color"],
                "icon-halo-color": ["halo_color"],
                "text-halo-blur": ["halo_blur"],
                "icon-halo-blur": ["halo_blur"],
                "text-halo-width": ["halo_width"],
                "icon-halo-width": ["halo_width"],
                "line-gap-width": ["gapwidth"],
                "line-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
                "fill-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"],
                "extrusion-pattern": ["pattern_to", "pattern_from", "pixel_ratio_to", "pixel_ratio_from"]
            } [t] || [t.replace(e + "-", "").replace(/-/g, "_")]
        }

        function wa(t, e, r) {
            var n = {
                    color: {
                        source: Ti,
                        composite: Di
                    },
                    number: {
                        source: Bi,
                        composite: Ti
                    },
                    boolean: {
                        source: Bi,
                        composite: Ti
                    }
                },
                i = function (t) {
                    return {
                        "line-pattern": {
                            source: yi,
                            composite: yi
                        },
                        "fill-pattern": {
                            source: yi,
                            composite: yi
                        },
                        "extrusion-pattern": {
                            source: yi,
                            composite: yi
                        }
                    } [t]
                }(t);
            return i && i[r] || n[e][r]
        }
        ba.prototype.populatePaintArrays = function (t, e, r, n, i, a) {
            for (var o in this.programConfigurations) this.programConfigurations[o].populatePaintArrays(t, e, n, i, a);
            void 0 !== e.id && this._featureMap.add(e.id, r, this._bufferOffset, t), this._bufferOffset = t, this.needsUpload = !0;
        }, ba.prototype.updatePaintArrays = function (t, e, r, n) {
            for (var i = 0, a = r; i < a.length; i += 1) {
                var o = a[i];
                this.needsUpload = this.programConfigurations[o.id].updatePaintArrays(t, this._featureMap, e, o, n) || this.needsUpload;
            }
        }, ba.prototype.get = function (t) {
            return this.programConfigurations[t]
        }, ba.prototype.upload = function (t) {
            if (this.needsUpload) {
                for (var e in this.programConfigurations) this.programConfigurations[e].upload(t);
                this.needsUpload = !1;
            }
        }, ba.prototype.destroy = function () {
            for (var t in this.programConfigurations) this.programConfigurations[t].destroy();
        }, xn("ConstantBinder", fa), xn("CrossFadedConstantBinder", da), xn("SourceExpressionBinder", ma), xn("CrossFadedCompositeBinder", va), xn("CompositeExpressionBinder", ga), xn("ProgramConfiguration", xa, {
            omit: ["_buffers"]
        }), xn("ProgramConfigurationSet", ba);
        var ka = {
            min: -1 * Math.pow(2, 14),
            max: Math.pow(2, 14) - 1
        };

        function Aa(t) {
            for (var e = 8192 / t.extent, r = t.loadGeometry(), n = 0; n < r.length; n++)
                for (var i = r[n], a = 0; a < i.length; a++) {
                    var o = i[a];
                    o.x = Math.round(o.x * e), o.y = Math.round(o.y * e), (o.x < ka.min || o.x > ka.max || o.y < ka.min || o.y > ka.max) && (x("Geometry exceeds allowed extent, reduce your vector tile buffer size"), o.x = u(o.x, ka.min, ka.max), o.y = u(o.y, ka.min, ka.max));
                }
            return r
        }

        function Sa(t, e, r, n, i) {
            t.emplaceBack(2 * e + (n + 1) / 2, 2 * r + (i + 1) / 2);
        }
        var Ia = function (t) {
            this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                return t.id
            })), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new li, this.indexArray = new Si, this.segments = new Hi, this.programConfigurations = new ba(t.layers, t.zoom), this.stateDependentLayerIds = this.layers.filter((function (t) {
                return t.isStateDependent()
            })).map((function (t) {
                return t.id
            }));
        };

        function za(t, e) {
            for (var r = 0; r < t.length; r++)
                if (Fa(e, t[r])) return !0;
            for (var n = 0; n < e.length; n++)
                if (Fa(t, e[n])) return !0;
            return !!Pa(t, e)
        }

        function Ba(t, e, r) {
            return !!Fa(t, e) || !!Ta(e, t, r)
        }

        function Va(t, e) {
            if (1 === t.length) return Ea(e, t[0]);
            for (var r = 0; r < e.length; r++)
                for (var n = e[r], i = 0; i < n.length; i++)
                    if (Fa(t, n[i])) return !0;
            for (var a = 0; a < t.length; a++)
                if (Ea(e, t[a])) return !0;
            for (var o = 0; o < e.length; o++)
                if (Pa(t, e[o])) return !0;
            return !1
        }

        function Ca(t, e, r) {
            for (var n = 0; n < e.length; n++) {
                var i = e[n];
                if (t.length >= 3)
                    for (var a = 0; a < i.length; a++)
                        if (Fa(t, i[a])) return !0;
                if (Ma(t, i, r)) return !0
            }
            return !1
        }

        function Ma(t, e, r) {
            if (t.length > 1) {
                if (Pa(t, e)) return !0;
                for (var n = 0; n < e.length; n++)
                    if (Ta(e[n], t, r)) return !0
            }
            for (var i = 0; i < t.length; i++)
                if (Ta(t[i], e, r)) return !0;
            return !1
        }

        function Pa(t, e) {
            if (0 === t.length || 0 === e.length) return !1;
            for (var r = 0; r < t.length - 1; r++)
                for (var n = t[r], i = t[r + 1], a = 0; a < e.length - 1; a++)
                    if (La(n, i, e[a], e[a + 1])) return !0;
            return !1
        }

        function La(t, e, r, n) {
            return b(t, r, n) !== b(e, r, n) && b(t, e, r) !== b(t, e, n)
        }

        function Ta(t, e, r) {
            var n = r * r;
            if (1 === e.length) return t.distSqr(e[0]) < n;
            for (var i = 1; i < e.length; i++)
                if (Da(t, e[i - 1], e[i]) < n) return !0;
            return !1
        }

        function Da(t, e, r) {
            var n = e.distSqr(r);
            if (0 === n) return t.distSqr(e);
            var i = ((t.x - e.x) * (r.x - e.x) + (t.y - e.y) * (r.y - e.y)) / n;
            return t.distSqr(i < 0 ? e : i > 1 ? r : r.sub(e)._mult(i)._add(e))
        }

        function Ea(t, e) {
            for (var r, n, i, a = !1, o = 0; o < t.length; o++)
                for (var s = 0, u = (r = t[o]).length - 1; s < r.length; u = s++)(n = r[s]).y > e.y != (i = r[u]).y > e.y && e.x < (i.x - n.x) * (e.y - n.y) / (i.y - n.y) + n.x && (a = !a);
            return a
        }

        function Fa(t, e) {
            for (var r = !1, n = 0, i = t.length - 1; n < t.length; i = n++) {
                var a = t[n],
                    o = t[i];
                a.y > e.y != o.y > e.y && e.x < (o.x - a.x) * (e.y - a.y) / (o.y - a.y) + a.x && (r = !r);
            }
            return r
        }

        function qa(t, e, r) {
            var n = r[0],
                i = r[2];
            if (t.x < n.x && e.x < n.x || t.x > i.x && e.x > i.x || t.y < n.y && e.y < n.y || t.y > i.y && e.y > i.y) return !1;
            var a = b(t, e, r[0]);
            return a !== b(t, e, r[1]) || a !== b(t, e, r[2]) || a !== b(t, e, r[3])
        }

        function Oa(t, e, r) {
            var n = e.paint.get(t).value;
            return "constant" === n.kind ? n.value : r.programConfigurations.get(e.id).getMaxValue(t)
        }

        function Ua(t) {
            return Math.sqrt(t[0] * t[0] + t[1] * t[1])
        }

        function Ra(t, e, r, n, a) {
            if (!e[0] && !e[1]) return t;
            var o = i.convert(e)._mult(a);
            "viewport" === r && o._rotate(-n);
            for (var s = [], u = 0; u < t.length; u++) s.push(t[u].sub(o));
            return s
        }
        Ia.prototype.populate = function (t, e, r) {
            var n = this.layers[0],
                i = [],
                a = null;
            "circle" === n.type && (a = n.layout.get("circle-sort-key"));
            for (var o = 0, s = t; o < s.length; o += 1) {
                var u = s[o],
                    l = u.feature,
                    p = u.id,
                    c = u.index,
                    h = u.sourceLayerIndex,
                    y = this.layers[0]._featureFilter.needGeometry,
                    f = {
                        type: l.type,
                        id: p,
                        properties: l.properties,
                        geometry: y ? Aa(l) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), f, r)) {
                    y || (f.geometry = Aa(l));
                    var d = a ? a.evaluate(f, {}, r) : void 0;
                    i.push({
                        id: p,
                        properties: l.properties,
                        type: l.type,
                        sourceLayerIndex: h,
                        index: c,
                        geometry: f.geometry,
                        patterns: {},
                        sortKey: d
                    });
                }
            }
            a && i.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var m = 0, g = i; m < g.length; m += 1) {
                var v = g[m],
                    x = v.geometry,
                    b = v.index,
                    _ = v.sourceLayerIndex,
                    w = t[b].feature;
                this.addFeature(v, x, b, r), e.featureIndex.insert(w, x, b, _, this.index);
            }
        }, Ia.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, Ia.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, Ia.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, Ia.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Gi), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, Ia.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, Ia.prototype.addFeature = function (t, e, r, n) {
            for (var i = 0, a = e; i < a.length; i += 1)
                for (var o = 0, s = a[i]; o < s.length; o += 1) {
                    var u = s[o],
                        l = u.x,
                        p = u.y;
                    if (!(l < 0 || l >= 8192 || p < 0 || p >= 8192)) {
                        var c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, t.sortKey),
                            h = c.vertexLength;
                        Sa(this.layoutVertexArray, l, p, -1, -1), Sa(this.layoutVertexArray, l, p, 1, -1), Sa(this.layoutVertexArray, l, p, 1, 1), Sa(this.layoutVertexArray, l, p, -1, 1), this.indexArray.emplaceBack(h, h + 1, h + 2), this.indexArray.emplaceBack(h, h + 3, h + 2), c.vertexLength += 4, c.primitiveLength += 2;
                    }
                }
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, {}, n);
        }, xn("CircleBucket", Ia, {
            omit: ["layers"]
        });
        var ja = new ri({
                "circle-sort-key": new Wn(ut.layout_circle["circle-sort-key"])
            }),
            Na = {
                paint: new ri({
                    "circle-radius": new Wn(ut.paint_circle["circle-radius"]),
                    "circle-color": new Wn(ut.paint_circle["circle-color"]),
                    "circle-blur": new Wn(ut.paint_circle["circle-blur"]),
                    "circle-opacity": new Wn(ut.paint_circle["circle-opacity"]),
                    "circle-translate": new $n(ut.paint_circle["circle-translate"]),
                    "circle-translate-anchor": new $n(ut.paint_circle["circle-translate-anchor"]),
                    "circle-pitch-scale": new $n(ut.paint_circle["circle-pitch-scale"]),
                    "circle-pitch-alignment": new $n(ut.paint_circle["circle-pitch-alignment"]),
                    "circle-stroke-width": new Wn(ut.paint_circle["circle-stroke-width"]),
                    "circle-stroke-color": new Wn(ut.paint_circle["circle-stroke-color"]),
                    "circle-stroke-opacity": new Wn(ut.paint_circle["circle-stroke-opacity"])
                }),
                layout: ja
            },
            Ka = "undefined" != typeof Float32Array ? Float32Array : Array;

        function Xa(t) {
            return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t
        }

        function Ga(t, e, r) {
            var n = e[0],
                i = e[1],
                a = e[2],
                o = e[3],
                s = e[4],
                u = e[5],
                l = e[6],
                p = e[7],
                c = e[8],
                h = e[9],
                y = e[10],
                f = e[11],
                d = e[12],
                m = e[13],
                g = e[14],
                v = e[15],
                x = r[0],
                b = r[1],
                _ = r[2],
                w = r[3];
            return t[0] = x * n + b * s + _ * c + w * d, t[1] = x * i + b * u + _ * h + w * m, t[2] = x * a + b * l + _ * y + w * g, t[3] = x * o + b * p + _ * f + w * v, t[4] = (x = r[4]) * n + (b = r[5]) * s + (_ = r[6]) * c + (w = r[7]) * d, t[5] = x * i + b * u + _ * h + w * m, t[6] = x * a + b * l + _ * y + w * g, t[7] = x * o + b * p + _ * f + w * v, t[8] = (x = r[8]) * n + (b = r[9]) * s + (_ = r[10]) * c + (w = r[11]) * d, t[9] = x * i + b * u + _ * h + w * m, t[10] = x * a + b * l + _ * y + w * g, t[11] = x * o + b * p + _ * f + w * v, t[12] = (x = r[12]) * n + (b = r[13]) * s + (_ = r[14]) * c + (w = r[15]) * d, t[13] = x * i + b * u + _ * h + w * m, t[14] = x * a + b * l + _ * y + w * g, t[15] = x * o + b * p + _ * f + w * v, t
        }
        Math.hypot || (Math.hypot = function () {
            for (var t = arguments, e = 0, r = arguments.length; r--;) e += t[r] * t[r];
            return Math.sqrt(e)
        });
        var Ha, Ya = Ga;

        function Za(t, e, r) {
            var n = e[0],
                i = e[1],
                a = e[2],
                o = e[3];
            return t[0] = r[0] * n + r[4] * i + r[8] * a + r[12] * o, t[1] = r[1] * n + r[5] * i + r[9] * a + r[13] * o, t[2] = r[2] * n + r[6] * i + r[10] * a + r[14] * o, t[3] = r[3] * n + r[7] * i + r[11] * a + r[15] * o, t
        }
        Ha = new Ka(3), Ka != Float32Array && (Ha[0] = 0, Ha[1] = 0, Ha[2] = 0),
            function () {
                var t = new Ka(4);
                Ka != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 0);
            }();
        var Ja = (function () {
            var t = new Ka(2);
            Ka != Float32Array && (t[0] = 0, t[1] = 0);
        }(), function (t) {
            function e(e) {
                t.call(this, e, Na);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.createBucket = function (t) {
                return new Ia(t)
            }, e.prototype.queryRadius = function (t) {
                var e = t;
                return Oa("circle-radius", this, e) + Oa("circle-stroke-width", this, e) + Ua(this.paint.get("circle-translate"))
            }, e.prototype.queryIntersectsFeature = function (t, e, r, n, i, a, o, s) {
                for (var u = Ra(t, this.paint.get("circle-translate"), this.paint.get("circle-translate-anchor"), a.angle, o), l = this.paint.get("circle-radius").evaluate(e, r) + this.paint.get("circle-stroke-width").evaluate(e, r), p = "map" === this.paint.get("circle-pitch-alignment"), c = p ? u : function (t, e) {
                        return t.map((function (t) {
                            return $a(t, e)
                        }))
                    }(u, s), h = p ? l * o : l, y = 0, f = n; y < f.length; y += 1)
                    for (var d = 0, m = f[y]; d < m.length; d += 1) {
                        var g = m[d],
                            v = p ? g : $a(g, s),
                            x = h,
                            b = Za([], [g.x, g.y, 0, 1], s);
                        if ("viewport" === this.paint.get("circle-pitch-scale") && "map" === this.paint.get("circle-pitch-alignment") ? x *= b[3] / a.cameraToCenterDistance : "map" === this.paint.get("circle-pitch-scale") && "viewport" === this.paint.get("circle-pitch-alignment") && (x *= a.cameraToCenterDistance / b[3]), Ba(c, v, x)) return !0
                    }
                return !1
            }, e
        }(ni));

        function $a(t, e) {
            var r = Za([], [t.x, t.y, 0, 1], e);
            return new i(r[0] / r[3], r[1] / r[3])
        }
        var Wa = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
        }(Ia);

        function Qa(t, e, r, n) {
            var i = e.width,
                a = e.height;
            if (n) {
                if (n instanceof Uint8ClampedArray) n = new Uint8Array(n.buffer);
                else if (n.length !== i * a * r) throw new RangeError("mismatched image size")
            } else n = new Uint8Array(i * a * r);
            return t.width = i, t.height = a, t.data = n, t
        }

        function to(t, e, r) {
            var n = e.width,
                i = e.height;
            if (n !== t.width || i !== t.height) {
                var a = Qa({}, {
                    width: n,
                    height: i
                }, r);
                eo(t, a, {
                    x: 0,
                    y: 0
                }, {
                    x: 0,
                    y: 0
                }, {
                    width: Math.min(t.width, n),
                    height: Math.min(t.height, i)
                }, r), t.width = n, t.height = i, t.data = a.data;
            }
        }

        function eo(t, e, r, n, i, a) {
            if (0 === i.width || 0 === i.height) return e;
            if (i.width > t.width || i.height > t.height || r.x > t.width - i.width || r.y > t.height - i.height) throw new RangeError("out of range source coordinates for image copy");
            if (i.width > e.width || i.height > e.height || n.x > e.width - i.width || n.y > e.height - i.height) throw new RangeError("out of range destination coordinates for image copy");
            for (var o = t.data, s = e.data, u = 0; u < i.height; u++)
                for (var l = ((r.y + u) * t.width + r.x) * a, p = ((n.y + u) * e.width + n.x) * a, c = 0; c < i.width * a; c++) s[p + c] = o[l + c];
            return e
        }
        xn("HeatmapBucket", Wa, {
            omit: ["layers"]
        });
        var ro = function (t, e) {
            Qa(this, t, 1, e);
        };
        ro.prototype.resize = function (t) {
            to(this, t, 1);
        }, ro.prototype.clone = function () {
            return new ro({
                width: this.width,
                height: this.height
            }, new Uint8Array(this.data))
        }, ro.copy = function (t, e, r, n, i) {
            eo(t, e, r, n, i, 1);
        };
        var no = function (t, e) {
            Qa(this, t, 4, e);
        };
        no.prototype.resize = function (t) {
            to(this, t, 4);
        }, no.prototype.replace = function (t, e) {
            e ? this.data.set(t) : this.data = t instanceof Uint8ClampedArray ? new Uint8Array(t.buffer) : t;
        }, no.prototype.clone = function () {
            return new no({
                width: this.width,
                height: this.height
            }, new Uint8Array(this.data))
        }, no.copy = function (t, e, r, n, i) {
            eo(t, e, r, n, i, 4);
        }, xn("AlphaImage", ro), xn("RGBAImage", no);
        var io = {
            paint: new ri({
                "heatmap-radius": new Wn(ut.paint_heatmap["heatmap-radius"]),
                "heatmap-weight": new Wn(ut.paint_heatmap["heatmap-weight"]),
                "heatmap-intensity": new $n(ut.paint_heatmap["heatmap-intensity"]),
                "heatmap-color": new ei(ut.paint_heatmap["heatmap-color"]),
                "heatmap-opacity": new $n(ut.paint_heatmap["heatmap-opacity"])
            })
        };

        function ao(t, e) {
            for (var r = new Uint8Array(1024), n = {}, i = 0, a = 0; i < 256; i++, a += 4) {
                n[e] = i / 255;
                var o = t.evaluate(n);
                r[a + 0] = Math.floor(255 * o.r / o.a), r[a + 1] = Math.floor(255 * o.g / o.a), r[a + 2] = Math.floor(255 * o.b / o.a), r[a + 3] = Math.floor(255 * o.a);
            }
            return new no({
                width: 256,
                height: 1
            }, r)
        }
        var oo = function (t) {
                function e(e) {
                    t.call(this, e, io), this._updateColorRamp();
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.createBucket = function (t) {
                    return new Wa(t)
                }, e.prototype._handleSpecialPaintPropertyUpdate = function (t) {
                    "heatmap-color" === t && this._updateColorRamp();
                }, e.prototype._updateColorRamp = function () {
                    this.colorRamp = ao(this._transitionablePaint._values["heatmap-color"].value.expression, "heatmapDensity"), this.colorRampTexture = null;
                }, e.prototype.resize = function () {
                    this.heatmapFbo && (this.heatmapFbo.destroy(), this.heatmapFbo = null);
                }, e.prototype.queryRadius = function () {
                    return 0
                }, e.prototype.queryIntersectsFeature = function () {
                    return !1
                }, e.prototype.hasOffscreenPass = function () {
                    return 0 !== this.paint.get("heatmap-opacity") && "none" !== this.visibility
                }, e
            }(ni),
            so = {
                paint: new ri({
                    "hillshade-illumination-direction": new $n(ut.paint_hillshade["hillshade-illumination-direction"]),
                    "hillshade-illumination-anchor": new $n(ut.paint_hillshade["hillshade-illumination-anchor"]),
                    "hillshade-exaggeration": new $n(ut.paint_hillshade["hillshade-exaggeration"]),
                    "hillshade-shadow-color": new $n(ut.paint_hillshade["hillshade-shadow-color"]),
                    "hillshade-highlight-color": new $n(ut.paint_hillshade["hillshade-highlight-color"]),
                    "hillshade-accent-color": new $n(ut.paint_hillshade["hillshade-accent-color"])
                })
            },
            uo = function (t) {
                function e(e) {
                    t.call(this, e, so);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.hasOffscreenPass = function () {
                    return 0 !== this.paint.get("hillshade-exaggeration") && "none" !== this.visibility
                }, e
            }(ni),
            lo = si([{
                name: "a_pos",
                components: 2,
                type: "Int16"
            }], 4).members,
            po = ho,
            co = ho;

        function ho(t, e, r) {
            r = r || 2;
            var n, i, a, o, s, u, l, p = e && e.length,
                c = p ? e[0] * r : t.length,
                h = yo(t, 0, c, r, !0),
                y = [];
            if (!h || h.next === h.prev) return y;
            if (p && (h = function (t, e, r, n) {
                    var i, a, o, s = [];
                    for (i = 0, a = e.length; i < a; i++)(o = yo(t, e[i] * n, i < a - 1 ? e[i + 1] * n : t.length, n, !1)) === o.next && (o.steiner = !0), s.push(So(o));
                    for (s.sort(_o), i = 0; i < s.length; i++) wo(s[i], r), r = fo(r, r.next);
                    return r
                }(t, e, h, r)), t.length > 80 * r) {
                n = a = t[0], i = o = t[1];
                for (var f = r; f < c; f += r)(s = t[f]) < n && (n = s), (u = t[f + 1]) < i && (i = u), s > a && (a = s), u > o && (o = u);
                l = 0 !== (l = Math.max(a - n, o - i)) ? 1 / l : 0;
            }
            return mo(h, y, r, n, i, l), y
        }

        function yo(t, e, r, n, i) {
            var a, o;
            if (i === qo(t, e, r, n) > 0)
                for (a = e; a < r; a += n) o = Do(a, t[a], t[a + 1], o);
            else
                for (a = r - n; a >= e; a -= n) o = Do(a, t[a], t[a + 1], o);
            return o && Vo(o, o.next) && (Eo(o), o = o.next), o
        }

        function fo(t, e) {
            if (!t) return t;
            e || (e = t);
            var r, n = t;
            do {
                if (r = !1, n.steiner || !Vo(n, n.next) && 0 !== Bo(n.prev, n, n.next)) n = n.next;
                else {
                    if (Eo(n), (n = e = n.prev) === n.next) break;
                    r = !0;
                }
            } while (r || n !== e);
            return e
        }

        function mo(t, e, r, n, i, a, o) {
            if (t) {
                !o && a && function (t, e, r, n) {
                    var i = t;
                    do {
                        null === i.z && (i.z = Ao(i.x, i.y, e, r, n)), i.prevZ = i.prev, i.nextZ = i.next, i = i.next;
                    } while (i !== t);
                    i.prevZ.nextZ = null, i.prevZ = null,
                        function (t) {
                            var e, r, n, i, a, o, s, u, l = 1;
                            do {
                                for (r = t, t = null, a = null, o = 0; r;) {
                                    for (o++, n = r, s = 0, e = 0; e < l && (s++, n = n.nextZ); e++);
                                    for (u = l; s > 0 || u > 0 && n;) 0 !== s && (0 === u || !n || r.z <= n.z) ? (i = r, r = r.nextZ, s--) : (i = n, n = n.nextZ, u--), a ? a.nextZ = i : t = i, i.prevZ = a, a = i;
                                    r = n;
                                }
                                a.nextZ = null, l *= 2;
                            } while (o > 1)
                        }(i);
                }(t, n, i, a);
                for (var s, u, l = t; t.prev !== t.next;)
                    if (s = t.prev, u = t.next, a ? vo(t, n, i, a) : go(t)) e.push(s.i / r), e.push(t.i / r), e.push(u.i / r), Eo(t), t = u.next, l = u.next;
                    else if ((t = u) === l) {
                    o ? 1 === o ? mo(t = xo(fo(t), e, r), e, r, n, i, a, 2) : 2 === o && bo(t, e, r, n, i, a) : mo(fo(t), e, r, n, i, a, 1);
                    break
                }
            }
        }

        function go(t) {
            var e = t.prev,
                r = t,
                n = t.next;
            if (Bo(e, r, n) >= 0) return !1;
            for (var i = t.next.next; i !== t.prev;) {
                if (Io(e.x, e.y, r.x, r.y, n.x, n.y, i.x, i.y) && Bo(i.prev, i, i.next) >= 0) return !1;
                i = i.next;
            }
            return !0
        }

        function vo(t, e, r, n) {
            var i = t.prev,
                a = t,
                o = t.next;
            if (Bo(i, a, o) >= 0) return !1;
            for (var s = i.x > a.x ? i.x > o.x ? i.x : o.x : a.x > o.x ? a.x : o.x, u = i.y > a.y ? i.y > o.y ? i.y : o.y : a.y > o.y ? a.y : o.y, l = Ao(i.x < a.x ? i.x < o.x ? i.x : o.x : a.x < o.x ? a.x : o.x, i.y < a.y ? i.y < o.y ? i.y : o.y : a.y < o.y ? a.y : o.y, e, r, n), p = Ao(s, u, e, r, n), c = t.prevZ, h = t.nextZ; c && c.z >= l && h && h.z <= p;) {
                if (c !== t.prev && c !== t.next && Io(i.x, i.y, a.x, a.y, o.x, o.y, c.x, c.y) && Bo(c.prev, c, c.next) >= 0) return !1;
                if (c = c.prevZ, h !== t.prev && h !== t.next && Io(i.x, i.y, a.x, a.y, o.x, o.y, h.x, h.y) && Bo(h.prev, h, h.next) >= 0) return !1;
                h = h.nextZ;
            }
            for (; c && c.z >= l;) {
                if (c !== t.prev && c !== t.next && Io(i.x, i.y, a.x, a.y, o.x, o.y, c.x, c.y) && Bo(c.prev, c, c.next) >= 0) return !1;
                c = c.prevZ;
            }
            for (; h && h.z <= p;) {
                if (h !== t.prev && h !== t.next && Io(i.x, i.y, a.x, a.y, o.x, o.y, h.x, h.y) && Bo(h.prev, h, h.next) >= 0) return !1;
                h = h.nextZ;
            }
            return !0
        }

        function xo(t, e, r) {
            var n = t;
            do {
                var i = n.prev,
                    a = n.next.next;
                !Vo(i, a) && Co(i, n, n.next, a) && Lo(i, a) && Lo(a, i) && (e.push(i.i / r), e.push(n.i / r), e.push(a.i / r), Eo(n), Eo(n.next), n = t = a), n = n.next;
            } while (n !== t);
            return fo(n)
        }

        function bo(t, e, r, n, i, a) {
            var o = t;
            do {
                for (var s = o.next.next; s !== o.prev;) {
                    if (o.i !== s.i && zo(o, s)) {
                        var u = To(o, s);
                        return o = fo(o, o.next), u = fo(u, u.next), mo(o, e, r, n, i, a), void mo(u, e, r, n, i, a)
                    }
                    s = s.next;
                }
                o = o.next;
            } while (o !== t)
        }

        function _o(t, e) {
            return t.x - e.x
        }

        function wo(t, e) {
            if (e = function (t, e) {
                    var r, n = e,
                        i = t.x,
                        a = t.y,
                        o = -1 / 0;
                    do {
                        if (a <= n.y && a >= n.next.y && n.next.y !== n.y) {
                            var s = n.x + (a - n.y) * (n.next.x - n.x) / (n.next.y - n.y);
                            if (s <= i && s > o) {
                                if (o = s, s === i) {
                                    if (a === n.y) return n;
                                    if (a === n.next.y) return n.next
                                }
                                r = n.x < n.next.x ? n : n.next;
                            }
                        }
                        n = n.next;
                    } while (n !== e);
                    if (!r) return null;
                    if (i === o) return r;
                    var u, l = r,
                        p = r.x,
                        c = r.y,
                        h = 1 / 0;
                    n = r;
                    do {
                        i >= n.x && n.x >= p && i !== n.x && Io(a < c ? i : o, a, p, c, a < c ? o : i, a, n.x, n.y) && (u = Math.abs(a - n.y) / (i - n.x), Lo(n, t) && (u < h || u === h && (n.x > r.x || n.x === r.x && ko(r, n))) && (r = n, h = u)), n = n.next;
                    } while (n !== l);
                    return r
                }(t, e)) {
                var r = To(e, t);
                fo(e, e.next), fo(r, r.next);
            }
        }

        function ko(t, e) {
            return Bo(t.prev, t, e.prev) < 0 && Bo(e.next, t, t.next) < 0
        }

        function Ao(t, e, r, n, i) {
            return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - r) * i) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - n) * i) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1
        }

        function So(t) {
            var e = t,
                r = t;
            do {
                (e.x < r.x || e.x === r.x && e.y < r.y) && (r = e), e = e.next;
            } while (e !== t);
            return r
        }

        function Io(t, e, r, n, i, a, o, s) {
            return (i - o) * (e - s) - (t - o) * (a - s) >= 0 && (t - o) * (n - s) - (r - o) * (e - s) >= 0 && (r - o) * (a - s) - (i - o) * (n - s) >= 0
        }

        function zo(t, e) {
            return t.next.i !== e.i && t.prev.i !== e.i && ! function (t, e) {
                var r = t;
                do {
                    if (r.i !== t.i && r.next.i !== t.i && r.i !== e.i && r.next.i !== e.i && Co(r, r.next, t, e)) return !0;
                    r = r.next;
                } while (r !== t);
                return !1
            }(t, e) && (Lo(t, e) && Lo(e, t) && function (t, e) {
                var r = t,
                    n = !1,
                    i = (t.x + e.x) / 2,
                    a = (t.y + e.y) / 2;
                do {
                    r.y > a != r.next.y > a && r.next.y !== r.y && i < (r.next.x - r.x) * (a - r.y) / (r.next.y - r.y) + r.x && (n = !n), r = r.next;
                } while (r !== t);
                return n
            }(t, e) && (Bo(t.prev, t, e.prev) || Bo(t, e.prev, e)) || Vo(t, e) && Bo(t.prev, t, t.next) > 0 && Bo(e.prev, e, e.next) > 0)
        }

        function Bo(t, e, r) {
            return (e.y - t.y) * (r.x - e.x) - (e.x - t.x) * (r.y - e.y)
        }

        function Vo(t, e) {
            return t.x === e.x && t.y === e.y
        }

        function Co(t, e, r, n) {
            var i = Po(Bo(t, e, r)),
                a = Po(Bo(t, e, n)),
                o = Po(Bo(r, n, t)),
                s = Po(Bo(r, n, e));
            return i !== a && o !== s || !(0 !== i || !Mo(t, r, e)) || !(0 !== a || !Mo(t, n, e)) || !(0 !== o || !Mo(r, t, n)) || !(0 !== s || !Mo(r, e, n))
        }

        function Mo(t, e, r) {
            return e.x <= Math.max(t.x, r.x) && e.x >= Math.min(t.x, r.x) && e.y <= Math.max(t.y, r.y) && e.y >= Math.min(t.y, r.y)
        }

        function Po(t) {
            return t > 0 ? 1 : t < 0 ? -1 : 0
        }

        function Lo(t, e) {
            return Bo(t.prev, t, t.next) < 0 ? Bo(t, e, t.next) >= 0 && Bo(t, t.prev, e) >= 0 : Bo(t, e, t.prev) < 0 || Bo(t, t.next, e) < 0
        }

        function To(t, e) {
            var r = new Fo(t.i, t.x, t.y),
                n = new Fo(e.i, e.x, e.y),
                i = t.next,
                a = e.prev;
            return t.next = e, e.prev = t, r.next = i, i.prev = r, n.next = r, r.prev = n, a.next = n, n.prev = a, n
        }

        function Do(t, e, r, n) {
            var i = new Fo(t, e, r);
            return n ? (i.next = n.next, i.prev = n, n.next.prev = i, n.next = i) : (i.prev = i, i.next = i), i
        }

        function Eo(t) {
            t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ);
        }

        function Fo(t, e, r) {
            this.i = t, this.x = e, this.y = r, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1;
        }

        function qo(t, e, r, n) {
            for (var i = 0, a = e, o = r - n; a < r; a += n) i += (t[o] - t[a]) * (t[a + 1] + t[o + 1]), o = a;
            return i
        }

        function Oo(t, e, r, n, i) {
            ! function t(e, r, n, i, a) {
                for (; i > n;) {
                    if (i - n > 600) {
                        var o = i - n + 1,
                            s = r - n + 1,
                            u = Math.log(o),
                            l = .5 * Math.exp(2 * u / 3),
                            p = .5 * Math.sqrt(u * l * (o - l) / o) * (s - o / 2 < 0 ? -1 : 1);
                        t(e, r, Math.max(n, Math.floor(r - s * l / o + p)), Math.min(i, Math.floor(r + (o - s) * l / o + p)), a);
                    }
                    var c = e[r],
                        h = n,
                        y = i;
                    for (Uo(e, n, r), a(e[i], c) > 0 && Uo(e, n, i); h < y;) {
                        for (Uo(e, h, y), h++, y--; a(e[h], c) < 0;) h++;
                        for (; a(e[y], c) > 0;) y--;
                    }
                    0 === a(e[n], c) ? Uo(e, n, y) : Uo(e, ++y, i), y <= r && (n = y + 1), r <= y && (i = y - 1);
                }
            }(t, e, r || 0, n || t.length - 1, i || Ro);
        }

        function Uo(t, e, r) {
            var n = t[e];
            t[e] = t[r], t[r] = n;
        }

        function Ro(t, e) {
            return t < e ? -1 : t > e ? 1 : 0
        }

        function jo(t, e) {
            var r = t.length;
            if (r <= 1) return [t];
            for (var n, i, a = [], o = 0; o < r; o++) {
                var s = _(t[o]);
                0 !== s && (t[o].area = Math.abs(s), void 0 === i && (i = s < 0), i === s < 0 ? (n && a.push(n), n = [t[o]]) : n.push(t[o]));
            }
            if (n && a.push(n), e > 1)
                for (var u = 0; u < a.length; u++) a[u].length <= e || (Oo(a[u], e, 1, a[u].length - 1, No), a[u] = a[u].slice(0, e));
            return a
        }

        function No(t, e) {
            return e.area - t.area
        }

        function Ko(t, e, r) {
            for (var n = r.patternDependencies, i = !1, a = 0, o = e; a < o.length; a += 1) {
                var s = o[a].paint.get(t + "-pattern");
                s.isConstant() || (i = !0);
                var u = s.constantOr(null);
                u && (i = !0, n[u.to] = !0, n[u.from] = !0);
            }
            return i
        }

        function Xo(t, e, r, n, i) {
            for (var a = i.patternDependencies, o = 0, s = e; o < s.length; o += 1) {
                var u = s[o],
                    l = u.paint.get(t + "-pattern").value;
                if ("constant" !== l.kind) {
                    var p = l.evaluate({
                            zoom: n - 1
                        }, r, {}, i.availableImages),
                        c = l.evaluate({
                            zoom: n
                        }, r, {}, i.availableImages),
                        h = l.evaluate({
                            zoom: n + 1
                        }, r, {}, i.availableImages);
                    c = c && c.name ? c.name : c, h = h && h.name ? h.name : h, a[p = p && p.name ? p.name : p] = !0, a[c] = !0, a[h] = !0, r.patterns[u.id] = {
                        min: p,
                        mid: c,
                        max: h
                    };
                }
            }
            return r
        }
        ho.deviation = function (t, e, r, n) {
            var i = e && e.length,
                a = Math.abs(qo(t, 0, i ? e[0] * r : t.length, r));
            if (i)
                for (var o = 0, s = e.length; o < s; o++) a -= Math.abs(qo(t, e[o] * r, o < s - 1 ? e[o + 1] * r : t.length, r));
            var u = 0;
            for (o = 0; o < n.length; o += 3) {
                var l = n[o] * r,
                    p = n[o + 1] * r,
                    c = n[o + 2] * r;
                u += Math.abs((t[l] - t[c]) * (t[p + 1] - t[l + 1]) - (t[l] - t[p]) * (t[c + 1] - t[l + 1]));
            }
            return 0 === a && 0 === u ? 0 : Math.abs((u - a) / a)
        }, ho.flatten = function (t) {
            for (var e = t[0][0].length, r = {
                    vertices: [],
                    holes: [],
                    dimensions: e
                }, n = 0, i = 0; i < t.length; i++) {
                for (var a = 0; a < t[i].length; a++)
                    for (var o = 0; o < e; o++) r.vertices.push(t[i][a][o]);
                i > 0 && r.holes.push(n += t[i - 1].length);
            }
            return r
        }, po.default = co;
        var Go = function (t) {
            this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                return t.id
            })), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new li, this.indexArray = new Si, this.indexArray2 = new Pi, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.segments2 = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                return t.isStateDependent()
            })).map((function (t) {
                return t.id
            }));
        };
        Go.prototype.populate = function (t, e, r) {
            this.hasPattern = Ko("fill", this.layers, e);
            for (var n = this.layers[0].layout.get("fill-sort-key"), i = [], a = 0, o = t; a < o.length; a += 1) {
                var s = o[a],
                    u = s.feature,
                    l = s.id,
                    p = s.index,
                    c = s.sourceLayerIndex,
                    h = this.layers[0]._featureFilter.needGeometry,
                    y = {
                        type: u.type,
                        id: l,
                        properties: u.properties,
                        geometry: h ? Aa(u) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), y, r)) {
                    h || (y.geometry = Aa(u));
                    var f = n ? n.evaluate(y, {}, r, e.availableImages) : void 0;
                    i.push({
                        id: l,
                        properties: u.properties,
                        type: u.type,
                        sourceLayerIndex: c,
                        index: p,
                        geometry: y.geometry,
                        patterns: {},
                        sortKey: f
                    });
                }
            }
            n && i.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var d = 0, m = i; d < m.length; d += 1) {
                var g = m[d],
                    v = g.geometry,
                    x = g.index,
                    b = g.sourceLayerIndex;
                if (this.hasPattern) {
                    var _ = Xo("fill", this.layers, g, this.zoom, e);
                    this.patternFeatures.push(_);
                } else this.addFeature(g, v, x, r, {});
                e.featureIndex.insert(t[x].feature, v, x, b, this.index);
            }
        }, Go.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, Go.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.patternFeatures; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, Go.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, Go.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, Go.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, lo), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.indexBuffer2 = t.createIndexBuffer(this.indexArray2)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, Go.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.indexBuffer2.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.segments2.destroy());
        }, Go.prototype.addFeature = function (t, e, r, n, i) {
            for (var a = 0, o = jo(e, 500); a < o.length; a += 1) {
                for (var s = o[a], u = 0, l = 0, p = s; l < p.length; l += 1) u += p[l].length;
                for (var c = this.segments.prepareSegment(u, this.layoutVertexArray, this.indexArray), h = c.vertexLength, y = [], f = [], d = 0, m = s; d < m.length; d += 1) {
                    var g = m[d];
                    if (0 !== g.length) {
                        g !== s[0] && f.push(y.length / 2);
                        var v = this.segments2.prepareSegment(g.length, this.layoutVertexArray, this.indexArray2),
                            x = v.vertexLength;
                        this.layoutVertexArray.emplaceBack(g[0].x, g[0].y), this.indexArray2.emplaceBack(x + g.length - 1, x), y.push(g[0].x), y.push(g[0].y);
                        for (var b = 1; b < g.length; b++) this.layoutVertexArray.emplaceBack(g[b].x, g[b].y), this.indexArray2.emplaceBack(x + b - 1, x + b), y.push(g[b].x), y.push(g[b].y);
                        v.vertexLength += g.length, v.primitiveLength += g.length;
                    }
                }
                for (var _ = po(y, f), w = 0; w < _.length; w += 3) this.indexArray.emplaceBack(h + _[w], h + _[w + 1], h + _[w + 2]);
                c.vertexLength += u, c.primitiveLength += _.length / 3;
            }
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, xn("FillBucket", Go, {
            omit: ["layers", "patternFeatures"]
        });
        var Ho = new ri({
                "fill-sort-key": new Wn(ut.layout_fill["fill-sort-key"])
            }),
            Yo = {
                paint: new ri({
                    "fill-antialias": new $n(ut.paint_fill["fill-antialias"]),
                    "fill-opacity": new Wn(ut.paint_fill["fill-opacity"]),
                    "fill-color": new Wn(ut.paint_fill["fill-color"]),
                    "fill-outline-color": new Wn(ut.paint_fill["fill-outline-color"]),
                    "fill-translate": new $n(ut.paint_fill["fill-translate"]),
                    "fill-translate-anchor": new $n(ut.paint_fill["fill-translate-anchor"]),
                    "fill-pattern": new Qn(ut.paint_fill["fill-pattern"]),
                    "fill-water": new $n(ut.paint_fill["fill-water"])
                }),
                layout: Ho
            },
            Zo = function (t) {
                function e(e) {
                    t.call(this, e, Yo);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.recalculate = function (e, r) {
                    t.prototype.recalculate.call(this, e, r);
                    var n = this.paint._values["fill-outline-color"];
                    "constant" === n.value.kind && void 0 === n.value.value && (this.paint._values["fill-outline-color"] = this.paint._values["fill-color"]);
                }, e.prototype.createBucket = function (t) {
                    return new Go(t)
                }, e.prototype.queryRadius = function () {
                    return Ua(this.paint.get("fill-translate"))
                }, e.prototype.queryIntersectsFeature = function (t, e, r, n, i, a, o) {
                    return Va(Ra(t, this.paint.get("fill-translate"), this.paint.get("fill-translate-anchor"), a.angle, o), n)
                }, e.prototype.isTileClipped = function () {
                    return !0
                }, e
            }(ni),
            Jo = si([{
                name: "a_pos",
                components: 2,
                type: "Int16"
            }, {
                name: "a_normal_ed",
                components: 4,
                type: "Int16"
            }], 4).members,
            $o = Wo;

        function Wo(t, e, r, n, i) {
            this.properties = {}, this.extent = r, this.type = 0, this._pbf = t, this._geometry = -1, this._keys = n, this._values = i, t.readFields(Qo, this, e);
        }

        function Qo(t, e, r) {
            1 == t ? e.id = r.readVarint() : 2 == t ? function (t, e) {
                for (var r = t.readVarint() + t.pos; t.pos < r;) {
                    var n = e._keys[t.readVarint()],
                        i = e._values[t.readVarint()];
                    e.properties[n] = i;
                }
            }(r, e) : 3 == t ? e.type = r.readVarint() : 4 == t && (e._geometry = r.pos);
        }

        function ts(t) {
            for (var e, r, n = 0, i = 0, a = t.length, o = a - 1; i < a; o = i++) n += ((r = t[o]).x - (e = t[i]).x) * (e.y + r.y);
            return n
        }
        Wo.types = ["Unknown", "Point", "LineString", "Polygon"], Wo.prototype.loadGeometry = function () {
            var t = this._pbf;
            t.pos = this._geometry;
            for (var e, r = t.readVarint() + t.pos, n = 1, a = 0, o = 0, s = 0, u = []; t.pos < r;) {
                if (a <= 0) {
                    var l = t.readVarint();
                    n = 7 & l, a = l >> 3;
                }
                if (a--, 1 === n || 2 === n) o += t.readSVarint(), s += t.readSVarint(), 1 === n && (e && u.push(e), e = []), e.push(new i(o, s));
                else {
                    if (7 !== n) throw new Error("unknown command " + n);
                    e && e.push(e[0].clone());
                }
            }
            return e && u.push(e), u
        }, Wo.prototype.bbox = function () {
            var t = this._pbf;
            t.pos = this._geometry;
            for (var e = t.readVarint() + t.pos, r = 1, n = 0, i = 0, a = 0, o = 1 / 0, s = -1 / 0, u = 1 / 0, l = -1 / 0; t.pos < e;) {
                if (n <= 0) {
                    var p = t.readVarint();
                    r = 7 & p, n = p >> 3;
                }
                if (n--, 1 === r || 2 === r)(i += t.readSVarint()) < o && (o = i), i > s && (s = i), (a += t.readSVarint()) < u && (u = a), a > l && (l = a);
                else if (7 !== r) throw new Error("unknown command " + r)
            }
            return [o, u, s, l]
        }, Wo.prototype.toGeoJSON = function (t, e, r) {
            var n, i, a = this.extent * Math.pow(2, r),
                o = this.extent * t,
                s = this.extent * e,
                u = this.loadGeometry(),
                l = Wo.types[this.type];

            function p(t) {
                for (var e = 0; e < t.length; e++) {
                    var r = t[e];
                    t[e] = [360 * (r.x + o) / a - 180, 360 / Math.PI * Math.atan(Math.exp((180 - 360 * (r.y + s) / a) * Math.PI / 180)) - 90];
                }
            }
            switch (this.type) {
                case 1:
                    var c = [];
                    for (n = 0; n < u.length; n++) c[n] = u[n][0];
                    p(u = c);
                    break;
                case 2:
                    for (n = 0; n < u.length; n++) p(u[n]);
                    break;
                case 3:
                    for (u = function (t) {
                            var e = t.length;
                            if (e <= 1) return [t];
                            for (var r, n, i = [], a = 0; a < e; a++) {
                                var o = ts(t[a]);
                                0 !== o && (void 0 === n && (n = o < 0), n === o < 0 ? (r && i.push(r), r = [t[a]]) : r.push(t[a]));
                            }
                            return r && i.push(r), i
                        }(u), n = 0; n < u.length; n++)
                        for (i = 0; i < u[n].length; i++) p(u[n][i]);
            }
            1 === u.length ? u = u[0] : l = "Multi" + l;
            var h = {
                type: "Feature",
                geometry: {
                    type: l,
                    coordinates: u
                },
                properties: this.properties
            };
            return "id" in this && (h.id = this.id), h
        };
        var es = rs;

        function rs(t, e) {
            this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t, this._keys = [], this._values = [], this._features = [], t.readFields(ns, this, e), this.length = this._features.length;
        }

        function ns(t, e, r) {
            15 === t ? e.version = r.readVarint() : 1 === t ? e.name = r.readString() : 5 === t ? e.extent = r.readVarint() : 2 === t ? e._features.push(r.pos) : 3 === t ? e._keys.push(r.readString()) : 4 === t && e._values.push(function (t) {
                for (var e = null, r = t.readVarint() + t.pos; t.pos < r;) {
                    var n = t.readVarint() >> 3;
                    e = 1 === n ? t.readString() : 2 === n ? t.readFloat() : 3 === n ? t.readDouble() : 4 === n ? t.readVarint64() : 5 === n ? t.readVarint() : 6 === n ? t.readSVarint() : 7 === n ? t.readBoolean() : null;
                }
                return e
            }(r));
        }

        function is(t, e, r) {
            if (3 === t) {
                var n = new es(r, r.readVarint() + r.pos);
                n.length && (e[n.name] = n);
            }
        }
        rs.prototype.feature = function (t) {
            if (t < 0 || t >= this._features.length) throw new Error("feature index out of bounds");
            this._pbf.pos = this._features[t];
            var e = this._pbf.readVarint() + this._pbf.pos;
            return new $o(this._pbf, e, this.extent, this._keys, this._values)
        };
        var as = {
                VectorTile: function (t, e) {
                    this.layers = t.readFields(is, {}, e);
                },
                VectorTileFeature: $o,
                VectorTileLayer: es
            },
            os = as.VectorTileFeature.types,
            ss = Math.pow(2, 13);

        function us(t, e, r, n, i, a, o, s) {
            t.emplaceBack(e, r, 2 * Math.floor(n * ss) + o, i * ss * 2, a * ss * 2, Math.round(s));
        }
        var ls = function (t) {
            this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                return t.id
            })), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new ci, this.indexArray = new Si, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                return t.isStateDependent()
            })).map((function (t) {
                return t.id
            }));
        };

        function ps(t, e) {
            return t.x === e.x && (t.x < 0 || t.x > 8192) || t.y === e.y && (t.y < 0 || t.y > 8192)
        }
        ls.prototype.populate = function (t, e, r) {
            this.features = [], this.hasPattern = Ko("extrusion", this.layers, e);
            for (var n = 0, i = t; n < i.length; n += 1) {
                var a = i[n],
                    o = a.feature,
                    s = a.id,
                    u = a.index,
                    l = a.sourceLayerIndex,
                    p = this.layers[0]._featureFilter.needGeometry,
                    c = {
                        type: o.type,
                        id: s,
                        properties: o.properties,
                        geometry: p ? Aa(o) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), c, r)) {
                    var h = {
                        id: s,
                        sourceLayerIndex: l,
                        index: u,
                        geometry: p ? c.geometry : Aa(o),
                        properties: o.properties,
                        type: o.type,
                        patterns: {}
                    };
                    void 0 !== o.id && (h.id = o.id), this.hasPattern ? this.features.push(Xo("extrusion", this.layers, h, this.zoom, e)) : this.addFeature(h, h.geometry, u, r, {}), e.featureIndex.insert(o, h.geometry, u, l, this.index, !0);
                }
            }
        }, ls.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.features; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, ls.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, ls.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, ls.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, ls.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Jo), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, ls.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, ls.prototype.addFeature = function (t, e, r, n, i) {
            for (var a = 0, o = jo(e, 500); a < o.length; a += 1) {
                for (var s = o[a], u = 0, l = 0, p = s; l < p.length; l += 1) u += p[l].length;
                for (var c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray), h = 0, y = s; h < y.length; h += 1) {
                    var f = y[h];
                    if (0 !== f.length && !((P = f).every((function (t) {
                            return t.x < 0
                        })) || P.every((function (t) {
                            return t.x > 8192
                        })) || P.every((function (t) {
                            return t.y < 0
                        })) || P.every((function (t) {
                            return t.y > 8192
                        }))))
                        for (var d = 0, m = 0; m < f.length; m++) {
                            var g = f[m];
                            if (m >= 1) {
                                var v = f[m - 1];
                                if (!ps(g, v)) {
                                    c.vertexLength + 4 > Hi.MAX_VERTEX_ARRAY_LENGTH && (c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));
                                    var x = g.sub(v)._perp()._unit(),
                                        b = v.dist(g);
                                    d + b > 32768 && (d = 0), us(this.layoutVertexArray, g.x, g.y, x.x, x.y, 0, 0, d), us(this.layoutVertexArray, g.x, g.y, x.x, x.y, 0, 1, d), us(this.layoutVertexArray, v.x, v.y, x.x, x.y, 0, 0, d += b), us(this.layoutVertexArray, v.x, v.y, x.x, x.y, 0, 1, d);
                                    var _ = c.vertexLength;
                                    this.indexArray.emplaceBack(_, _ + 2, _ + 1), this.indexArray.emplaceBack(_ + 1, _ + 2, _ + 3), c.vertexLength += 4, c.primitiveLength += 2;
                                }
                            }
                        }
                }
                if (c.vertexLength + u > Hi.MAX_VERTEX_ARRAY_LENGTH && (c = this.segments.prepareSegment(u, this.layoutVertexArray, this.indexArray)), "Polygon" === os[t.type]) {
                    for (var w = [], k = [], A = c.vertexLength, S = 0, I = s; S < I.length; S += 1) {
                        var z = I[S];
                        if (0 !== z.length) {
                            z !== s[0] && k.push(w.length / 2);
                            for (var B = 0; B < z.length; B++) {
                                var V = z[B];
                                us(this.layoutVertexArray, V.x, V.y, 0, 0, 1, 1, 0), w.push(V.x), w.push(V.y);
                            }
                        }
                    }
                    for (var C = po(w, k), M = 0; M < C.length; M += 3) this.indexArray.emplaceBack(A + C[M], A + C[M + 2], A + C[M + 1]);
                    c.primitiveLength += C.length / 3, c.vertexLength += u;
                }
            }
            var P;
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, xn("FillExtrusionBucket", ls, {
            omit: ["layers", "features"]
        });
        var cs = {
                paint: new ri({
                    "extrusion-opacity": new $n(ut.paint_extrusion["extrusion-opacity"]),
                    "extrusion-color": new Wn(ut.paint_extrusion["extrusion-color"]),
                    "extrusion-translate": new $n(ut.paint_extrusion["extrusion-translate"]),
                    "extrusion-translate-anchor": new $n(ut.paint_extrusion["extrusion-translate-anchor"]),
                    "extrusion-pattern": new Qn(ut.paint_extrusion["extrusion-pattern"]),
                    "extrusion-height": new Wn(ut.paint_extrusion["extrusion-height"]),
                    "extrusion-base": new Wn(ut.paint_extrusion["extrusion-base"]),
                    "extrusion-vertical-gradient": new $n(ut.paint_extrusion["extrusion-vertical-gradient"])
                })
            },
            hs = function (t) {
                function e(e) {
                    t.call(this, e, cs);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.createBucket = function (t) {
                    return new ls(t)
                }, e.prototype.queryRadius = function () {
                    return Ua(this.paint.get("extrusion-translate"))
                }, e.prototype.is3D = function () {
                    return !0
                }, e.prototype.queryIntersectsFeature = function (t, e, r, n, a, o, s, u) {
                    var l = Ra(t, this.paint.get("extrusion-translate"), this.paint.get("extrusion-translate-anchor"), o.angle, s),
                        p = this.paint.get("extrusion-height").evaluate(e, r),
                        c = this.paint.get("extrusion-base").evaluate(e, r),
                        h = function (t, e, r, n) {
                            for (var a = [], o = 0, s = t; o < s.length; o += 1) {
                                var u = s[o],
                                    l = [u.x, u.y, 0, 1];
                                Za(l, l, e), a.push(new i(l[0] / l[3], l[1] / l[3]));
                            }
                            return a
                        }(l, u),
                        y = function (t, e, r, n) {
                            for (var a = [], o = [], s = n[8] * e, u = n[9] * e, l = n[10] * e, p = n[11] * e, c = n[8] * r, h = n[9] * r, y = n[10] * r, f = n[11] * r, d = 0, m = t; d < m.length; d += 1) {
                                for (var g = [], v = [], x = 0, b = m[d]; x < b.length; x += 1) {
                                    var _ = b[x],
                                        w = _.x,
                                        k = _.y,
                                        A = n[0] * w + n[4] * k + n[12],
                                        S = n[1] * w + n[5] * k + n[13],
                                        I = n[2] * w + n[6] * k + n[14],
                                        z = n[3] * w + n[7] * k + n[15],
                                        B = I + l,
                                        V = z + p,
                                        C = A + c,
                                        M = S + h,
                                        P = I + y,
                                        L = z + f,
                                        T = new i((A + s) / V, (S + u) / V);
                                    T.z = B / V, g.push(T);
                                    var D = new i(C / L, M / L);
                                    D.z = P / L, v.push(D);
                                }
                                a.push(g), o.push(v);
                            }
                            return [a, o]
                        }(n, c, p, u);
                    return function (t, e, r) {
                        var n = 1 / 0;
                        Va(r, e) && (n = fs(r, e[0]));
                        for (var i = 0; i < e.length; i++)
                            for (var a = e[i], o = t[i], s = 0; s < a.length - 1; s++) {
                                var u = a[s],
                                    l = [u, a[s + 1], o[s + 1], o[s], u];
                                za(r, l) && (n = Math.min(n, fs(r, l)));
                            }
                        return n !== 1 / 0 && n
                    }(y[0], y[1], h)
                }, e
            }(ni);

        function ys(t, e) {
            return t.x * e.x + t.y * e.y
        }

        function fs(t, e) {
            if (1 === t.length) {
                for (var r, n = 0, i = e[n++]; !r || i.equals(r);)
                    if (!(r = e[n++])) return 1 / 0;
                for (; n < e.length; n++) {
                    var a = e[n],
                        o = t[0],
                        s = r.sub(i),
                        u = a.sub(i),
                        l = o.sub(i),
                        p = ys(s, s),
                        c = ys(s, u),
                        h = ys(u, u),
                        y = ys(l, s),
                        f = ys(l, u),
                        d = p * h - c * c,
                        m = (h * y - c * f) / d,
                        g = (p * f - c * y) / d,
                        v = i.z * (1 - m - g) + r.z * m + a.z * g;
                    if (isFinite(v)) return v
                }
                return 1 / 0
            }
            for (var x = 1 / 0, b = 0, _ = e; b < _.length; b += 1) x = Math.min(x, _[b].z);
            return x
        }
        var ds = si([{
                name: "a_pos_normal",
                components: 2,
                type: "Int16"
            }, {
                name: "a_data",
                components: 4,
                type: "Uint8"
            }], 4).members,
            ms = as.VectorTileFeature.types,
            gs = Math.cos(Math.PI / 180 * 37.5),
            vs = Math.pow(2, 14) / .5,
            xs = function (t) {
                this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                    return t.id
                })), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new hi, this.indexArray = new Si, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                    return t.isStateDependent()
                })).map((function (t) {
                    return t.id
                }));
            };
        xs.prototype.populate = function (t, e, r) {
            this.hasPattern = Ko("line", this.layers, e);
            for (var n = this.layers[0].layout.get("line-sort-key"), i = [], a = 0, o = t; a < o.length; a += 1) {
                var s = o[a],
                    u = s.feature,
                    l = s.id,
                    p = s.index,
                    c = s.sourceLayerIndex,
                    h = this.layers[0]._featureFilter.needGeometry,
                    y = {
                        type: u.type,
                        id: l,
                        properties: u.properties,
                        geometry: h ? Aa(u) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), y, r)) {
                    h || (y.geometry = Aa(u));
                    var f = n ? n.evaluate(y, {}, r) : void 0;
                    i.push({
                        id: l,
                        properties: u.properties,
                        type: u.type,
                        sourceLayerIndex: c,
                        index: p,
                        geometry: y.geometry,
                        patterns: {},
                        sortKey: f
                    });
                }
            }
            n && i.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var d = 0, m = i; d < m.length; d += 1) {
                var g = m[d],
                    v = g.geometry,
                    x = g.index,
                    b = g.sourceLayerIndex;
                if (this.hasPattern) {
                    var _ = Xo("line", this.layers, g, this.zoom, e);
                    this.patternFeatures.push(_);
                } else this.addFeature(g, v, x, r, {});
                e.featureIndex.insert(t[x].feature, v, x, b, this.index);
            }
        }, xs.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, xs.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.patternFeatures; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, xs.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, xs.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, xs.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, ds), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, xs.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, xs.prototype.addFeature = function (t, e, r, n, i) {
            for (var a = this.layers[0].layout, o = a.get("line-join").evaluate(t, {}), s = a.get("line-cap"), u = a.get("line-miter-limit"), l = a.get("line-round-limit"), p = 0, c = e; p < c.length; p += 1) this.addLine(c[p], t, o, s, u, l);
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, xs.prototype.addLine = function (t, e, r, n, i, a) {
            if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, e.properties && e.properties.hasOwnProperty("minemap_clip_start") && e.properties.hasOwnProperty("minemap_clip_end")) {
                this.clipStart = +e.properties.minemap_clip_start, this.clipEnd = +e.properties.minemap_clip_end;
                for (var o = 0; o < t.length - 1; o++) this.totalDistance += t[o].dist(t[o + 1]);
                this.updateScaledDistance();
            }
            for (var s = "Polygon" === ms[e.type], u = t.length; u >= 2 && t[u - 1].equals(t[u - 2]);) u--;
            for (var l = 0; l < u - 1 && t[l].equals(t[l + 1]);) l++;
            if (!(u < (s ? 3 : 2))) {
                "bevel" === r && (i = 1.05);
                var p, c = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
                    h = this.segments.prepareSegment(10 * u, this.layoutVertexArray, this.indexArray),
                    y = void 0,
                    f = void 0,
                    d = void 0,
                    m = void 0;
                this.e1 = this.e2 = -1, s && (m = t[l].sub(p = t[u - 2])._unit()._perp());
                for (var g = l; g < u; g++)
                    if (!(f = g === u - 1 ? s ? t[l + 1] : void 0 : t[g + 1]) || !t[g].equals(f)) {
                        m && (d = m), p && (y = p), p = t[g], m = f ? f.sub(p)._unit()._perp() : d;
                        var v = (d = d || m).add(m);
                        0 === v.x && 0 === v.y || v._unit();
                        var x = d.x * m.x + d.y * m.y,
                            b = v.x * m.x + v.y * m.y,
                            _ = 0 !== b ? 1 / b : 1 / 0,
                            w = 2 * Math.sqrt(2 - 2 * b),
                            k = b < gs && y && f,
                            A = d.x * m.y - d.y * m.x > 0;
                        if (k && g > l) {
                            var S = p.dist(y);
                            if (S > 2 * c) {
                                var I = p.sub(p.sub(y)._mult(c / S)._round());
                                this.updateDistance(y, I), this.addCurrentVertex(I, d, 0, 0, h), y = I;
                            }
                        }
                        var z = y && f,
                            B = z ? r : s ? "butt" : n;
                        if (z && "round" === B && (_ < a ? B = "miter" : _ <= 2 && (B = "fakeround")), "miter" === B && _ > i && (B = "bevel"), "bevel" === B && (_ > 2 && (B = "flipbevel"), _ < i && (B = "miter")), y && this.updateDistance(y, p), "miter" === B) v._mult(_), this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("flipbevel" === B) {
                            if (_ > 100) v = m.mult(-1);
                            else {
                                var V = _ * d.add(m).mag() / d.sub(m).mag();
                                v._perp()._mult(V * (A ? -1 : 1));
                            }
                            this.addCurrentVertex(p, v, 0, 0, h), this.addCurrentVertex(p, v.mult(-1), 0, 0, h);
                        } else if ("bevel" === B || "fakeround" === B) {
                            var C = -Math.sqrt(_ * _ - 1),
                                M = A ? C : 0,
                                P = A ? 0 : C;
                            if (y && this.addCurrentVertex(p, d, M, P, h), "fakeround" === B)
                                for (var L = Math.round(180 * w / Math.PI / 20), T = 1; T < L; T++) {
                                    var D = T / L;
                                    if (.5 !== D) {
                                        var E = D - .5;
                                        D += D * E * (D - 1) * ((1.0904 + x * (x * (3.55645 - 1.43519 * x) - 3.2452)) * E * E + (.848013 + x * (.215638 * x - 1.06021)));
                                    }
                                    var F = m.sub(d)._mult(D)._add(d)._unit()._mult(A ? -1 : 1);
                                    this.addHalfVertex(p, F.x, F.y, !1, A, 0, h);
                                }
                            f && this.addCurrentVertex(p, m, -M, -P, h);
                        } else if ("butt" === B) this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("square" === B) {
                            var q = y ? 1 : -1;
                            this.addCurrentVertex(p, v, q, q, h);
                        } else "round" === B && (y && (this.addCurrentVertex(p, d, 0, 0, h), this.addCurrentVertex(p, d, 1, 1, h, !0)), f && (this.addCurrentVertex(p, m, -1, -1, h, !0), this.addCurrentVertex(p, m, 0, 0, h)));
                        if (k && g < u - 1) {
                            var O = p.dist(f);
                            if (O > 2 * c) {
                                var U = p.add(f.sub(p)._mult(c / O)._round());
                                this.updateDistance(p, U), this.addCurrentVertex(U, m, 0, 0, h), p = U;
                            }
                        }
                    }
            }
        }, xs.prototype.addCurrentVertex = function (t, e, r, n, i, a) {
            void 0 === a && (a = !1);
            var o = e.y * n - e.x,
                s = -e.y - e.x * n;
            this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, a, !1, r, i), this.addHalfVertex(t, o, s, a, !0, -n, i), this.distance > vs / 2 && 0 === this.totalDistance && (this.distance = 0, this.addCurrentVertex(t, e, r, n, i, a));
        }, xs.prototype.addHalfVertex = function (t, e, r, n, i, a, o) {
            var s = .5 * this.scaledDistance;
            this.layoutVertexArray.emplaceBack((t.x << 1) + (n ? 1 : 0), (t.y << 1) + (i ? 1 : 0), Math.round(63 * e) + 128, Math.round(63 * r) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1) | (63 & s) << 2, s >> 6);
            var u = o.vertexLength++;
            this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, u), o.primitiveLength++), i ? this.e2 = u : this.e1 = u;
        }, xs.prototype.updateScaledDistance = function () {
            this.scaledDistance = this.totalDistance > 0 ? (this.clipStart + (this.clipEnd - this.clipStart) * this.distance / this.totalDistance) * (vs - 1) : this.distance;
        }, xs.prototype.updateDistance = function (t, e) {
            this.distance += t.dist(e), this.updateScaledDistance();
        }, xn("LineBucket", xs, {
            omit: ["layers", "patternFeatures"]
        });
        var bs = new ri({
                "line-cap": new $n(ut.layout_line["line-cap"]),
                "line-join": new Wn(ut.layout_line["line-join"]),
                "line-miter-limit": new $n(ut.layout_line["line-miter-limit"]),
                "line-round-limit": new $n(ut.layout_line["line-round-limit"]),
                "line-sort-key": new Wn(ut.layout_line["line-sort-key"]),
                "border-visibility": new $n(ut.layout_line["border-visibility"])
            }),
            _s = {
                paint: new ri({
                    "line-opacity": new Wn(ut.paint_line["line-opacity"]),
                    "line-color": new Wn(ut.paint_line["line-color"]),
                    "line-translate": new $n(ut.paint_line["line-translate"]),
                    "line-translate-anchor": new $n(ut.paint_line["line-translate-anchor"]),
                    "line-width": new Wn(ut.paint_line["line-width"]),
                    "line-border-opacity": new Wn(ut.paint_line["line-border-opacity"]),
                    "line-border-color": new Wn(ut.paint_line["line-border-color"]),
                    "line-border-width": new Wn(ut.paint_line["line-border-width"]),
                    "line-gap-width": new Wn(ut.paint_line["line-gap-width"]),
                    "line-offset": new Wn(ut.paint_line["line-offset"]),
                    "line-blur": new Wn(ut.paint_line["line-blur"]),
                    "line-dasharray": new ti(ut.paint_line["line-dasharray"]),
                    "line-pattern": new Qn(ut.paint_line["line-pattern"]),
                    "line-gradient": new ei(ut.paint_line["line-gradient"]),
                    "half-render": new $n(ut.paint_line["half-render"]),
                    "line-normal-direction": new Wn(ut.paint_line["line-normal-direction"])
                }),
                layout: bs
            },
            ws = new(function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.possiblyEvaluate = function (e, r) {
                    return r = new jn(Math.floor(r.zoom), {
                        now: r.now,
                        fadeDuration: r.fadeDuration,
                        zoomHistory: r.zoomHistory,
                        transition: r.transition
                    }), t.prototype.possiblyEvaluate.call(this, e, r)
                }, e.prototype.evaluate = function (e, r, n, i) {
                    return r = p({}, r, {
                        zoom: Math.floor(r.zoom)
                    }), t.prototype.evaluate.call(this, e, r, n, i)
                }, e
            }(Wn))(_s.paint.properties["line-width"].specification);
        ws.useIntegerZoom = !0;
        var ks = function (t) {
            function e(e) {
                t.call(this, e, _s);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._handleSpecialPaintPropertyUpdate = function (t) {
                "line-gradient" === t && this._updateGradient();
            }, e.prototype._updateGradient = function () {
                this.gradient = ao(this._transitionablePaint._values["line-gradient"].value.expression, "lineProgress"), this.gradientTexture = null;
            }, e.prototype.recalculate = function (e, r) {
                t.prototype.recalculate.call(this, e, r), this.paint._values["line-floorwidth"] = ws.possiblyEvaluate(this._transitioningPaint._values["line-width"].value, e);
            }, e.prototype.createBucket = function (t) {
                return new xs(t)
            }, e.prototype.queryRadius = function (t) {
                var e = t,
                    r = As(Oa("line-width", this, e), Oa("line-gap-width", this, e)),
                    n = Oa("line-offset", this, e);
                return r / 2 + Math.abs(n) + Ua(this.paint.get("line-translate"))
            }, e.prototype.queryIntersectsFeature = function (t, e, r, n, a, o, s) {
                var u = Ra(t, this.paint.get("line-translate"), this.paint.get("line-translate-anchor"), o.angle, s),
                    l = s / 2 * As(this.paint.get("line-width").evaluate(e, r), this.paint.get("line-gap-width").evaluate(e, r)),
                    p = this.paint.get("line-offset").evaluate(e, r);
                return p && (n = function (t, e) {
                    for (var r = [], n = new i(0, 0), a = 0; a < t.length; a++) {
                        for (var o = t[a], s = [], u = 0; u < o.length; u++) {
                            var l = o[u],
                                p = o[u + 1],
                                c = 0 === u ? n : l.sub(o[u - 1])._unit()._perp(),
                                h = u === o.length - 1 ? n : p.sub(l)._unit()._perp(),
                                y = c._add(h)._unit();
                            y._mult(1 / (y.x * h.x + y.y * h.y)), s.push(y._mult(e)._add(l));
                        }
                        r.push(s);
                    }
                    return r
                }(n, p * s)), Ca(u, n, l)
            }, e.prototype.isTileClipped = function () {
                return !0
            }, e
        }(ni);

        function As(t, e) {
            return e > 0 ? e + 2 * t : t
        }
        var Ss = si([{
                name: "a_pos_offset",
                components: 4,
                type: "Int16"
            }, {
                name: "a_data",
                components: 4,
                type: "Uint16"
            }, {
                name: "a_pixeloffset",
                components: 4,
                type: "Int16"
            }], 4),
            Is = si([{
                name: "a_projected_pos",
                components: 3,
                type: "Float32"
            }], 4),
            zs = (si([{
                name: "a_fade_opacity",
                components: 1,
                type: "Uint32"
            }], 4), si([{
                name: "a_placed",
                components: 2,
                type: "Uint8"
            }, {
                name: "a_shift",
                components: 2,
                type: "Float32"
            }])),
            Bs = (si([{
                type: "Int16",
                name: "anchorPointX"
            }, {
                type: "Int16",
                name: "anchorPointY"
            }, {
                type: "Int16",
                name: "x1"
            }, {
                type: "Int16",
                name: "y1"
            }, {
                type: "Int16",
                name: "x2"
            }, {
                type: "Int16",
                name: "y2"
            }, {
                type: "Uint32",
                name: "featureIndex"
            }, {
                type: "Uint16",
                name: "sourceLayerIndex"
            }, {
                type: "Uint16",
                name: "bucketIndex"
            }]), si([{
                name: "a_pos",
                components: 2,
                type: "Int16"
            }, {
                name: "a_anchor_pos",
                components: 2,
                type: "Int16"
            }, {
                name: "a_extrude",
                components: 2,
                type: "Int16"
            }], 4)),
            Vs = si([{
                name: "a_pos",
                components: 2,
                type: "Float32"
            }, {
                name: "a_radius",
                components: 1,
                type: "Float32"
            }, {
                name: "a_flags",
                components: 2,
                type: "Int16"
            }], 4);

        function Cs(t, e, r) {
            return t.sections.forEach((function (t) {
                t.text = function (t, e, r) {
                    var n = e.layout.get("text-transform").evaluate(r, {});
                    return "uppercase" === n ? t = t.toLocaleUpperCase() : "lowercase" === n && (t = t.toLocaleLowerCase()), Rn.applyArabicShaping && (t = Rn.applyArabicShaping(t)), t
                }(t.text, e, r);
            })), t
        }

        function Ms(t) {
            var e = {},
                r = {},
                n = [],
                i = 0;

            function a(e) {
                n.push(t[e]), i++;
            }

            function o(t, e, i) {
                var a = r[t];
                return delete r[t], r[e] = a, n[a].geometry[0].pop(), n[a].geometry[0] = n[a].geometry[0].concat(i[0]), a
            }

            function s(t, r, i) {
                var a = e[r];
                return delete e[r], e[t] = a, n[a].geometry[0].shift(), n[a].geometry[0] = i[0].concat(n[a].geometry[0]), a
            }

            function u(t, e, r) {
                var n = r ? e[0][e[0].length - 1] : e[0][0];
                return t + ":" + n.x + ":" + n.y
            }
            for (var l = 0; l < t.length; l++) {
                var p = t[l],
                    c = p.geometry,
                    h = p.text ? p.text.toString() : null;
                if (h) {
                    var y = u(h, c),
                        f = u(h, c, !0);
                    if (y in r && f in e && r[y] !== e[f]) {
                        var d = s(y, f, c),
                            m = o(y, f, n[d].geometry);
                        delete e[y], delete r[f], r[u(h, n[m].geometry, !0)] = m, n[d].geometry = null;
                    } else y in r ? o(y, f, c) : f in e ? s(y, f, c) : (a(l), e[y] = i - 1, r[f] = i - 1);
                } else a(l);
            }
            return n.filter((function (t) {
                return t.geometry
            }))
        }
        si([{
            name: "triangle",
            components: 3,
            type: "Uint16"
        }]), si([{
            type: "Int16",
            name: "anchorX"
        }, {
            type: "Int16",
            name: "anchorY"
        }, {
            type: "Uint16",
            name: "glyphStartIndex"
        }, {
            type: "Uint16",
            name: "numGlyphs"
        }, {
            type: "Uint32",
            name: "vertexStartIndex"
        }, {
            type: "Uint32",
            name: "lineStartIndex"
        }, {
            type: "Uint32",
            name: "lineLength"
        }, {
            type: "Uint16",
            name: "segment"
        }, {
            type: "Uint16",
            name: "lowerSize"
        }, {
            type: "Uint16",
            name: "upperSize"
        }, {
            type: "Float32",
            name: "lineOffsetX"
        }, {
            type: "Float32",
            name: "lineOffsetY"
        }, {
            type: "Uint8",
            name: "writingMode"
        }, {
            type: "Uint8",
            name: "placedOrientation"
        }, {
            type: "Uint8",
            name: "hidden"
        }, {
            type: "Uint32",
            name: "crossTileID"
        }, {
            type: "Int16",
            name: "associatedIconIndex"
        }]), si([{
            type: "Int16",
            name: "anchorX"
        }, {
            type: "Int16",
            name: "anchorY"
        }, {
            type: "Int16",
            name: "rightJustifiedTextSymbolIndex"
        }, {
            type: "Int16",
            name: "centerJustifiedTextSymbolIndex"
        }, {
            type: "Int16",
            name: "leftJustifiedTextSymbolIndex"
        }, {
            type: "Int16",
            name: "verticalPlacedTextSymbolIndex"
        }, {
            type: "Int16",
            name: "placedIconSymbolIndex"
        }, {
            type: "Int16",
            name: "verticalPlacedIconSymbolIndex"
        }, {
            type: "Uint16",
            name: "key"
        }, {
            type: "Uint16",
            name: "textBoxStartIndex"
        }, {
            type: "Uint16",
            name: "textBoxEndIndex"
        }, {
            type: "Uint16",
            name: "verticalTextBoxStartIndex"
        }, {
            type: "Uint16",
            name: "verticalTextBoxEndIndex"
        }, {
            type: "Uint16",
            name: "iconBoxStartIndex"
        }, {
            type: "Uint16",
            name: "iconBoxEndIndex"
        }, {
            type: "Uint16",
            name: "verticalIconBoxStartIndex"
        }, {
            type: "Uint16",
            name: "verticalIconBoxEndIndex"
        }, {
            type: "Uint16",
            name: "featureIndex"
        }, {
            type: "Uint16",
            name: "numHorizontalGlyphVertices"
        }, {
            type: "Uint16",
            name: "numVerticalGlyphVertices"
        }, {
            type: "Uint16",
            name: "numIconVertices"
        }, {
            type: "Uint16",
            name: "numVerticalIconVertices"
        }, {
            type: "Uint16",
            name: "useRuntimeCollisionCircles"
        }, {
            type: "Uint32",
            name: "crossTileID"
        }, {
            type: "Float32",
            name: "textBoxScale"
        }, {
            type: "Float32",
            components: 2,
            name: "textOffset"
        }, {
            type: "Float32",
            name: "collisionCircleDiameter"
        }]), si([{
            type: "Float32",
            name: "offsetX"
        }]), si([{
            type: "Int16",
            name: "x"
        }, {
            type: "Int16",
            name: "y"
        }, {
            type: "Int16",
            name: "tileUnitDistanceFromAnchor"
        }]);
        var Ps = {
                "!": "︕",
                "#": "＃",
                $: "＄",
                "%": "％",
                "&": "＆",
                "(": "︵",
                ")": "︶",
                "*": "＊",
                "+": "＋",
                ",": "︐",
                "-": "︲",
                ".": "・",
                "/": "／",
                ":": "︓",
                ";": "︔",
                "<": "︿",
                "=": "＝",
                ">": "﹀",
                "?": "︖",
                "@": "＠",
                "[": "﹇",
                "\\": "＼",
                "]": "﹈",
                "^": "＾",
                _: "︳",
                "`": "｀",
                "{": "︷",
                "|": "―",
                "}": "︸",
                "~": "～",
                "¢": "￠",
                "£": "￡",
                "¥": "￥",
                "¦": "￤",
                "¬": "￢",
                "¯": "￣",
                "–": "︲",
                "—": "︱",
                "‘": "﹃",
                "’": "﹄",
                "“": "﹁",
                "”": "﹂",
                "…": "︙",
                "‧": "・",
                "₩": "￦",
                "、": "︑",
                "。": "︒",
                "〈": "︿",
                "〉": "﹀",
                "《": "︽",
                "》": "︾",
                "「": "﹁",
                "」": "﹂",
                "『": "﹃",
                "』": "﹄",
                "【": "︻",
                "】": "︼",
                "〔": "︹",
                "〕": "︺",
                "〖": "︗",
                "〗": "︘",
                "！": "︕",
                "（": "︵",
                "）": "︶",
                "，": "︐",
                "－": "︲",
                "．": "・",
                "：": "︓",
                "；": "︔",
                "＜": "︿",
                "＞": "﹀",
                "？": "︖",
                "［": "﹇",
                "］": "﹈",
                "＿": "︳",
                "｛": "︷",
                "｜": "―",
                "｝": "︸",
                "｟": "︵",
                "｠": "︶",
                "｡": "︒",
                "｢": "﹁",
                "｣": "﹂"
            },
            Ls = function (t, e, r, n, i) {
                var a, o, s = 8 * i - n - 1,
                    u = (1 << s) - 1,
                    l = u >> 1,
                    p = -7,
                    c = r ? i - 1 : 0,
                    h = r ? -1 : 1,
                    y = t[e + c];
                for (c += h, a = y & (1 << -p) - 1, y >>= -p, p += s; p > 0; a = 256 * a + t[e + c], c += h, p -= 8);
                for (o = a & (1 << -p) - 1, a >>= -p, p += n; p > 0; o = 256 * o + t[e + c], c += h, p -= 8);
                if (0 === a) a = 1 - l;
                else {
                    if (a === u) return o ? NaN : 1 / 0 * (y ? -1 : 1);
                    o += Math.pow(2, n), a -= l;
                }
                return (y ? -1 : 1) * o * Math.pow(2, a - n)
            },
            Ts = function (t, e, r, n, i, a) {
                var o, s, u, l = 8 * a - i - 1,
                    p = (1 << l) - 1,
                    c = p >> 1,
                    h = 23 === i ? Math.pow(2, -24) - Math.pow(2, -77) : 0,
                    y = n ? 0 : a - 1,
                    f = n ? 1 : -1,
                    d = e < 0 || 0 === e && 1 / e < 0 ? 1 : 0;
                for (e = Math.abs(e), isNaN(e) || e === 1 / 0 ? (s = isNaN(e) ? 1 : 0, o = p) : (o = Math.floor(Math.log(e) / Math.LN2), e * (u = Math.pow(2, -o)) < 1 && (o--, u *= 2), (e += o + c >= 1 ? h / u : h * Math.pow(2, 1 - c)) * u >= 2 && (o++, u /= 2), o + c >= p ? (s = 0, o = p) : o + c >= 1 ? (s = (e * u - 1) * Math.pow(2, i), o += c) : (s = e * Math.pow(2, c - 1) * Math.pow(2, i), o = 0)); i >= 8; t[r + y] = 255 & s, y += f, s /= 256, i -= 8);
                for (o = o << i | s, l += i; l > 0; t[r + y] = 255 & o, y += f, o /= 256, l -= 8);
                t[r + y - f] |= 128 * d;
            },
            Ds = Es;

        function Es(t) {
            this.buf = ArrayBuffer.isView && ArrayBuffer.isView(t) ? t : new Uint8Array(t || 0), this.pos = 0, this.type = 0, this.length = this.buf.length;
        }
        Es.Varint = 0, Es.Fixed64 = 1, Es.Bytes = 2, Es.Fixed32 = 5;
        var Fs = "undefined" == typeof TextDecoder ? null : new TextDecoder("utf8");

        function qs(t) {
            return t.type === Es.Bytes ? t.readVarint() + t.pos : t.pos + 1
        }

        function Os(t, e, r) {
            return r ? 4294967296 * e + (t >>> 0) : 4294967296 * (e >>> 0) + (t >>> 0)
        }

        function Us(t, e, r) {
            var n = e <= 16383 ? 1 : e <= 2097151 ? 2 : e <= 268435455 ? 3 : Math.floor(Math.log(e) / (7 * Math.LN2));
            r.realloc(n);
            for (var i = r.pos - 1; i >= t; i--) r.buf[i + n] = r.buf[i];
        }

        function Rs(t, e) {
            for (var r = 0; r < t.length; r++) e.writeVarint(t[r]);
        }

        function js(t, e) {
            for (var r = 0; r < t.length; r++) e.writeSVarint(t[r]);
        }

        function Ns(t, e) {
            for (var r = 0; r < t.length; r++) e.writeFloat(t[r]);
        }

        function Ks(t, e) {
            for (var r = 0; r < t.length; r++) e.writeDouble(t[r]);
        }

        function Xs(t, e) {
            for (var r = 0; r < t.length; r++) e.writeBoolean(t[r]);
        }

        function Gs(t, e) {
            for (var r = 0; r < t.length; r++) e.writeFixed32(t[r]);
        }

        function Hs(t, e) {
            for (var r = 0; r < t.length; r++) e.writeSFixed32(t[r]);
        }

        function Ys(t, e) {
            for (var r = 0; r < t.length; r++) e.writeFixed64(t[r]);
        }

        function Zs(t, e) {
            for (var r = 0; r < t.length; r++) e.writeSFixed64(t[r]);
        }

        function Js(t, e) {
            return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + 16777216 * t[e + 3]
        }

        function $s(t, e, r) {
            t[r] = e, t[r + 1] = e >>> 8, t[r + 2] = e >>> 16, t[r + 3] = e >>> 24;
        }

        function Ws(t, e) {
            return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + (t[e + 3] << 24)
        }

        function Qs(t, e, r) {
            1 === t && r.readMessage(tu, e);
        }

        function tu(t, e, r) {
            if (3 === t) {
                var n = r.readMessage(eu, {}),
                    i = n.width,
                    a = n.height,
                    o = n.left,
                    s = n.top,
                    u = n.advance;
                e.push({
                    id: n.id,
                    bitmap: new ro({
                        width: i + 6,
                        height: a + 6
                    }, n.bitmap),
                    metrics: {
                        width: i,
                        height: a,
                        left: o,
                        top: s,
                        advance: u
                    }
                });
            }
        }

        function eu(t, e, r) {
            1 === t ? e.id = r.readVarint() : 2 === t ? e.bitmap = r.readBytes() : 3 === t ? e.width = r.readVarint() : 4 === t ? e.height = r.readVarint() : 5 === t ? e.left = r.readSVarint() : 6 === t ? e.top = r.readSVarint() : 7 === t && (e.advance = r.readVarint());
        }

        function ru(t) {
            for (var e = 0, r = 0, n = 0, i = t; n < i.length; n += 1) {
                var a = i[n];
                e += a.w * a.h, r = Math.max(r, a.w);
            }
            t.sort((function (t, e) {
                return e.h - t.h
            }));
            for (var o = [{
                    x: 0,
                    y: 0,
                    w: Math.max(Math.ceil(Math.sqrt(e / .95)), r),
                    h: 1 / 0
                }], s = 0, u = 0, l = 0, p = t; l < p.length; l += 1)
                for (var c = p[l], h = o.length - 1; h >= 0; h--) {
                    var y = o[h];
                    if (!(c.w > y.w || c.h > y.h)) {
                        if (c.x = y.x, c.y = y.y, u = Math.max(u, c.y + c.h), s = Math.max(s, c.x + c.w), c.w === y.w && c.h === y.h) {
                            var f = o.pop();
                            h < o.length && (o[h] = f);
                        } else c.h === y.h ? (y.x += c.w, y.w -= c.w) : c.w === y.w ? (y.y += c.h, y.h -= c.h) : (o.push({
                            x: y.x + c.w,
                            y: y.y,
                            w: y.w - c.w,
                            h: c.h
                        }), y.y += c.h, y.h -= c.h);
                        break
                    }
                }
            return {
                w: s,
                h: u,
                fill: e / (s * u) || 0
            }
        }
        Es.prototype = {
            destroy: function () {
                this.buf = null;
            },
            readFields: function (t, e, r) {
                for (r = r || this.length; this.pos < r;) {
                    var n = this.readVarint(),
                        i = n >> 3,
                        a = this.pos;
                    this.type = 7 & n, t(i, e, this), this.pos === a && this.skip(n);
                }
                return e
            },
            readMessage: function (t, e) {
                return this.readFields(t, e, this.readVarint() + this.pos)
            },
            readFixed32: function () {
                var t = Js(this.buf, this.pos);
                return this.pos += 4, t
            },
            readSFixed32: function () {
                var t = Ws(this.buf, this.pos);
                return this.pos += 4, t
            },
            readFixed64: function () {
                var t = Js(this.buf, this.pos) + 4294967296 * Js(this.buf, this.pos + 4);
                return this.pos += 8, t
            },
            readSFixed64: function () {
                var t = Js(this.buf, this.pos) + 4294967296 * Ws(this.buf, this.pos + 4);
                return this.pos += 8, t
            },
            readFloat: function () {
                var t = Ls(this.buf, this.pos, !0, 23, 4);
                return this.pos += 4, t
            },
            readDouble: function () {
                var t = Ls(this.buf, this.pos, !0, 52, 8);
                return this.pos += 8, t
            },
            readVarint: function (t) {
                var e, r, n = this.buf;
                return e = 127 & (r = n[this.pos++]), r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 7, r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 14, r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 21, r < 128 ? e : function (t, e, r) {
                    var n, i, a = r.buf;
                    if (n = (112 & (i = a[r.pos++])) >> 4, i < 128) return Os(t, n, e);
                    if (n |= (127 & (i = a[r.pos++])) << 3, i < 128) return Os(t, n, e);
                    if (n |= (127 & (i = a[r.pos++])) << 10, i < 128) return Os(t, n, e);
                    if (n |= (127 & (i = a[r.pos++])) << 17, i < 128) return Os(t, n, e);
                    if (n |= (127 & (i = a[r.pos++])) << 24, i < 128) return Os(t, n, e);
                    if (n |= (1 & (i = a[r.pos++])) << 31, i < 128) return Os(t, n, e);
                    throw new Error("Expected varint not more than 10 bytes")
                }(e |= (15 & (r = n[this.pos])) << 28, t, this))))
            },
            readVarint64: function () {
                return this.readVarint(!0)
            },
            readSVarint: function () {
                var t = this.readVarint();
                return t % 2 == 1 ? (t + 1) / -2 : t / 2
            },
            readBoolean: function () {
                return Boolean(this.readVarint())
            },
            readString: function () {
                var t = this.readVarint() + this.pos,
                    e = this.pos;
                return this.pos = t, t - e >= 12 && Fs ? function (t, e, r) {
                    return Fs.decode(t.subarray(e, r))
                }(this.buf, e, t) : function (t, e, r) {
                    for (var n = "", i = e; i < r;) {
                        var a, o, s, u = t[i],
                            l = null,
                            p = u > 239 ? 4 : u > 223 ? 3 : u > 191 ? 2 : 1;
                        if (i + p > r) break;
                        1 === p ? u < 128 && (l = u) : 2 === p ? 128 == (192 & (a = t[i + 1])) && (l = (31 & u) << 6 | 63 & a) <= 127 && (l = null) : 3 === p ? (o = t[i + 2], 128 == (192 & (a = t[i + 1])) && 128 == (192 & o) && ((l = (15 & u) << 12 | (63 & a) << 6 | 63 & o) <= 2047 || l >= 55296 && l <= 57343) && (l = null)) : 4 === p && (o = t[i + 2], s = t[i + 3], 128 == (192 & (a = t[i + 1])) && 128 == (192 & o) && 128 == (192 & s) && ((l = (15 & u) << 18 | (63 & a) << 12 | (63 & o) << 6 | 63 & s) <= 65535 || l >= 1114112) && (l = null)), null === l ? (l = 65533, p = 1) : l > 65535 && (l -= 65536, n += String.fromCharCode(l >>> 10 & 1023 | 55296), l = 56320 | 1023 & l), n += String.fromCharCode(l), i += p;
                    }
                    return n
                }(this.buf, e, t)
            },
            readBytes: function () {
                var t = this.readVarint() + this.pos,
                    e = this.buf.subarray(this.pos, t);
                return this.pos = t, e
            },
            readPackedVarint: function (t, e) {
                if (this.type !== Es.Bytes) return t.push(this.readVarint(e));
                var r = qs(this);
                for (t = t || []; this.pos < r;) t.push(this.readVarint(e));
                return t
            },
            readPackedSVarint: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readSVarint());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readSVarint());
                return t
            },
            readPackedBoolean: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readBoolean());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readBoolean());
                return t
            },
            readPackedFloat: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readFloat());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readFloat());
                return t
            },
            readPackedDouble: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readDouble());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readDouble());
                return t
            },
            readPackedFixed32: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readFixed32());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readFixed32());
                return t
            },
            readPackedSFixed32: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readSFixed32());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readSFixed32());
                return t
            },
            readPackedFixed64: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readFixed64());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readFixed64());
                return t
            },
            readPackedSFixed64: function (t) {
                if (this.type !== Es.Bytes) return t.push(this.readSFixed64());
                var e = qs(this);
                for (t = t || []; this.pos < e;) t.push(this.readSFixed64());
                return t
            },
            skip: function (t) {
                var e = 7 & t;
                if (e === Es.Varint)
                    for (; this.buf[this.pos++] > 127;);
                else if (e === Es.Bytes) this.pos = this.readVarint() + this.pos;
                else if (e === Es.Fixed32) this.pos += 4;
                else {
                    if (e !== Es.Fixed64) throw new Error("Unimplemented type: " + e);
                    this.pos += 8;
                }
            },
            writeTag: function (t, e) {
                this.writeVarint(t << 3 | e);
            },
            realloc: function (t) {
                for (var e = this.length || 16; e < this.pos + t;) e *= 2;
                if (e !== this.length) {
                    var r = new Uint8Array(e);
                    r.set(this.buf), this.buf = r, this.length = e;
                }
            },
            finish: function () {
                return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length)
            },
            writeFixed32: function (t) {
                this.realloc(4), $s(this.buf, t, this.pos), this.pos += 4;
            },
            writeSFixed32: function (t) {
                this.realloc(4), $s(this.buf, t, this.pos), this.pos += 4;
            },
            writeFixed64: function (t) {
                this.realloc(8), $s(this.buf, -1 & t, this.pos), $s(this.buf, Math.floor(t * (1 / 4294967296)), this.pos + 4), this.pos += 8;
            },
            writeSFixed64: function (t) {
                this.realloc(8), $s(this.buf, -1 & t, this.pos), $s(this.buf, Math.floor(t * (1 / 4294967296)), this.pos + 4), this.pos += 8;
            },
            writeVarint: function (t) {
                (t = +t || 0) > 268435455 || t < 0 ? function (t, e) {
                    var r, n;
                    if (t >= 0 ? (r = t % 4294967296 | 0, n = t / 4294967296 | 0) : (n = ~(-t / 4294967296), 4294967295 ^ (r = ~(-t % 4294967296)) ? r = r + 1 | 0 : (r = 0, n = n + 1 | 0)), t >= 0x10000000000000000 || t < -0x10000000000000000) throw new Error("Given varint doesn't fit into 10 bytes");
                    e.realloc(10),
                        function (t, e, r) {
                            r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, r.buf[r.pos] = 127 & (t >>>= 7);
                        }(r, 0, e),
                        function (t, e) {
                            var r = (7 & t) << 4;
                            e.buf[e.pos++] |= r | ((t >>>= 3) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t)))));
                        }(n, e);
                }(t, this) : (this.realloc(4), this.buf[this.pos++] = 127 & t | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = t >>> 7 & 127))));
            },
            writeSVarint: function (t) {
                this.writeVarint(t < 0 ? 2 * -t - 1 : 2 * t);
            },
            writeBoolean: function (t) {
                this.writeVarint(Boolean(t));
            },
            writeString: function (t) {
                t = String(t), this.realloc(4 * t.length), this.pos++;
                var e = this.pos;
                this.pos = function (t, e, r) {
                    for (var n, i, a = 0; a < e.length; a++) {
                        if ((n = e.charCodeAt(a)) > 55295 && n < 57344) {
                            if (!i) {
                                n > 56319 || a + 1 === e.length ? (t[r++] = 239, t[r++] = 191, t[r++] = 189) : i = n;
                                continue
                            }
                            if (n < 56320) {
                                t[r++] = 239, t[r++] = 191, t[r++] = 189, i = n;
                                continue
                            }
                            n = i - 55296 << 10 | n - 56320 | 65536, i = null;
                        } else i && (t[r++] = 239, t[r++] = 191, t[r++] = 189, i = null);
                        n < 128 ? t[r++] = n : (n < 2048 ? t[r++] = n >> 6 | 192 : (n < 65536 ? t[r++] = n >> 12 | 224 : (t[r++] = n >> 18 | 240, t[r++] = n >> 12 & 63 | 128), t[r++] = n >> 6 & 63 | 128), t[r++] = 63 & n | 128);
                    }
                    return r
                }(this.buf, t, this.pos);
                var r = this.pos - e;
                r >= 128 && Us(e, r, this), this.pos = e - 1, this.writeVarint(r), this.pos += r;
            },
            writeFloat: function (t) {
                this.realloc(4), Ts(this.buf, t, this.pos, !0, 23, 4), this.pos += 4;
            },
            writeDouble: function (t) {
                this.realloc(8), Ts(this.buf, t, this.pos, !0, 52, 8), this.pos += 8;
            },
            writeBytes: function (t) {
                var e = t.length;
                this.writeVarint(e), this.realloc(e);
                for (var r = 0; r < e; r++) this.buf[this.pos++] = t[r];
            },
            writeRawMessage: function (t, e) {
                this.pos++;
                var r = this.pos;
                t(e, this);
                var n = this.pos - r;
                n >= 128 && Us(r, n, this), this.pos = r - 1, this.writeVarint(n), this.pos += n;
            },
            writeMessage: function (t, e, r) {
                this.writeTag(t, Es.Bytes), this.writeRawMessage(e, r);
            },
            writePackedVarint: function (t, e) {
                e.length && this.writeMessage(t, Rs, e);
            },
            writePackedSVarint: function (t, e) {
                e.length && this.writeMessage(t, js, e);
            },
            writePackedBoolean: function (t, e) {
                e.length && this.writeMessage(t, Xs, e);
            },
            writePackedFloat: function (t, e) {
                e.length && this.writeMessage(t, Ns, e);
            },
            writePackedDouble: function (t, e) {
                e.length && this.writeMessage(t, Ks, e);
            },
            writePackedFixed32: function (t, e) {
                e.length && this.writeMessage(t, Gs, e);
            },
            writePackedSFixed32: function (t, e) {
                e.length && this.writeMessage(t, Hs, e);
            },
            writePackedFixed64: function (t, e) {
                e.length && this.writeMessage(t, Ys, e);
            },
            writePackedSFixed64: function (t, e) {
                e.length && this.writeMessage(t, Zs, e);
            },
            writeBytesField: function (t, e) {
                this.writeTag(t, Es.Bytes), this.writeBytes(e);
            },
            writeFixed32Field: function (t, e) {
                this.writeTag(t, Es.Fixed32), this.writeFixed32(e);
            },
            writeSFixed32Field: function (t, e) {
                this.writeTag(t, Es.Fixed32), this.writeSFixed32(e);
            },
            writeFixed64Field: function (t, e) {
                this.writeTag(t, Es.Fixed64), this.writeFixed64(e);
            },
            writeSFixed64Field: function (t, e) {
                this.writeTag(t, Es.Fixed64), this.writeSFixed64(e);
            },
            writeVarintField: function (t, e) {
                this.writeTag(t, Es.Varint), this.writeVarint(e);
            },
            writeSVarintField: function (t, e) {
                this.writeTag(t, Es.Varint), this.writeSVarint(e);
            },
            writeStringField: function (t, e) {
                this.writeTag(t, Es.Bytes), this.writeString(e);
            },
            writeFloatField: function (t, e) {
                this.writeTag(t, Es.Fixed32), this.writeFloat(e);
            },
            writeDoubleField: function (t, e) {
                this.writeTag(t, Es.Fixed64), this.writeDouble(e);
            },
            writeBooleanField: function (t, e) {
                this.writeVarintField(t, Boolean(e));
            }
        };
        var nu = function (t, e) {
                var r = e.pixelRatio,
                    n = e.version,
                    i = e.stretchX,
                    a = e.stretchY,
                    o = e.content;
                this.paddedRect = t, this.pixelRatio = r, this.stretchX = i, this.stretchY = a, this.content = o, this.version = n;
            },
            iu = {
                tl: {
                    configurable: !0
                },
                br: {
                    configurable: !0
                },
                tlbr: {
                    configurable: !0
                },
                displaySize: {
                    configurable: !0
                }
            };
        iu.tl.get = function () {
            return [this.paddedRect.x + 1, this.paddedRect.y + 1]
        }, iu.br.get = function () {
            return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1]
        }, iu.tlbr.get = function () {
            return this.tl.concat(this.br)
        }, iu.displaySize.get = function () {
            return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio]
        }, Object.defineProperties(nu.prototype, iu);
        var au = function (t, e) {
            var r = {},
                n = {};
            this.haveRenderCallbacks = [];
            var i = [];
            this.addImages(t, r, i), this.addImages(e, n, i);
            var a = ru(i),
                o = new no({
                    width: a.w || 1,
                    height: a.h || 1
                });
            for (var s in t) {
                var u = t[s],
                    l = r[s].paddedRect;
                no.copy(u.data, o, {
                    x: 0,
                    y: 0
                }, {
                    x: l.x + 1,
                    y: l.y + 1
                }, u.data);
            }
            for (var p in e) {
                var c = e[p],
                    h = n[p].paddedRect,
                    y = h.x + 1,
                    f = h.y + 1,
                    d = c.data.width,
                    m = c.data.height;
                no.copy(c.data, o, {
                    x: 0,
                    y: 0
                }, {
                    x: y,
                    y: f
                }, c.data), no.copy(c.data, o, {
                    x: 0,
                    y: m - 1
                }, {
                    x: y,
                    y: f - 1
                }, {
                    width: d,
                    height: 1
                }), no.copy(c.data, o, {
                    x: 0,
                    y: 0
                }, {
                    x: y,
                    y: f + m
                }, {
                    width: d,
                    height: 1
                }), no.copy(c.data, o, {
                    x: d - 1,
                    y: 0
                }, {
                    x: y - 1,
                    y: f
                }, {
                    width: 1,
                    height: m
                }), no.copy(c.data, o, {
                    x: 0,
                    y: 0
                }, {
                    x: y + d,
                    y: f
                }, {
                    width: 1,
                    height: m
                });
            }
            this.image = o, this.iconPositions = r, this.patternPositions = n;
        };
        au.prototype.addImages = function (t, e, r) {
            for (var n in t) {
                var i = t[n],
                    a = {
                        x: 0,
                        y: 0,
                        w: i.data.width + 2,
                        h: i.data.height + 2
                    };
                r.push(a), e[n] = new nu(a, i), i.hasRenderCallback && this.haveRenderCallbacks.push(n);
            }
        }, au.prototype.patchUpdatedImages = function (t, e) {
            for (var r in t.dispatchRenderCallbacks(this.haveRenderCallbacks), t.updatedImages) this.patchUpdatedImage(this.iconPositions[r], t.getImage(r), e), this.patchUpdatedImage(this.patternPositions[r], t.getImage(r), e);
        }, au.prototype.patchUpdatedImage = function (t, e, r) {
            if (t && e && t.version !== e.version) {
                t.version = e.version;
                var n = t.tl;
                r.update(e.data, void 0, {
                    x: n[0],
                    y: n[1]
                });
            }
        }, xn("ImagePosition", nu), xn("ImageAtlas", au);
        var ou = {
                horizontal: 1,
                vertical: 2,
                horizontalOnly: 3
            },
            su = function () {
                this.scale = 1, this.fontStack = "", this.imageName = null;
            };
        su.forText = function (t, e) {
            var r = new su;
            return r.scale = t || 1, r.fontStack = e, r
        }, su.forImage = function (t) {
            var e = new su;
            return e.imageName = t, e
        };
        var uu = function () {
            this.text = "", this.sectionIndex = [], this.sections = [], this.imageSectionID = null;
        };

        function lu(t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d) {
            var m, g = uu.fromFeature(t, i);
            c === ou.vertical && g.verticalizePunctuation();
            var v = Rn.processBidirectionalText,
                x = Rn.processStyledBidirectionalText;
            if (v && 1 === g.sections.length) {
                m = [];
                for (var b = 0, _ = v(g.toString(), mu(g, l, a, e, n, y, f)); b < _.length; b += 1) {
                    var w = _[b],
                        k = new uu;
                    k.text = w, k.sections = g.sections;
                    for (var A = 0; A < w.length; A++) k.sectionIndex.push(0);
                    m.push(k);
                }
            } else if (x) {
                m = [];
                for (var S = 0, I = x(g.text, g.sectionIndex, mu(g, l, a, e, n, y, f)); S < I.length; S += 1) {
                    var z = I[S],
                        B = new uu;
                    B.text = z[0], B.sectionIndex = z[1], B.sections = g.sections, m.push(B);
                }
            } else m = function (t, e) {
                for (var r = [], n = t.text, i = 0, a = 0, o = e; a < o.length; a += 1) {
                    var s = o[a];
                    r.push(t.substring(i, s)), i = s;
                }
                return i < n.length && r.push(t.substring(i, n.length)), r
            }(g, mu(g, l, a, e, n, y, f));
            var V = [],
                C = {
                    positionedLines: V,
                    text: g.toString(),
                    top: p[1],
                    bottom: p[1],
                    left: p[0],
                    right: p[0],
                    writingMode: c,
                    iconsInText: !1,
                    verticalizable: !1
                };
            return function (t, e, r, n, i, a, o, s, u, l, p, c) {
                for (var h = 0, y = -17, f = 0, d = 0, m = "right" === s ? 1 : "left" === s ? 0 : .5, g = 0, v = 0, x = i; v < x.length; v += 1) {
                    var b = x[v];
                    b.trim();
                    var _ = b.getMaxScale(),
                        w = 24 * (_ - 1),
                        k = {
                            positionedGlyphs: [],
                            lineOffset: 0
                        };
                    t.positionedLines[g] = k;
                    var A = k.positionedGlyphs,
                        S = 0;
                    if (b.length()) {
                        for (var I = 0; I < b.length(); I++) {
                            var z = b.getSection(I),
                                B = b.getSectionIndex(I),
                                V = b.getCharCode(I),
                                C = 0,
                                M = null,
                                P = null,
                                L = null,
                                T = 24,
                                D = !(u === ou.horizontal || !p && !Bn(V) || p && (pu[V] || (K = V, In.Arabic(K) || In["Arabic Supplement"](K) || In["Arabic Extended-A"](K) || In["Arabic Presentation Forms-A"](K) || In["Arabic Presentation Forms-B"](K))));
                            if (z.imageName) {
                                var E = n[z.imageName];
                                if (!E) continue;
                                L = z.imageName, t.iconsInText = t.iconsInText || !0, P = E.paddedRect;
                                var F = E.displaySize;
                                z.scale = 24 * z.scale / c, C = w + (24 - F[1] * z.scale), T = (M = {
                                    width: F[0],
                                    height: F[1],
                                    left: 1,
                                    top: -3,
                                    advance: D ? F[1] : F[0]
                                }).advance;
                                var q = D ? F[0] * z.scale - 24 * _ : F[1] * z.scale - 24 * _;
                                q > 0 && q > S && (S = q);
                            } else {
                                var O = r[z.fontStack],
                                    U = O && O[V];
                                if (U && U.rect) P = U.rect, M = U.metrics;
                                else {
                                    var R = e[z.fontStack],
                                        j = R && R[V];
                                    if (!j) continue;
                                    M = j.metrics;
                                }
                                C = 24 * (_ - z.scale);
                            }
                            D ? (t.verticalizable = !0, A.push({
                                glyph: V,
                                imageName: L,
                                x: h,
                                y: y + C,
                                vertical: D,
                                scale: z.scale,
                                fontStack: z.fontStack,
                                sectionIndex: B,
                                metrics: M,
                                rect: P
                            }), h += T * z.scale + l) : (A.push({
                                glyph: V,
                                imageName: L,
                                x: h,
                                y: y + C,
                                vertical: D,
                                scale: z.scale,
                                fontStack: z.fontStack,
                                sectionIndex: B,
                                metrics: M,
                                rect: P
                            }), h += M.advance * z.scale + l);
                        }
                        0 !== A.length && (f = Math.max(h - l, f), vu(A, 0, A.length - 1, m, S)), h = 0;
                        var N = a * _ + S;
                        k.lineOffset = Math.max(S, w), y += N, d = Math.max(N, d), ++g;
                    } else y += a, ++g;
                }
                var K, X = y - -17,
                    G = gu(o),
                    H = G.horizontalAlign,
                    Y = G.verticalAlign;
                (function (t, e, r, n, i, a, o, s, u) {
                    var l, p = (e - r) * i;
                    l = a !== o ? -s * n - -17 : (-n * u + .5) * o;
                    for (var c = 0, h = t; c < h.length; c += 1)
                        for (var y = 0, f = h[c].positionedGlyphs; y < f.length; y += 1) {
                            var d = f[y];
                            d.x += p, d.y += l;
                        }
                })(t.positionedLines, m, H, Y, f, d, a, X, i.length), t.top += -Y * X, t.bottom = t.top + X, t.left += -H * f, t.right = t.left + f;
            }(C, e, r, n, m, o, s, u, c, l, h, d), ! function (t) {
                for (var e = 0, r = t; e < r.length; e += 1)
                    if (0 !== r[e].positionedGlyphs.length) return !1;
                return !0
            }(V) && C
        }
        uu.fromFeature = function (t, e) {
            for (var r = new uu, n = 0; n < t.sections.length; n++) {
                var i = t.sections[n];
                i.image ? r.addImageSection(i) : r.addTextSection(i, e);
            }
            return r
        }, uu.prototype.length = function () {
            return this.text.length
        }, uu.prototype.getSection = function (t) {
            return this.sections[this.sectionIndex[t]]
        }, uu.prototype.getSectionIndex = function (t) {
            return this.sectionIndex[t]
        }, uu.prototype.getCharCode = function (t) {
            return this.text.charCodeAt(t)
        }, uu.prototype.verticalizePunctuation = function () {
            this.text = function (t) {
                for (var e = "", r = 0; r < t.length; r++) {
                    var n = t.charCodeAt(r + 1) || null,
                        i = t.charCodeAt(r - 1) || null;
                    e += n && Vn(n) && !Ps[t[r + 1]] || i && Vn(i) && !Ps[t[r - 1]] || !Ps[t[r]] ? t[r] : Ps[t[r]];
                }
                return e
            }(this.text);
        }, uu.prototype.trim = function () {
            for (var t = 0, e = 0; e < this.text.length && pu[this.text.charCodeAt(e)]; e++) t++;
            for (var r = this.text.length, n = this.text.length - 1; n >= 0 && n >= t && pu[this.text.charCodeAt(n)]; n--) r--;
            this.text = this.text.substring(t, r), this.sectionIndex = this.sectionIndex.slice(t, r);
        }, uu.prototype.substring = function (t, e) {
            var r = new uu;
            return r.text = this.text.substring(t, e), r.sectionIndex = this.sectionIndex.slice(t, e), r.sections = this.sections, r
        }, uu.prototype.toString = function () {
            return this.text
        }, uu.prototype.getMaxScale = function () {
            var t = this;
            return this.sectionIndex.reduce((function (e, r) {
                return Math.max(e, t.sections[r].scale)
            }), 0)
        }, uu.prototype.addTextSection = function (t, e) {
            this.text += t.text, this.sections.push(su.forText(t.scale, t.fontStack || e));
            for (var r = this.sections.length - 1, n = 0; n < t.text.length; ++n) this.sectionIndex.push(r);
        }, uu.prototype.addImageSection = function (t) {
            var e = t.image ? t.image.name : "";
            if (0 !== e.length) {
                var r = this.getNextImageSectionCharCode();
                r ? (this.text += String.fromCharCode(r), this.sections.push(su.forImage(e)), this.sectionIndex.push(this.sections.length - 1)) : x("Reached maximum number of images 6401");
            } else x("Can't add FormattedSection with an empty image.");
        }, uu.prototype.getNextImageSectionCharCode = function () {
            return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344, this.imageSectionID)
        };
        var pu = {
                9: !0,
                10: !0,
                11: !0,
                12: !0,
                13: !0,
                32: !0
            },
            cu = {};

        function hu(t, e, r, n, i, a) {
            if (e.imageName) {
                var o = n[e.imageName];
                return o ? o.displaySize[0] * e.scale * 24 / a + i : 0
            }
            var s = r[e.fontStack],
                u = s && s[t];
            return u ? u.metrics.advance * e.scale + i : 0
        }

        function yu(t, e, r, n) {
            var i = Math.pow(t - e, 2);
            return n ? t < e ? i / 2 : 2 * i : i + Math.abs(r) * r
        }

        function fu(t, e, r) {
            var n = 0;
            return 10 === t && (n -= 1e4), r && (n += 150), 40 !== t && 65288 !== t || (n += 50), 41 !== e && 65289 !== e || (n += 50), n
        }

        function du(t, e, r, n, i, a) {
            for (var o = null, s = yu(e, r, i, a), u = 0, l = n; u < l.length; u += 1) {
                var p = l[u],
                    c = yu(e - p.x, r, i, a) + p.badness;
                c <= s && (o = p, s = c);
            }
            return {
                index: t,
                x: e,
                priorBreak: o,
                badness: s
            }
        }

        function mu(t, e, r, n, i, a, o) {
            if ("point" !== a) return [];
            if (!t) return [];
            for (var s, u = [], l = function (t, e, r, n, i, a) {
                    for (var o = 0, s = 0; s < t.length(); s++) {
                        var u = t.getSection(s);
                        o += hu(t.getCharCode(s), u, n, i, e, a);
                    }
                    return o / Math.max(1, Math.ceil(o / r))
                }(t, e, r, n, i, o), p = t.text.indexOf("​") >= 0, c = 0, h = 0; h < t.length(); h++) {
                var y = t.getSection(h),
                    f = t.getCharCode(h);
                if (pu[f] || (c += hu(f, y, n, i, e, o)), h < t.length() - 1) {
                    var d = !((s = f) < 11904 || !(In["Bopomofo Extended"](s) || In.Bopomofo(s) || In["CJK Compatibility Forms"](s) || In["CJK Compatibility Ideographs"](s) || In["CJK Compatibility"](s) || In["CJK Radicals Supplement"](s) || In["CJK Strokes"](s) || In["CJK Symbols and Punctuation"](s) || In["CJK Unified Ideographs Extension A"](s) || In["CJK Unified Ideographs"](s) || In["Enclosed CJK Letters and Months"](s) || In["Halfwidth and Fullwidth Forms"](s) || In.Hiragana(s) || In["Ideographic Description Characters"](s) || In["Kangxi Radicals"](s) || In["Katakana Phonetic Extensions"](s) || In.Katakana(s) || In["Vertical Forms"](s) || In["Yi Radicals"](s) || In["Yi Syllables"](s)));
                    (cu[f] || d || y.imageName) && u.push(du(h + 1, c, l, u, fu(f, t.getCharCode(h + 1), d && p), !1));
                }
            }
            return function t(e) {
                return e ? t(e.priorBreak).concat(e.index) : []
            }(du(t.length(), c, l, u, 0, !0))
        }

        function gu(t) {
            var e = .5,
                r = .5;
            switch (t) {
                case "right":
                case "top-right":
                case "bottom-right":
                    e = 1;
                    break;
                case "left":
                case "top-left":
                case "bottom-left":
                    e = 0;
            }
            switch (t) {
                case "bottom":
                case "bottom-right":
                case "bottom-left":
                    r = 1;
                    break;
                case "top":
                case "top-right":
                case "top-left":
                    r = 0;
            }
            return {
                horizontalAlign: e,
                verticalAlign: r
            }
        }

        function vu(t, e, r, n, i) {
            if (n || i)
                for (var a = t[r], o = (t[r].x + a.metrics.advance * a.scale) * n, s = e; s <= r; s++) t[s].x -= o, t[s].y += i;
        }

        function xu(t, e, r, n, i, a) {
            var o, s = t.image;
            if (s.content) {
                var u = s.content,
                    l = s.pixelRatio || 1;
                o = [u[0] / l, u[1] / l, s.displaySize[0] - u[2] / l, s.displaySize[1] - u[3] / l];
            }
            var p, c, h, y, f = e.left * a,
                d = e.right * a;
            "width" === r || "both" === r ? (y = i[0] + f - n[3], c = i[0] + d + n[1]) : c = (y = i[0] + (f + d - s.displaySize[0]) / 2) + s.displaySize[0];
            var m = e.top * a,
                g = e.bottom * a;
            return "height" === r || "both" === r ? (p = i[1] + m - n[0], h = i[1] + g + n[2]) : h = (p = i[1] + (m + g - s.displaySize[1]) / 2) + s.displaySize[1], {
                image: s,
                top: p,
                right: c,
                bottom: h,
                left: y,
                collisionPadding: o
            }
        }
        cu[10] = !0, cu[32] = !0, cu[38] = !0, cu[40] = !0, cu[41] = !0, cu[43] = !0, cu[45] = !0, cu[47] = !0, cu[173] = !0, cu[183] = !0, cu[8203] = !0, cu[8208] = !0, cu[8211] = !0, cu[8231] = !0;
        var bu = function (t) {
            function e(e, r, n, i) {
                t.call(this, e, r), this.angle = n, void 0 !== i && (this.segment = i);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.clone = function () {
                return new e(this.x, this.y, this.angle, this.segment)
            }, e
        }(i);

        function _u(t, e) {
            var r = e.expression;
            if ("constant" === r.kind) return {
                kind: "constant",
                layoutSize: r.evaluate(new jn(t + 1))
            };
            if ("source" === r.kind) return {
                kind: "source"
            };
            for (var n = r.zoomStops, i = r.interpolationType, a = 0; a < n.length && n[a] <= t;) a++;
            for (var o = a = Math.max(0, a - 1); o < n.length && n[o] < t + 1;) o++;
            o = Math.min(n.length - 1, o);
            var s = n[a],
                u = n[o];
            return "composite" === r.kind ? {
                kind: "composite",
                minZoom: s,
                maxZoom: u,
                interpolationType: i
            } : {
                kind: "camera",
                minZoom: s,
                maxZoom: u,
                minSize: r.evaluate(new jn(s)),
                maxSize: r.evaluate(new jn(u)),
                interpolationType: i
            }
        }

        function wu(t, e, r) {
            var n = e.uSize,
                i = r.lowerSize;
            return "source" === t.kind ? i / 128 : "composite" === t.kind ? Ae(i / 128, r.upperSize / 128, e.uSizeT) : n
        }

        function ku(t, e) {
            var r = 0,
                n = 0;
            if ("constant" === t.kind) n = t.layoutSize;
            else if ("source" !== t.kind) {
                var i = t.interpolationType,
                    a = i ? u(Oe.interpolationFactor(i, e, t.minZoom, t.maxZoom), 0, 1) : 0;
                "camera" === t.kind ? n = Ae(t.minSize, t.maxSize, a) : r = a;
            }
            return {
                uSizeT: r,
                uSize: n
            }
        }
        xn("Anchor", bu);
        var Au = Object.freeze({
            __proto__: null,
            getSizeData: _u,
            evaluateSizeForFeature: wu,
            evaluateSizeForZoom: ku,
            SIZE_PACK_FACTOR: 128
        });

        function Su(t, e, r, n, i) {
            if (void 0 === e.segment) return !0;
            for (var a = e, o = e.segment + 1, s = 0; s > -r / 2;) {
                if (--o < 0) return !1;
                s -= t[o].dist(a), a = t[o];
            }
            s += t[o].dist(t[o + 1]), o++;
            for (var u = [], l = 0; s < r / 2;) {
                var p = t[o],
                    c = t[o + 1];
                if (!c) return !1;
                var h = t[o - 1].angleTo(p) - p.angleTo(c);
                for (h = Math.abs((h + 3 * Math.PI) % (2 * Math.PI) - Math.PI), u.push({
                        distance: s,
                        angleDelta: h
                    }), l += h; s - u[0].distance > n;) l -= u.shift().angleDelta;
                if (l > i) return !1;
                o++, s += p.dist(c);
            }
            return !0
        }

        function Iu(t) {
            for (var e = 0, r = 0; r < t.length - 1; r++) e += t[r].dist(t[r + 1]);
            return e
        }

        function zu(t, e, r) {
            return t ? .6 * e * r : 0
        }

        function Bu(t, e) {
            return Math.max(t ? t.right - t.left : 0, e ? e.right - e.left : 0)
        }

        function Vu(t, e, r, n, i, a) {
            for (var o = zu(r, i, a), s = Bu(r, n) * a, u = 0, l = Iu(t) / 2, p = 0; p < t.length - 1; p++) {
                var c = t[p],
                    h = t[p + 1],
                    y = c.dist(h);
                if (u + y > l) {
                    var f = (l - u) / y,
                        d = Ae(c.x, h.x, f),
                        m = Ae(c.y, h.y, f),
                        g = new bu(d, m, h.angleTo(c), p);
                    return g._round(), !o || Su(t, g, s, o, e) ? g : void 0
                }
                u += y;
            }
        }

        function Cu(t, e, r, n, i, a, o, s, u) {
            var l = zu(n, a, o),
                p = Bu(n, i),
                c = p * o,
                h = 0 === t[0].x || t[0].x === u || 0 === t[0].y || t[0].y === u;
            return e - c < e / 4 && (e = c + e / 4),
                function t(e, r, n, i, a, o, s, u, l) {
                    for (var p = o / 2, c = Iu(e), h = 0, y = r - n, f = [], d = 0; d < e.length - 1; d++) {
                        for (var m = e[d], g = e[d + 1], v = m.dist(g), x = g.angleTo(m); y + n < h + v;) {
                            var b = ((y += n) - h) / v,
                                _ = Ae(m.x, g.x, b),
                                w = Ae(m.y, g.y, b);
                            if (_ >= 0 && _ < l && w >= 0 && w < l && y - p >= 0 && y + p <= c) {
                                var k = new bu(_, w, x, d);
                                k._round(), i && !Su(e, k, o, i, a) || f.push(k);
                            }
                        }
                        h += v;
                    }
                    return u || f.length || s || (f = t(e, h / 2, n, i, a, o, s, !0, l)), f
                }(t, h ? e / 2 * s % e : (p / 2 + 2 * a) * o * s % e, e, l, r, c, h, !1, u)
        }

        function Mu(t, e, r, n, a) {
            for (var o = [], s = 0; s < t.length; s++)
                for (var u = t[s], l = void 0, p = 0; p < u.length - 1; p++) {
                    var c = u[p],
                        h = u[p + 1];
                    c.x < e && h.x < e || (c.x < e ? c = new i(e, c.y + (e - c.x) / (h.x - c.x) * (h.y - c.y))._round() : h.x < e && (h = new i(e, c.y + (e - c.x) / (h.x - c.x) * (h.y - c.y))._round()), c.y < r && h.y < r || (c.y < r ? c = new i(c.x + (r - c.y) / (h.y - c.y) * (h.x - c.x), r)._round() : h.y < r && (h = new i(c.x + (r - c.y) / (h.y - c.y) * (h.x - c.x), r)._round()), c.x >= n && h.x >= n || (c.x >= n ? c = new i(n, c.y + (n - c.x) / (h.x - c.x) * (h.y - c.y))._round() : h.x >= n && (h = new i(n, c.y + (n - c.x) / (h.x - c.x) * (h.y - c.y))._round()), c.y >= a && h.y >= a || (c.y >= a ? c = new i(c.x + (a - c.y) / (h.y - c.y) * (h.x - c.x), a)._round() : h.y >= a && (h = new i(c.x + (a - c.y) / (h.y - c.y) * (h.x - c.x), a)._round()), l && c.equals(l[l.length - 1]) || o.push(l = [c]), l.push(h)))));
                }
            return o
        }

        function Pu(t, e, r, n, a, o) {
            var s = [],
                u = t.image,
                l = u.pixelRatio,
                p = u.paddedRect.w - 2,
                c = u.paddedRect.h - 2,
                h = t.right - t.left,
                y = t.bottom - t.top,
                f = u.stretchX || [
                    [0, p]
                ],
                d = u.stretchY || [
                    [0, c]
                ],
                m = function (t, e) {
                    return t + e[1] - e[0]
                },
                g = f.reduce(m, 0),
                v = d.reduce(m, 0),
                x = p - g,
                b = c - v,
                _ = 0,
                w = g,
                k = 0,
                A = v,
                S = 0,
                I = x,
                z = 0,
                B = b;
            if (u.content && n) {
                var V = u.content;
                _ = Lu(f, 0, V[0]), k = Lu(d, 0, V[1]), w = Lu(f, V[0], V[2]), A = Lu(d, V[1], V[3]), S = V[0] - _, z = V[1] - k, I = V[2] - V[0] - w, B = V[3] - V[1] - A;
            }
            var C = function (n, s, p, c) {
                var f, d = Du(n.stretch - _, w, h, t.left),
                    m = Eu(n.fixed - S, I, n.stretch, g),
                    x = Du(s.stretch - k, A, y, t.top),
                    b = Eu(s.fixed - z, B, s.stretch, v),
                    V = Du(p.stretch - _, w, h, t.left),
                    C = Eu(p.fixed - S, I, p.stretch, g),
                    M = Du(c.stretch - k, A, y, t.top),
                    P = Eu(c.fixed - z, B, c.stretch, v),
                    L = new i(d, x),
                    T = new i(V, x),
                    D = new i(V, M),
                    E = new i(d, M),
                    F = new i(m / l, b / l),
                    q = new i(C / l, P / l);
                if (f = a ? "symtracking" !== a.type || a.layout.get("compatible-mode") ? "symtracking" === a.type ? Fu(o, 0) : "symbol" === a.type && a.paint.get("render-road-mark") ? Fu(o, Math.PI / 2) : a.layout.get("icon-rotate").evaluate(o) * Math.PI / 180 : o.properties.car_rotate * Math.PI / 180 : e * Math.PI / 180) {
                    var O = Math.sin(f),
                        U = Math.cos(f),
                        R = [U, -O, O, U];
                    L._matMult(R), T._matMult(R), E._matMult(R), D._matMult(R);
                }
                var j = n.stretch + n.fixed,
                    N = s.stretch + s.fixed;
                return {
                    tl: L,
                    tr: T,
                    bl: E,
                    br: D,
                    tex: {
                        x: u.paddedRect.x + 1 + j,
                        y: u.paddedRect.y + 1 + N,
                        w: p.stretch + p.fixed - j,
                        h: c.stretch + c.fixed - N
                    },
                    writingMode: void 0,
                    glyphOffset: [0, 0],
                    sectionIndex: 0,
                    pixelOffsetTL: F,
                    pixelOffsetBR: q,
                    minFontScaleX: I / l / h,
                    minFontScaleY: B / l / y,
                    isSDF: r
                }
            };
            if (n && (u.stretchX || u.stretchY))
                for (var M = Tu(f, x, g), P = Tu(d, b, v), L = 0; L < M.length - 1; L++)
                    for (var T = M[L], D = M[L + 1], E = 0; E < P.length - 1; E++) s.push(C(T, P[E], D, P[E + 1]));
            else s.push(C({
                fixed: 0,
                stretch: -1
            }, {
                fixed: 0,
                stretch: -1
            }, {
                fixed: 0,
                stretch: p + 1
            }, {
                fixed: 0,
                stretch: c + 1
            }));
            return s
        }

        function Lu(t, e, r) {
            for (var n = 0, i = 0, a = t; i < a.length; i += 1) {
                var o = a[i];
                n += Math.max(e, Math.min(r, o[1])) - Math.max(e, Math.min(r, o[0]));
            }
            return n
        }

        function Tu(t, e, r) {
            for (var n = [{
                    fixed: -1,
                    stretch: 0
                }], i = 0, a = t; i < a.length; i += 1) {
                var o = a[i],
                    s = o[0],
                    u = o[1],
                    l = n[n.length - 1];
                n.push({
                    fixed: s - l.stretch,
                    stretch: l.stretch
                }), n.push({
                    fixed: s - l.stretch,
                    stretch: l.stretch + (u - s)
                });
            }
            return n.push({
                fixed: e + 1,
                stretch: r
            }), n
        }

        function Du(t, e, r, n) {
            return t / e * r + n
        }

        function Eu(t, e, r, n) {
            return t - e * r / n
        }

        function Fu(t, e) {
            var r = t.geometry[0];
            return r.length > 2 && (!t.properties.hasOwnProperty("name") || -1 === t.properties.name.indexOf("箭头")) || 1 === r.length ? 0 : r[1].angleTo(r[0]) + (e || 0)
        }
        var qu = function (t, e, r, n, a, o, s, u, l, p) {
                if (this.boxStartIndex = t.length, l) {
                    var c = o.top,
                        h = o.bottom,
                        y = o.collisionPadding;
                    y && (c -= y[1], h += y[3]);
                    var f = h - c;
                    f > 0 && (f = Math.max(10, f), this.circleDiameter = f);
                } else {
                    var d = o.top * s - u,
                        m = o.bottom * s + u,
                        g = o.left * s - u,
                        v = o.right * s + u,
                        x = o.collisionPadding;
                    if (x && (g -= x[0] * s, d -= x[1] * s, v += x[2] * s, m += x[3] * s), p) {
                        var b = new i(g, d),
                            _ = new i(v, d),
                            w = new i(g, m),
                            k = new i(v, m),
                            A = p * Math.PI / 180;
                        b._rotate(A), _._rotate(A), w._rotate(A), k._rotate(A), g = Math.min(b.x, _.x, w.x, k.x), v = Math.max(b.x, _.x, w.x, k.x), d = Math.min(b.y, _.y, w.y, k.y), m = Math.max(b.y, _.y, w.y, k.y);
                    }
                    t.emplaceBack(e.x, e.y, g, d, v, m, r, n, a);
                }
                this.boxEndIndex = t.length;
            },
            Ou = function (t, e) {
                if (void 0 === t && (t = []), void 0 === e && (e = Uu), this.data = t, this.length = this.data.length, this.compare = e, this.length > 0)
                    for (var r = (this.length >> 1) - 1; r >= 0; r--) this._down(r);
            };

        function Uu(t, e) {
            return t < e ? -1 : t > e ? 1 : 0
        }

        function Ru(t, e, r) {
            void 0 === e && (e = 1), void 0 === r && (r = !1);
            for (var n = 1 / 0, a = 1 / 0, o = -1 / 0, s = -1 / 0, u = t[0], l = 0; l < u.length; l++) {
                var p = u[l];
                (!l || p.x < n) && (n = p.x), (!l || p.y < a) && (a = p.y), (!l || p.x > o) && (o = p.x), (!l || p.y > s) && (s = p.y);
            }
            var c = Math.min(o - n, s - a),
                h = c / 2,
                y = new Ou([], ju);
            if (0 === c) return new i(n, a);
            for (var f = n; f < o; f += c)
                for (var d = a; d < s; d += c) y.push(new Nu(f + h, d + h, h, t));
            for (var m = function (t) {
                    for (var e = 0, r = 0, n = 0, i = t[0], a = 0, o = i.length, s = o - 1; a < o; s = a++) {
                        var u = i[a],
                            l = i[s],
                            p = u.x * l.y - l.x * u.y;
                        r += (u.x + l.x) * p, n += (u.y + l.y) * p, e += 3 * p;
                    }
                    return new Nu(r / e, n / e, 0, t)
                }(t), g = y.length; y.length;) {
                var v = y.pop();
                (v.d > m.d || !m.d) && (m = v, r && console.log("found best %d after %d probes", Math.round(1e4 * v.d) / 1e4, g)), v.max - m.d <= e || (y.push(new Nu(v.p.x - (h = v.h / 2), v.p.y - h, h, t)), y.push(new Nu(v.p.x + h, v.p.y - h, h, t)), y.push(new Nu(v.p.x - h, v.p.y + h, h, t)), y.push(new Nu(v.p.x + h, v.p.y + h, h, t)), g += 4);
            }
            return r && (console.log("num probes: " + g), console.log("best distance: " + m.d)), m.p
        }

        function ju(t, e) {
            return e.max - t.max
        }

        function Nu(t, e, r, n) {
            this.p = new i(t, e), this.h = r, this.d = function (t, e) {
                for (var r = !1, n = 1 / 0, i = 0; i < e.length; i++)
                    for (var a = e[i], o = 0, s = a.length, u = s - 1; o < s; u = o++) {
                        var l = a[o],
                            p = a[u];
                        l.y > t.y != p.y > t.y && t.x < (p.x - l.x) * (t.y - l.y) / (p.y - l.y) + l.x && (r = !r), n = Math.min(n, Da(t, l, p));
                    }
                return (r ? 1 : -1) * Math.sqrt(n)
            }(this.p, n), this.max = this.d + this.h * Math.SQRT2;
        }
        Ou.prototype.push = function (t) {
            this.data.push(t), this.length++, this._up(this.length - 1);
        }, Ou.prototype.pop = function () {
            if (0 !== this.length) {
                var t = this.data[0],
                    e = this.data.pop();
                return this.length--, this.length > 0 && (this.data[0] = e, this._down(0)), t
            }
        }, Ou.prototype.peek = function () {
            return this.data[0]
        }, Ou.prototype._up = function (t) {
            for (var e = this.data, r = this.compare, n = e[t]; t > 0;) {
                var i = t - 1 >> 1,
                    a = e[i];
                if (r(n, a) >= 0) break;
                e[t] = a, t = i;
            }
            e[t] = n;
        }, Ou.prototype._down = function (t) {
            for (var e = this.data, r = this.compare, n = this.length >> 1, i = e[t]; t < n;) {
                var a = 1 + (t << 1),
                    o = e[a],
                    s = a + 1;
                if (s < this.length && r(e[s], o) < 0 && (a = s, o = e[s]), r(o, i) >= 0) break;
                e[t] = o, t = a;
            }
            e[t] = i;
        };
        var Ku = Number.POSITIVE_INFINITY;

        function Xu(t, e) {
            return e[1] !== Ku ? function (t, e, r) {
                var n = 0,
                    i = 0;
                switch (e = Math.abs(e), r = Math.abs(r), t) {
                    case "top-right":
                    case "top-left":
                    case "top":
                        i = r - 7;
                        break;
                    case "bottom-right":
                    case "bottom-left":
                    case "bottom":
                        i = 7 - r;
                }
                switch (t) {
                    case "top-right":
                    case "bottom-right":
                    case "right":
                        n = -e;
                        break;
                    case "top-left":
                    case "bottom-left":
                    case "left":
                        n = e;
                }
                return [n, i]
            }(t, e[0], e[1]) : function (t, e) {
                var r = 0,
                    n = 0;
                e < 0 && (e = 0);
                var i = e / Math.sqrt(2);
                switch (t) {
                    case "top-right":
                    case "top-left":
                        n = i - 7;
                        break;
                    case "bottom-right":
                    case "bottom-left":
                        n = 7 - i;
                        break;
                    case "bottom":
                        n = 7 - e;
                        break;
                    case "top":
                        n = e - 7;
                }
                switch (t) {
                    case "top-right":
                    case "bottom-right":
                        r = -i;
                        break;
                    case "top-left":
                    case "bottom-left":
                        r = i;
                        break;
                    case "left":
                        r = e;
                        break;
                    case "right":
                        r = -e;
                }
                return [r, n]
            }(t, e[0])
        }

        function Gu(t) {
            switch (t) {
                case "right":
                case "top-right":
                case "bottom-right":
                    return "right";
                case "left":
                case "top-left":
                case "bottom-left":
                    return "left"
            }
            return "center"
        }

        function Hu(t, e, r, n, a, o, s, u, l, p, c, h, y, f, d) {
            var m = function (t, e, r, n, a, o, s, u) {
                    for (var l = n.layout.get("text-rotate").evaluate(o, {}) * Math.PI / 180, p = [], c = 0, h = e.positionedLines; c < h.length; c += 1)
                        for (var y = h[c], f = 0, d = y.positionedGlyphs; f < d.length; f += 1) {
                            var m = d[f];
                            if (m.rect) {
                                var g = m.rect || {},
                                    v = 4,
                                    x = !0,
                                    b = 1,
                                    _ = 0,
                                    w = (a || u) && m.vertical,
                                    k = m.metrics.advance * m.scale / 2;
                                if (u && e.verticalizable && (_ = y.lineOffset / 2 - (m.imageName ? -(24 - m.metrics.width * m.scale) / 2 : 24 * (m.scale - 1))), m.imageName) {
                                    var A = s[m.imageName];
                                    x = A.sdf, v = 1 / (b = A.pixelRatio);
                                }
                                var S = a ? [m.x + k, m.y] : [0, 0],
                                    I = a ? [0, 0] : [m.x + k + r[0], m.y + r[1] - _],
                                    z = [0, 0];
                                w && (z = I, I = [0, 0]);
                                var B = (m.metrics.left - v) * m.scale - k + I[0],
                                    V = (-m.metrics.top - v) * m.scale + I[1],
                                    C = B + g.w * m.scale / b,
                                    M = V + g.h * m.scale / b,
                                    P = new i(B, V),
                                    L = new i(C, V),
                                    T = new i(B, M),
                                    D = new i(C, M);
                                if (w) {
                                    var E = new i(-k, k - -17),
                                        F = -Math.PI / 2,
                                        q = 12 - k,
                                        O = new i(22 - q, -(m.imageName ? q : 0)),
                                        U = new(Function.prototype.bind.apply(i, [null].concat(z)));
                                    P._rotateAround(F, E)._add(O)._add(U), L._rotateAround(F, E)._add(O)._add(U), T._rotateAround(F, E)._add(O)._add(U), D._rotateAround(F, E)._add(O)._add(U);
                                }
                                if (l) {
                                    var R = Math.sin(l),
                                        j = Math.cos(l),
                                        N = [j, -R, R, j];
                                    P._matMult(N), L._matMult(N), T._matMult(N), D._matMult(N);
                                }
                                var K = new i(0, 0),
                                    X = new i(0, 0);
                                p.push({
                                    tl: P,
                                    tr: L,
                                    bl: T,
                                    br: D,
                                    tex: g,
                                    writingMode: e.writingMode,
                                    glyphOffset: S,
                                    sectionIndex: m.sectionIndex,
                                    isSDF: x,
                                    pixelOffsetTL: K,
                                    pixelOffsetBR: X,
                                    minFontScaleX: 0,
                                    minFontScaleY: 0
                                });
                            }
                        }
                    return p
                }(0, r, u, a, o, s, n, t.allowVerticalPlacement),
                g = t.textSizeData,
                v = null;
            "source" === g.kind ? (v = [128 * a.layout.get("text-size").evaluate(s, {})])[0] > 32640 && x(t.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".') : "composite" === g.kind && ((v = [128 * f.compositeTextSizes[0].evaluate(s, {}, d), 128 * f.compositeTextSizes[1].evaluate(s, {}, d)])[0] > 32640 || v[1] > 32640) && x(t.layerIds[0] + ': Value for "text-size" is >= 255. Reduce your "text-size".'), t.addSymbols(t.text, m, v, u, o, s, p, e, l.lineStartIndex, l.lineLength, y, d);
            for (var b = 0, _ = c; b < _.length; b += 1) h[_[b]] = t.text.placedSymbolArray.length - 1;
            return 4 * m.length
        }

        function Yu(t) {
            for (var e in t) return t[e];
            return null
        }

        function Zu(t, e, r, n) {
            var i = t.compareText;
            if (e in i) {
                for (var a = i[e], o = a.length - 1; o >= 0; o--)
                    if (n.dist(a[o]) < r) return !0
            } else i[e] = [];
            return i[e].push(n), !1
        }
        var Ju = as.VectorTileFeature.types,
            $u = [{
                name: "a_fade_opacity",
                components: 1,
                type: "Uint8",
                offset: 0
            }];

        function Wu(t, e, r, n, i, a, o, s, u, l, p, c, h) {
            var y = s ? Math.min(32640, Math.round(s[0])) : 0,
                f = s ? Math.min(32640, Math.round(s[1])) : 0;
            t.emplaceBack(e, r, Math.round(32 * n), Math.round(32 * i), a, o, (y << 1) + (u ? 1 : 0), f, 16 * l, 16 * p, 256 * c, 256 * h);
        }

        function Qu(t, e, r) {
            t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r);
        }

        function tl(t) {
            for (var e = 0, r = t.sections; e < r.length; e += 1)
                if (Pn(r[e].text)) return !0;
            return !1
        }
        var el = function (t) {
            this.layoutVertexArray = new vi, this.indexArray = new Si, this.programConfigurations = t, this.segments = new Hi, this.dynamicLayoutVertexArray = new xi, this.opacityVertexArray = new bi, this.placedSymbolArray = new Oi;
        };
        el.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length
        }, el.prototype.upload = function (t, e, r, n) {
            this.isEmpty() || (r && (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Ss.members), this.indexBuffer = t.createIndexBuffer(this.indexArray, e), this.dynamicLayoutVertexBuffer = t.createVertexBuffer(this.dynamicLayoutVertexArray, Is.members, !0), this.opacityVertexBuffer = t.createVertexBuffer(this.opacityVertexArray, $u, !0), this.opacityVertexBuffer.itemSize = 1), (r || n) && this.programConfigurations.upload(t));
        }, el.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy());
        }, xn("SymbolBuffers", el);
        var rl = function (t, e, r) {
            this.layoutVertexArray = new t, this.layoutAttributes = e, this.indexArray = new r, this.segments = new Hi, this.collisionVertexArray = new Ai;
        };
        rl.prototype.upload = function (t) {
            this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t.createVertexBuffer(this.collisionVertexArray, zs.members, !0);
        }, rl.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy());
        }, xn("CollisionBuffers", rl);
        var nl = function (t) {
            this.collisionBoxArray = t.collisionBoxArray, this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                return t.id
            })), this.index = t.index, this.pixelRatio = t.pixelRatio, this.sourceLayerIndex = t.sourceLayerIndex, this.hasPattern = !1, this.hasRTLText = !1, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = Xa([]), this.placementViewportMatrix = Xa([]);
            var e = this.layers[0]._unevaluatedLayout._values;
            this.textSizeData = _u(this.zoom, e["text-size"]), this.iconSizeData = _u(this.zoom, e["icon-size"]);
            var r = this.layers[0].layout,
                n = r.get("symbol-sort-key"),
                i = r.get("symbol-z-order");
            this.sortFeaturesByKey = "viewport-y" !== i && void 0 !== n.constantOr(1), this.sortFeaturesByY = ("viewport-y" === i || "auto" === i && !this.sortFeaturesByKey) && (r.get("text-allow-overlap") || r.get("icon-allow-overlap") || r.get("text-ignore-placement") || r.get("icon-ignore-placement")), "point" === r.get("symbol-placement") && (this.writingModes = r.get("text-writing-mode").map((function (t) {
                return ou[t]
            }))), this.stateDependentLayerIds = this.layers.filter((function (t) {
                return t.isStateDependent()
            })).map((function (t) {
                return t.id
            })), this.sourceID = t.sourceID;
        };

        function il(t, e) {
            return e.replace(/{([^{}]+)}/g, (function (e, r) {
                return r in t ? String(t[r]) : ""
            }))
        }
        nl.prototype.createArrays = function () {
            this.text = new el(new ba(this.layers, this.zoom, (function (t) {
                return /^text/.test(t)
            }))), this.icon = new el(new ba(this.layers, this.zoom, (function (t) {
                return /^icon/.test(t)
            }))), this.glyphOffsetArray = new ji, this.lineVertexArray = new Ni, this.symbolInstances = new Ri;
        }, nl.prototype.calculateGlyphDependencies = function (t, e, r, n, i) {
            for (var a = 0; a < t.length; a++)
                if (e[t.charCodeAt(a)] = !0, (r || n) && i) {
                    var o = Ps[t.charAt(a)];
                    o && (e[o.charCodeAt(0)] = !0);
                }
        }, nl.prototype.populate = function (t, e, r) {
            var n = this.layers[0],
                i = n.layout,
                a = i.get("text-font"),
                o = i.get("text-field"),
                s = i.get("icon-image"),
                u = ("constant" !== o.value.kind || o.value.value instanceof Ft && !o.value.value.isEmpty() || o.value.value.toString().length > 0) && ("constant" !== a.value.kind || a.value.value.length > 0),
                l = "constant" !== s.value.kind || !!s.value.value || Object.keys(s.parameters).length > 0,
                p = i.get("symbol-sort-key");
            if (this.features = [], u || l) {
                for (var c = e.iconDependencies, h = e.glyphDependencies, y = e.availableImages, f = new jn(this.zoom), d = 0, m = t; d < m.length; d += 1) {
                    var g = m[d],
                        v = g.feature,
                        x = g.id,
                        b = g.index,
                        _ = g.sourceLayerIndex,
                        w = n._featureFilter.needGeometry,
                        k = {
                            type: v.type,
                            id: x,
                            properties: v.properties,
                            geometry: w ? Aa(v) : []
                        };
                    if (n._featureFilter.filter(f, k, r)) {
                        w || (k.geometry = Aa(v));
                        var A = void 0;
                        if (u) {
                            var S = n.getValueAndResolveTokens("text-field", k, r, y),
                                I = Ft.factory(S);
                            tl(I) && (this.hasRTLText = !0), (!this.hasRTLText || "unavailable" === On() || this.hasRTLText && Rn.isParsed()) && (A = Cs(I, n, k));
                        }
                        var z = void 0;
                        if (l) {
                            var B = n.getValueAndResolveTokens("icon-image", k, r, y);
                            z = B instanceof qt ? B : qt.fromString(B);
                        }
                        if (A || z) {
                            var V = this.sortFeaturesByKey ? p.evaluate(k, {}, r) : void 0,
                                C = {
                                    id: x,
                                    text: A,
                                    icon: z,
                                    index: b,
                                    sourceLayerIndex: _,
                                    geometry: Aa(v),
                                    properties: v.properties,
                                    type: Ju[v.type],
                                    sortKey: V
                                };
                            if (this.features.push(C), z && (c[z.name] = !0), A) {
                                var M = a.evaluate(k, {}, r).join(","),
                                    P = "map" === i.get("text-rotation-alignment") && "point" !== i.get("symbol-placement");
                                this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(ou.vertical) >= 0;
                                for (var L = 0, T = A.sections; L < T.length; L += 1) {
                                    var D = T[L];
                                    if (D.image) c[D.image.name] = !0;
                                    else {
                                        var E = zn(A.toString()),
                                            F = D.fontStack || M,
                                            q = h[F] = h[F] || {};
                                        this.calculateGlyphDependencies(D.text, q, P, this.allowVerticalPlacement, E);
                                    }
                                }
                            }
                        }
                    }
                }
                "line" === i.get("symbol-placement") && (this.features = Ms(this.features)), this.sortFeaturesByKey && this.features.sort((function (t, e) {
                    return t.sortKey - e.sortKey
                }));
            }
        }, nl.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t, e, this.layers, r), this.icon.programConfigurations.updatePaintArrays(t, e, this.layers, r));
        }, nl.prototype.isEmpty = function () {
            return 0 === this.symbolInstances.length && !this.hasRTLText
        }, nl.prototype.uploadPending = function () {
            return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload
        }, nl.prototype.upload = function (t) {
            !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t), this.iconCollisionBox.upload(t)), this.text.upload(t, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = !0;
        }, nl.prototype.destroyDebugData = function () {
            this.textCollisionBox.destroy(), this.iconCollisionBox.destroy();
        }, nl.prototype.destroy = function () {
            this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData();
        }, nl.prototype.addToLineVertexArray = function (t, e) {
            var r = this.lineVertexArray.length;
            if (void 0 !== t.segment) {
                for (var n = t.dist(e[t.segment + 1]), i = t.dist(e[t.segment]), a = {}, o = t.segment + 1; o < e.length; o++) a[o] = {
                    x: e[o].x,
                    y: e[o].y,
                    tileUnitDistanceFromAnchor: n
                }, o < e.length - 1 && (n += e[o + 1].dist(e[o]));
                for (var s = t.segment || 0; s >= 0; s--) a[s] = {
                    x: e[s].x,
                    y: e[s].y,
                    tileUnitDistanceFromAnchor: i
                }, s > 0 && (i += e[s - 1].dist(e[s]));
                for (var u = 0; u < e.length; u++) {
                    var l = a[u];
                    this.lineVertexArray.emplaceBack(l.x, l.y, l.tileUnitDistanceFromAnchor);
                }
            }
            return {
                lineStartIndex: r,
                lineLength: this.lineVertexArray.length - r
            }
        }, nl.prototype.addSymbols = function (t, e, r, n, i, a, o, s, u, l, p, c) {
            for (var h = t.indexArray, y = t.layoutVertexArray, f = t.segments.prepareSegment(4 * e.length, y, h, a.sortKey), d = this.glyphOffsetArray.length, m = f.vertexLength, g = this.allowVerticalPlacement && o === ou.vertical ? Math.PI / 2 : 0, v = a.text && a.text.sections, x = 0; x < e.length; x++) {
                var b = e[x],
                    _ = b.tl,
                    w = b.tr,
                    k = b.bl,
                    A = b.br,
                    S = b.tex,
                    I = b.pixelOffsetTL,
                    z = b.pixelOffsetBR,
                    B = b.minFontScaleX,
                    V = b.minFontScaleY,
                    C = b.glyphOffset,
                    M = b.isSDF,
                    P = b.sectionIndex,
                    L = f.vertexLength,
                    T = C[1];
                Wu(y, s.x, s.y, _.x, T + _.y, S.x, S.y, r, M, I.x, I.y, B, V), Wu(y, s.x, s.y, w.x, T + w.y, S.x + S.w, S.y, r, M, z.x, I.y, B, V), Wu(y, s.x, s.y, k.x, T + k.y, S.x, S.y + S.h, r, M, I.x, z.y, B, V), Wu(y, s.x, s.y, A.x, T + A.y, S.x + S.w, S.y + S.h, r, M, z.x, z.y, B, V), Qu(t.dynamicLayoutVertexArray, s, g), h.emplaceBack(L, L + 1, L + 2), h.emplaceBack(L + 1, L + 2, L + 3), f.vertexLength += 4, f.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(C[0]), x !== e.length - 1 && P === e[x + 1].sectionIndex || t.programConfigurations.populatePaintArrays(y.length, a, a.index, {}, c, v && v[P]);
            }
            t.placedSymbolArray.emplaceBack(s.x, s.y, d, this.glyphOffsetArray.length - d, m, u, l, s.segment, r ? r[0] : 0, r ? r[1] : 0, n[0], n[1], o, 0, !1, 0, p);
        }, nl.prototype._addCollisionDebugVertex = function (t, e, r, n, i, a) {
            return e.emplaceBack(0, 0), t.emplaceBack(r.x, r.y, n, i, Math.round(a.x), Math.round(a.y))
        }, nl.prototype.addCollisionDebugVertices = function (t, e, r, n, a, o, s) {
            var u = a.segments.prepareSegment(4, a.layoutVertexArray, a.indexArray),
                l = u.vertexLength,
                p = a.layoutVertexArray,
                c = a.collisionVertexArray,
                h = s.anchorX,
                y = s.anchorY;
            this._addCollisionDebugVertex(p, c, o, h, y, new i(t, e)), this._addCollisionDebugVertex(p, c, o, h, y, new i(r, e)), this._addCollisionDebugVertex(p, c, o, h, y, new i(r, n)), this._addCollisionDebugVertex(p, c, o, h, y, new i(t, n)), u.vertexLength += 4;
            var f = a.indexArray;
            f.emplaceBack(l, l + 1), f.emplaceBack(l + 1, l + 2), f.emplaceBack(l + 2, l + 3), f.emplaceBack(l + 3, l), u.primitiveLength += 4;
        }, nl.prototype.addDebugCollisionBoxes = function (t, e, r, n) {
            for (var i = t; i < e; i++) {
                var a = this.collisionBoxArray.get(i);
                this.addCollisionDebugVertices(a.x1, a.y1, a.x2, a.y2, n ? this.textCollisionBox : this.iconCollisionBox, a.anchorPoint, r);
            }
        }, nl.prototype.generateCollisionDebugBuffers = function () {
            this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new rl(wi, Bs.members, Pi), this.iconCollisionBox = new rl(wi, Bs.members, Pi);
            for (var t = 0; t < this.symbolInstances.length; t++) {
                var e = this.symbolInstances.get(t);
                this.addDebugCollisionBoxes(e.textBoxStartIndex, e.textBoxEndIndex, e, !0), this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex, e.verticalTextBoxEndIndex, e, !0), this.addDebugCollisionBoxes(e.iconBoxStartIndex, e.iconBoxEndIndex, e, !1), this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex, e.verticalIconBoxEndIndex, e, !1);
            }
        }, nl.prototype._deserializeCollisionBoxesForSymbol = function (t, e, r, n, i, a, o, s, u) {
            for (var l = {}, p = e; p < r; p++) {
                var c = t.get(p);
                l.textBox = {
                    x1: c.x1,
                    y1: c.y1,
                    x2: c.x2,
                    y2: c.y2,
                    anchorPointX: c.anchorPointX,
                    anchorPointY: c.anchorPointY
                }, l.textFeatureIndex = c.featureIndex;
                break
            }
            for (var h = n; h < i; h++) {
                var y = t.get(h);
                l.verticalTextBox = {
                    x1: y.x1,
                    y1: y.y1,
                    x2: y.x2,
                    y2: y.y2,
                    anchorPointX: y.anchorPointX,
                    anchorPointY: y.anchorPointY
                }, l.verticalTextFeatureIndex = y.featureIndex;
                break
            }
            for (var f = a; f < o; f++) {
                var d = t.get(f);
                l.iconBox = {
                    x1: d.x1,
                    y1: d.y1,
                    x2: d.x2,
                    y2: d.y2,
                    anchorPointX: d.anchorPointX,
                    anchorPointY: d.anchorPointY
                }, l.iconFeatureIndex = d.featureIndex;
                break
            }
            for (var m = s; m < u; m++) {
                var g = t.get(m);
                l.verticalIconBox = {
                    x1: g.x1,
                    y1: g.y1,
                    x2: g.x2,
                    y2: g.y2,
                    anchorPointX: g.anchorPointX,
                    anchorPointY: g.anchorPointY
                }, l.verticalIconFeatureIndex = g.featureIndex;
                break
            }
            return l
        }, nl.prototype.deserializeCollisionBoxes = function (t) {
            this.collisionArrays = [];
            for (var e = 0; e < this.symbolInstances.length; e++) {
                var r = this.symbolInstances.get(e);
                this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t, r.textBoxStartIndex, r.textBoxEndIndex, r.verticalTextBoxStartIndex, r.verticalTextBoxEndIndex, r.iconBoxStartIndex, r.iconBoxEndIndex, r.verticalIconBoxStartIndex, r.verticalIconBoxEndIndex));
            }
        }, nl.prototype.hasTextData = function () {
            return this.text.segments.get().length > 0
        }, nl.prototype.hasIconData = function () {
            return this.icon.segments.get().length > 0
        }, nl.prototype.hasDebugData = function () {
            return this.textCollisionBox && this.iconCollisionBox
        }, nl.prototype.hasTextCollisionBoxData = function () {
            return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0
        }, nl.prototype.hasIconCollisionBoxData = function () {
            return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0
        }, nl.prototype.addIndicesForPlacedSymbol = function (t, e) {
            for (var r = t.placedSymbolArray.get(e), n = r.vertexStartIndex + 4 * r.numGlyphs, i = r.vertexStartIndex; i < n; i += 4) t.indexArray.emplaceBack(i, i + 1, i + 2), t.indexArray.emplaceBack(i + 1, i + 2, i + 3);
        }, nl.prototype.getSortedSymbolIndexes = function (t) {
            if (this.sortedAngle === t && void 0 !== this.symbolInstanceIndexes) return this.symbolInstanceIndexes;
            for (var e = Math.sin(t), r = Math.cos(t), n = [], i = [], a = [], o = 0; o < this.symbolInstances.length; ++o) {
                a.push(o);
                var s = this.symbolInstances.get(o);
                n.push(0 | Math.round(e * s.anchorX + r * s.anchorY)), i.push(s.featureIndex);
            }
            return a.sort((function (t, e) {
                return n[t] - n[e] || i[e] - i[t]
            })), a
        }, nl.prototype.addToSortKeyRanges = function (t, e) {
            var r = this.sortKeyRanges[this.sortKeyRanges.length - 1];
            r && r.sortKey === e ? r.symbolInstanceEnd = t + 1 : this.sortKeyRanges.push({
                sortKey: e,
                symbolInstanceStart: t,
                symbolInstanceEnd: t + 1
            });
        }, nl.prototype.sortFeatures = function (t) {
            var e = this;
            if (this.sortFeaturesByY && this.sortedAngle !== t && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
                this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t), this.sortedAngle = t, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];
                for (var r = 0, n = this.symbolInstanceIndexes; r < n.length; r += 1) {
                    var i = this.symbolInstances.get(n[r]);
                    this.featureSortOrder.push(i.featureIndex), [i.rightJustifiedTextSymbolIndex, i.centerJustifiedTextSymbolIndex, i.leftJustifiedTextSymbolIndex].forEach((function (t, r, n) {
                        t >= 0 && n.indexOf(t) === r && e.addIndicesForPlacedSymbol(e.text, t);
                    })), i.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, i.verticalPlacedTextSymbolIndex), i.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, i.placedIconSymbolIndex), i.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, i.verticalPlacedIconSymbolIndex);
                }
                this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray);
            }
        }, xn("SymbolBucket", nl, {
            omit: ["layers", "collisionBoxArray", "features", "compareText"]
        }), nl.MAX_GLYPHS = 65535, nl.addDynamicAttributes = Qu;
        var al = new ri({
                "symbol-placement": new $n(ut.layout_symbol["symbol-placement"]),
                "symbol-spacing": new $n(ut.layout_symbol["symbol-spacing"]),
                "symbol-avoid-edges": new $n(ut.layout_symbol["symbol-avoid-edges"]),
                "symbol-sort-key": new Wn(ut.layout_symbol["symbol-sort-key"]),
                "symbol-z-order": new $n(ut.layout_symbol["symbol-z-order"]),
                "icon-allow-overlap": new $n(ut.layout_symbol["icon-allow-overlap"]),
                "icon-ignore-placement": new $n(ut.layout_symbol["icon-ignore-placement"]),
                "icon-optional": new $n(ut.layout_symbol["icon-optional"]),
                "icon-rotation-alignment": new $n(ut.layout_symbol["icon-rotation-alignment"]),
                "icon-size": new Wn(ut.layout_symbol["icon-size"]),
                "icon-text-fit": new $n(ut.layout_symbol["icon-text-fit"]),
                "icon-text-fit-padding": new $n(ut.layout_symbol["icon-text-fit-padding"]),
                "icon-image": new Wn(ut.layout_symbol["icon-image"]),
                "icon-rotate": new Wn(ut.layout_symbol["icon-rotate"]),
                "icon-padding": new $n(ut.layout_symbol["icon-padding"]),
                "icon-keep-upright": new $n(ut.layout_symbol["icon-keep-upright"]),
                "icon-offset": new Wn(ut.layout_symbol["icon-offset"]),
                "icon-anchor": new Wn(ut.layout_symbol["icon-anchor"]),
                "icon-pitch-alignment": new $n(ut.layout_symbol["icon-pitch-alignment"]),
                "text-pitch-alignment": new $n(ut.layout_symbol["text-pitch-alignment"]),
                "text-rotation-alignment": new $n(ut.layout_symbol["text-rotation-alignment"]),
                "text-field": new Wn(ut.layout_symbol["text-field"]),
                "text-font": new Wn(ut.layout_symbol["text-font"]),
                "text-size": new Wn(ut.layout_symbol["text-size"]),
                "text-max-width": new Wn(ut.layout_symbol["text-max-width"]),
                "text-line-height": new $n(ut.layout_symbol["text-line-height"]),
                "text-letter-spacing": new Wn(ut.layout_symbol["text-letter-spacing"]),
                "text-justify": new Wn(ut.layout_symbol["text-justify"]),
                "text-radial-offset": new Wn(ut.layout_symbol["text-radial-offset"]),
                "text-variable-anchor": new $n(ut.layout_symbol["text-variable-anchor"]),
                "text-anchor": new Wn(ut.layout_symbol["text-anchor"]),
                "text-max-angle": new $n(ut.layout_symbol["text-max-angle"]),
                "text-writing-mode": new $n(ut.layout_symbol["text-writing-mode"]),
                "text-rotate": new Wn(ut.layout_symbol["text-rotate"]),
                "text-padding": new $n(ut.layout_symbol["text-padding"]),
                "text-keep-upright": new $n(ut.layout_symbol["text-keep-upright"]),
                "text-transform": new Wn(ut.layout_symbol["text-transform"]),
                "text-offset": new Wn(ut.layout_symbol["text-offset"]),
                "text-allow-overlap": new $n(ut.layout_symbol["text-allow-overlap"]),
                "text-ignore-placement": new $n(ut.layout_symbol["text-ignore-placement"]),
                "text-optional": new $n(ut.layout_symbol["text-optional"])
            }),
            ol = {
                paint: new ri({
                    "icon-opacity": new Wn(ut.paint_symbol["icon-opacity"]),
                    "icon-color": new Wn(ut.paint_symbol["icon-color"]),
                    "icon-halo-color": new Wn(ut.paint_symbol["icon-halo-color"]),
                    "icon-halo-width": new Wn(ut.paint_symbol["icon-halo-width"]),
                    "icon-halo-blur": new Wn(ut.paint_symbol["icon-halo-blur"]),
                    "icon-translate": new $n(ut.paint_symbol["icon-translate"]),
                    "icon-translate-anchor": new $n(ut.paint_symbol["icon-translate-anchor"]),
                    "text-opacity": new Wn(ut.paint_symbol["text-opacity"]),
                    "text-color": new Wn(ut.paint_symbol["text-color"], {
                        runtimeType: bt,
                        getOverride: function (t) {
                            return t.textColor
                        },
                        hasOverride: function (t) {
                            return !!t.textColor
                        }
                    }),
                    "text-halo-color": new Wn(ut.paint_symbol["text-halo-color"]),
                    "text-halo-width": new Wn(ut.paint_symbol["text-halo-width"]),
                    "text-halo-blur": new Wn(ut.paint_symbol["text-halo-blur"]),
                    "text-translate": new $n(ut.paint_symbol["text-translate"]),
                    "text-translate-anchor": new $n(ut.paint_symbol["text-translate-anchor"])
                }),
                layout: al
            },
            sl = function (t) {
                this.type = t.property.overrides ? t.property.overrides.runtimeType : mt, this.defaultValue = t;
            };
        sl.prototype.evaluate = function (t) {
            if (t.formattedSection) {
                var e = this.defaultValue.property.overrides;
                if (e && e.hasOverride(t.formattedSection)) return e.getOverride(t.formattedSection)
            }
            return t.feature && t.featureState ? this.defaultValue.evaluate(t.feature, t.featureState) : this.defaultValue.property.specification.default
        }, sl.prototype.eachChild = function (t) {
            this.defaultValue.isConstant() || t(this.defaultValue.value._styleExpression.expression);
        }, sl.prototype.outputDefined = function () {
            return !1
        }, sl.prototype.serialize = function () {
            return null
        }, xn("FormatSectionOverride", sl, {
            omit: ["defaultValue"]
        });
        var ul = function (t) {
                function e(e) {
                    t.call(this, e, ol);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.recalculate = function (e, r) {
                    if (t.prototype.recalculate.call(this, e, r), "auto" === this.layout.get("icon-rotation-alignment") && (this.layout._values["icon-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-rotation-alignment") && (this.layout._values["text-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-pitch-alignment") && (this.layout._values["text-pitch-alignment"] = this.layout.get("text-rotation-alignment")), "auto" === this.layout.get("icon-pitch-alignment") && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment")), "point" === this.layout.get("symbol-placement")) {
                        var n = this.layout.get("text-writing-mode");
                        if (n) {
                            for (var i = [], a = 0, o = n; a < o.length; a += 1) {
                                var s = o[a];
                                i.indexOf(s) < 0 && i.push(s);
                            }
                            this.layout._values["text-writing-mode"] = i;
                        } else this.layout._values["text-writing-mode"] = ["horizontal"];
                    }
                    this._setPaintOverrides();
                }, e.prototype.getValueAndResolveTokens = function (t, e, r, n) {
                    var i = this.layout.get(t).evaluate(e, {}, r, n),
                        a = this._unevaluatedLayout._values[t];
                    return a.isDataDriven() || Sr(a.value) || !i ? i : il(e.properties, i)
                }, e.prototype.createBucket = function (t) {
                    return new nl(t)
                }, e.prototype.queryRadius = function () {
                    return 0
                }, e.prototype.queryIntersectsFeature = function () {
                    return !1
                }, e.prototype._setPaintOverrides = function () {
                    for (var t = 0, r = ol.paint.overridableProperties; t < r.length; t += 1) {
                        var n = r[t];
                        if (e.hasPaintOverride(this.layout, n)) {
                            var i, a = this.paint.get(n),
                                o = new sl(a),
                                s = new Ar(o, a.property.specification);
                            i = "constant" === a.value.kind || "source" === a.value.kind ? new zr("source", s) : new Br("composite", s, a.value.zoomStops, a.value._interpolationType), this.paint._values[n] = new Zn(a.property, i, a.parameters);
                        }
                    }
                }, e.prototype._handleOverridablePaintPropertyUpdate = function (t, r, n) {
                    return !(!this.layout || r.isDataDriven() || n.isDataDriven()) && e.hasPaintOverride(this.layout, t)
                }, e.hasPaintOverride = function (t, e) {
                    var r = t.get("text-field"),
                        n = ol.paint.properties[e],
                        i = !1,
                        a = function (t) {
                            for (var e = 0, r = t; e < r.length; e += 1)
                                if (n.overrides && n.overrides.hasOverride(r[e])) return void(i = !0)
                        };
                    if ("constant" === r.value.kind && r.value.value instanceof Ft) a(r.value.value.sections);
                    else if ("source" === r.value.kind) {
                        var o = function (t) {
                                i || (t instanceof Nt && Rt(t.value) === At ? a(t.value.sections) : t instanceof Ht ? a(t.sections) : t.eachChild(o));
                            },
                            s = r.value;
                        s._styleExpression && o(s._styleExpression.expression);
                    }
                    return i
                }, e
            }(ni),
            ll = {
                paint: new ri({
                    "background-color": new $n(ut.paint_background["background-color"]),
                    "background-pattern": new ti(ut.paint_background["background-pattern"]),
                    "background-opacity": new $n(ut.paint_background["background-opacity"])
                })
            },
            pl = function (t) {
                function e(e) {
                    t.call(this, e, ll);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
            }(ni),
            cl = {
                paint: new ri({
                    "raster-opacity": new $n(ut.paint_raster["raster-opacity"]),
                    "raster-hue-rotate": new $n(ut.paint_raster["raster-hue-rotate"]),
                    "raster-brightness-min": new $n(ut.paint_raster["raster-brightness-min"]),
                    "raster-brightness-max": new $n(ut.paint_raster["raster-brightness-max"]),
                    "raster-saturation": new $n(ut.paint_raster["raster-saturation"]),
                    "raster-contrast": new $n(ut.paint_raster["raster-contrast"]),
                    "raster-resampling": new $n(ut.paint_raster["raster-resampling"]),
                    "raster-fade-duration": new $n(ut.paint_raster["raster-fade-duration"])
                })
            },
            hl = function (t) {
                function e(e) {
                    t.call(this, e, cl);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
            }(ni),
            yl = function (t) {
                function e(e) {
                    t.call(this, e, {}), this.implementation = e;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.is3D = function () {
                    return "3d" === this.implementation.renderingMode
                }, e.prototype.hasOffscreenPass = function () {
                    return void 0 !== this.implementation.prerender
                }, e.prototype.recalculate = function () {}, e.prototype.updateTransitions = function () {}, e.prototype.hasTransition = function () {}, e.prototype.serialize = function () {}, e.prototype.onAdd = function (t) {
                    this.implementation.onAdd && this.implementation.onAdd(t, t.painter.context.gl);
                }, e.prototype.onRemove = function (t) {
                    this.implementation.onRemove && this.implementation.onRemove(t, t.painter.context.gl);
                }, e
            }(ni),
            fl = si([{
                name: "a_pos_normal",
                components: 2,
                type: "Int16"
            }, {
                name: "a_data",
                components: 4,
                type: "Uint8"
            }, {
                name: "a_height",
                components: 1,
                type: "Float32"
            }, {
                name: "a_seq",
                components: 2,
                type: "Uint16"
            }], 4).members,
            dl = as.VectorTileFeature.types,
            ml = Math.cos(Math.PI / 180 * 37.5),
            gl = Math.pow(2, 14) / .5,
            vl = function (t) {
                this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                    return t.id
                })), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new fi, this.indexArray = new Si, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                    return t.isStateDependent()
                })).map((function (t) {
                    return t.id
                })), this.hSeq = 0, this.seq = 0, this._count = 0;
            };
        vl.prototype.populate = function (t, e, r) {
            for (var n = this.layers[0].layout.get("airline-sort-key"), i = [], a = 0, o = t; a < o.length; a += 1) {
                var s = o[a],
                    u = s.feature,
                    l = s.id,
                    p = s.index,
                    c = s.sourceLayerIndex,
                    h = this.layers[0]._featureFilter.needGeometry,
                    y = {
                        type: u.type,
                        id: l,
                        properties: u.properties,
                        geometry: h ? Aa(u) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), y, r)) {
                    h || (y.geometry = Aa(u));
                    var f = n ? n.evaluate(y, {}, r) : void 0;
                    i.push({
                        id: l,
                        properties: u.properties,
                        type: u.type,
                        sourceLayerIndex: c,
                        index: p,
                        geometry: y.geometry,
                        patterns: {},
                        sortKey: f
                    });
                }
            }
            n && i.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var d = 0, m = i; d < m.length; d += 1) {
                var g = m[d],
                    v = g.geometry,
                    x = g.index,
                    b = g.sourceLayerIndex;
                if (this.hasPattern) {
                    var _ = Xo("line", this.layers, g, this.zoom, e);
                    this.patternFeatures.push(_);
                } else this.addFeature(g, v, x, r, {});
                e.featureIndex.insert(t[x].feature, v, x, b, this.index);
            }
        }, vl.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, vl.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.patternFeatures; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, vl.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, vl.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, vl.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, fl), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, vl.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, vl.prototype.addFeature = function (t, e, r, n, i) {
            var a = this.layers[0].layout,
                o = a.get("airline-join").evaluate(t, {}),
                s = a.get("airline-cap"),
                u = a.get("airline-miter-limit"),
                l = a.get("airline-round-limit");
            this.seq = t.properties.link_seq, this._count = t.properties.total;
            for (var p = 0, c = e; p < c.length; p += 1) this.addLine(c[p], t, o, s, u, l);
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, vl.prototype.addLine = function (t, e, r, n, i, a) {
            if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, e.properties && e.properties.hasOwnProperty("minemap_clip_start") && e.properties.hasOwnProperty("minemap_clip_end")) {
                this.clipStart = +e.properties.minemap_clip_start, this.clipEnd = +e.properties.minemap_clip_end;
                for (var o = 0; o < t.length - 1; o++) this.totalDistance += t[o].dist(t[o + 1]);
                this.updateScaledDistance();
            }
            for (var s = "Polygon" === dl[e.type], u = t.length; u >= 2 && t[u - 1].equals(t[u - 2]);) u--;
            for (var l = 0; l < u - 1 && t[l].equals(t[l + 1]);) l++;
            if (!(u < (s ? 3 : 2))) {
                "bevel" === r && (i = 1.05);
                var p, c = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
                    h = this.segments.prepareSegment(10 * u, this.layoutVertexArray, this.indexArray),
                    y = void 0,
                    f = void 0,
                    d = void 0,
                    m = void 0;
                this.e1 = this.e2 = -1, s && (m = t[l].sub(p = t[u - 2])._unit()._perp());
                for (var g = l; g < u; g++)
                    if (this.hSeq = 0 === g ? 10 * e.properties.start_height : 10 * e.properties.end_height, !(f = g === u - 1 ? s ? t[l + 1] : void 0 : t[g + 1]) || !t[g].equals(f)) {
                        m && (d = m), p && (y = p), p = t[g], m = f ? f.sub(p)._unit()._perp() : d;
                        var v = (d = d || m).add(m);
                        0 === v.x && 0 === v.y || v._unit();
                        var x = d.x * m.x + d.y * m.y,
                            b = v.x * m.x + v.y * m.y,
                            _ = 0 !== b ? 1 / b : 1 / 0,
                            w = 2 * Math.sqrt(2 - 2 * b),
                            k = b < ml && y && f,
                            A = d.x * m.y - d.y * m.x > 0;
                        if (k && g > l) {
                            var S = p.dist(y);
                            if (S > 2 * c) {
                                var I = p.sub(p.sub(y)._mult(c / S)._round());
                                this.updateDistance(y, I), this.addCurrentVertex(I, d, 0, 0, h), y = I;
                            }
                        }
                        var z = y && f,
                            B = z ? r : s ? "butt" : n;
                        if (z && "round" === B && (_ < a ? B = "miter" : _ <= 2 && (B = "fakeround")), "miter" === B && _ > i && (B = "bevel"), "bevel" === B && (_ > 2 && (B = "flipbevel"), _ < i && (B = "miter")), y && this.updateDistance(y, p), "miter" === B) v._mult(_), this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("flipbevel" === B) {
                            if (_ > 100) v = m.mult(-1);
                            else {
                                var V = _ * d.add(m).mag() / d.sub(m).mag();
                                v._perp()._mult(V * (A ? -1 : 1));
                            }
                            this.addCurrentVertex(p, v, 0, 0, h), this.addCurrentVertex(p, v.mult(-1), 0, 0, h);
                        } else if ("bevel" === B || "fakeround" === B) {
                            var C = -Math.sqrt(_ * _ - 1),
                                M = A ? C : 0,
                                P = A ? 0 : C;
                            if (y && this.addCurrentVertex(p, d, M, P, h), "fakeround" === B)
                                for (var L = Math.round(180 * w / Math.PI / 20), T = 1; T < L; T++) {
                                    var D = T / L;
                                    if (.5 !== D) {
                                        var E = D - .5;
                                        D += D * E * (D - 1) * ((1.0904 + x * (x * (3.55645 - 1.43519 * x) - 3.2452)) * E * E + (.848013 + x * (.215638 * x - 1.06021)));
                                    }
                                    var F = m.sub(d)._mult(D)._add(d)._unit()._mult(A ? -1 : 1);
                                    this.addHalfVertex(p, F.x, F.y, !1, A, 0, h);
                                }
                            f && this.addCurrentVertex(p, m, -M, -P, h);
                        } else if ("butt" === B) this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("square" === B) {
                            var q = y ? 1 : -1;
                            this.addCurrentVertex(p, v, q, q, h);
                        } else "round" === B && (y && (this.addCurrentVertex(p, d, 0, 0, h), this.addCurrentVertex(p, d, 1, 1, h, !0)), f && (this.addCurrentVertex(p, m, -1, -1, h, !0), this.addCurrentVertex(p, m, 0, 0, h)));
                        if (k && g < u - 1) {
                            var O = p.dist(f);
                            if (O > 2 * c) {
                                var U = p.add(f.sub(p)._mult(c / O)._round());
                                this.updateDistance(p, U), this.addCurrentVertex(U, m, 0, 0, h), p = U;
                            }
                        }
                    }
            }
        }, vl.prototype.addCurrentVertex = function (t, e, r, n, i, a) {
            void 0 === a && (a = !1);
            var o = e.y * n - e.x,
                s = -e.y - e.x * n;
            this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, a, !1, r, i), this.addHalfVertex(t, o, s, a, !0, -n, i), this.distance > gl / 2 && 0 === this.totalDistance && (this.distance = 0, this.addCurrentVertex(t, e, r, n, i, a));
        }, vl.prototype.addHalfVertex = function (t, e, r, n, i, a, o) {
            var s = .5 * this.scaledDistance;
            this.layoutVertexArray.emplaceBack((t.x << 1) + (n ? 1 : 0), (t.y << 1) + (i ? 1 : 0), Math.round(63 * e) + 128, Math.round(63 * r) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1) | (63 & s) << 2, s >> 6, this.hSeq, this.seq, this._count);
            var u = o.vertexLength++;
            this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, u), o.primitiveLength++), i ? this.e2 = u : this.e1 = u;
        }, vl.prototype.updateScaledDistance = function () {
            this.scaledDistance = this.totalDistance > 0 ? (this.clipStart + (this.clipEnd - this.clipStart) * this.distance / this.totalDistance) * (gl - 1) : this.distance;
        }, vl.prototype.updateDistance = function (t, e) {
            this.distance += t.dist(e), this.updateScaledDistance();
        }, xn("AirlineBucket", vl, {
            omit: ["layers", "patternFeatures"]
        });
        var xl = new ri({
                "airline-cap": new $n(ut.layout_airline["airline-cap"]),
                "airline-join": new Wn(ut.layout_airline["airline-join"]),
                "airline-miter-limit": new $n(ut.layout_airline["airline-miter-limit"]),
                "airline-round-limit": new $n(ut.layout_airline["airline-round-limit"]),
                "airline-sort-key": new Wn(ut.layout_airline["airline-sort-key"])
            }),
            bl = {
                paint: new ri({
                    "airline-opacity": new Wn(ut.paint_airline["airline-opacity"]),
                    "airline-color": new Wn(ut.paint_airline["airline-color"]),
                    "airline-translate": new $n(ut.paint_airline["airline-translate"]),
                    "airline-translate-anchor": new $n(ut.paint_airline["airline-translate-anchor"]),
                    "airline-width": new Wn(ut.paint_airline["airline-width"]),
                    "airline-gap-width": new Wn(ut.paint_airline["airline-gap-width"]),
                    "airline-offset": new Wn(ut.paint_airline["airline-offset"]),
                    "airline-blur": new Wn(ut.paint_airline["airline-blur"]),
                    "airline-seg-group": new $n(ut.paint_airline["airline-seg-group"]),
                    "airline-speed": new $n(ut.paint_airline["airline-speed"]),
                    "airline-type": new $n(ut.paint_airline["airline-type"])
                }),
                layout: xl
            },
            _l = function (t) {
                function e(e) {
                    t.call(this, e, bl);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.createBucket = function (t) {
                    return new vl(t)
                }, e.prototype.queryRadius = function (t) {
                    var e = t,
                        r = wl(Oa("airline-width", this, e), Oa("airline-gap-width", this, e)),
                        n = Oa("airline-offset", this, e);
                    return r / 2 + Math.abs(n) + Ua(this.paint.get("airline-translate"))
                }, e.prototype.queryIntersectsFeature = function (t, e, r, n, a, o, s) {
                    var u = Ra(t, this.paint.get("airline-translate"), this.paint.get("airline-translate-anchor"), o.angle, s),
                        l = s / 2 * wl(this.paint.get("airline-width").evaluate(e, r), this.paint.get("airline-gap-width").evaluate(e, r)),
                        p = this.paint.get("airline-offset").evaluate(e, r);
                    return p && (n = function (t, e) {
                        for (var r = [], n = new i(0, 0), a = 0; a < t.length; a++) {
                            for (var o = t[a], s = [], u = 0; u < o.length; u++) {
                                var l = o[u],
                                    p = o[u + 1],
                                    c = 0 === u ? n : l.sub(o[u - 1])._unit()._perp(),
                                    h = u === o.length - 1 ? n : p.sub(l)._unit()._perp(),
                                    y = c._add(h)._unit();
                                y._mult(1 / (y.x * h.x + y.y * h.y)), s.push(y._mult(e)._add(l));
                            }
                            r.push(s);
                        }
                        return r
                    }(n, p * s)), Ca(u, n, l)
                }, e.prototype.isTileClipped = function () {
                    return !0
                }, e
            }(ni);

        function wl(t, e) {
            return e > 0 ? e + 2 * t : t
        }
        var kl = si([{
                name: "a_pos_normal",
                components: 2,
                type: "Int16"
            }, {
                name: "a_data",
                components: 4,
                type: "Uint8"
            }, {
                name: "a_seq",
                components: 1,
                type: "Uint16"
            }, {
                name: "a_info",
                components: 2,
                type: "Uint16"
            }], 4).members,
            Al = as.VectorTileFeature.types,
            Sl = Math.cos(Math.PI / 180 * 37.5),
            Il = Math.pow(2, 14) / .5,
            zl = function (t) {
                this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                    return t.id
                })), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new di, this.indexArray = new Si, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                    return t.isStateDependent()
                })).map((function (t) {
                    return t.id
                })), this.seq = 0, this.total = 0, this.offset = 0;
            };
        zl.prototype.populate = function (t, e, r) {
            for (var n = this.layers[0].layout.get("dynamicLine-sort-key"), i = [], a = 0, o = t; a < o.length; a += 1) {
                var s = o[a],
                    u = s.feature,
                    l = s.id,
                    p = s.index,
                    c = s.sourceLayerIndex,
                    h = this.layers[0]._featureFilter.needGeometry,
                    y = {
                        type: u.type,
                        id: l,
                        properties: u.properties,
                        geometry: h ? Aa(u) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), y, r)) {
                    h || (y.geometry = Aa(u));
                    var f = n ? n.evaluate(y, {}, r) : void 0;
                    i.push({
                        id: l,
                        properties: u.properties,
                        type: u.type,
                        sourceLayerIndex: c,
                        index: p,
                        geometry: y.geometry,
                        patterns: {},
                        sortKey: f
                    });
                }
            }
            n && i.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var d = 0, m = i; d < m.length; d += 1) {
                var g = m[d],
                    v = g.geometry,
                    x = g.index,
                    b = g.sourceLayerIndex;
                if (this.hasPattern) {
                    var _ = Xo("line", this.layers, g, this.zoom, e);
                    this.patternFeatures.push(_);
                } else this.addFeature(g, v, x, r, {});
                e.featureIndex.insert(t[x].feature, v, x, b, this.index);
            }
        }, zl.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, zl.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.patternFeatures; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, zl.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, zl.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, zl.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, kl), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, zl.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, zl.prototype.addFeature = function (t, e, r, n, i) {
            var a = this.layers[0].layout,
                o = a.get("dynamicLine-join").evaluate(t, {}),
                s = a.get("dynamicLine-cap"),
                u = a.get("dynamicLine-miter-limit"),
                l = a.get("dynamicLine-round-limit");
            this.seq = t.properties.link_seq, this.total = t.properties.total_link_count, this.offset = t.properties.offset_link_count;
            for (var p = 0, c = e; p < c.length; p += 1) this.addLine(c[p], t, o, s, u, l);
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, zl.prototype.addLine = function (t, e, r, n, i, a) {
            if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, e.properties && e.properties.hasOwnProperty("minemap_clip_start") && e.properties.hasOwnProperty("minemap_clip_end")) {
                this.clipStart = +e.properties.minemap_clip_start, this.clipEnd = +e.properties.minemap_clip_end;
                for (var o = 0; o < t.length - 1; o++) this.totalDistance += t[o].dist(t[o + 1]);
                this.updateScaledDistance();
            }
            for (var s = "Polygon" === Al[e.type], u = t.length; u >= 2 && t[u - 1].equals(t[u - 2]);) u--;
            for (var l = 0; l < u - 1 && t[l].equals(t[l + 1]);) l++;
            if (!(u < (s ? 3 : 2))) {
                "bevel" === r && (i = 1.05);
                var p, c = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
                    h = this.segments.prepareSegment(10 * u, this.layoutVertexArray, this.indexArray),
                    y = void 0,
                    f = void 0,
                    d = void 0,
                    m = void 0;
                this.e1 = this.e2 = -1, s && (m = t[l].sub(p = t[u - 2])._unit()._perp());
                for (var g = l; g < u; g++)
                    if (this.seq++, !(f = g === u - 1 ? s ? t[l + 1] : void 0 : t[g + 1]) || !t[g].equals(f)) {
                        m && (d = m), p && (y = p), p = t[g], m = f ? f.sub(p)._unit()._perp() : d;
                        var v = (d = d || m).add(m);
                        0 === v.x && 0 === v.y || v._unit();
                        var x = d.x * m.x + d.y * m.y,
                            b = v.x * m.x + v.y * m.y,
                            _ = 0 !== b ? 1 / b : 1 / 0,
                            w = 2 * Math.sqrt(2 - 2 * b),
                            k = b < Sl && y && f,
                            A = d.x * m.y - d.y * m.x > 0;
                        if (k && g > l) {
                            var S = p.dist(y);
                            if (S > 2 * c) {
                                var I = p.sub(p.sub(y)._mult(c / S)._round());
                                this.updateDistance(y, I), this.addCurrentVertex(I, d, 0, 0, h), y = I;
                            }
                        }
                        var z = y && f,
                            B = z ? r : s ? "butt" : n;
                        if (z && "round" === B && (_ < a ? B = "miter" : _ <= 2 && (B = "fakeround")), "miter" === B && _ > i && (B = "bevel"), "bevel" === B && (_ > 2 && (B = "flipbevel"), _ < i && (B = "miter")), y && this.updateDistance(y, p), "miter" === B) v._mult(_), this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("flipbevel" === B) {
                            if (_ > 100) v = m.mult(-1);
                            else {
                                var V = _ * d.add(m).mag() / d.sub(m).mag();
                                v._perp()._mult(V * (A ? -1 : 1));
                            }
                            this.addCurrentVertex(p, v, 0, 0, h), this.addCurrentVertex(p, v.mult(-1), 0, 0, h);
                        } else if ("bevel" === B || "fakeround" === B) {
                            var C = -Math.sqrt(_ * _ - 1),
                                M = A ? C : 0,
                                P = A ? 0 : C;
                            if (y && this.addCurrentVertex(p, d, M, P, h), "fakeround" === B)
                                for (var L = Math.round(180 * w / Math.PI / 20), T = 1; T < L; T++) {
                                    var D = T / L;
                                    if (.5 !== D) {
                                        var E = D - .5;
                                        D += D * E * (D - 1) * ((1.0904 + x * (x * (3.55645 - 1.43519 * x) - 3.2452)) * E * E + (.848013 + x * (.215638 * x - 1.06021)));
                                    }
                                    var F = m.sub(d)._mult(D)._add(d)._unit()._mult(A ? -1 : 1);
                                    this.addHalfVertex(p, F.x, F.y, !1, A, 0, h);
                                }
                            f && this.addCurrentVertex(p, m, -M, -P, h);
                        } else if ("butt" === B) this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("square" === B) {
                            var q = y ? 1 : -1;
                            this.addCurrentVertex(p, v, q, q, h);
                        } else "round" === B && (y && (this.addCurrentVertex(p, d, 0, 0, h), this.addCurrentVertex(p, d, 1, 1, h, !0)), f && (this.addCurrentVertex(p, m, -1, -1, h, !0), this.addCurrentVertex(p, m, 0, 0, h)));
                        if (k && g < u - 1) {
                            var O = p.dist(f);
                            if (O > 2 * c) {
                                var U = p.add(f.sub(p)._mult(c / O)._round());
                                this.updateDistance(p, U), this.addCurrentVertex(U, m, 0, 0, h), p = U;
                            }
                        }
                    }
            }
        }, zl.prototype.addCurrentVertex = function (t, e, r, n, i, a) {
            void 0 === a && (a = !1);
            var o = e.y * n - e.x,
                s = -e.y - e.x * n;
            this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, a, !1, r, i), this.addHalfVertex(t, o, s, a, !0, -n, i), this.distance > Il / 2 && 0 === this.totalDistance && (this.distance = 0, this.addCurrentVertex(t, e, r, n, i, a));
        }, zl.prototype.addHalfVertex = function (t, e, r, n, i, a, o) {
            var s = .5 * this.scaledDistance;
            this.layoutVertexArray.emplaceBack((t.x << 1) + (n ? 1 : 0), (t.y << 1) + (i ? 1 : 0), Math.round(63 * e) + 128, Math.round(63 * r) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1) | (63 & s) << 2, s >> 6, this.seq, this.total, this.offset);
            var u = o.vertexLength++;
            this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, u), o.primitiveLength++), i ? this.e2 = u : this.e1 = u;
        }, zl.prototype.updateScaledDistance = function () {
            this.scaledDistance = this.totalDistance > 0 ? (this.clipStart + (this.clipEnd - this.clipStart) * this.distance / this.totalDistance) * (Il - 1) : this.distance;
        }, zl.prototype.updateDistance = function (t, e) {
            this.distance += t.dist(e), this.updateScaledDistance();
        }, xn("DynamicLineBucket", zl, {
            omit: ["layers", "patternFeatures"]
        });
        var Bl = new ri({
                "dynamicLine-cap": new $n(ut.layout_dynamicLine["dynamicLine-cap"]),
                "dynamicLine-join": new Wn(ut.layout_dynamicLine["dynamicLine-join"]),
                "dynamicLine-miter-limit": new $n(ut.layout_dynamicLine["dynamicLine-miter-limit"]),
                "dynamicLine-round-limit": new $n(ut.layout_dynamicLine["dynamicLine-round-limit"]),
                "dynamicLine-sort-key": new Wn(ut.layout_dynamicLine["dynamicLine-sort-key"])
            }),
            Vl = {
                paint: new ri({
                    "dynamicLine-opacity": new Wn(ut.paint_dynamicLine["dynamicLine-opacity"]),
                    "dynamicLine-color": new Wn(ut.paint_dynamicLine["dynamicLine-color"]),
                    "dynamicLine-translate": new $n(ut.paint_dynamicLine["dynamicLine-translate"]),
                    "dynamicLine-translate-anchor": new $n(ut.paint_dynamicLine["dynamicLine-translate-anchor"]),
                    "dynamicLine-width": new Wn(ut.paint_dynamicLine["dynamicLine-width"]),
                    "dynamicLine-gap-width": new Wn(ut.paint_dynamicLine["dynamicLine-gap-width"]),
                    "dynamicLine-offset": new Wn(ut.paint_dynamicLine["dynamicLine-offset"]),
                    "dynamicLine-blur": new Wn(ut.paint_dynamicLine["dynamicLine-blur"]),
                    "dynamicLine-seg-group": new $n(ut.paint_dynamicLine["dynamicLine-seg-group"]),
                    "dynamicLine-speed": new $n(ut.paint_dynamicLine["dynamicLine-speed"])
                }),
                layout: Bl
            },
            Cl = new(function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.possiblyEvaluate = function (e, r) {
                    return r = new jn(Math.floor(r.zoom), {
                        now: r.now,
                        fadeDuration: r.fadeDuration,
                        zoomHistory: r.zoomHistory,
                        transition: r.transition
                    }), t.prototype.possiblyEvaluate.call(this, e, r)
                }, e.prototype.evaluate = function (e, r, n, i) {
                    return r = p({}, r, {
                        zoom: Math.floor(r.zoom)
                    }), t.prototype.evaluate.call(this, e, r, n, i)
                }, e
            }(Wn))(Vl.paint.properties["dynamicLine-width"].specification);
        Cl.useIntegerZoom = !0;
        var Ml = function (t) {
            function e(e) {
                t.call(this, e, Vl);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.recalculate = function (e, r) {
                t.prototype.recalculate.call(this, e, r), this.paint._values["dynamicLine-floorwidth"] = Cl.possiblyEvaluate(this._transitioningPaint._values["dynamicLine-width"].value, e);
            }, e.prototype.createBucket = function (t) {
                return new zl(t)
            }, e.prototype.queryRadius = function (t) {
                var e = t,
                    r = Pl(Oa("dynamicLine-width", this, e), Oa("dynamicLine-gap-width", this, e)),
                    n = Oa("dynamicLine-offset", this, e);
                return r / 2 + Math.abs(n) + Ua(this.paint.get("dynamicLine-translate"))
            }, e.prototype.queryIntersectsFeature = function (t, e, r, n, a, o, s) {
                var u = Ra(t, this.paint.get("dynamicLine-translate"), this.paint.get("dynamicLine-translate-anchor"), o.angle, s),
                    l = s / 2 * Pl(this.paint.get("dynamicLine-width").evaluate(e, r), this.paint.get("dynamicLine-gap-width").evaluate(e, r)),
                    p = this.paint.get("dynamicLine-offset").evaluate(e, r);
                return p && (n = function (t, e) {
                    for (var r = [], n = new i(0, 0), a = 0; a < t.length; a++) {
                        for (var o = t[a], s = [], u = 0; u < o.length; u++) {
                            var l = o[u],
                                p = o[u + 1],
                                c = 0 === u ? n : l.sub(o[u - 1])._unit()._perp(),
                                h = u === o.length - 1 ? n : p.sub(l)._unit()._perp(),
                                y = c._add(h)._unit();
                            y._mult(1 / (y.x * h.x + y.y * h.y)), s.push(y._mult(e)._add(l));
                        }
                        r.push(s);
                    }
                    return r
                }(n, p * s)), Ca(u, n, l)
            }, e.prototype.isTileClipped = function () {
                return !0
            }, e
        }(ni);

        function Pl(t, e) {
            return e > 0 ? e + 2 * t : t
        }
        var Ll = si([{
                name: "a_pos_normal",
                components: 2,
                type: "Int16"
            }, {
                name: "a_data",
                components: 4,
                type: "Uint8"
            }, {
                name: "a_extra_m",
                components: 3,
                type: "Uint8"
            }, {
                name: "a_i_p_e",
                components: 2,
                type: "Uint16"
            }], 4).members,
            Tl = as.VectorTileFeature.types,
            Dl = Math.cos(Math.PI / 180 * 37.5),
            El = Math.pow(2, 14) / .5,
            Fl = function (t) {
                this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                    return t.id
                })), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new mi, this.indexArray = new Si, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                    return t.isStateDependent()
                })).map((function (t) {
                    return t.id
                })), this.curOpacity = 0, this.curNum = 0, this.curStatus = 1, this._percent = 0;
            };
        Fl.prototype.populate = function (t, e, r) {
            for (var n = this.layers[0].layout.get("sprite-sort-key"), i = [], a = 0, o = t; a < o.length; a += 1) {
                var s = o[a],
                    u = s.feature,
                    l = s.id,
                    p = s.index,
                    c = s.sourceLayerIndex,
                    h = this.layers[0]._featureFilter.needGeometry,
                    y = {
                        type: u.type,
                        id: l,
                        properties: u.properties,
                        geometry: h ? Aa(u) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), y, r)) {
                    h || (y.geometry = Aa(u));
                    var f = n ? n.evaluate(y, {}, r) : void 0;
                    i.push({
                        id: l,
                        properties: u.properties,
                        type: u.type,
                        sourceLayerIndex: c,
                        index: p,
                        geometry: y.geometry,
                        patterns: {},
                        sortKey: f
                    });
                }
            }
            n && i.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var d = 0, m = i; d < m.length; d += 1) {
                var g = m[d],
                    v = g.geometry,
                    x = g.index,
                    b = g.sourceLayerIndex;
                if (this.hasPattern) {
                    var _ = Xo("line", this.layers, g, this.zoom, e);
                    this.patternFeatures.push(_);
                } else this.addFeature(g, v, x, r, {});
                e.featureIndex.insert(t[x].feature, v, x, b, this.index);
            }
        }, Fl.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, Fl.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.patternFeatures; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, Fl.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, Fl.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, Fl.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Ll), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, Fl.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, Fl.prototype.addFeature = function (t, e, r, n, i) {
            var a = this.layers[0].layout,
                o = a.get("sprite-join").evaluate(t, {}),
                s = a.get("sprite-cap"),
                u = a.get("sprite-miter-limit"),
                l = a.get("sprite-round-limit");
            this.curNum = t.properties.link_seq ? t.properties.link_seq : this.curNum, this.curNum %= 10, this.curStatus = t.properties.status || 1, this._percent = 100 * t.properties.link_seq / t.properties.total || 1;
            for (var p = 0, c = e; p < c.length; p += 1) this.addLine(c[p], t, o, s, u, l);
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, Fl.prototype.addLine = function (t, e, r, n, i, a) {
            if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, e.properties && e.properties.hasOwnProperty("minemap_clip_start") && e.properties.hasOwnProperty("minemap_clip_end")) {
                this.clipStart = +e.properties.minemap_clip_start, this.clipEnd = +e.properties.minemap_clip_end;
                for (var o = 0; o < t.length - 1; o++) this.totalDistance += t[o].dist(t[o + 1]);
                this.updateScaledDistance();
            }
            for (var s = "Polygon" === Tl[e.type], u = t.length; u >= 2 && t[u - 1].equals(t[u - 2]);) u--;
            for (var l = 0; l < u - 1 && t[l].equals(t[l + 1]);) l++;
            if (!(u < (s ? 3 : 2))) {
                "bevel" === r && (i = 1.05);
                var p, c = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
                    h = this.segments.prepareSegment(10 * u, this.layoutVertexArray, this.indexArray),
                    y = void 0,
                    f = void 0,
                    d = void 0,
                    m = void 0;
                this.e1 = this.e2 = -1, s && (m = t[l].sub(p = t[u - 2])._unit()._perp());
                for (var g = l; g < u; g++)
                    if (this.curOpacity = Math.round(255 / u * g), !(f = g === u - 1 ? s ? t[l + 1] : void 0 : t[g + 1]) || !t[g].equals(f)) {
                        m && (d = m), p && (y = p), p = t[g], m = f ? f.sub(p)._unit()._perp() : d;
                        var v = (d = d || m).add(m);
                        0 === v.x && 0 === v.y || v._unit();
                        var x = d.x * m.x + d.y * m.y,
                            b = v.x * m.x + v.y * m.y,
                            _ = 0 !== b ? 1 / b : 1 / 0,
                            w = 2 * Math.sqrt(2 - 2 * b),
                            k = b < Dl && y && f,
                            A = d.x * m.y - d.y * m.x > 0;
                        if (k && g > l) {
                            var S = p.dist(y);
                            if (S > 2 * c) {
                                var I = p.sub(p.sub(y)._mult(c / S)._round());
                                this.updateDistance(y, I), this.addCurrentVertex(I, d, 0, 0, h), y = I;
                            }
                        }
                        var z = y && f,
                            B = z ? r : s ? "butt" : n;
                        if (z && "round" === B && (_ < a ? B = "miter" : _ <= 2 && (B = "fakeround")), "miter" === B && _ > i && (B = "bevel"), "bevel" === B && (_ > 2 && (B = "flipbevel"), _ < i && (B = "miter")), y && this.updateDistance(y, p), "miter" === B) v._mult(_), this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("flipbevel" === B) {
                            if (_ > 100) v = m.mult(-1);
                            else {
                                var V = _ * d.add(m).mag() / d.sub(m).mag();
                                v._perp()._mult(V * (A ? -1 : 1));
                            }
                            this.addCurrentVertex(p, v, 0, 0, h), this.addCurrentVertex(p, v.mult(-1), 0, 0, h);
                        } else if ("bevel" === B || "fakeround" === B) {
                            var C = -Math.sqrt(_ * _ - 1),
                                M = A ? C : 0,
                                P = A ? 0 : C;
                            if (y && this.addCurrentVertex(p, d, M, P, h), "fakeround" === B)
                                for (var L = Math.round(180 * w / Math.PI / 20), T = 1; T < L; T++) {
                                    var D = T / L;
                                    if (.5 !== D) {
                                        var E = D - .5;
                                        D += D * E * (D - 1) * ((1.0904 + x * (x * (3.55645 - 1.43519 * x) - 3.2452)) * E * E + (.848013 + x * (.215638 * x - 1.06021)));
                                    }
                                    var F = m.sub(d)._mult(D)._add(d)._unit()._mult(A ? -1 : 1);
                                    this.addHalfVertex(p, F.x, F.y, !1, A, 0, h);
                                }
                            f && this.addCurrentVertex(p, m, -M, -P, h);
                        } else if ("butt" === B) this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("square" === B) {
                            var q = y ? 1 : -1;
                            this.addCurrentVertex(p, v, q, q, h);
                        } else "round" === B && (y && (this.addCurrentVertex(p, d, 0, 0, h), this.addCurrentVertex(p, d, 1, 1, h, !0)), f && (this.addCurrentVertex(p, m, -1, -1, h, !0), this.addCurrentVertex(p, m, 0, 0, h)));
                        if (k && g < u - 1) {
                            var O = p.dist(f);
                            if (O > 2 * c) {
                                var U = p.add(f.sub(p)._mult(c / O)._round());
                                this.updateDistance(p, U), this.addCurrentVertex(U, m, 0, 0, h), p = U;
                            }
                        }
                    }
            }
        }, Fl.prototype.addCurrentVertex = function (t, e, r, n, i, a) {
            void 0 === a && (a = !1);
            var o = e.y * n - e.x,
                s = -e.y - e.x * n;
            this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, a, !1, r, i), this.addHalfVertex(t, o, s, a, !0, -n, i), this.distance > El / 2 && 0 === this.totalDistance && (this.distance = 0, this.addCurrentVertex(t, e, r, n, i, a));
        }, Fl.prototype.addHalfVertex = function (t, e, r, n, i, a, o) {
            var s = t.z,
                u = .5 * this.scaledDistance;
            this.layoutVertexArray.emplaceBack((t.x << 1) + (n ? 1 : 0), (t.y << 1) + (i ? 1 : 0), Math.round(63 * e) + 128, Math.round(63 * r) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1) | (63 & u) << 2, u >> 6, 255 & this.curOpacity, parseInt(this.curNum), parseInt(this.curStatus), parseInt(0 === s ? 0 : s - 500 < 6 ? 6 : s - 500 + 6), parseInt(this._percent));
            var l = o.vertexLength++;
            this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, l), o.primitiveLength++), i ? this.e2 = l : this.e1 = l;
        }, Fl.prototype.updateScaledDistance = function () {
            this.scaledDistance = this.totalDistance > 0 ? (this.clipStart + (this.clipEnd - this.clipStart) * this.distance / this.totalDistance) * (El - 1) : this.distance;
        }, Fl.prototype.updateDistance = function (t, e) {
            this.distance += t.dist(e), this.updateScaledDistance();
        }, xn("SpriteBucket", Fl, {
            omit: ["layers", "patternFeatures"]
        });
        var ql = new ri({
                "sprite-cap": new $n(ut.layout_sprite["sprite-cap"]),
                "sprite-join": new Wn(ut.layout_sprite["sprite-join"]),
                "sprite-miter-limit": new $n(ut.layout_sprite["sprite-miter-limit"]),
                "sprite-round-limit": new $n(ut.layout_sprite["sprite-round-limit"]),
                "sprite-sort-key": new Wn(ut.layout_sprite["sprite-sort-key"])
            }),
            Ol = {
                paint: new ri({
                    "sprite-opacity": new Wn(ut.paint_sprite["sprite-opacity"]),
                    "sprite-color": new Wn(ut.paint_sprite["sprite-color"]),
                    "sprite-translate": new $n(ut.paint_sprite["sprite-translate"]),
                    "sprite-translate-anchor": new $n(ut.paint_sprite["sprite-translate-anchor"]),
                    "sprite-width": new Wn(ut.paint_sprite["sprite-width"]),
                    "sprite-gap-width": new Wn(ut.paint_sprite["sprite-gap-width"]),
                    "sprite-offset": new Wn(ut.paint_sprite["sprite-offset"]),
                    "sprite-blur": new Wn(ut.paint_sprite["sprite-blur"]),
                    "sprite-speed-factor": new Wn(ut.paint_sprite["sprite-speed-factor"]),
                    "sprite-speed": new $n(ut.paint_sprite["sprite-speed"])
                }),
                layout: ql
            },
            Ul = function (t) {
                function e(e) {
                    t.call(this, e, Ol);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.createBucket = function (t) {
                    return new Fl(t)
                }, e.prototype.queryRadius = function (t) {
                    var e = t,
                        r = Rl(Oa("sprite-width", this, e), Oa("sprite-gap-width", this, e)),
                        n = Oa("sprite-offset", this, e);
                    return r / 2 + Math.abs(n) + Ua(this.paint.get("sprite-translate"))
                }, e.prototype.queryIntersectsFeature = function (t, e, r, n, a, o, s) {
                    var u = Ra(t, this.paint.get("sprite-translate"), this.paint.get("sprite-translate-anchor"), o.angle, s),
                        l = s / 2 * Rl(this.paint.get("sprite-width").evaluate(e, r), this.paint.get("sprite-gap-width").evaluate(e, r)),
                        p = this.paint.get("sprite-offset").evaluate(e, r);
                    return p && (n = function (t, e) {
                        for (var r = [], n = new i(0, 0), a = 0; a < t.length; a++) {
                            for (var o = t[a], s = [], u = 0; u < o.length; u++) {
                                var l = o[u],
                                    p = o[u + 1],
                                    c = 0 === u ? n : l.sub(o[u - 1])._unit()._perp(),
                                    h = u === o.length - 1 ? n : p.sub(l)._unit()._perp(),
                                    y = c._add(h)._unit();
                                y._mult(1 / (y.x * h.x + y.y * h.y)), s.push(y._mult(e)._add(l));
                            }
                            r.push(s);
                        }
                        return r
                    }(n, p * s)), Ca(u, n, l)
                }, e.prototype.isTileClipped = function () {
                    return !0
                }, e
            }(ni);

        function Rl(t, e) {
            return e > 0 ? e + 2 * t : t
        }
        var jl = si([{
                name: "a_pos_normal",
                components: 2,
                type: "Int16"
            }, {
                name: "a_data",
                components: 4,
                type: "Uint8"
            }, {
                name: "a_seq",
                components: 1,
                type: "Uint16"
            }], 4).members,
            Nl = as.VectorTileFeature.types,
            Kl = Math.cos(Math.PI / 180 * 37.5),
            Xl = Math.pow(2, 14) / .5,
            Gl = function (t) {
                this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                    return t.id
                })), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new gi, this.indexArray = new Si, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                    return t.isStateDependent()
                })).map((function (t) {
                    return t.id
                })), this.seq = 0;
            };
        Gl.prototype.populate = function (t, e, r) {
            for (var n = this.layers[0].layout.get("tracking-sort-key"), i = [], a = 0, o = t; a < o.length; a += 1) {
                var s = o[a],
                    u = s.feature,
                    l = s.id,
                    p = s.index,
                    c = s.sourceLayerIndex,
                    h = this.layers[0]._featureFilter.needGeometry,
                    y = {
                        type: u.type,
                        id: l,
                        properties: u.properties,
                        geometry: h ? Aa(u) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), y, r)) {
                    h || (y.geometry = Aa(u));
                    var f = n ? n.evaluate(y, {}, r) : void 0;
                    i.push({
                        id: l,
                        properties: u.properties,
                        type: u.type,
                        sourceLayerIndex: c,
                        index: p,
                        geometry: y.geometry,
                        patterns: {},
                        sortKey: f
                    });
                }
            }
            n && i.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var d = 0, m = i; d < m.length; d += 1) {
                var g = m[d],
                    v = g.geometry,
                    x = g.index,
                    b = g.sourceLayerIndex;
                this.addFeature(g, v, x, r, {}), e.featureIndex.insert(t[x].feature, v, x, b, this.index);
            }
        }, Gl.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, Gl.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.patternFeatures; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, Gl.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, Gl.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, Gl.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, jl), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, Gl.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, Gl.prototype.addFeature = function (t, e, r, n, i) {
            var a = this.layers[0].layout,
                o = a.get("tracking-join").evaluate(t, {}),
                s = a.get("tracking-cap"),
                u = a.get("tracking-miter-limit"),
                l = a.get("tracking-round-limit");
            this.seq = t.properties.link_seq;
            for (var p = 0, c = e; p < c.length; p += 1) this.addTracking(c[p], t, o, s, u, l);
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, Gl.prototype.addTracking = function (t, e, r, n, i, a) {
            if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, e.properties && e.properties.hasOwnProperty("minemap_clip_start") && e.properties.hasOwnProperty("minemap_clip_end")) {
                this.clipStart = +e.properties.minemap_clip_start, this.clipEnd = +e.properties.minemap_clip_end;
                for (var o = 0; o < t.length - 1; o++) this.totalDistance += t[o].dist(t[o + 1]);
                this.updateScaledDistance();
            }
            for (var s = "Polygon" === Nl[e.type], u = t.length; u >= 2 && t[u - 1].equals(t[u - 2]);) u--;
            for (var l = 0; l < u - 1 && t[l].equals(t[l + 1]);) l++;
            if (!(u < (s ? 3 : 2))) {
                "bevel" === r && (i = 1.05);
                var p, c = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,
                    h = this.segments.prepareSegment(10 * u, this.layoutVertexArray, this.indexArray),
                    y = void 0,
                    f = void 0,
                    d = void 0,
                    m = void 0;
                this.e1 = this.e2 = -1, s && (m = t[l].sub(p = t[u - 2])._unit()._perp());
                for (var g = l; g < u; g++)
                    if (this.seq++, !(f = g === u - 1 ? s ? t[l + 1] : void 0 : t[g + 1]) || !t[g].equals(f)) {
                        m && (d = m), p && (y = p), p = t[g], m = f ? f.sub(p)._unit()._perp() : d;
                        var v = (d = d || m).add(m);
                        0 === v.x && 0 === v.y || v._unit();
                        var x = d.x * m.x + d.y * m.y,
                            b = v.x * m.x + v.y * m.y,
                            _ = 0 !== b ? 1 / b : 1 / 0,
                            w = 2 * Math.sqrt(2 - 2 * b),
                            k = b < Kl && y && f,
                            A = d.x * m.y - d.y * m.x > 0;
                        if (k && g > l) {
                            var S = p.dist(y);
                            if (S > 2 * c) {
                                var I = p.sub(p.sub(y)._mult(c / S)._round());
                                this.updateDistance(y, I), this.addCurrentVertex(I, d, 0, 0, h), y = I;
                            }
                        }
                        var z = y && f,
                            B = z ? r : s ? "butt" : n;
                        if (z && "round" === B && (_ < a ? B = "miter" : _ <= 2 && (B = "fakeround")), "miter" === B && _ > i && (B = "bevel"), "bevel" === B && (_ > 2 && (B = "flipbevel"), _ < i && (B = "miter")), y && this.updateDistance(y, p), "miter" === B) v._mult(_), this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("flipbevel" === B) {
                            if (_ > 100) v = m.mult(-1);
                            else {
                                var V = _ * d.add(m).mag() / d.sub(m).mag();
                                v._perp()._mult(V * (A ? -1 : 1));
                            }
                            this.addCurrentVertex(p, v, 0, 0, h), this.addCurrentVertex(p, v.mult(-1), 0, 0, h);
                        } else if ("bevel" === B || "fakeround" === B) {
                            var C = -Math.sqrt(_ * _ - 1),
                                M = A ? C : 0,
                                P = A ? 0 : C;
                            if (y && this.addCurrentVertex(p, d, M, P, h), "fakeround" === B)
                                for (var L = Math.round(180 * w / Math.PI / 20), T = 1; T < L; T++) {
                                    var D = T / L;
                                    if (.5 !== D) {
                                        var E = D - .5;
                                        D += D * E * (D - 1) * ((1.0904 + x * (x * (3.55645 - 1.43519 * x) - 3.2452)) * E * E + (.848013 + x * (.215638 * x - 1.06021)));
                                    }
                                    var F = m.sub(d)._mult(D)._add(d)._unit()._mult(A ? -1 : 1);
                                    this.addHalfVertex(p, F.x, F.y, !1, A, 0, h);
                                }
                            f && this.addCurrentVertex(p, m, -M, -P, h);
                        } else if ("butt" === B) this.addCurrentVertex(p, v, 0, 0, h);
                        else if ("square" === B) {
                            var q = y ? 1 : -1;
                            this.addCurrentVertex(p, v, q, q, h);
                        } else "round" === B && (y && (this.addCurrentVertex(p, d, 0, 0, h), this.addCurrentVertex(p, d, 1, 1, h, !0)), f && (this.addCurrentVertex(p, m, -1, -1, h, !0), this.addCurrentVertex(p, m, 0, 0, h)));
                        if (k && g < u - 1) {
                            var O = p.dist(f);
                            if (O > 2 * c) {
                                var U = p.add(f.sub(p)._mult(c / O)._round());
                                this.updateDistance(p, U), this.addCurrentVertex(U, m, 0, 0, h), p = U;
                            }
                        }
                    }
            }
        }, Gl.prototype.addCurrentVertex = function (t, e, r, n, i, a) {
            void 0 === a && (a = !1);
            var o = e.y * n - e.x,
                s = -e.y - e.x * n;
            this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, a, !1, r, i), this.addHalfVertex(t, o, s, a, !0, -n, i), this.distance > Xl / 2 && 0 === this.totalDistance && (this.distance = 0, this.addCurrentVertex(t, e, r, n, i, a));
        }, Gl.prototype.addHalfVertex = function (t, e, r, n, i, a, o) {
            var s = .5 * this.scaledDistance;
            this.layoutVertexArray.emplaceBack((t.x << 1) + (n ? 1 : 0), (t.y << 1) + (i ? 1 : 0), Math.round(63 * e) + 128, Math.round(63 * r) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1) | (63 & s) << 2, s >> 6, this.seq);
            var u = o.vertexLength++;
            this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, u), o.primitiveLength++), i ? this.e2 = u : this.e1 = u;
        }, Gl.prototype.updateScaledDistance = function () {
            this.scaledDistance = this.totalDistance > 0 ? (this.clipStart + (this.clipEnd - this.clipStart) * this.distance / this.totalDistance) * (Xl - 1) : this.distance;
        }, Gl.prototype.updateDistance = function (t, e) {
            this.distance += t.dist(e), this.updateScaledDistance();
        }, xn("TrackingBucket", Gl, {
            omit: ["layers", "patternFeatures"]
        });
        var Hl = new ri({
                "tracking-cap": new $n(ut.layout_tracking["tracking-cap"]),
                "tracking-join": new Wn(ut.layout_tracking["tracking-join"]),
                "tracking-miter-limit": new $n(ut.layout_tracking["tracking-miter-limit"]),
                "tracking-round-limit": new $n(ut.layout_tracking["tracking-round-limit"]),
                "tracking-sort-key": new Wn(ut.layout_tracking["tracking-sort-key"]),
                "tracking-display-mode": new $n(ut.layout_tracking["tracking-display-mode"])
            }),
            Yl = {
                paint: new ri({
                    "tracking-opacity": new Wn(ut.paint_tracking["tracking-opacity"]),
                    "tracking-color": new Wn(ut.paint_tracking["tracking-color"]),
                    "tracking-translate": new $n(ut.paint_tracking["tracking-translate"]),
                    "tracking-translate-anchor": new $n(ut.paint_tracking["tracking-translate-anchor"]),
                    "tracking-width": new Wn(ut.paint_tracking["tracking-width"]),
                    "tracking-gap-width": new Wn(ut.paint_tracking["tracking-gap-width"]),
                    "tracking-offset": new Wn(ut.paint_tracking["tracking-offset"]),
                    "tracking-blur": new Wn(ut.paint_tracking["tracking-blur"]),
                    "tracking-seg-count": new $n(ut.paint_tracking["tracking-seg-count"]),
                    "tracking-seg-group": new $n(ut.paint_tracking["tracking-seg-group"]),
                    "tracking-speed": new $n(ut.paint_tracking["tracking-speed"])
                }),
                layout: Hl
            };
        new(function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.possiblyEvaluate = function (e, r) {
                return r = new jn(Math.floor(r.zoom), {
                    now: r.now,
                    fadeDuration: r.fadeDuration,
                    zoomHistory: r.zoomHistory,
                    transition: r.transition
                }), t.prototype.possiblyEvaluate.call(this, e, r)
            }, e.prototype.evaluate = function (e, r, n, i) {
                return r = p({}, r, {
                    zoom: Math.floor(r.zoom)
                }), t.prototype.evaluate.call(this, e, r, n, i)
            }, e
        }(Wn))(Yl.paint.properties["tracking-width"].specification).useIntegerZoom = !0;
        var Zl = function (t) {
            function e(e) {
                t.call(this, e, Yl);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.createBucket = function (t) {
                return new Gl(t)
            }, e.prototype.queryRadius = function (t) {
                var e = t,
                    r = Jl(Oa("tracking-width", this, e), Oa("tracking-gap-width", this, e)),
                    n = Oa("tracking-offset", this, e);
                return r / 2 + Math.abs(n) + Ua(this.paint.get("tracking-translate"))
            }, e.prototype.queryIntersectsFeature = function (t, e, r, n, a, o, s) {
                var u = Ra(t, this.paint.get("tracking-translate"), this.paint.get("tracking-translate-anchor"), o.angle, s),
                    l = s / 2 * Jl(this.paint.get("tracking-width").evaluate(e, r), this.paint.get("tracking-gap-width").evaluate(e, r)),
                    p = this.paint.get("tracking-offset").evaluate(e, r);
                return p && (n = function (t, e) {
                    for (var r = [], n = new i(0, 0), a = 0; a < t.length; a++) {
                        for (var o = t[a], s = [], u = 0; u < o.length; u++) {
                            var l = o[u],
                                p = o[u + 1],
                                c = 0 === u ? n : l.sub(o[u - 1])._unit()._perp(),
                                h = u === o.length - 1 ? n : p.sub(l)._unit()._perp(),
                                y = c._add(h)._unit();
                            y._mult(1 / (y.x * h.x + y.y * h.y)), s.push(y._mult(e)._add(l));
                        }
                        r.push(s);
                    }
                    return r
                }(n, p * s)), Ca(u, n, l)
            }, e.prototype.isTileClipped = function () {
                return !0
            }, e
        }(ni);

        function Jl(t, e) {
            return e > 0 ? e + 2 * t : t
        }
        var $l = si([{
                name: "a_pos_offset",
                components: 4,
                type: "Int16"
            }, {
                name: "a_data",
                components: 4,
                type: "Uint16"
            }, {
                name: "a_pixeloffset",
                components: 4,
                type: "Int16"
            }, {
                name: "a_extra",
                components: 1,
                type: "Uint16"
            }], 4),
            Wl = si([{
                name: "a_projected_pos",
                components: 3,
                type: "Float32"
            }], 4),
            Ql = (si([{
                name: "a_fade_opacity",
                components: 1,
                type: "Uint32"
            }], 4), si([{
                name: "a_placed",
                components: 2,
                type: "Uint8"
            }, {
                name: "a_shift",
                components: 2,
                type: "Float32"
            }])),
            tp = (si([{
                type: "Int16",
                name: "anchorPointX"
            }, {
                type: "Int16",
                name: "anchorPointY"
            }, {
                type: "Int16",
                name: "x1"
            }, {
                type: "Int16",
                name: "y1"
            }, {
                type: "Int16",
                name: "x2"
            }, {
                type: "Int16",
                name: "y2"
            }, {
                type: "Uint32",
                name: "featureIndex"
            }, {
                type: "Uint16",
                name: "sourceLayerIndex"
            }, {
                type: "Uint16",
                name: "bucketIndex"
            }]), si([{
                name: "a_pos",
                components: 2,
                type: "Int16"
            }, {
                name: "a_anchor_pos",
                components: 2,
                type: "Int16"
            }, {
                name: "a_extrude",
                components: 2,
                type: "Int16"
            }], 4)),
            ep = (si([{
                name: "a_pos",
                components: 2,
                type: "Float32"
            }, {
                name: "a_radius",
                components: 1,
                type: "Float32"
            }, {
                name: "a_flags",
                components: 2,
                type: "Int16"
            }], 4), si([{
                name: "triangle",
                components: 3,
                type: "Uint16"
            }]), si([{
                type: "Int16",
                name: "anchorX"
            }, {
                type: "Int16",
                name: "anchorY"
            }, {
                type: "Uint16",
                name: "glyphStartIndex"
            }, {
                type: "Uint16",
                name: "numGlyphs"
            }, {
                type: "Uint32",
                name: "vertexStartIndex"
            }, {
                type: "Uint32",
                name: "lineStartIndex"
            }, {
                type: "Uint32",
                name: "lineLength"
            }, {
                type: "Uint16",
                name: "segment"
            }, {
                type: "Uint16",
                name: "lowerSize"
            }, {
                type: "Uint16",
                name: "upperSize"
            }, {
                type: "Float32",
                name: "lineOffsetX"
            }, {
                type: "Float32",
                name: "lineOffsetY"
            }, {
                type: "Uint8",
                name: "writingMode"
            }, {
                type: "Uint8",
                name: "placedOrientation"
            }, {
                type: "Uint8",
                name: "hidden"
            }, {
                type: "Uint32",
                name: "crossTileID"
            }, {
                type: "Int16",
                name: "associatedIconIndex"
            }]), si([{
                type: "Int16",
                name: "anchorX"
            }, {
                type: "Int16",
                name: "anchorY"
            }, {
                type: "Int16",
                name: "rightJustifiedTextSymbolIndex"
            }, {
                type: "Int16",
                name: "centerJustifiedTextSymbolIndex"
            }, {
                type: "Int16",
                name: "leftJustifiedTextSymbolIndex"
            }, {
                type: "Int16",
                name: "verticalPlacedTextSymbolIndex"
            }, {
                type: "Int16",
                name: "placedIconSymbolIndex"
            }, {
                type: "Int16",
                name: "verticalPlacedIconSymbolIndex"
            }, {
                type: "Uint16",
                name: "key"
            }, {
                type: "Uint16",
                name: "textBoxStartIndex"
            }, {
                type: "Uint16",
                name: "textBoxEndIndex"
            }, {
                type: "Uint16",
                name: "verticalTextBoxStartIndex"
            }, {
                type: "Uint16",
                name: "verticalTextBoxEndIndex"
            }, {
                type: "Uint16",
                name: "iconBoxStartIndex"
            }, {
                type: "Uint16",
                name: "iconBoxEndIndex"
            }, {
                type: "Uint16",
                name: "verticalIconBoxStartIndex"
            }, {
                type: "Uint16",
                name: "verticalIconBoxEndIndex"
            }, {
                type: "Uint16",
                name: "featureIndex"
            }, {
                type: "Uint16",
                name: "numHorizontalGlyphVertices"
            }, {
                type: "Uint16",
                name: "numVerticalGlyphVertices"
            }, {
                type: "Uint16",
                name: "numIconVertices"
            }, {
                type: "Uint16",
                name: "numVerticalIconVertices"
            }, {
                type: "Uint16",
                name: "useRuntimeCollisionCircles"
            }, {
                type: "Uint32",
                name: "crossTileID"
            }, {
                type: "Float32",
                name: "textBoxScale"
            }, {
                type: "Float32",
                components: 2,
                name: "textOffset"
            }, {
                type: "Float32",
                name: "collisionCircleDiameter"
            }]), si([{
                type: "Float32",
                name: "offsetX"
            }]), si([{
                type: "Int16",
                name: "x"
            }, {
                type: "Int16",
                name: "y"
            }, {
                type: "Int16",
                name: "tileUnitDistanceFromAnchor"
            }]), as.VectorTileFeature.types),
            rp = [{
                name: "a_fade_opacity",
                components: 1,
                type: "Uint8",
                offset: 0
            }];

        function np(t, e, r, n, i, a, o, s, u, l, p, c, h, y) {
            var f = s ? Math.min(32640, Math.round(s[0])) : 0,
                d = s ? Math.min(32640, Math.round(s[1])) : 0;
            t.emplaceBack(e, r, Math.round(32 * n), Math.round(32 * i), a, o, (f << 1) + (u ? 1 : 0), d, 16 * l, 16 * p, 256 * c, 256 * h, y);
        }

        function ip(t, e, r) {
            t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r), t.emplaceBack(e.x, e.y, r);
        }

        function ap(t) {
            for (var e = 0, r = t.sections; e < r.length; e += 1)
                if (Pn(r[e].text)) return !0;
            return !1
        }
        var op = function (t) {
            this.layoutVertexArray = new Ci, this.indexArray = new Si, this.programConfigurations = t, this.segments = new Hi, this.dynamicLayoutVertexArray = new xi, this.opacityVertexArray = new bi, this.placedSymbolArray = new Oi;
        };
        op.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length
        }, op.prototype.upload = function (t, e, r, n) {
            this.isEmpty() || (r && (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, $l.members), this.indexBuffer = t.createIndexBuffer(this.indexArray, e), this.dynamicLayoutVertexBuffer = t.createVertexBuffer(this.dynamicLayoutVertexArray, Wl.members, !0), this.opacityVertexBuffer = t.createVertexBuffer(this.opacityVertexArray, rp, !0), this.opacityVertexBuffer.itemSize = 1), (r || n) && this.programConfigurations.upload(t));
        }, op.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy());
        }, xn("SymtrackingBuffers", op);
        var sp = function (t, e, r) {
            this.layoutVertexArray = new t, this.layoutAttributes = e, this.indexArray = new r, this.segments = new Hi, this.collisionVertexArray = new Ai;
        };
        sp.prototype.upload = function (t) {
            this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t.createVertexBuffer(this.collisionVertexArray, Ql.members, !0);
        }, sp.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy());
        }, xn("CollisionBuffersMineMap", sp);
        var up = function (t) {
            this.collisionBoxArray = t.collisionBoxArray, this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                return t.id
            })), this.index = t.index, this.pixelRatio = t.pixelRatio, this.sourceLayerIndex = t.sourceLayerIndex, this.hasPattern = !1, this.hasRTLText = !1, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = Xa([]), this.placementViewportMatrix = Xa([]);
            var e = this.layers[0]._unevaluatedLayout._values;
            this.textSizeData = _u(this.zoom, e["text-size"]), this.iconSizeData = _u(this.zoom, e["icon-size"]);
            var r = this.layers[0].layout,
                n = r.get("symbol-sort-key"),
                i = r.get("symbol-z-order");
            this.sortFeaturesByKey = "viewport-y" !== i && void 0 !== n.constantOr(1), this.sortFeaturesByY = ("viewport-y" === i || "auto" === i && !this.sortFeaturesByKey) && (r.get("text-allow-overlap") || r.get("icon-allow-overlap") || r.get("text-ignore-placement") || r.get("icon-ignore-placement")), "point" === r.get("symbol-placement") && (this.writingModes = r.get("text-writing-mode").map((function (t) {
                return ou[t]
            }))), this.stateDependentLayerIds = this.layers.filter((function (t) {
                return t.isStateDependent()
            })).map((function (t) {
                return t.id
            })), this.sourceID = t.sourceID;
        };
        up.prototype.createArrays = function () {
            this.text = new op(new ba(this.layers, this.zoom, (function (t) {
                return /^text/.test(t)
            }))), this.icon = new op(new ba(this.layers, this.zoom, (function (t) {
                return /^icon/.test(t)
            }))), this.glyphOffsetArray = new ji, this.lineVertexArray = new Ni, this.symbolInstances = new Ri;
        }, up.prototype.calculateGlyphDependencies = function (t, e, r, n, i) {
            for (var a = 0; a < t.length; a++)
                if (e[t.charCodeAt(a)] = !0, (r || n) && i) {
                    var o = Ps[t.charAt(a)];
                    o && (e[o.charCodeAt(0)] = !0);
                }
        }, up.prototype.populate = function (t, e, r) {
            var n = this.layers[0],
                i = n.layout,
                a = i.get("text-font"),
                o = i.get("text-field"),
                s = i.get("icon-image"),
                u = ("constant" !== o.value.kind || o.value.value instanceof Ft && !o.value.value.isEmpty() || o.value.value.toString().length > 0) && ("constant" !== a.value.kind || a.value.value.length > 0),
                l = "constant" !== s.value.kind || !!s.value.value || Object.keys(s.parameters).length > 0,
                p = i.get("symbol-sort-key");
            if (this.features = [], u || l) {
                for (var c = e.iconDependencies, h = e.glyphDependencies, y = e.availableImages, f = new jn(this.zoom), d = 0, m = t; d < m.length; d += 1) {
                    var g = m[d],
                        v = g.feature,
                        x = g.id,
                        b = g.index,
                        _ = g.sourceLayerIndex,
                        w = n._featureFilter.needGeometry,
                        k = {
                            type: v.type,
                            id: x,
                            properties: v.properties,
                            geometry: w ? Aa(v) : []
                        };
                    if (n._featureFilter.filter(f, k, r)) {
                        w || (k.geometry = Aa(v));
                        var A = void 0;
                        if (u) {
                            var S = n.getValueAndResolveTokens("text-field", k, r, y),
                                I = Ft.factory(S);
                            ap(I) && (this.hasRTLText = !0), (!this.hasRTLText || "unavailable" === On() || this.hasRTLText && Rn.isParsed()) && (A = Cs(I, n, k));
                        }
                        var z = void 0;
                        if (l) {
                            var B = n.getValueAndResolveTokens("icon-image", k, r, y);
                            z = B instanceof qt ? B : qt.fromString(B);
                        }
                        if (A || z) {
                            var V = this.sortFeaturesByKey ? p.evaluate(k, {}, r) : void 0,
                                C = {
                                    id: x,
                                    text: A,
                                    icon: z,
                                    index: b,
                                    sourceLayerIndex: _,
                                    geometry: Aa(v),
                                    properties: v.properties,
                                    type: ep[v.type],
                                    sortKey: V
                                };
                            if (this.features.push(C), z && (c[z.name] = !0), A) {
                                var M = a.evaluate(k, {}, r).join(","),
                                    P = "map" === i.get("text-rotation-alignment") && "point" !== i.get("symbol-placement");
                                this.allowVerticalPlacement = this.writingModes && this.writingModes.indexOf(ou.vertical) >= 0;
                                for (var L = 0, T = A.sections; L < T.length; L += 1) {
                                    var D = T[L];
                                    if (D.image) c[D.image.name] = !0;
                                    else {
                                        var E = zn(A.toString()),
                                            F = D.fontStack || M,
                                            q = h[F] = h[F] || {};
                                        this.calculateGlyphDependencies(D.text, q, P, this.allowVerticalPlacement, E);
                                    }
                                }
                            }
                        }
                    }
                }
                "line" === i.get("symbol-placement") && (this.features = Ms(this.features)), this.sortFeaturesByKey && this.features.sort((function (t, e) {
                    return t.sortKey - e.sortKey
                }));
            }
        }, up.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t, e, this.layers, r), this.icon.programConfigurations.updatePaintArrays(t, e, this.layers, r));
        }, up.prototype.isEmpty = function () {
            return 0 === this.symbolInstances.length && !this.hasRTLText
        }, up.prototype.uploadPending = function () {
            return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload
        }, up.prototype.upload = function (t) {
            !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t), this.iconCollisionBox.upload(t)), this.text.upload(t, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = !0;
        }, up.prototype.destroyDebugData = function () {
            this.textCollisionBox.destroy(), this.iconCollisionBox.destroy();
        }, up.prototype.destroy = function () {
            this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData();
        }, up.prototype.addToLineVertexArray = function (t, e) {
            var r = this.lineVertexArray.length;
            if (void 0 !== t.segment) {
                for (var n = t.dist(e[t.segment + 1]), i = t.dist(e[t.segment]), a = {}, o = t.segment + 1; o < e.length; o++) a[o] = {
                    x: e[o].x,
                    y: e[o].y,
                    tileUnitDistanceFromAnchor: n
                }, o < e.length - 1 && (n += e[o + 1].dist(e[o]));
                for (var s = t.segment || 0; s >= 0; s--) a[s] = {
                    x: e[s].x,
                    y: e[s].y,
                    tileUnitDistanceFromAnchor: i
                }, s > 0 && (i += e[s - 1].dist(e[s]));
                for (var u = 0; u < e.length; u++) {
                    var l = a[u];
                    this.lineVertexArray.emplaceBack(l.x, l.y, l.tileUnitDistanceFromAnchor);
                }
            }
            return {
                lineStartIndex: r,
                lineLength: this.lineVertexArray.length - r
            }
        }, up.prototype.addSymbols = function (t, e, r, n, i, a, o, s, u, l, p, c) {
            for (var h = t.indexArray, y = t.layoutVertexArray, f = t.segments.prepareSegment(4 * e.length, y, h, a.sortKey), d = this.glyphOffsetArray.length, m = f.vertexLength, g = this.allowVerticalPlacement && o === ou.vertical ? Math.PI / 2 : 0, v = a.text && a.text.sections, x = 0; x < e.length; x++) {
                var b = e[x],
                    _ = b.tl,
                    w = b.tr,
                    k = b.bl,
                    A = b.br,
                    S = b.tex,
                    I = b.pixelOffsetTL,
                    z = b.pixelOffsetBR,
                    B = b.minFontScaleX,
                    V = b.minFontScaleY,
                    C = b.glyphOffset,
                    M = b.isSDF,
                    P = b.sectionIndex,
                    L = f.vertexLength,
                    T = C[1];
                np(y, s.x, s.y, _.x, T + _.y, S.x, S.y, r, M, I.x, I.y, B, V, a.properties.link_seq), np(y, s.x, s.y, w.x, T + w.y, S.x + S.w, S.y, r, M, z.x, I.y, B, V, a.properties.link_seq), np(y, s.x, s.y, k.x, T + k.y, S.x, S.y + S.h, r, M, I.x, z.y, B, V, a.properties.link_seq), np(y, s.x, s.y, A.x, T + A.y, S.x + S.w, S.y + S.h, r, M, z.x, z.y, B, V, a.properties.link_seq), ip(t.dynamicLayoutVertexArray, s, g), h.emplaceBack(L, L + 1, L + 2), h.emplaceBack(L + 1, L + 2, L + 3), f.vertexLength += 4, f.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(C[0]), x !== e.length - 1 && P === e[x + 1].sectionIndex || t.programConfigurations.populatePaintArrays(y.length, a, a.index, {}, c, v && v[P]);
            }
            t.placedSymbolArray.emplaceBack(s.x, s.y, d, this.glyphOffsetArray.length - d, m, u, l, s.segment, r ? r[0] : 0, r ? r[1] : 0, n[0], n[1], o, 0, !1, 0, p);
        }, up.prototype._addCollisionDebugVertex = function (t, e, r, n, i, a) {
            return e.emplaceBack(0, 0), t.emplaceBack(r.x, r.y, n, i, Math.round(a.x), Math.round(a.y))
        }, up.prototype.addCollisionDebugVertices = function (t, e, r, n, a, o, s) {
            var u = a.segments.prepareSegment(4, a.layoutVertexArray, a.indexArray),
                l = u.vertexLength,
                p = a.layoutVertexArray,
                c = a.collisionVertexArray,
                h = s.anchorX,
                y = s.anchorY;
            this._addCollisionDebugVertex(p, c, o, h, y, new i(t, e)), this._addCollisionDebugVertex(p, c, o, h, y, new i(r, e)), this._addCollisionDebugVertex(p, c, o, h, y, new i(r, n)), this._addCollisionDebugVertex(p, c, o, h, y, new i(t, n)), u.vertexLength += 4;
            var f = a.indexArray;
            f.emplaceBack(l, l + 1), f.emplaceBack(l + 1, l + 2), f.emplaceBack(l + 2, l + 3), f.emplaceBack(l + 3, l), u.primitiveLength += 4;
        }, up.prototype.addDebugCollisionBoxes = function (t, e, r, n) {
            for (var i = t; i < e; i++) {
                var a = this.collisionBoxArray.get(i);
                this.addCollisionDebugVertices(a.x1, a.y1, a.x2, a.y2, n ? this.textCollisionBox : this.iconCollisionBox, a.anchorPoint, r);
            }
        }, up.prototype.generateCollisionDebugBuffers = function () {
            this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new sp(wi, tp.members, Pi), this.iconCollisionBox = new sp(wi, tp.members, Pi);
            for (var t = 0; t < this.symbolInstances.length; t++) {
                var e = this.symbolInstances.get(t);
                this.addDebugCollisionBoxes(e.textBoxStartIndex, e.textBoxEndIndex, e, !0), this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex, e.verticalTextBoxEndIndex, e, !0), this.addDebugCollisionBoxes(e.iconBoxStartIndex, e.iconBoxEndIndex, e, !1), this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex, e.verticalIconBoxEndIndex, e, !1);
            }
        }, up.prototype._deserializeCollisionBoxesForSymbol = function (t, e, r, n, i, a, o, s, u) {
            for (var l = {}, p = e; p < r; p++) {
                var c = t.get(p);
                l.textBox = {
                    x1: c.x1,
                    y1: c.y1,
                    x2: c.x2,
                    y2: c.y2,
                    anchorPointX: c.anchorPointX,
                    anchorPointY: c.anchorPointY
                }, l.textFeatureIndex = c.featureIndex;
                break
            }
            for (var h = n; h < i; h++) {
                var y = t.get(h);
                l.verticalTextBox = {
                    x1: y.x1,
                    y1: y.y1,
                    x2: y.x2,
                    y2: y.y2,
                    anchorPointX: y.anchorPointX,
                    anchorPointY: y.anchorPointY
                }, l.verticalTextFeatureIndex = y.featureIndex;
                break
            }
            for (var f = a; f < o; f++) {
                var d = t.get(f);
                l.iconBox = {
                    x1: d.x1,
                    y1: d.y1,
                    x2: d.x2,
                    y2: d.y2,
                    anchorPointX: d.anchorPointX,
                    anchorPointY: d.anchorPointY
                }, l.iconFeatureIndex = d.featureIndex;
                break
            }
            for (var m = s; m < u; m++) {
                var g = t.get(m);
                l.verticalIconBox = {
                    x1: g.x1,
                    y1: g.y1,
                    x2: g.x2,
                    y2: g.y2,
                    anchorPointX: g.anchorPointX,
                    anchorPointY: g.anchorPointY
                }, l.verticalIconFeatureIndex = g.featureIndex;
                break
            }
            return l
        }, up.prototype.deserializeCollisionBoxes = function (t) {
            this.collisionArrays = [];
            for (var e = 0; e < this.symbolInstances.length; e++) {
                var r = this.symbolInstances.get(e);
                this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t, r.textBoxStartIndex, r.textBoxEndIndex, r.verticalTextBoxStartIndex, r.verticalTextBoxEndIndex, r.iconBoxStartIndex, r.iconBoxEndIndex, r.verticalIconBoxStartIndex, r.verticalIconBoxEndIndex));
            }
        }, up.prototype.hasTextData = function () {
            return this.text.segments.get().length > 0
        }, up.prototype.hasIconData = function () {
            return this.icon.segments.get().length > 0
        }, up.prototype.hasDebugData = function () {
            return this.textCollisionBox && this.iconCollisionBox
        }, up.prototype.hasTextCollisionBoxData = function () {
            return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0
        }, up.prototype.hasIconCollisionBoxData = function () {
            return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0
        }, up.prototype.addIndicesForPlacedSymbol = function (t, e) {
            for (var r = t.placedSymbolArray.get(e), n = r.vertexStartIndex + 4 * r.numGlyphs, i = r.vertexStartIndex; i < n; i += 4) t.indexArray.emplaceBack(i, i + 1, i + 2), t.indexArray.emplaceBack(i + 1, i + 2, i + 3);
        }, up.prototype.getSortedSymbolIndexes = function (t) {
            if (this.sortedAngle === t && void 0 !== this.symbolInstanceIndexes) return this.symbolInstanceIndexes;
            for (var e = Math.sin(t), r = Math.cos(t), n = [], i = [], a = [], o = 0; o < this.symbolInstances.length; ++o) {
                a.push(o);
                var s = this.symbolInstances.get(o);
                n.push(0 | Math.round(e * s.anchorX + r * s.anchorY)), i.push(s.featureIndex);
            }
            return a.sort((function (t, e) {
                return n[t] - n[e] || i[e] - i[t]
            })), a
        }, up.prototype.addToSortKeyRanges = function (t, e) {
            var r = this.sortKeyRanges[this.sortKeyRanges.length - 1];
            r && r.sortKey === e ? r.symbolInstanceEnd = t + 1 : this.sortKeyRanges.push({
                sortKey: e,
                symbolInstanceStart: t,
                symbolInstanceEnd: t + 1
            });
        }, up.prototype.sortFeatures = function (t) {
            var e = this;
            if (this.sortFeaturesByY && this.sortedAngle !== t && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {
                this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t), this.sortedAngle = t, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];
                for (var r = 0, n = this.symbolInstanceIndexes; r < n.length; r += 1) {
                    var i = this.symbolInstances.get(n[r]);
                    this.featureSortOrder.push(i.featureIndex), [i.rightJustifiedTextSymbolIndex, i.centerJustifiedTextSymbolIndex, i.leftJustifiedTextSymbolIndex].forEach((function (t, r, n) {
                        t >= 0 && n.indexOf(t) === r && e.addIndicesForPlacedSymbol(e.text, t);
                    })), i.verticalPlacedTextSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.text, i.verticalPlacedTextSymbolIndex), i.placedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, i.placedIconSymbolIndex), i.verticalPlacedIconSymbolIndex >= 0 && this.addIndicesForPlacedSymbol(this.icon, i.verticalPlacedIconSymbolIndex);
                }
                this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray);
            }
        }, xn("SymtrackingBucket", up, {
            omit: ["layers", "collisionBoxArray", "features", "compareText"]
        }), up.MAX_GLYPHS = 65535, up.addDynamicAttributes = ip;
        var lp = new ri({
                "symtracking-time-segment": new $n(ut.layout_symtracking["symtracking-time-segment"]),
                "symtracking-fps": new $n(ut.layout_symtracking["symtracking-fps"]),
                "compatible-mode": new $n(ut.layout_symtracking["compatible-mode"]),
                "symbol-spacing": new $n(ut.layout_symtracking["symbol-spacing"]),
                "symbol-sort-key": new Wn(ut.layout_symtracking["symbol-sort-key"]),
                "symbol-z-order": new $n(ut.layout_symtracking["symbol-z-order"]),
                "symbol-placement": new $n(ut.layout_symtracking["symbol-placement"]),
                "symbol-avoid-edges": new $n(ut.layout_symtracking["symbol-avoid-edges"]),
                "icon-allow-overlap": new $n(ut.layout_symtracking["icon-allow-overlap"]),
                "icon-ignore-placement": new $n(ut.layout_symtracking["icon-ignore-placement"]),
                "icon-optional": new $n(ut.layout_symtracking["icon-optional"]),
                "icon-rotation-alignment": new $n(ut.layout_symtracking["icon-rotation-alignment"]),
                "icon-size": new Wn(ut.layout_symtracking["icon-size"]),
                "icon-text-fit": new $n(ut.layout_symtracking["icon-text-fit"]),
                "icon-text-fit-padding": new $n(ut.layout_symtracking["icon-text-fit-padding"]),
                "icon-image": new Wn(ut.layout_symtracking["icon-image"]),
                "icon-rotate": new Wn(ut.layout_symtracking["icon-rotate"]),
                "icon-padding": new $n(ut.layout_symtracking["icon-padding"]),
                "icon-keep-upright": new $n(ut.layout_symtracking["icon-keep-upright"]),
                "icon-offset": new Wn(ut.layout_symtracking["icon-offset"]),
                "icon-anchor": new Wn(ut.layout_symtracking["icon-anchor"]),
                "icon-pitch-alignment": new $n(ut.layout_symtracking["icon-pitch-alignment"]),
                "text-pitch-alignment": new $n(ut.layout_symtracking["text-pitch-alignment"]),
                "text-rotation-alignment": new $n(ut.layout_symtracking["text-rotation-alignment"]),
                "text-field": new Wn(ut.layout_symtracking["text-field"]),
                "text-font": new Wn(ut.layout_symtracking["text-font"]),
                "text-size": new Wn(ut.layout_symtracking["text-size"]),
                "text-max-width": new Wn(ut.layout_symtracking["text-max-width"]),
                "text-line-height": new $n(ut.layout_symtracking["text-line-height"]),
                "text-letter-spacing": new Wn(ut.layout_symtracking["text-letter-spacing"]),
                "text-justify": new Wn(ut.layout_symtracking["text-justify"]),
                "text-radial-offset": new Wn(ut.layout_symtracking["text-radial-offset"]),
                "text-variable-anchor": new $n(ut.layout_symtracking["text-variable-anchor"]),
                "text-anchor": new Wn(ut.layout_symtracking["text-anchor"]),
                "text-max-angle": new $n(ut.layout_symtracking["text-max-angle"]),
                "text-writing-mode": new $n(ut.layout_symtracking["text-writing-mode"]),
                "text-rotate": new Wn(ut.layout_symtracking["text-rotate"]),
                "text-padding": new $n(ut.layout_symtracking["text-padding"]),
                "text-keep-upright": new $n(ut.layout_symtracking["text-keep-upright"]),
                "text-transform": new Wn(ut.layout_symtracking["text-transform"]),
                "text-offset": new Wn(ut.layout_symtracking["text-offset"]),
                "text-allow-overlap": new $n(ut.layout_symtracking["text-allow-overlap"]),
                "text-ignore-placement": new $n(ut.layout_symtracking["text-ignore-placement"]),
                "text-optional": new $n(ut.layout_symtracking["text-optional"])
            }),
            pp = {
                paint: new ri({
                    "icon-opacity": new Wn(ut.paint_symtracking["icon-opacity"]),
                    "icon-color": new Wn(ut.paint_symtracking["icon-color"]),
                    "icon-halo-color": new Wn(ut.paint_symtracking["icon-halo-color"]),
                    "icon-halo-width": new Wn(ut.paint_symtracking["icon-halo-width"]),
                    "icon-halo-blur": new Wn(ut.paint_symtracking["icon-halo-blur"]),
                    "icon-translate": new $n(ut.paint_symtracking["icon-translate"]),
                    "icon-translate-anchor": new $n(ut.paint_symtracking["icon-translate-anchor"]),
                    "text-opacity": new Wn(ut.paint_symtracking["text-opacity"]),
                    "text-color": new Wn(ut.paint_symtracking["text-color"], {
                        runtimeType: bt,
                        getOverride: function (t) {
                            return t.textColor
                        },
                        hasOverride: function (t) {
                            return !!t.textColor
                        }
                    }),
                    "text-halo-color": new Wn(ut.paint_symtracking["text-halo-color"]),
                    "text-halo-width": new Wn(ut.paint_symtracking["text-halo-width"]),
                    "text-halo-blur": new Wn(ut.paint_symtracking["text-halo-blur"]),
                    "text-translate": new $n(ut.paint_symtracking["text-translate"]),
                    "text-translate-anchor": new $n(ut.paint_symtracking["text-translate-anchor"]),
                    "symtracking-delay": new $n(ut.paint_symtracking["symtracking-delay"])
                }),
                layout: lp
            },
            cp = function (t) {
                function e(e) {
                    t.call(this, e, pp);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.recalculate = function (e, r) {
                    if (t.prototype.recalculate.call(this, e, r), "auto" === this.layout.get("icon-rotation-alignment") && (this.layout._values["icon-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-rotation-alignment") && (this.layout._values["text-rotation-alignment"] = "point" !== this.layout.get("symbol-placement") ? "map" : "viewport"), "auto" === this.layout.get("text-pitch-alignment") && (this.layout._values["text-pitch-alignment"] = this.layout.get("text-rotation-alignment")), "auto" === this.layout.get("icon-pitch-alignment") && (this.layout._values["icon-pitch-alignment"] = this.layout.get("icon-rotation-alignment")), "point" === this.layout.get("symbol-placement")) {
                        var n = this.layout.get("text-writing-mode");
                        if (n) {
                            for (var i = [], a = 0, o = n; a < o.length; a += 1) {
                                var s = o[a];
                                i.indexOf(s) < 0 && i.push(s);
                            }
                            this.layout._values["text-writing-mode"] = i;
                        } else this.layout._values["text-writing-mode"] = ["horizontal"];
                    }
                    this._setPaintOverrides();
                }, e.prototype.getValueAndResolveTokens = function (t, e, r, n) {
                    var i = this.layout.get(t).evaluate(e, {}, r, n),
                        a = this._unevaluatedLayout._values[t];
                    return a.isDataDriven() || Sr(a.value) || !i ? i : il(e.properties, i)
                }, e.prototype.createBucket = function (t) {
                    return new up(t)
                }, e.prototype.queryRadius = function () {
                    return 0
                }, e.prototype.queryIntersectsFeature = function () {
                    return !1
                }, e.prototype._setPaintOverrides = function () {
                    for (var t = 0, r = pp.paint.overridableProperties; t < r.length; t += 1) {
                        var n = r[t];
                        if (e.hasPaintOverride(this.layout, n)) {
                            var i, a = this.paint.get(n),
                                o = new sl(a),
                                s = new Ar(o, a.property.specification);
                            i = "constant" === a.value.kind || "source" === a.value.kind ? new zr("source", s) : new Br("composite", s, a.value.zoomStops, a.value._interpolationType), this.paint._values[n] = new Zn(a.property, i, a.parameters);
                        }
                    }
                }, e.prototype._handleOverridablePaintPropertyUpdate = function (t, r, n) {
                    return !(!this.layout || r.isDataDriven() || n.isDataDriven()) && e.hasPaintOverride(this.layout, t)
                }, e.hasPaintOverride = function (t, e) {
                    var r = t.get("text-field"),
                        n = pp.paint.properties[e],
                        i = !1,
                        a = function (t) {
                            for (var e = 0, r = t; e < r.length; e += 1)
                                if (n.overrides && n.overrides.hasOverride(r[e])) return void(i = !0)
                        };
                    if ("constant" === r.value.kind && r.value.value instanceof Ft) a(r.value.value.sections);
                    else if ("source" === r.value.kind) {
                        var o = function (t) {
                                i || (t instanceof Nt && Rt(t.value) === At ? a(t.value.sections) : t instanceof Ht ? a(t.sections) : t.eachChild(o));
                            },
                            s = r.value;
                        s._styleExpression && o(s._styleExpression.expression);
                    }
                    return i
                }, e
            }(ni),
            hp = si([{
                name: "a_pos",
                components: 2,
                type: "Int16"
            }, {
                name: "a_normal_ed",
                components: 4,
                type: "Int16"
            }], 4).members,
            yp = as.VectorTileFeature.types,
            fp = Math.pow(2, 13);

        function dp(t, e, r, n, i, a, o, s) {
            t.emplaceBack(e, r, 2 * Math.floor(n * fp) + o, i * fp * 2, a * fp * 2, Math.round(s));
        }
        var mp = function (t) {
            this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map((function (t) {
                return t.id
            })), this.index = t.index, this.hasPattern = !1, this.layoutVertexArray = new ci, this.indexArray = new Si, this.programConfigurations = new ba(t.layers, t.zoom), this.segments = new Hi, this.stateDependentLayerIds = this.layers.filter((function (t) {
                return t.isStateDependent()
            })).map((function (t) {
                return t.id
            }));
        };

        function gp(t, e) {
            return t.x === e.x && (t.x < 0 || t.x > 8192) || t.y === e.y && (t.y < 0 || t.y > 8192)
        }
        mp.prototype.populate = function (t, e, r) {
            this.features = [];
            for (var n = 0, i = t; n < i.length; n += 1) {
                var a = i[n],
                    o = a.feature,
                    s = a.id,
                    u = a.index,
                    l = a.sourceLayerIndex,
                    p = this.layers[0]._featureFilter.needGeometry,
                    c = {
                        type: o.type,
                        id: s,
                        properties: o.properties,
                        geometry: p ? Aa(o) : []
                    };
                if (this.layers[0]._featureFilter.filter(new jn(this.zoom), c, r)) {
                    var h = {
                        id: s,
                        sourceLayerIndex: l,
                        index: u,
                        geometry: p ? c.geometry : Aa(o),
                        properties: o.properties,
                        type: o.type,
                        patterns: {}
                    };
                    this.addFeature(h, h.geometry, u, r, {}), e.featureIndex.insert(o, h.geometry, u, l, this.index, !0);
                }
            }
        }, mp.prototype.addFeatures = function (t, e, r) {
            for (var n = 0, i = this.features; n < i.length; n += 1) {
                var a = i[n];
                this.addFeature(a, a.geometry, a.index, e, r);
            }
        }, mp.prototype.update = function (t, e, r) {
            this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r);
        }, mp.prototype.isEmpty = function () {
            return 0 === this.layoutVertexArray.length
        }, mp.prototype.uploadPending = function () {
            return !this.uploaded || this.programConfigurations.needsUpload
        }, mp.prototype.upload = function (t) {
            this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, hp), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;
        }, mp.prototype.destroy = function () {
            this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());
        }, mp.prototype.addFeature = function (t, e, r, n, i) {
            for (var a = 0, o = jo(e, 500); a < o.length; a += 1) {
                for (var s = o[a], u = 0, l = 0, p = s; l < p.length; l += 1) u += p[l].length;
                for (var c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray), h = 0, y = s; h < y.length; h += 1) {
                    var f = y[h];
                    if (0 !== f.length && !((P = f).every((function (t) {
                            return t.x < 0
                        })) || P.every((function (t) {
                            return t.x > 8192
                        })) || P.every((function (t) {
                            return t.y < 0
                        })) || P.every((function (t) {
                            return t.y > 8192
                        }))))
                        for (var d = 0, m = 0; m < f.length; m++) {
                            var g = f[m];
                            if (m >= 1) {
                                var v = f[m - 1];
                                if (!gp(g, v)) {
                                    c.vertexLength + 4 > Hi.MAX_VERTEX_ARRAY_LENGTH && (c = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray));
                                    var x = g.sub(v)._perp()._unit(),
                                        b = v.dist(g);
                                    d + b > 32768 && (d = 0), dp(this.layoutVertexArray, g.x, g.y, x.x, x.y, 0, 0, d), dp(this.layoutVertexArray, g.x, g.y, x.x, x.y, 0, 1, d), dp(this.layoutVertexArray, v.x, v.y, x.x, x.y, 0, 0, d += b), dp(this.layoutVertexArray, v.x, v.y, x.x, x.y, 0, 1, d);
                                    var _ = c.vertexLength;
                                    this.indexArray.emplaceBack(_, _ + 2, _ + 1), this.indexArray.emplaceBack(_ + 1, _ + 2, _ + 3), c.vertexLength += 4, c.primitiveLength += 2;
                                }
                            }
                        }
                }
                if (c.vertexLength + u > Hi.MAX_VERTEX_ARRAY_LENGTH && (c = this.segments.prepareSegment(u, this.layoutVertexArray, this.indexArray)), "Polygon" === yp[t.type]) {
                    for (var w = [], k = [], A = c.vertexLength, S = 0, I = s; S < I.length; S += 1) {
                        var z = I[S];
                        if (0 !== z.length) {
                            z !== s[0] && k.push(w.length / 2);
                            for (var B = 0; B < z.length; B++) {
                                var V = z[B];
                                dp(this.layoutVertexArray, V.x, V.y, 0, 0, 1, 1, 0), w.push(V.x), w.push(V.y);
                            }
                        }
                    }
                    for (var C = po(w, k), M = 0; M < C.length; M += 3) this.indexArray.emplaceBack(A + C[M], A + C[M + 2], A + C[M + 1]);
                    c.primitiveLength += C.length / 3, c.vertexLength += u;
                }
            }
            var P;
            this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, n);
        }, xn("HistogramBucket", mp, {
            omit: ["layers", "features"]
        });
        var vp = new ri({
                "histogram-max-height-render": new $n(ut.layout_histogram["histogram-max-height-render"]),
                "histogram-color-render": new $n(ut.layout_histogram["histogram-color-render"])
            }),
            xp = {
                paint: new ri({
                    "histogram-opacity": new $n(ut.paint_histogram["histogram-opacity"]),
                    "histogram-color": new Wn(ut.paint_histogram["histogram-color"]),
                    "histogram-colors": new $n(ut.paint_histogram["histogram-colors"]),
                    "histogram-translate": new $n(ut.paint_histogram["histogram-translate"]),
                    "histogram-translate-anchor": new $n(ut.paint_histogram["histogram-translate-anchor"]),
                    "histogram-height": new Wn(ut.paint_histogram["histogram-height"]),
                    "histogram-base": new Wn(ut.paint_histogram["histogram-base"]),
                    "histogram-vertical-gradient": new $n(ut.paint_histogram["histogram-vertical-gradient"]),
                    "histogram-dynamic": new $n(ut.paint_histogram["histogram-dynamic"]),
                    "histogram-heightArr1": new Wn(ut.paint_histogram["histogram-heightArr1"]),
                    "histogram-heightArr2": new Wn(ut.paint_histogram["histogram-heightArr2"]),
                    "histogram-heightArr3": new Wn(ut.paint_histogram["histogram-heightArr3"]),
                    "histogram-speed": new $n(ut.paint_histogram["histogram-speed"]),
                    "histogram-count": new $n(ut.paint_histogram["histogram-count"]),
                    "histogram-max-height": new $n(ut.paint_histogram["histogram-max-height"]),
                    "depth-change": new $n(ut.paint_histogram["depth-change"])
                }),
                layout: vp
            };

        function bp(t, e) {
            return t.x * e.x + t.y * e.y
        }

        function _p(t, e) {
            if (1 === t.length) {
                for (var r, n = 0, i = e[n++]; !r || i.equals(r);)
                    if (!(r = e[n++])) return 1 / 0;
                for (; n < e.length; n++) {
                    var a = e[n],
                        o = t[0],
                        s = r.sub(i),
                        u = a.sub(i),
                        l = o.sub(i),
                        p = bp(s, s),
                        c = bp(s, u),
                        h = bp(u, u),
                        y = bp(l, s),
                        f = bp(l, u),
                        d = p * h - c * c,
                        m = (h * y - c * f) / d,
                        g = (p * f - c * y) / d,
                        v = i.z * (1 - m - g) + r.z * m + a.z * g;
                    if (isFinite(v)) return v
                }
                return 1 / 0
            }
            for (var x = 1 / 0, b = 0, _ = e; b < _.length; b += 1) x = Math.min(x, _[b].z);
            return x
        }
        var wp = {
                circle: Ja,
                heatmap: oo,
                hillshade: uo,
                fill: Zo,
                extrusion: hs,
                line: ks,
                symbol: ul,
                background: pl,
                raster: hl,
                airline: _l,
                dynamicLine: Ml,
                sprite: Ul,
                tracking: Zl,
                symtracking: cp,
                histogram: function (t) {
                    function e(e) {
                        t.call(this, e, xp);
                    }
                    return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.createBucket = function (t) {
                        return new mp(t)
                    }, e.prototype.queryRadius = function () {
                        return Ua(this.paint.get("histogram-translate"))
                    }, e.prototype.is3D = function () {
                        return !0
                    }, e.prototype.queryIntersectsFeature = function (t, e, r, n, a, o, s, u) {
                        var l = Ra(t, this.paint.get("histogram-translate"), this.paint.get("histogram-translate-anchor"), o.angle, s),
                            p = this.paint.get("histogram-height").evaluate(e, r),
                            c = this.paint.get("histogram-base").evaluate(e, r),
                            h = function (t, e, r, n) {
                                for (var a = [], o = 0, s = t; o < s.length; o += 1) {
                                    var u = s[o],
                                        l = [u.x, u.y, 0, 1];
                                    Za(l, l, e), a.push(new i(l[0] / l[3], l[1] / l[3]));
                                }
                                return a
                            }(l, u),
                            y = function (t, e, r, n) {
                                for (var a = [], o = [], s = n[8] * e, u = n[9] * e, l = n[10] * e, p = n[11] * e, c = n[8] * r, h = n[9] * r, y = n[10] * r, f = n[11] * r, d = 0, m = t; d < m.length; d += 1) {
                                    for (var g = [], v = [], x = 0, b = m[d]; x < b.length; x += 1) {
                                        var _ = b[x],
                                            w = _.x,
                                            k = _.y,
                                            A = n[0] * w + n[4] * k + n[12],
                                            S = n[1] * w + n[5] * k + n[13],
                                            I = n[2] * w + n[6] * k + n[14],
                                            z = n[3] * w + n[7] * k + n[15],
                                            B = I + l,
                                            V = z + p,
                                            C = A + c,
                                            M = S + h,
                                            P = I + y,
                                            L = z + f,
                                            T = new i((A + s) / V, (S + u) / V);
                                        T.z = B / V, g.push(T);
                                        var D = new i(C / L, M / L);
                                        D.z = P / L, v.push(D);
                                    }
                                    a.push(g), o.push(v);
                                }
                                return [a, o]
                            }(n, c, p, u);
                        return function (t, e, r) {
                            var n = 1 / 0;
                            Va(r, e) && (n = _p(r, e[0]));
                            for (var i = 0; i < e.length; i++)
                                for (var a = e[i], o = t[i], s = 0; s < a.length - 1; s++) {
                                    var u = a[s],
                                        l = [u, a[s + 1], o[s + 1], o[s], u];
                                    za(r, l) && (n = Math.min(n, _p(r, l)));
                                }
                            return n !== 1 / 0 && n
                        }(y[0], y[1], h)
                    }, e
                }(ni)
            },
            kp = self.HTMLImageElement,
            Ap = self.HTMLCanvasElement,
            Sp = self.HTMLVideoElement,
            Ip = self.ImageData,
            zp = self.ImageBitmap,
            Bp = function (t, e, r, n) {
                this.context = t, this.format = r, this.texture = t.gl.createTexture(), this.update(e, n);
            };
        Bp.prototype.update = function (t, e, r) {
            var n = t.width,
                i = t.height,
                a = !(this.size && this.size[0] === n && this.size[1] === i || r),
                o = this.context,
                s = o.gl;
            if (this.useMipmap = Boolean(e && e.useMipmap), s.bindTexture(s.TEXTURE_2D, this.texture), o.pixelStoreUnpackFlipY.set(!1), o.pixelStoreUnpack.set(1), o.pixelStoreUnpackPremultiplyAlpha.set(this.format === s.RGBA && (!e || !1 !== e.premultiply)), a) this.size = [n, i], t instanceof kp || t instanceof Ap || t instanceof Sp || t instanceof Ip || zp && t instanceof zp ? s.texImage2D(s.TEXTURE_2D, 0, this.format, this.format, s.UNSIGNED_BYTE, t) : s.texImage2D(s.TEXTURE_2D, 0, this.format, n, i, 0, this.format, s.UNSIGNED_BYTE, t.data);
            else {
                var u = r || {
                        x: 0,
                        y: 0
                    },
                    l = u.x,
                    p = u.y;
                t instanceof kp || t instanceof Ap || t instanceof Sp || t instanceof Ip || zp && t instanceof zp ? s.texSubImage2D(s.TEXTURE_2D, 0, l, p, s.RGBA, s.UNSIGNED_BYTE, t) : s.texSubImage2D(s.TEXTURE_2D, 0, l, p, n, i, s.RGBA, s.UNSIGNED_BYTE, t.data);
            }
            this.useMipmap && this.isSizePowerOfTwo() && s.generateMipmap(s.TEXTURE_2D);
        }, Bp.prototype.bind = function (t, e, r) {
            var n = this.context.gl;
            n.bindTexture(n.TEXTURE_2D, this.texture), r !== n.LINEAR_MIPMAP_NEAREST || this.isSizePowerOfTwo() || (r = n.LINEAR), t !== this.filter && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, t), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, r || t), this.filter = t), e !== this.wrap && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, e), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, e), this.wrap = e);
        }, Bp.prototype.isSizePowerOfTwo = function () {
            return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0
        }, Bp.prototype.destroy = function () {
            this.context.gl.deleteTexture(this.texture), this.texture = null;
        };
        var Vp = function (t) {
            var e = this;
            this._callback = t, this._triggered = !1, "undefined" != typeof MessageChannel && (this._channel = new MessageChannel, this._channel.port2.onmessage = function () {
                e._triggered = !1, e._callback();
            });
        };
        Vp.prototype.trigger = function () {
            var t = this;
            this._triggered || (this._triggered = !0, this._channel ? this._channel.port1.postMessage(!0) : setTimeout((function () {
                t._triggered = !1, t._callback();
            }), 0));
        }, Vp.prototype.remove = function () {
            delete this._channel, this._callback = function () {};
        };
        var Cp = function (t, e, r) {
            this.target = t, this.parent = e, this.mapId = r, this.callbacks = {}, this.tasks = {}, this.taskQueue = [], this.cancelCallbacks = {}, y(["receive", "process"], this), this.invoker = new Vp(this.process), this.target.addEventListener("message", this.receive, !1), this.globalScope = w() ? t : self;
        };

        function Mp(t, e, r) {
            var n = 2 * Math.PI * 6378137 / 256 / Math.pow(2, r);
            return [t * n - 2 * Math.PI * 6378137 / 2, e * n - 2 * Math.PI * 6378137 / 2]
        }
        Cp.prototype.send = function (t, e, r, n, i) {
            var a = this;
            void 0 === i && (i = !1);
            var o = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);
            r && (this.callbacks[o] = r);
            var s = S(this.globalScope) ? void 0 : [];
            return this.target.postMessage({
                id: o,
                type: t,
                hasCallback: !!r,
                targetMapId: n,
                mustQueue: i,
                sourceMapId: this.mapId,
                data: kn(e, s)
            }, s), {
                cancel: function () {
                    r && delete a.callbacks[o], a.target.postMessage({
                        id: o,
                        type: "<cancel>",
                        targetMapId: n,
                        sourceMapId: a.mapId
                    });
                }
            }
        }, Cp.prototype.receive = function (t) {
            var e = t.data,
                r = e.id;
            if (r && (!e.targetMapId || this.mapId === e.targetMapId))
                if ("<cancel>" === e.type) {
                    delete this.tasks[r];
                    var n = this.cancelCallbacks[r];
                    delete this.cancelCallbacks[r], n && n();
                } else w() || e.mustQueue ? (this.tasks[r] = e, this.taskQueue.push(r), this.invoker.trigger()) : this.processTask(r, e);
        }, Cp.prototype.process = function () {
            if (this.taskQueue.length) {
                var t = this.taskQueue.shift(),
                    e = this.tasks[t];
                delete this.tasks[t], this.taskQueue.length && this.invoker.trigger(), e && this.processTask(t, e);
            }
        }, Cp.prototype.processTask = function (t, e) {
            var r = this;
            if ("<response>" === e.type) {
                var n = this.callbacks[t];
                delete this.callbacks[t], n && (e.error ? n(An(e.error)) : n(null, An(e.data)));
            } else {
                var i = !1,
                    a = S(this.globalScope) ? void 0 : [],
                    o = e.hasCallback ? function (e, n) {
                        i = !0, delete r.cancelCallbacks[t], r.target.postMessage({
                            id: t,
                            type: "<response>",
                            sourceMapId: r.mapId,
                            error: e ? kn(e) : null,
                            data: kn(n, a)
                        }, a);
                    } : function (t) {
                        i = !0;
                    },
                    s = null,
                    u = An(e.data);
                if (this.parent[e.type]) s = this.parent[e.type](e.sourceMapId, u, o);
                else if (this.parent.getWorkerSource) {
                    var l = e.type.split(".");
                    s = this.parent.getWorkerSource(e.sourceMapId, l[0], u.source)[l[1]](u, o);
                } else o(new Error("Could not find function " + e.type));
                !i && s && s.cancel && (this.cancelCallbacks[t] = s.cancel);
            }
        }, Cp.prototype.remove = function () {
            this.invoker.remove(), this.target.removeEventListener("message", this.receive, !1);
        };
        var Pp = function (t, e) {
            t && (e ? this.setSouthWest(t).setNorthEast(e) : 4 === t.length ? this.setSouthWest([t[0], t[1]]).setNorthEast([t[2], t[3]]) : this.setSouthWest(t[0]).setNorthEast(t[1]));
        };
        Pp.prototype.setNorthEast = function (t) {
            return this._ne = t instanceof Lp ? new Lp(t.lng, t.lat) : Lp.convert(t), this
        }, Pp.prototype.setSouthWest = function (t) {
            return this._sw = t instanceof Lp ? new Lp(t.lng, t.lat) : Lp.convert(t), this
        }, Pp.prototype.extend = function (t) {
            var e, r, n = this._sw,
                i = this._ne;
            if (t instanceof Lp) e = t, r = t;
            else {
                if (!(t instanceof Pp)) return Array.isArray(t) ? 4 === t.length || t.every(Array.isArray) ? this.extend(Pp.convert(t)) : this.extend(Lp.convert(t)) : this;
                if (r = t._ne, !(e = t._sw) || !r) return this
            }
            return n || i ? (n.lng = Math.min(e.lng, n.lng), n.lat = Math.min(e.lat, n.lat), i.lng = Math.max(r.lng, i.lng), i.lat = Math.max(r.lat, i.lat)) : (this._sw = new Lp(e.lng, e.lat), this._ne = new Lp(r.lng, r.lat)), this
        }, Pp.prototype.getCenter = function () {
            return new Lp((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2)
        }, Pp.prototype.getSouthWest = function () {
            return this._sw
        }, Pp.prototype.getNorthEast = function () {
            return this._ne
        }, Pp.prototype.getNorthWest = function () {
            return new Lp(this.getWest(), this.getNorth())
        }, Pp.prototype.getSouthEast = function () {
            return new Lp(this.getEast(), this.getSouth())
        }, Pp.prototype.getWest = function () {
            return this._sw.lng
        }, Pp.prototype.getSouth = function () {
            return this._sw.lat
        }, Pp.prototype.getEast = function () {
            return this._ne.lng
        }, Pp.prototype.getNorth = function () {
            return this._ne.lat
        }, Pp.prototype.toArray = function () {
            return [this._sw.toArray(), this._ne.toArray()]
        }, Pp.prototype.toString = function () {
            return "LngLatBounds(" + this._sw.toString() + ", " + this._ne.toString() + ")"
        }, Pp.prototype.isEmpty = function () {
            return !(this._sw && this._ne)
        }, Pp.prototype.contains = function (t) {
            var e = Lp.convert(t),
                r = e.lng,
                n = e.lat,
                i = this._sw.lng <= r && r <= this._ne.lng;
            return this._sw.lng > this._ne.lng && (i = this._sw.lng >= r && r >= this._ne.lng), this._sw.lat <= n && n <= this._ne.lat && i
        }, Pp.convert = function (t) {
            return !t || t instanceof Pp ? t : new Pp(t)
        };
        var Lp = function (t, e) {
            if (isNaN(t) || isNaN(e)) throw new Error("Invalid LngLat object: (" + t + ", " + e + ")");
            if (this.lng = +t, this.lat = +e, this.lat > 90 || this.lat < -90) throw new Error("Invalid LngLat latitude value: must be between -90 and 90")
        };
        Lp.prototype.wrap = function () {
            return new Lp(l(this.lng, -180, 180), this.lat)
        }, Lp.prototype.toArray = function () {
            return [this.lng, this.lat]
        }, Lp.prototype.wrapToBestWorld = function (t) {
            var e = new Lp(this.lng, this.lat);
            return Math.abs(this.lng - t.lng) > 180 && (t.lng < 0 ? e.lng -= 360 : e.lng += 360), e
        }, Lp.prototype.toString = function () {
            return "LngLat(" + this.lng + ", " + this.lat + ")"
        }, Lp.prototype.distanceTo = function (t) {
            var e = Math.PI / 180,
                r = this.lat * e,
                n = t.lat * e,
                i = Math.sin(r) * Math.sin(n) + Math.cos(r) * Math.cos(n) * Math.cos((t.lng - this.lng) * e);
            return 6371008.8 * Math.acos(Math.min(i, 1))
        }, Lp.prototype.toBounds = function (t) {
            void 0 === t && (t = 0);
            var e = 360 * t / 40075017,
                r = e / Math.cos(Math.PI / 180 * this.lat);
            return new Pp(new Lp(this.lng - r, this.lat - e), new Lp(this.lng + r, this.lat + e))
        }, Lp.convert = function (t) {
            if (t instanceof Lp) return t;
            if (Array.isArray(t) && (2 === t.length || 3 === t.length)) return new Lp(Number(t[0]), Number(t[1]));
            if (!Array.isArray(t) && "object" == typeof t && null !== t) return new Lp(Number("lng" in t ? t.lng : t.lon), Number(t.lat));
            throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")
        };
        var Tp = 2 * Math.PI * 6371008.8;

        function Dp(t) {
            return Tp * Math.cos(t * Math.PI / 180)
        }

        function Ep(t) {
            return (180 + t) / 360
        }

        function Fp(t) {
            return (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t * Math.PI / 360))) / 360
        }

        function qp(t, e) {
            return t / Dp(e)
        }

        function Op(t) {
            return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * t) * Math.PI / 180)) - 90
        }
        var Up = function (t, e, r) {
            void 0 === r && (r = 0), this.x = +t, this.y = +e, this.z = +r;
        };
        Up.fromLngLat = function (t, e) {
            void 0 === e && (e = 0);
            var r = Lp.convert(t);
            return new Up(Ep(r.lng), Fp(r.lat), qp(e, r.lat))
        }, Up.prototype.toLngLat = function () {
            return new Lp(360 * this.x - 180, Op(this.y))
        }, Up.prototype.toAltitude = function () {
            return this.z * Dp(Op(this.y))
        }, Up.prototype.meterInMercatorCoordinateUnits = function () {
            return 1 / Tp * (t = Op(this.y), 1 / Math.cos(t * Math.PI / 180));
            var t;
        };
        var Rp = 2 * Math.PI * 6371008.8;

        function jp(t) {
            return Rp * Math.cos(t * Math.PI / 180)
        }

        function Np(t) {
            return (180 + t) / 360
        }

        function Kp(t) {
            return (90 - t) / 180 / 2
        }

        function Xp(t) {
            return 90 - 2 * t * 180
        }

        function Gp(t) {
            for (var e = t.geometry.coordinates, r = 0; r < e.length; r++) {
                var n = e[r];
                if (Array.isArray(n))
                    for (var i = 0; i < n.length; i++) {
                        var a = n[i];
                        Array.isArray(a) ? a.splice(0, 2, Hp(a)[0], Hp(a)[1]) : (i++, n.splice(0, 2, Hp(n)[0], Hp(n)[1]));
                    } else r++, e.splice(0, 2, Hp(e)[0], Hp(e)[1]);
            }
        }

        function Hp(t) {
            var e = 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t[1] * Math.PI / 360));
            return [t[0], 90 - 256 * (180 - e) * 2 / 360 * .7031250001548544]
        }
        var Yp = function (t, e, r) {
            void 0 === r && (r = 0), this.x = +t, this.y = +e, this.z = +r;
        };
        Yp.fromLngLat = function (t, e) {
            void 0 === e && (e = 0);
            var r = Lp.convert(t);
            return new Yp(Np(r.lng), Kp(r.lat), function (t, e) {
                return t / jp(e)
            }(e, r.lat))
        }, Yp.prototype.toLngLat = function () {
            return new Lp(360 * this.x - 180, Xp(this.y))
        }, Yp.prototype.toAltitude = function () {
            return this.z * jp(Xp(this.y))
        };
        var Zp = function (t, e, r) {
            this.z = t, this.x = e, this.y = r, this.key = Wp(0, t, t, e, r);
        };
        Zp.prototype.equals = function (t) {
            return this.z === t.z && this.x === t.x && this.y === t.y
        }, Zp.prototype.url = function (t, e) {
            var r = function (t, e, r) {
                    var n = Mp(256 * t, 256 * (e = Math.pow(2, r) - e - 1), r),
                        i = Mp(256 * (t + 1), 256 * (e + 1), r);
                    return n[0] + "," + n[1] + "," + i[0] + "," + i[1]
                }(this.x, this.y, this.z),
                n = function (t, e, r) {
                    for (var n, i = "", a = t; a > 0; a--) i += (e & (n = 1 << a - 1) ? 1 : 0) + (r & n ? 2 : 0);
                    return i
                }(this.z, this.x, this.y),
                i = "tms" === e ? Math.pow(2, this.z) - this.y - 1 : this.y;
            return t[(this.x + this.y) % t.length].replace("{prefix}", (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace("{z}", String(this.z)).replace("{x}", String(this.x)).replace("{y}", String("tms" === e ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace("{m}", String(Math.floor(this.x / 16))).replace("{n}", String(Math.floor(i / 16))).replace("{quadkey}", n).replace("{bbox-epsg-3857}", r)
        }, Zp.prototype.toRealCoord = function (t) {
            var e = "tms" === t ? Math.pow(2, this.z) - this.y - 1 : this.y;
            return {
                x: this.x,
                y: e,
                z: this.z
            }
        }, Zp.prototype.getTilePoint = function (t) {
            var e = Math.pow(2, this.z);
            return new i(8192 * (t.x * e - this.x), 8192 * (t.y * e - this.y))
        }, Zp.prototype.toString = function () {
            return this.z + "/" + this.x + "/" + this.y
        };
        var Jp = function (t, e) {
                this.wrap = t, this.canonical = e, this.key = Wp(t, e.z, e.z, e.x, e.y);
            },
            $p = function (t, e, r, n, i) {
                this.overscaledZ = t, this.wrap = e, this.canonical = new Zp(r, +n, +i), this.key = Wp(e, t, r, n, i);
            };

        function Wp(t, e, r, n, i) {
            (t *= 2) < 0 && (t = -1 * t - 1);
            var a = 1 << r;
            return (a * a * t + a * i + n).toString(36) + r.toString(36) + e.toString(36)
        }
        $p.prototype.equals = function (t) {
            return this.overscaledZ === t.overscaledZ && this.wrap === t.wrap && this.canonical.equals(t.canonical)
        }, $p.prototype.scaledTo = function (t) {
            var e = this.canonical.z - t;
            return t > this.canonical.z ? new $p(t, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y) : new $p(t, this.wrap, t, this.canonical.x >> e, this.canonical.y >> e)
        }, $p.prototype.calculateScaledKey = function (t, e) {
            var r = this.canonical.z - t;
            return t > this.canonical.z ? Wp(this.wrap * +e, t, this.canonical.z, this.canonical.x, this.canonical.y) : Wp(this.wrap * +e, t, t, this.canonical.x >> r, this.canonical.y >> r)
        }, $p.prototype.isChildOf = function (t) {
            if (t.wrap !== this.wrap) return !1;
            var e = this.canonical.z - t.canonical.z;
            return 0 === t.overscaledZ || t.overscaledZ < this.overscaledZ && t.canonical.x === this.canonical.x >> e && t.canonical.y === this.canonical.y >> e
        }, $p.prototype.children = function (t) {
            if (this.overscaledZ >= t) return [new $p(this.overscaledZ + 1, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y)];
            var e = this.canonical.z + 1,
                r = 2 * this.canonical.x,
                n = 2 * this.canonical.y;
            return [new $p(e, this.wrap, e, r, n), new $p(e, this.wrap, e, r + 1, n), new $p(e, this.wrap, e, r, n + 1), new $p(e, this.wrap, e, r + 1, n + 1)]
        }, $p.prototype.isLessThan = function (t) {
            return this.wrap < t.wrap || !(this.wrap > t.wrap) && (this.overscaledZ < t.overscaledZ || !(this.overscaledZ > t.overscaledZ) && (this.canonical.x < t.canonical.x || !(this.canonical.x > t.canonical.x) && this.canonical.y < t.canonical.y))
        }, $p.prototype.wrapped = function () {
            return new $p(this.overscaledZ, 0, this.canonical.z, this.canonical.x, this.canonical.y)
        }, $p.prototype.unwrapTo = function (t) {
            return new $p(this.overscaledZ, t, this.canonical.z, this.canonical.x, this.canonical.y)
        }, $p.prototype.overscaleFactor = function () {
            return Math.pow(2, this.overscaledZ - this.canonical.z)
        }, $p.prototype.toUnwrapped = function () {
            return new Jp(this.wrap, this.canonical)
        }, $p.prototype.toString = function () {
            return this.overscaledZ + "/" + this.canonical.x + "/" + this.canonical.y
        }, $p.prototype.getTilePoint = function (t) {
            return this.canonical.getTilePoint(new Up(t.x - this.wrap, t.y))
        }, xn("CanonicalTileID", Zp), xn("OverscaledTileID", $p, {
            omit: ["posMatrix"]
        });
        var Qp = function (t, e, r) {
            if (this.uid = t, e.height !== e.width) throw new RangeError("DEM tiles must be square");
            if (r && "minemap" !== r && "terrarium" !== r) return x('"' + r + '" is not a valid encoding type. Valid types include "minemap" and "terrarium".');
            this.stride = e.height;
            var n = this.dim = e.height - 2;
            this.data = new Uint32Array(e.data.buffer), this.encoding = r || "minemap";
            for (var i = 0; i < n; i++) this.data[this._idx(-1, i)] = this.data[this._idx(0, i)], this.data[this._idx(n, i)] = this.data[this._idx(n - 1, i)], this.data[this._idx(i, -1)] = this.data[this._idx(i, 0)], this.data[this._idx(i, n)] = this.data[this._idx(i, n - 1)];
            this.data[this._idx(-1, -1)] = this.data[this._idx(0, 0)], this.data[this._idx(n, -1)] = this.data[this._idx(n - 1, 0)], this.data[this._idx(-1, n)] = this.data[this._idx(0, n - 1)], this.data[this._idx(n, n)] = this.data[this._idx(n - 1, n - 1)];
        };
        Qp.prototype.get = function (t, e) {
            var r = new Uint8Array(this.data.buffer),
                n = 4 * this._idx(t, e);
            return ("terrarium" === this.encoding ? this._unpackTerrarium : this._unpackMineMap)(r[n], r[n + 1], r[n + 2])
        }, Qp.prototype.getUnpackVector = function () {
            return "terrarium" === this.encoding ? [256, 1, 1 / 256, 32768] : [6553.6, 25.6, .1, 1e4]
        }, Qp.prototype._idx = function (t, e) {
            if (t < -1 || t >= this.dim + 1 || e < -1 || e >= this.dim + 1) throw new RangeError("out of range source coordinates for DEM data");
            return (e + 1) * this.stride + (t + 1)
        }, Qp.prototype._unpackMineMap = function (t, e, r) {
            return (256 * t * 256 + 256 * e + r) / 10 - 1e4
        }, Qp.prototype._unpackTerrarium = function (t, e, r) {
            return 256 * t + e + r / 256 - 32768
        }, Qp.prototype.getPixels = function () {
            return new no({
                width: this.stride,
                height: this.stride
            }, new Uint8Array(this.data.buffer))
        }, Qp.prototype.backfillBorder = function (t, e, r) {
            if (this.dim !== t.dim) throw new Error("dem dimension mismatch");
            var n = e * this.dim,
                i = e * this.dim + this.dim,
                a = r * this.dim,
                o = r * this.dim + this.dim;
            switch (e) {
                case -1:
                    n = i - 1;
                    break;
                case 1:
                    i = n + 1;
            }
            switch (r) {
                case -1:
                    a = o - 1;
                    break;
                case 1:
                    o = a + 1;
            }
            for (var s = -e * this.dim, u = -r * this.dim, l = a; l < o; l++)
                for (var p = n; p < i; p++) this.data[this._idx(p, l)] = t.data[this._idx(p + s, l + u)];
        }, xn("DEMData", Qp);
        var tc = function (t) {
            this._stringToNumber = {}, this._numberToString = [];
            for (var e = 0; e < t.length; e++) {
                var r = t[e];
                this._stringToNumber[r] = e, this._numberToString[e] = r;
            }
        };
        tc.prototype.encode = function (t) {
            return this._stringToNumber[t]
        }, tc.prototype.decode = function (t) {
            return this._numberToString[t]
        };
        var ec = function (t, e, r, n, i) {
                this.type = "Feature", this._vectorTileFeature = t, t._z = e, t._x = r, t._y = n, this.properties = t.properties, this.id = i;
            },
            rc = {
                geometry: {
                    configurable: !0
                }
            };
        rc.geometry.get = function () {
            return void 0 === this._geometry && (this._geometry = this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x, this._vectorTileFeature._y, this._vectorTileFeature._z).geometry), this._geometry
        }, rc.geometry.set = function (t) {
            this._geometry = t;
        }, ec.prototype.toJSON = function () {
            var t = {
                geometry: this.geometry
            };
            for (var e in this) "_geometry" !== e && "_vectorTileFeature" !== e && (t[e] = this[e]);
            return t
        }, Object.defineProperties(ec.prototype, rc);
        var nc = function () {
            this.state = {}, this.stateChanges = {}, this.deletedStates = {};
        };
        nc.prototype.updateState = function (t, e, r) {
            var n = String(e);
            if (this.stateChanges[t] = this.stateChanges[t] || {}, this.stateChanges[t][n] = this.stateChanges[t][n] || {}, p(this.stateChanges[t][n], r), null === this.deletedStates[t])
                for (var i in this.deletedStates[t] = {}, this.state[t]) i !== n && (this.deletedStates[t][i] = null);
            else if (this.deletedStates[t] && null === this.deletedStates[t][n])
                for (var a in this.deletedStates[t][n] = {}, this.state[t][n]) r[a] || (this.deletedStates[t][n][a] = null);
            else
                for (var o in r) this.deletedStates[t] && this.deletedStates[t][n] && null === this.deletedStates[t][n][o] && delete this.deletedStates[t][n][o];
        }, nc.prototype.removeFeatureState = function (t, e, r) {
            if (null !== this.deletedStates[t]) {
                var n = String(e);
                if (this.deletedStates[t] = this.deletedStates[t] || {}, r && void 0 !== e) null !== this.deletedStates[t][n] && (this.deletedStates[t][n] = this.deletedStates[t][n] || {}, this.deletedStates[t][n][r] = null);
                else if (void 0 !== e)
                    if (this.stateChanges[t] && this.stateChanges[t][n])
                        for (r in this.deletedStates[t][n] = {}, this.stateChanges[t][n]) this.deletedStates[t][n][r] = null;
                    else this.deletedStates[t][n] = null;
                else this.deletedStates[t] = null;
            }
        }, nc.prototype.getState = function (t, e) {
            var r = String(e),
                n = p({}, (this.state[t] || {})[r], (this.stateChanges[t] || {})[r]);
            if (null === this.deletedStates[t]) return {};
            if (this.deletedStates[t]) {
                var i = this.deletedStates[t][e];
                if (null === i) return {};
                for (var a in i) delete n[a];
            }
            return n
        }, nc.prototype.initializeTileState = function (t, e) {
            t.setFeatureState(this.state, e);
        }, nc.prototype.coalesceChanges = function (t, e) {
            var r = {};
            for (var n in this.stateChanges) {
                this.state[n] = this.state[n] || {};
                var i = {};
                for (var a in this.stateChanges[n]) this.state[n][a] || (this.state[n][a] = {}), p(this.state[n][a], this.stateChanges[n][a]), i[a] = this.state[n][a];
                r[n] = i;
            }
            for (var o in this.deletedStates) {
                this.state[o] = this.state[o] || {};
                var s = {};
                if (null === this.deletedStates[o])
                    for (var u in this.state[o]) s[u] = {}, this.state[o][u] = {};
                else
                    for (var l in this.deletedStates[o]) {
                        if (null === this.deletedStates[o][l]) this.state[o][l] = {};
                        else
                            for (var c = 0, h = Object.keys(this.deletedStates[o][l]); c < h.length; c += 1) delete this.state[o][l][h[c]];
                        s[l] = this.state[o][l];
                    }
                r[o] = r[o] || {}, p(r[o], s);
            }
            if (this.stateChanges = {}, this.deletedStates = {}, 0 !== Object.keys(r).length)
                for (var y in t) t[y].setFeatureState(r, e);
        };
        var ic = function (t, e) {
            this.tileID = t, this.x = t.canonical.x, this.y = t.canonical.y, this.z = t.canonical.z, this.grid = new fn(8192, 16, 0), this.grid3D = new fn(8192, 16, 0), this.featureIndexArray = new Xi, this.promoteId = e;
        };

        function ac(t, e, r, n, i) {
            return d(t, (function (t, a) {
                var o = e instanceof Jn ? e.get(a) : null;
                return o && o.evaluate ? o.evaluate(r, n, i) : o
            }))
        }

        function oc(t) {
            for (var e = 1 / 0, r = 1 / 0, n = -1 / 0, i = -1 / 0, a = 0, o = t; a < o.length; a += 1) {
                var s = o[a];
                e = Math.min(e, s.x), r = Math.min(r, s.y), n = Math.max(n, s.x), i = Math.max(i, s.y);
            }
            return {
                minX: e,
                minY: r,
                maxX: n,
                maxY: i
            }
        }

        function sc(t, e) {
            return e - t
        }
        ic.prototype.insert = function (t, e, r, n, i, a) {
            var o = this.featureIndexArray.length;
            this.featureIndexArray.emplaceBack(r, n, i);
            for (var s = a ? this.grid3D : this.grid, u = 0; u < e.length; u++) {
                for (var l = e[u], p = [1 / 0, 1 / 0, -1 / 0, -1 / 0], c = 0; c < l.length; c++) {
                    var h = l[c];
                    p[0] = Math.min(p[0], h.x), p[1] = Math.min(p[1], h.y), p[2] = Math.max(p[2], h.x), p[3] = Math.max(p[3], h.y);
                }
                p[0] < 8192 && p[1] < 8192 && p[2] >= 0 && p[3] >= 0 && s.insert(o, p[0], p[1], p[2], p[3]);
            }
        }, ic.prototype.loadVTLayers = function () {
            return this.vtLayers || (this.vtLayers = new as.VectorTile(new Ds(this.rawTileData)).layers, this.sourceLayerCoder = new tc(this.vtLayers ? Object.keys(this.vtLayers).sort() : ["_geojsonTileLayer"])), this.vtLayers
        }, ic.prototype.query = function (t, e, r, n) {
            var a = this;
            this.loadVTLayers();
            for (var o = t.params || {}, s = 8192 / t.tileSize / t.scale, u = Or(o.filter), l = t.queryGeometry, p = t.queryPadding * s, c = oc(l), h = this.grid.query(c.minX - p, c.minY - p, c.maxX + p, c.maxY + p), y = oc(t.cameraQueryGeometry), f = this.grid3D.query(y.minX - p, y.minY - p, y.maxX + p, y.maxY + p, (function (e, r, n, a) {
                    return function (t, e, r, n, a) {
                        for (var o = 0, s = t; o < s.length; o += 1) {
                            var u = s[o];
                            if (e <= u.x && r <= u.y && n >= u.x && a >= u.y) return !0
                        }
                        var l = [new i(e, r), new i(e, a), new i(n, a), new i(n, r)];
                        if (t.length > 2)
                            for (var p = 0, c = l; p < c.length; p += 1)
                                if (Fa(t, c[p])) return !0;
                        for (var h = 0; h < t.length - 1; h++)
                            if (qa(t[h], t[h + 1], l)) return !0;
                        return !1
                    }(t.cameraQueryGeometry, e - p, r - p, n + p, a + p)
                })), d = 0, m = f; d < m.length; d += 1) h.push(m[d]);
            h.sort(sc);
            for (var g, v = {}, x = function (i) {
                    var p = h[i];
                    if (p !== g) {
                        g = p;
                        var c = a.featureIndexArray.get(p),
                            y = null;
                        a.loadMatchingFeature(v, c.bucketIndex, c.sourceLayerIndex, c.featureIndex, u, o.layers, o.availableImages, e, r, n, (function (e, r, n) {
                            return y || (y = Aa(e)), r.queryIntersectsFeature(l, e, n, y, a.z, t.transform, s, t.pixelPosMatrix)
                        }));
                    }
                }, b = 0; b < h.length; b++) x(b);
            return v
        }, ic.prototype.loadMatchingFeature = function (t, e, r, n, i, a, o, s, u, l, p) {
            var c = this.bucketLayerIDs[e];
            if (!a || function (t, e) {
                    for (var r = 0; r < t.length; r++)
                        if (e.indexOf(t[r]) >= 0) return !0;
                    return !1
                }(a, c)) {
                var h = this.sourceLayerCoder.decode(r),
                    y = this.vtLayers[h].feature(n);
                if (i.filter(new jn(this.tileID.overscaledZ), y))
                    for (var f = this.getId(y, h), d = 0; d < c.length; d++) {
                        var m = c[d];
                        if (!(a && a.indexOf(m) < 0)) {
                            var g = s[m];
                            if (g) {
                                var v = {};
                                void 0 !== f && l && (v = l.getState(g.sourceLayer || "_geojsonTileLayer", f));
                                var x = u[m];
                                x.paint = ac(x.paint, g.paint, y, v, o), x.layout = ac(x.layout, g.layout, y, v, o);
                                var b = !p || p(y, g, v);
                                if (b) {
                                    var _ = new ec(y, this.z, this.x, this.y, f);
                                    _.layer = x;
                                    var w = t[m];
                                    void 0 === w && (w = t[m] = []), w.push({
                                        featureIndex: n,
                                        feature: _,
                                        intersectionZ: b
                                    });
                                }
                            }
                        }
                    }
            }
        }, ic.prototype.lookupSymbolFeatures = function (t, e, r, n, i, a, o, s) {
            var u = {};
            this.loadVTLayers();
            for (var l = Or(i), p = 0, c = t; p < c.length; p += 1) this.loadMatchingFeature(u, r, n, c[p], l, a, o, s, e);
            return u
        }, ic.prototype.hasLayer = function (t) {
            for (var e = 0, r = this.bucketLayerIDs; e < r.length; e += 1)
                for (var n = 0, i = r[e]; n < i.length; n += 1)
                    if (t === i[n]) return !0;
            return !1
        }, ic.prototype.getId = function (t, e) {
            var r = t.id;
            return this.promoteId && "boolean" == typeof (r = t.properties["string" == typeof this.promoteId ? this.promoteId : this.promoteId[e]]) && (r = Number(r)), r
        }, xn("FeatureIndex", ic, {
            omit: ["rawTileData", "sourceLayerCoder"]
        });
        var uc = function (t, e) {
            this.tileID = t, this.uid = h(), this.uses = 0, this.tileSize = e, this.buckets = {}, this.expirationTime = null, this.queryPadding = 0, this.hasSymbolBuckets = !1, this.hasRTLText = !1, this.dependencies = {}, this.expiredRequestCount = 0, this.state = "loading", this.eTag = null;
        };
        uc.prototype.registerFadeDuration = function (t) {
            var e = t + this.timeAdded;
            e < L.now() || this.fadeEndTime && e < this.fadeEndTime || (this.fadeEndTime = e);
        }, uc.prototype.wasRequested = function () {
            return "errored" === this.state || "loaded" === this.state || "reloading" === this.state
        }, uc.prototype.loadVectorData = function (t, e, r) {
            if (this.hasData() && this.unloadVectorData(), this.state = "loaded", t) {
                for (var n in this.eTag = t.eTag || null, t.featureIndex && (this.latestFeatureIndex = t.featureIndex, t.rawTileData ? (this.latestRawTileData = t.rawTileData, this.latestFeatureIndex.rawTileData = t.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)), this.collisionBoxArray = t.collisionBoxArray, this.buckets = function (t, e) {
                        var r = {};
                        if (!e) return r;
                        for (var n = function () {
                                var t = a[i],
                                    n = t.layerIds.map((function (t) {
                                        return e.getLayer(t)
                                    })).filter(Boolean);
                                if (0 !== n.length) {
                                    t.layers = n, t.stateDependentLayerIds && (t.stateDependentLayers = t.stateDependentLayerIds.map((function (t) {
                                        return n.filter((function (e) {
                                            return e.id === t
                                        }))[0]
                                    })));
                                    for (var o = 0, s = n; o < s.length; o += 1) r[s[o].id] = t;
                                }
                            }, i = 0, a = t; i < a.length; i += 1) n();
                        return r
                    }(t.buckets, e.style), this.hasSymbolBuckets = !1, this.buckets) {
                    var i = this.buckets[n];
                    if (i instanceof nl || i instanceof up) {
                        if (this.hasSymbolBuckets = !0, !r) break;
                        i.justReloaded = !0;
                    }
                }
                if (this.hasRTLText = !1, this.hasSymbolBuckets)
                    for (var a in this.buckets) {
                        var o = this.buckets[a];
                        if ((o instanceof nl || o instanceof up) && o.hasRTLText) {
                            this.hasRTLText = !0, Rn.isLoading() || Rn.isLoaded() || "deferred" !== On() || Un();
                            break
                        }
                    }
                for (var s in this.queryPadding = 0, this.buckets) {
                    var u = this.buckets[s];
                    this.queryPadding = Math.max(this.queryPadding, e.style.getLayer(s).queryRadius(u));
                }
                t.imageAtlas && (this.imageAtlas = t.imageAtlas), t.glyphAtlasImage && (this.glyphAtlasImage = t.glyphAtlasImage);
            } else this.collisionBoxArray = new Fi;
        }, uc.prototype.unloadVectorData = function () {
            for (var t in this.buckets) this.buckets[t].destroy();
            this.buckets = {}, this.imageAtlasTexture && this.imageAtlasTexture.destroy(), this.imageAtlas && (this.imageAtlas = null), this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(), this.latestFeatureIndex = null, this.state = "unloaded";
        }, uc.prototype.getBucket = function (t) {
            return this.buckets[t.id]
        }, uc.prototype.upload = function (t) {
            for (var e in this.buckets) {
                var r = this.buckets[e];
                r.uploadPending() && r.upload(t);
            }
            var n = t.gl;
            this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new Bp(t, this.imageAtlas.image, n.RGBA), this.imageAtlas.uploaded = !0), this.glyphAtlasImage && (this.glyphAtlasTexture = new Bp(t, this.glyphAtlasImage, n.ALPHA), this.glyphAtlasImage = null);
        }, uc.prototype.prepare = function (t) {
            this.imageAtlas && this.imageAtlas.patchUpdatedImages(t, this.imageAtlasTexture);
        }, uc.prototype.queryRenderedFeatures = function (t, e, r, n, i, a, o, s, u, l) {
            return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({
                queryGeometry: n,
                cameraQueryGeometry: i,
                scale: a,
                tileSize: this.tileSize,
                pixelPosMatrix: l,
                transform: s,
                params: o,
                queryPadding: this.queryPadding * u
            }, t, e, r) : {}
        }, uc.prototype.querySourceFeatures = function (t, e) {
            var r = this.latestFeatureIndex;
            if (r && r.rawTileData) {
                var n = r.loadVTLayers(),
                    i = e ? e.sourceLayer : "",
                    a = n._geojsonTileLayer || n[i];
                if (a)
                    for (var o = Or(e && e.filter), s = this.tileID.canonical, u = s.z, l = s.x, p = s.y, c = {
                            z: u,
                            x: l,
                            y: p
                        }, h = 0; h < a.length; h++) {
                        var y = a.feature(h);
                        if (o.filter(new jn(this.tileID.overscaledZ), y)) {
                            var f = r.getId(y, i),
                                d = new ec(y, u, l, p, f);
                            d.tile = c, t.push(d);
                        }
                    }
            }
        }, uc.prototype.hasData = function () {
            return "loaded" === this.state || "reloading" === this.state || "expired" === this.state
        }, uc.prototype.patternsLoaded = function () {
            return this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length
        }, uc.prototype.setExpiryData = function (t) {
            var e = this.expirationTime;
            if (t.cacheControl) {
                var r = k(t.cacheControl);
                r["max-age"] && (this.expirationTime = Date.now() + 1e3 * r["max-age"]);
            } else t.expires && (this.expirationTime = new Date(t.expires).getTime());
            if (this.expirationTime) {
                var n = Date.now(),
                    i = !1;
                if (this.expirationTime > n) i = !1;
                else if (e)
                    if (this.expirationTime < e) i = !0;
                    else {
                        var a = this.expirationTime - e;
                        a ? this.expirationTime = n + Math.max(a, 3e4) : i = !0;
                    }
                else i = !0;
                i ? (this.expiredRequestCount++, this.state = "expired") : this.expiredRequestCount = 0;
            }
        }, uc.prototype.getExpiryTimeout = function () {
            if (this.expirationTime) return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - (new Date).getTime(), Math.pow(2, 31) - 1)
        }, uc.prototype.setFeatureState = function (t, e) {
            if (this.latestFeatureIndex && this.latestFeatureIndex.rawTileData && 0 !== Object.keys(t).length) {
                var r = this.latestFeatureIndex.loadVTLayers();
                for (var n in this.buckets)
                    if (e.style.hasLayer(n)) {
                        var i = this.buckets[n],
                            a = i.layers[0].sourceLayer || "_geojsonTileLayer",
                            o = r[a],
                            s = t[a];
                        if (o && s && 0 !== Object.keys(s).length) {
                            i.update(s, o, this.imageAtlas && this.imageAtlas.patternPositions || {});
                            var u = e && e.style && e.style.getLayer(n);
                            u && u.paint && (this.queryPadding = Math.max(this.queryPadding, u.queryRadius(i)));
                        }
                    }
            }
        }, uc.prototype.holdingForFade = function () {
            return void 0 !== this.symbolFadeHoldUntil
        }, uc.prototype.symbolFadeFinished = function () {
            return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < L.now()
        }, uc.prototype.clearFadeHold = function () {
            this.symbolFadeHoldUntil = void 0;
        }, uc.prototype.setHoldDuration = function (t) {
            this.symbolFadeHoldUntil = L.now() + t;
        }, uc.prototype.setDependencies = function (t, e) {
            for (var r = {}, n = 0, i = e; n < i.length; n += 1) r[i[n]] = !0;
            this.dependencies[t] = r;
        }, uc.prototype.hasDependency = function (t, e) {
            for (var r = 0, n = t; r < n.length; r += 1) {
                var i = this.dependencies[n[r]];
                if (i)
                    for (var a = 0, o = e; a < o.length; a += 1)
                        if (i[o[a]]) return !0
            }
            return !1
        };
        var lc = self.performance,
            pc = function (t) {
                this._marks = {
                    start: [t.url, "start"].join("#"),
                    end: [t.url, "end"].join("#"),
                    measure: t.url.toString()
                }, lc.mark(this._marks.start);
            };
        pc.prototype.finish = function () {
            lc.mark(this._marks.end);
            var t = lc.getEntriesByName(this._marks.measure);
            return 0 === t.length && (lc.measure(this._marks.measure, this._marks.start, this._marks.end), t = lc.getEntriesByName(this._marks.measure), lc.clearMarks(this._marks.start), lc.clearMarks(this._marks.end), lc.clearMeasures(this._marks.measure)), t
        }, t.Actor = Cp, t.AlphaImage = ro, t.CanonicalTileID = Zp, t.CollisionBoxArray = Fi, t.Color = Tt, t.DEMData = Qp, t.DataConstantProperty = $n, t.DictionaryCoder = tc, t.EXTENT = 8192, t.ErrorEvent = ot, t.EvaluationParameters = jn, t.Event = at, t.Evented = st, t.FeatureIndex = ic, t.FillBucket = Go, t.FillExtrusionBucket = ls, t.ImageAtlas = au, t.ImagePosition = nu, t.LineBucket = xs, t.LngLat = Lp, t.LngLatBounds = Pp, t.LngLatCoordinate = Yp, t.MercatorCoordinate = Up, t.ONE_EM = 24, t.OverscaledTileID = $p, t.Point = i, t.Point$1 = i, t.Properties = ri, t.Protobuf = Ds, t.RGBAImage = no, t.RequestPerformance = pc, t.ResourceType = Z, t.SegmentVector = Hi, t.SourceFeatureState = nc, t.StructArrayLayout1ui2 = Li, t.StructArrayLayout2f1f2i16 = ki, t.StructArrayLayout2i4 = li, t.StructArrayLayout3ui6 = Si, t.StructArrayLayout4i8 = pi, t.SymbolBucket = nl, t.SymtrackingBucket = up, t.Texture = Bp, t.Tile = uc, t.Transitionable = Xn, t.Uniform1f = oa, t.Uniform1i = aa, t.Uniform2f = sa, t.Uniform3f = ua, t.Uniform4f = la, t.UniformColor = pa, t.UniformMatrix4f = ha, t.UnwrappedTileID = Jp, t.ValidationError = lt, t.WritingMode = ou, t.ZoomHistory = Sn, t.add = function (t, e, r) {
            return t[0] = e[0] + r[0], t[1] = e[1] + r[1], t[2] = e[2] + r[2], t
        }, t.addDynamicAttributes = Qu, t.addDynamicAttributes$1 = ip, t.asyncAll = function (t, e, r) {
            if (!t.length) return r(null, []);
            var n = t.length,
                i = new Array(t.length),
                a = null;
            t.forEach((function (t, o) {
                e(t, (function (t, e) {
                    t && (a = t), i[o] = e, 0 == --n && r(a, i);
                }));
            }));
        }, t.b64DecodeUnicode = function (t) {
            return decodeURIComponent(self.atob(t).split("").map((function (t) {
                return "%" + ("00" + t.charCodeAt(0).toString(16)).slice(-2)
            })).join(""))
        }, t.b64EncodeUnicode = function (t) {
            return self.btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g, (function (t, e) {
                return String.fromCharCode(Number("0x" + e))
            })))
        }, t.bezier = o, t.bindAll = y, t.browser = L, t.cacheEntryPossiblyAdded = function (t) {
            ++R > E && (t.getActor().send("enforceCacheSizeLimit", D), R = 0);
        }, t.clamp = u, t.clearTileCache = function (t) {
            var e = self.caches.delete("minemap-tiles");
            t && e.catch(t).then((function () {
                return t()
            }));
        }, t.clipLine = Mu, t.clone = function (t) {
            var e = new Ka(16);
            return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e
        }, t.clone$1 = g, t.clone$2 = function (t) {
            var e = new Ka(3);
            return e[0] = t[0], e[1] = t[1], e[2] = t[2], e
        }, t.collisionCircleLayout = Vs, t.colorParser = Pt, t.config = T, t.create = function () {
            var t = new Ka(16);
            return Ka != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0), t[0] = 1, t[5] = 1, t[10] = 1, t[15] = 1, t
        }, t.create$1 = function () {
            var t = new Ka(9);
            return Ka != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[5] = 0, t[6] = 0, t[7] = 0), t[0] = 1, t[4] = 1, t[8] = 1, t
        }, t.create$2 = function () {
            var t = new Ka(4);
            return Ka != Float32Array && (t[1] = 0, t[2] = 0), t[0] = 1, t[3] = 1, t
        }, t.createCommonjsModule = e, t.createExpression = Ir, t.createLayout = si, t.createStyleLayer = function (t) {
            return "custom" === t.type ? new yl(t) : new wp[t.type](t)
        }, t.cross = function (t, e, r) {
            var n = e[0],
                i = e[1],
                a = e[2],
                o = r[0],
                s = r[1],
                u = r[2];
            return t[0] = i * u - a * s, t[1] = a * o - n * u, t[2] = n * s - i * o, t
        }, t.deepEqual = function t(e, r) {
            if (Array.isArray(e)) {
                if (!Array.isArray(r) || e.length !== r.length) return !1;
                for (var n = 0; n < e.length; n++)
                    if (!t(e[n], r[n])) return !1;
                return !0
            }
            if ("object" == typeof e && null !== e && null !== r) {
                if ("object" != typeof r) return !1;
                if (Object.keys(e).length !== Object.keys(r).length) return !1;
                for (var i in e)
                    if (!t(e[i], r[i])) return !1;
                return !0
            }
            return e === r
        }, t.dot = function (t, e) {
            return t[0] * e[0] + t[1] * e[1] + t[2] * e[2]
        }, t.dot$1 = function (t, e) {
            return t[0] * e[0] + t[1] * e[1] + t[2] * e[2] + t[3] * e[3]
        }, t.ease = s, t.emitValidationErrors = yn, t.endsWith = f, t.enforceCacheSizeLimit = function (t) {
            F(), B && B.then((function (e) {
                e.keys().then((function (r) {
                    for (var n = 0; n < r.length - t; n++) e.delete(r[n]);
                }));
            }));
        }, t.evaluateSizeForFeature = wu, t.evaluateSizeForZoom = ku, t.evaluateVariableOffset = Xu, t.evented = qn, t.extend = p, t.featureFilter = Or, t.filterObject = m, t.fromRotation = function (t, e) {
            var r = Math.sin(e),
                n = Math.cos(e);
            return t[0] = n, t[1] = r, t[2] = 0, t[3] = -r, t[4] = n, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t
        }, t.getAnchorAlignment = gu, t.getAnchorJustification = Gu, t.getArrayBuffer = et, t.getImage = rt, t.getJSON = function (t, e) {
            return tt(p(t = "string" == typeof t ? {
                url: t
            } : t, {
                type: "json"
            }), e)
        }, t.getRTLTextPluginStatus = On, t.getReferrer = Q, t.getVideo = function (t, e) {
            var r, n, i = self.document.createElement("video");
            i.muted = !0, i.onloadstart = function () {
                e(null, i);
            };
            for (var a = 0; a < t.length; a++) {
                var o = self.document.createElement("source");
                r = t[a], n = void 0, (n = self.document.createElement("a")).href = r, (n.protocol !== self.document.location.protocol || n.host !== self.document.location.host) && (i.crossOrigin = "Anonymous"), o.src = t[a], i.appendChild(o);
            }
            return {
                cancel: function () {}
            }
        }, t.identity = Xa, t.invert = function (t, e) {
            var r = e[0],
                n = e[1],
                i = e[2],
                a = e[3],
                o = e[4],
                s = e[5],
                u = e[6],
                l = e[7],
                p = e[8],
                c = e[9],
                h = e[10],
                y = e[11],
                f = e[12],
                d = e[13],
                m = e[14],
                g = e[15],
                v = r * s - n * o,
                x = r * u - i * o,
                b = r * l - a * o,
                _ = n * u - i * s,
                w = n * l - a * s,
                k = i * l - a * u,
                A = p * d - c * f,
                S = p * m - h * f,
                I = p * g - y * f,
                z = c * m - h * d,
                B = c * g - y * d,
                V = h * g - y * m,
                C = v * V - x * B + b * z + _ * I - w * S + k * A;
            return C ? (t[0] = (s * V - u * B + l * z) * (C = 1 / C), t[1] = (i * B - n * V - a * z) * C, t[2] = (d * k - m * w + g * _) * C, t[3] = (h * w - c * k - y * _) * C, t[4] = (u * I - o * V - l * S) * C, t[5] = (r * V - i * I + a * S) * C, t[6] = (m * b - f * k - g * x) * C, t[7] = (p * k - h * b + y * x) * C, t[8] = (o * B - s * I + l * A) * C, t[9] = (n * I - r * B - a * A) * C, t[10] = (f * w - d * b + g * v) * C, t[11] = (c * b - p * w - y * v) * C, t[12] = (s * S - o * z - u * A) * C, t[13] = (r * z - n * S + i * A) * C, t[14] = (d * x - f * _ - m * v) * C, t[15] = (p * _ - c * x + h * v) * C, t) : null
        }, t.isChar = In, t.keysDifference = function (t, e) {
            var r = [];
            for (var n in t) n in e || r.push(n);
            return r
        }, t.lngLatXfromLng = Np, t.lngLatYfromLat = Kp, t.makeRequest = tt, t.mapObject = d, t.mercatorXfromLng = Ep, t.mercatorYfromLat = Fp, t.mercatorZfromAltitude = qp, t.mul = Ya, t.multiply = Ga, t.mvt = as, t.normalize = function (t, e) {
            var r = e[0],
                n = e[1],
                i = e[2],
                a = r * r + n * n + i * i;
            return a > 0 && (a = 1 / Math.sqrt(a)), t[0] = e[0] * a, t[1] = e[1] * a, t[2] = e[2] * a, t
        }, t.number = Ae, t.offscreenCanvasSupported = G, t.ortho = function (t, e, r, n, i, a, o) {
            var s = 1 / (e - r),
                u = 1 / (n - i),
                l = 1 / (a - o);
            return t[0] = -2 * s, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = -2 * u, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 2 * l, t[11] = 0, t[12] = (e + r) * s, t[13] = (i + n) * u, t[14] = (o + a) * l, t[15] = 1, t
        }, t.parseGlyphPBF = function (t) {
            return new Ds(t).readFields(Qs, [])
        }, t.pbf = Ds, t.performSymbolLayout = function (t, e, r, n, i, a, o) {
            t.createArrays(), t.tilePixelRatio = 8192 / (512 * t.overscaling), t.compareText = {}, t.iconsNeedLinear = !1;
            var s = t.layers[0].layout,
                u = t.layers[0]._unevaluatedLayout._values,
                l = {};
            if ("composite" === t.textSizeData.kind) {
                var p = t.textSizeData,
                    c = p.maxZoom;
                l.compositeTextSizes = [u["text-size"].possiblyEvaluate(new jn(p.minZoom), o), u["text-size"].possiblyEvaluate(new jn(c), o)];
            }
            if ("composite" === t.iconSizeData.kind) {
                var h = t.iconSizeData,
                    y = h.maxZoom;
                l.compositeIconSizes = [u["icon-size"].possiblyEvaluate(new jn(h.minZoom), o), u["icon-size"].possiblyEvaluate(new jn(y), o)];
            }
            l.layoutTextSize = u["text-size"].possiblyEvaluate(new jn(t.zoom + 1), o), l.layoutIconSize = u["icon-size"].possiblyEvaluate(new jn(t.zoom + 1), o), l.textMaxSize = u["text-size"].possiblyEvaluate(new jn(18));
            for (var f = 24 * s.get("text-line-height"), d = "map" === s.get("text-rotation-alignment") && "point" !== s.get("symbol-placement"), m = s.get("text-keep-upright"), g = s.get("text-size"), v = function () {
                    var a = _[b],
                        u = s.get("text-font").evaluate(a, {}, o).join(","),
                        p = g.evaluate(a, {}, o),
                        c = l.layoutTextSize.evaluate(a, {}, o),
                        h = l.layoutIconSize.evaluate(a, {}, o),
                        y = {
                            horizontal: {},
                            vertical: void 0
                        },
                        v = a.text,
                        w = [0, 0];
                    if (v) {
                        var k = v.toString(),
                            A = 24 * s.get("text-letter-spacing").evaluate(a, {}, o),
                            S = function (t) {
                                for (var e = 0, r = t; e < r.length; e += 1)
                                    if (n = r[e].charCodeAt(0), In.Arabic(n) || In["Arabic Supplement"](n) || In["Arabic Extended-A"](n) || In["Arabic Presentation Forms-A"](n) || In["Arabic Presentation Forms-B"](n)) return !1;
                                var n;
                                return !0
                            }(k) ? A : 0,
                            I = s.get("text-anchor").evaluate(a, {}, o),
                            z = s.get("text-variable-anchor");
                        if (!z) {
                            var B = s.get("text-radial-offset").evaluate(a, {}, o);
                            w = B ? Xu(I, [24 * B, Ku]) : s.get("text-offset").evaluate(a, {}, o).map((function (t) {
                                return 24 * t
                            }));
                        }
                        var V = d ? "center" : s.get("text-justify").evaluate(a, {}, o),
                            C = s.get("symbol-placement"),
                            M = "point" === C ? 24 * s.get("text-max-width").evaluate(a, {}, o) : 0,
                            P = function () {
                                t.allowVerticalPlacement && zn(k) && (y.vertical = lu(v, e, r, i, u, M, f, I, "left", S, w, ou.vertical, !0, C, c, p));
                            };
                        if (!d && z) {
                            for (var L = "auto" === V ? z.map((function (t) {
                                    return Gu(t)
                                })) : [V], T = !1, D = 0; D < L.length; D++) {
                                var E = L[D];
                                if (!y.horizontal[E])
                                    if (T) y.horizontal[E] = y.horizontal[0];
                                    else {
                                        var F = lu(v, e, r, i, u, M, f, "center", E, S, w, ou.horizontal, !1, C, c, p);
                                        F && (y.horizontal[E] = F, T = 1 === F.positionedLines.length);
                                    }
                            }
                            P();
                        } else {
                            "auto" === V && (V = Gu(I));
                            var q = lu(v, e, r, i, u, M, f, I, V, S, w, ou.horizontal, !1, C, c, p);
                            q && (y.horizontal[V] = q), P(), zn(k) && d && m && (y.vertical = lu(v, e, r, i, u, M, f, I, V, S, w, ou.vertical, !1, C, c, p));
                        }
                    }
                    var O = void 0,
                        U = !1;
                    if (a.icon && a.icon.name) {
                        var R = n[a.icon.name];
                        R && (O = function (t, e, r) {
                            var n = gu(r),
                                i = e[0] - t.displaySize[0] * n.horizontalAlign,
                                a = e[1] - t.displaySize[1] * n.verticalAlign;
                            return {
                                image: t,
                                top: a,
                                bottom: a + t.displaySize[1],
                                left: i,
                                right: i + t.displaySize[0]
                            }
                        }(i[a.icon.name], s.get("icon-offset").evaluate(a, {}, o), s.get("icon-anchor").evaluate(a, {}, o)), U = R.sdf, void 0 === t.sdfIcons ? t.sdfIcons = R.sdf : t.sdfIcons !== R.sdf && x("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"), (R.pixelRatio !== t.pixelRatio || 0 !== s.get("icon-rotate").constantOr(1)) && (t.iconsNeedLinear = !0));
                    }
                    var j = Yu(y.horizontal) || y.vertical;
                    t.iconsInText = !!j && j.iconsInText, (j || O) && function (t, e, r, n, i, a, o, s, u, l, p) {
                        var c = a.textMaxSize.evaluate(e, {});
                        void 0 === c && (c = o);
                        var h, y = t.layers[0].layout,
                            f = y.get("icon-offset").evaluate(e, {}, p),
                            d = Yu(r.horizontal),
                            m = o / 24,
                            g = t.tilePixelRatio * m,
                            v = t.tilePixelRatio * c / 24,
                            b = t.tilePixelRatio * s,
                            _ = t.tilePixelRatio * y.get("symbol-spacing"),
                            w = y.get("text-padding") * t.tilePixelRatio,
                            k = y.get("icon-padding") * t.tilePixelRatio,
                            A = y.get("text-max-angle") / 180 * Math.PI,
                            S = t instanceof nl && "map" === y.get("text-rotation-alignment") && "point" !== y.get("symbol-placement"),
                            I = t instanceof nl && "map" === y.get("icon-rotation-alignment") && "point" !== y.get("symbol-placement"),
                            z = t instanceof nl ? y.get("symbol-placement") : "point",
                            B = _ / 2,
                            V = y.get("icon-text-fit");
                        n && "none" !== V && (t.allowVerticalPlacement && r.vertical && (h = xu(n, r.vertical, V, y.get("icon-text-fit-padding"), f, m)), d && (n = xu(n, d, V, y.get("icon-text-fit-padding"), f, m)));
                        var C = function (s, c) {
                            c.x < 0 || c.x >= 8192 || c.y < 0 || c.y >= 8192 || function (t, e, r, n, i, a, o, s, u, l, p, c, h, y, f, d, m, g, v, b, _, w, k, A, S) {
                                var I, z, B, V, C, M = t.addToLineVertexArray(e, r),
                                    P = 0,
                                    L = 0,
                                    T = 0,
                                    D = 0,
                                    E = -1,
                                    F = -1,
                                    q = {},
                                    O = Wi(""),
                                    U = 0,
                                    R = 0;
                                if (void 0 === s._unevaluatedLayout.getValue("text-radial-offset") ? (U = (I = s.layout.get("text-offset").evaluate(_, {}, A).map((function (t) {
                                        return 24 * t
                                    })))[0], R = I[1]) : (U = 24 * s.layout.get("text-radial-offset").evaluate(_, {}, A), R = Ku), t.allowVerticalPlacement && n.vertical) {
                                    var j = s.layout.get("text-rotate").evaluate(_, {}, A) + 90;
                                    V = new qu(u, e, l, p, c, n.vertical, h, y, f, j), o && (C = new qu(u, e, l, p, c, o, m, g, f, j));
                                }
                                if (i) {
                                    var N = s.layout.get("icon-rotate").evaluate(_, {}),
                                        K = "none" !== s.layout.get("icon-text-fit"),
                                        X = Pu(i, N, k, K, s, _),
                                        G = o ? Pu(o, N, k, K, s, _) : void 0;
                                    B = new qu(u, e, l, p, c, i, m, g, !1, N), P = 4 * X.length;
                                    var H = t.iconSizeData,
                                        Y = null;
                                    "source" === H.kind ? (Y = [128 * s.layout.get("icon-size").evaluate(_, {})])[0] > 32640 && x(t.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".') : "composite" === H.kind && ((Y = [128 * w.compositeIconSizes[0].evaluate(_, {}, A), 128 * w.compositeIconSizes[1].evaluate(_, {}, A)])[0] > 32640 || Y[1] > 32640) && x(t.layerIds[0] + ': Value for "icon-size" is >= 255. Reduce your "icon-size".'), t.addSymbols(t.icon, X, Y, b, v, _, !1, e, M.lineStartIndex, M.lineLength, -1, A), E = t.icon.placedSymbolArray.length - 1, G && (L = 4 * G.length, t.addSymbols(t.icon, G, Y, b, v, _, ou.vertical, e, M.lineStartIndex, M.lineLength, -1, A), F = t.icon.placedSymbolArray.length - 1);
                                }
                                for (var Z in n.horizontal) {
                                    var J = n.horizontal[Z];
                                    if (!z) {
                                        O = Wi(J.text);
                                        var $ = s.layout.get("text-rotate").evaluate(_, {}, A);
                                        z = new qu(u, e, l, p, c, J, h, y, f, $);
                                    }
                                    var W = 1 === J.positionedLines.length;
                                    if (T += Hu(t, e, J, a, s, f, _, d, M, n.vertical ? ou.horizontal : ou.horizontalOnly, W ? Object.keys(n.horizontal) : [Z], q, E, w, A), W) break
                                }
                                n.vertical && (D += Hu(t, e, n.vertical, a, s, f, _, d, M, ou.vertical, ["vertical"], q, F, w, A));
                                var Q = z ? z.boxStartIndex : t.collisionBoxArray.length,
                                    tt = z ? z.boxEndIndex : t.collisionBoxArray.length,
                                    et = V ? V.boxStartIndex : t.collisionBoxArray.length,
                                    rt = V ? V.boxEndIndex : t.collisionBoxArray.length,
                                    nt = B ? B.boxStartIndex : t.collisionBoxArray.length,
                                    it = B ? B.boxEndIndex : t.collisionBoxArray.length,
                                    at = C ? C.boxStartIndex : t.collisionBoxArray.length,
                                    ot = C ? C.boxEndIndex : t.collisionBoxArray.length,
                                    st = -1,
                                    ut = function (t, e) {
                                        return t && t.circleDiameter ? Math.max(t.circleDiameter, e) : e
                                    };
                                st = ut(z, st), st = ut(V, st), st = ut(B, st);
                                var lt = (st = ut(C, st)) > -1 ? 1 : 0;
                                lt && (st *= S / 24), t.glyphOffsetArray.length >= nl.MAX_GLYPHS && x("Too many glyphs being rendered in a tile."), void 0 !== _.sortKey && t.addToSortKeyRanges(t.symbolInstances.length, _.sortKey), t.symbolInstances.emplaceBack(e.x, e.y, q.right >= 0 ? q.right : -1, q.center >= 0 ? q.center : -1, q.left >= 0 ? q.left : -1, q.vertical || -1, E, F, O, Q, tt, et, rt, nt, it, at, ot, l, T, D, P, L, lt, 0, h, U, R, st);
                            }(t, c, s, r, n, i, h, t.layers[0], t.collisionBoxArray, e.index, e.sourceLayerIndex, t.index, g, w, S, u, b, k, I, f, e, a, l, p, o);
                        };
                        if ("line" === z)
                            for (var M = 0, P = Mu(e.geometry, 0, 0, 8192, 8192); M < P.length; M += 1)
                                for (var L = P[M], T = 0, D = Cu(L, _, A, r.vertical || d, n, 24, v, t.overscaling, 8192); T < D.length; T += 1) {
                                    var E = D[T];
                                    d && Zu(t, d.text, B, E) || C(L, E);
                                } else if ("line-center" === z)
                                    for (var F = 0, q = e.geometry; F < q.length; F += 1) {
                                        var O = q[F];
                                        if (O.length > 1) {
                                            var U = Vu(O, A, r.vertical || d, n, 24, v);
                                            U && C(O, U);
                                        }
                                    } else if ("Polygon" === e.type)
                                        for (var R = 0, j = jo(e.geometry, 0); R < j.length; R += 1) {
                                            var N = j[R],
                                                K = Ru(N, 16);
                                            C(N[0], new bu(K.x, K.y, 0));
                                        } else if ("LineString" === e.type)
                                            for (var X = 0, G = e.geometry; X < G.length; X += 1) {
                                                var H = G[X];
                                                C(H, new bu(H[0].x, H[0].y, 0));
                                            } else if ("Point" === e.type)
                                                for (var Y = 0, Z = e.geometry; Y < Z.length; Y += 1)
                                                    for (var J = 0, $ = Z[Y]; J < $.length; J += 1) {
                                                        var W = $[J];
                                                        C([W], new bu(W.x, W.y, 0));
                                                    }
                    }(t, a, y, O, n, l, c, h, w, U, o);
                }, b = 0, _ = t.features; b < _.length; b += 1) v();
            a && t.generateCollisionDebugBuffers();
        }, t.perspective = function (t, e, r, n, i) {
            var a, o = 1 / Math.tan(e / 2);
            return t[0] = o / r, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = o, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = -1, t[12] = 0, t[13] = 0, t[15] = 0, null != i && i !== 1 / 0 ? (t[10] = (i + n) * (a = 1 / (n - i)), t[14] = 2 * i * n * a) : (t[10] = -1, t[14] = -2 * n), t
        }, t.pick = function (t, e) {
            for (var r = {}, n = 0; n < e.length; n++) {
                var i = e[n];
                i in t && (r[i] = t[i]);
            }
            return r
        }, t.plugin = Rn, t.polygonIntersectsPolygon = za, t.postData = function (t, e) {
            return tt(p(t, {
                method: "POST"
            }), e)
        }, t.potpack = ru, t.refProperties = ["type", "source", "source-layer", "minzoom", "maxzoom", "filter", "layout"], t.register = xn, t.registerForPluginStateChange = function (t) {
            return t({
                pluginStatus: Tn,
                pluginURL: Dn
            }), qn.on("pluginStateChange", t), t
        }, t.resultfakeToReal = function (t) {
            if (Array.isArray(t))
                for (var e = 0; e < t.length; e++) Gp(t[e]);
            else
                for (var r in t)
                    for (var n = t[r], i = 0; i < n.length; i++) Gp(n[i]);
        }, t.rotate = function (t, e, r) {
            var n = e[0],
                i = e[1],
                a = e[2],
                o = e[3],
                s = Math.sin(r),
                u = Math.cos(r);
            return t[0] = n * u + a * s, t[1] = i * u + o * s, t[2] = n * -s + a * u, t[3] = i * -s + o * u, t
        }, t.rotateX = function (t, e, r) {
            var n = Math.sin(r),
                i = Math.cos(r),
                a = e[4],
                o = e[5],
                s = e[6],
                u = e[7],
                l = e[8],
                p = e[9],
                c = e[10],
                h = e[11];
            return e !== t && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[4] = a * i + l * n, t[5] = o * i + p * n, t[6] = s * i + c * n, t[7] = u * i + h * n, t[8] = l * i - a * n, t[9] = p * i - o * n, t[10] = c * i - s * n, t[11] = h * i - u * n, t
        }, t.rotateZ = function (t, e, r) {
            var n = Math.sin(r),
                i = Math.cos(r),
                a = e[0],
                o = e[1],
                s = e[2],
                u = e[3],
                l = e[4],
                p = e[5],
                c = e[6],
                h = e[7];
            return e !== t && (t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = a * i + l * n, t[1] = o * i + p * n, t[2] = s * i + c * n, t[3] = u * i + h * n, t[4] = l * i - a * n, t[5] = p * i - o * n, t[6] = c * i - s * n, t[7] = h * i - u * n, t
        }, t.scale = function (t, e, r) {
            var n = r[0],
                i = r[1],
                a = r[2];
            return t[0] = e[0] * n, t[1] = e[1] * n, t[2] = e[2] * n, t[3] = e[3] * n, t[4] = e[4] * i, t[5] = e[5] * i, t[6] = e[6] * i, t[7] = e[7] * i, t[8] = e[8] * a, t[9] = e[9] * a, t[10] = e[10] * a, t[11] = e[11] * a, t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15], t
        }, t.scale$1 = function (t, e, r) {
            return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t[3] = e[3] * r, t
        }, t.scale$2 = function (t, e, r) {
            return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t
        }, t.setCacheLimits = function (t, e) {
            D = t, E = e;
        }, t.setRTLTextPlugin = function (t, e, r) {
            if (void 0 === r && (r = !1), "deferred" === Tn || "loading" === Tn || "loaded" === Tn) throw new Error("setRTLTextPlugin cannot be called multiple times.");
            Dn = L.resolveURL(t), Tn = "deferred", Ln = e, Fn(), r || Un();
        }, t.sphericalToCartesian = function (t) {
            var e = t[0],
                r = t[1],
                n = t[2];
            return r += 90, r *= Math.PI / 180, n *= Math.PI / 180, {
                x: e * Math.cos(r) * Math.sin(n),
                y: e * Math.sin(r) * Math.sin(n),
                z: e * Math.cos(n)
            }
        }, t.sqrLen = function (t) {
            var e = t[0],
                r = t[1];
            return e * e + r * r
        }, t.storageAvailable = function (t) {
            try {
                var e = self[t];
                return e.setItem("_minemap_test_", 1), e.removeItem("_minemap_test_"), !0
            } catch (t) {
                return !1
            }
        }, t.styleSpec = ut, t.sub = function (t, e, r) {
            return t[0] = e[0] - r[0], t[1] = e[1] - r[1], t[2] = e[2] - r[2], t
        }, t.symbolSize = Au, t.transformMat3 = function (t, e, r) {
            var n = e[0],
                i = e[1],
                a = e[2];
            return t[0] = n * r[0] + i * r[3] + a * r[6], t[1] = n * r[1] + i * r[4] + a * r[7], t[2] = n * r[2] + i * r[5] + a * r[8], t
        }, t.transformMat4 = Za, t.translate = function (t, e, r) {
            var n, i, a, o, s, u, l, p, c, h, y, f, d = r[0],
                m = r[1],
                g = r[2];
            return e === t ? (t[12] = e[0] * d + e[4] * m + e[8] * g + e[12], t[13] = e[1] * d + e[5] * m + e[9] * g + e[13], t[14] = e[2] * d + e[6] * m + e[10] * g + e[14], t[15] = e[3] * d + e[7] * m + e[11] * g + e[15]) : (i = e[1], a = e[2], o = e[3], s = e[4], u = e[5], l = e[6], p = e[7], c = e[8], h = e[9], y = e[10], f = e[11], t[0] = n = e[0], t[1] = i, t[2] = a, t[3] = o, t[4] = s, t[5] = u, t[6] = l, t[7] = p, t[8] = c, t[9] = h, t[10] = y, t[11] = f, t[12] = n * d + s * m + c * g + e[12], t[13] = i * d + u * m + h * g + e[13], t[14] = a * d + l * m + y * g + e[14], t[15] = o * d + p * m + f * g + e[15]), t
        }, t.triggerPluginCompletionEvent = En, t.uniqueId = h, t.uuid = function () {
            return function t(e) {
                return e ? (e ^ 16 * Math.random() >> e / 4).toString(16) : ([1e7] + -[1e3] + -4e3 + -8e3 + -1e11).replace(/[018]/g, t)
            }()
        }, t.validateCustomStyleLayer = function (t) {
            var e = [],
                r = t.id;
            return void 0 === r && e.push({
                message: "layers." + r + ': missing required property "id"'
            }), void 0 === t.render && e.push({
                message: "layers." + r + ': missing required method "render"'
            }), t.renderingMode && "2d" !== t.renderingMode && "3d" !== t.renderingMode && e.push({
                message: "layers." + r + ': property "renderingMode" must be either "2d" or "3d"'
            }), e
        }, t.validateLight = pn, t.validateStyle = ln, t.validateUuid = function (t) {
            return !!t && /^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)
        }, t.values = function (t) {
            var e = [];
            for (var r in t) e.push(t[r]);
            return e
        }, t.vectorTile = as, t.warnOnce = x, t.webpSupported = j, t.window = self, t.wrap = l;
    }));

    define(["./shared"], (function (e) {
        "use strict";

        function t(e) {
            var r = typeof e;
            if ("number" === r || "boolean" === r || "string" === r || null == e) return JSON.stringify(e);
            if (Array.isArray(e)) {
                for (var i = "[", n = 0, o = e; n < o.length; n += 1) i += t(o[n]) + ",";
                return i + "]"
            }
            for (var a = Object.keys(e).sort(), s = "{", l = 0; l < a.length; l++) s += JSON.stringify(a[l]) + ":" + t(e[a[l]]) + ",";
            return s + "}"
        }

        function r(r) {
            for (var i = "", n = 0, o = e.refProperties; n < o.length; n += 1) i += "/" + t(r[o[n]]);
            return i
        }
        var i = function (e) {
            this.keyCache = {}, e && this.replace(e);
        };
        i.prototype.replace = function (e) {
            this._layerConfigs = {}, this._layers = {}, this.update(e, []);
        }, i.prototype.update = function (t, i) {
            for (var n = this, o = 0, a = t; o < a.length; o += 1) {
                var s = a[o];
                this._layerConfigs[s.id] = s;
                var l = this._layers[s.id] = e.createStyleLayer(s);
                l._featureFilter = e.featureFilter(l.filter), this.keyCache[s.id] && delete this.keyCache[s.id];
            }
            for (var u = 0, h = i; u < h.length; u += 1) {
                var c = h[u];
                delete this.keyCache[c], delete this._layerConfigs[c], delete this._layers[c];
            }
            this.familiesBySource = {};
            for (var p = 0, f = function (e, t) {
                    for (var i = {}, n = 0; n < e.length; n++) {
                        var o = t && t[e[n].id] || r(e[n]);
                        t && (t[e[n].id] = o);
                        var a = i[o];
                        a || (a = i[o] = []), a.push(e[n]);
                    }
                    var s = [];
                    for (var l in i) s.push(i[l]);
                    return s
                }(e.values(this._layerConfigs), this.keyCache); p < f.length; p += 1) {
                var d = f[p].map((function (e) {
                        return n._layers[e.id]
                    })),
                    g = d[0];
                if ("none" !== g.visibility) {
                    var v = g.source || "",
                        m = this.familiesBySource[v];
                    m || (m = this.familiesBySource[v] = {});
                    var y = g.sourceLayer || "_geojsonTileLayer",
                        x = m[y];
                    x || (x = m[y] = []), x.push(d);
                }
            }
        };
        var n = function (t) {
            var r = {},
                i = [];
            for (var n in t) {
                var o = t[n],
                    a = r[n] = {};
                for (var s in o) {
                    var l = o[+s];
                    if (l && 0 !== l.bitmap.width && 0 !== l.bitmap.height) {
                        var u = {
                            x: 0,
                            y: 0,
                            w: l.bitmap.width + 2,
                            h: l.bitmap.height + 2
                        };
                        i.push(u), a[s] = {
                            rect: u,
                            metrics: l.metrics
                        };
                    }
                }
            }
            var h = e.potpack(i),
                c = new e.AlphaImage({
                    width: h.w || 1,
                    height: h.h || 1
                });
            for (var p in t) {
                var f = t[p];
                for (var d in f) {
                    var g = f[+d];
                    if (g && 0 !== g.bitmap.width && 0 !== g.bitmap.height) {
                        var v = r[p][d].rect;
                        e.AlphaImage.copy(g.bitmap, c, {
                            x: 0,
                            y: 0
                        }, {
                            x: v.x + 1,
                            y: v.y + 1
                        }, g.bitmap);
                    }
                }
            }
            this.image = c, this.positions = r;
        };
        e.register("GlyphAtlas", n);
        var o = function (t) {
            this.tileID = new e.OverscaledTileID(t.tileID.overscaledZ, t.tileID.wrap, t.tileID.canonical.z, t.tileID.canonical.x, t.tileID.canonical.y), this.uid = t.uid, this.zoom = t.zoom, this.pixelRatio = t.pixelRatio, this.tileSize = t.tileSize, this.source = t.source, this.overscaling = this.tileID.overscaleFactor(), this.showCollisionBoxes = t.showCollisionBoxes, this.collectResourceTiming = !!t.collectResourceTiming, this.returnDependencies = !!t.returnDependencies, this.promoteId = t.promoteId, this.sourceOptions = t.sourceOptions;
        };

        function a(t, r, i) {
            for (var n = new e.EvaluationParameters(r), o = 0, a = t; o < a.length; o += 1) a[o].recalculate(n, i);
        }

        function s(t, r) {
            var i = t.sourceOptions || {},
                n = i.separate || {};
            i.traffic && t.eTag && (t.request.headers || (t.request.headers = new e.window.Headers), t.request.headers.set("If-None-Match", t.eTag));
            var o = e.getArrayBuffer(t.request, (function (t, o, a, s, l) {
                t ? r(t) : o && r(null, {
                    vectorTile: i.traffic && n.isPbfSeparate && l && l.endsWith("_status") ? null : new e.vectorTile.VectorTile(new e.pbf(o)),
                    rawData: o,
                    cacheControl: a,
                    expires: s,
                    eTag: l
                });
            }));
            return function () {
                o.cancel(), r();
            }
        }
        o.prototype.parse = function (e, t, r, i, n, o) {
            this.status = "parsing", this.data = e;
            var a = this.sourceOptions || {},
                s = a.separate || {};
            if (a.traffic && s.isPbfSeparate && (s.separateSource || "") === this.source && this.eTag && this.eTag.endsWith("_status") && o) {
                var l = String.fromCharCode.apply(null, new Uint8Array(o));
                this.parsing(e, t, r, i, a, l.length > 0 ? JSON.parse(l) : null, n);
            } else this.parsing(e, t, r, i, a, null, n);
        }, o.prototype.parsing = function (t, r, i, o, s, l, u) {
            var h = this;
            this.status = "parsing", this.data = t, this.collisionBoxArray = new e.CollisionBoxArray;
            var c = new e.DictionaryCoder(Object.keys(t.layers).sort()),
                p = new e.FeatureIndex(this.tileID, this.promoteId);
            p.bucketLayerIDs = [];
            var f, d, g, v, m, y, x = {},
                w = {
                    featureIndex: p,
                    iconDependencies: {},
                    patternDependencies: {},
                    glyphDependencies: {},
                    availableImages: i
                },
                S = s.separate || {},
                M = function (e, t, r) {
                    r || (e.properties.status = 1), e.properties.status = t[0].includes(r) ? 0 : t[1].includes(r) ? 2 : t[2].includes(r) ? 3 : t[3].includes(r) ? 4 : 1;
                },
                I = [];
            s.traffic && S.isPbfSeparate && S.separateSource === this.source && this.eTag && this.eTag.endsWith("_status") && (v = (g = l || {})[(f = [0, 2, 3, 4])[1]] || [], m = g[f[2]] || [], y = g[f[3]] || [], (d = I).push(g[f[0]] || []), d.push(v), d.push(m), d.push(y));
            var b, T, _, P, L = r.familiesBySource[this.source];
            for (var k in L) {
                var C = t.layers[k];
                if (C) {
                    1 === C.version && e.warnOnce('Vector tile source "' + this.source + '" layer "' + k + '" does not use vector tile spec v2 and therefore may have some rendering errors.');
                    for (var D = c.encode(k), O = [], z = 0; z < C.length; z++) {
                        var N = C.feature(z);
                        s.traffic && S.isPbfSeparate && S.separateLayer === k && this.eTag && this.eTag.endsWith("_status") && M(N, I, String(N.properties.linkid));
                        var E = p.getId(N, k);
                        O.push({
                            feature: N,
                            id: E,
                            index: z,
                            sourceLayerIndex: D
                        });
                    }
                    for (var F = 0, J = L[k]; F < J.length; F += 1) {
                        var A = J[F],
                            B = A[0];
                        B.minzoom && this.zoom < Math.floor(B.minzoom) || B.maxzoom && this.zoom >= B.maxzoom || "none" !== B.visibility && (a(A, this.zoom, i), (x[B.id] = B.createBucket({
                            index: p.bucketLayerIDs.length,
                            layers: A,
                            zoom: this.zoom,
                            pixelRatio: this.pixelRatio,
                            overscaling: this.overscaling,
                            collisionBoxArray: this.collisionBoxArray,
                            sourceLayerIndex: D,
                            sourceID: this.source
                        })).populate(O, w, this.tileID.canonical), p.bucketLayerIDs.push(A.map((function (e) {
                            return e.id
                        }))));
                    }
                }
            }
            var Z = e.mapObject(w.glyphDependencies, (function (e) {
                return Object.keys(e).map(Number)
            }));
            Object.keys(Z).length ? o.send("getGlyphs", {
                uid: this.uid,
                stacks: Z
            }, (function (e, t) {
                b || (b = e, T = t, Y.call(h));
            })) : T = {};
            var G = Object.keys(w.iconDependencies);
            G.length ? o.send("getImages", {
                icons: G,
                source: this.source,
                tileID: this.tileID,
                type: "icons"
            }, (function (e, t) {
                b || (b = e, _ = t, Y.call(h));
            })) : _ = {};
            var W = Object.keys(w.patternDependencies);

            function Y() {
                if (b) return u(b);
                if (T && _ && P) {
                    var t = new n(T),
                        r = new e.ImageAtlas(_, P);
                    for (var o in x) {
                        var s = x[o];
                        s instanceof e.SymbolBucket || s instanceof e.SymtrackingBucket ? (a(s.layers, this.zoom, i), e.performSymbolLayout(s, T, t.positions, _, r.iconPositions, this.showCollisionBoxes, this.tileID.canonical)) : s.hasPattern && (s instanceof e.LineBucket || s instanceof e.FillBucket || s instanceof e.FillExtrusionBucket) && (a(s.layers, this.zoom, i), s.addFeatures(w, this.tileID.canonical, r.patternPositions));
                    }
                    this.status = "done", u(null, {
                        buckets: e.values(x).filter((function (e) {
                            return !e.isEmpty()
                        })),
                        featureIndex: p,
                        collisionBoxArray: this.collisionBoxArray,
                        glyphAtlasImage: t.image,
                        imageAtlas: r,
                        glyphMap: this.returnDependencies ? T : null,
                        iconMap: this.returnDependencies ? _ : null,
                        glyphPositions: this.returnDependencies ? t.positions : null
                    });
                }
            }
            W.length ? o.send("getImages", {
                icons: W,
                source: this.source,
                tileID: this.tileID,
                type: "patterns"
            }, (function (e, t) {
                b || (b = e, P = t, Y.call(h));
            })) : P = {}, Y.call(this);
        };
        var l = function (e, t, r, i) {
            this.actor = e, this.layerIndex = t, this.availableImages = r, this.loadVectorData = i || s, this.loading = {}, this.loaded = {};
        };
        l.prototype.loadTile = function (t, r) {
            var i = this,
                n = t.uid;
            this.loading || (this.loading = {});
            var a = !!(t && t.request && t.request.collectResourceTiming) && new e.RequestPerformance(t.request),
                s = this.loading[n] = new o(t),
                l = t.sourceOptions || {},
                u = l.separate || {};
            if (l.traffic && u.isPbfSeparate) {
                var h = this.loaded[n];
                h && h.vectorTile && h.vectorTile.layers ? s.vectorTile = h.vectorTile : t.eTag = "99999999_9999999999999_all";
            }
            s.abort = this.loadVectorData(t, (function (o, h) {
                if (delete i.loading[n], o || !h) return l.traffic && o && 304 === o.status ? void i.reloadTile(t, r) : (s.status = "done", i.loaded[n] = s, r(o));
                var c = h.rawData,
                    p = {};
                h.expires && (p.expires = h.expires), h.cacheControl && (p.cacheControl = h.cacheControl);
                var f = {
                        eTag: h.eTag
                    },
                    d = {};
                if (a) {
                    var g = a.finish();
                    g && (d.resourceTiming = JSON.parse(JSON.stringify(g)));
                }
                l.traffic && u.isPbfSeparate && h.eTag && h.eTag.endsWith("_status") || !h.vectorTile || (s.vectorTile = h.vectorTile), s.parse(s.vectorTile, i.layerIndex, i.availableImages, i.actor, (function (t, i) {
                    if (t || !i) return r(t);
                    r(null, e.extend({
                        rawTileData: c.slice(0)
                    }, i, p, d, f));
                }), c), i.loaded = i.loaded || {}, i.loaded[n] = s;
            }));
        }, l.prototype.reloadTile = function (t, r) {
            var i = this,
                n = this.loaded,
                o = t.uid,
                a = this;
            if (n && n[o]) {
                var s = n[o];
                s.showCollisionBoxes = t.showCollisionBoxes;
                var l = function (t, n) {
                    var o = s.reloadCallback;
                    o && (delete s.reloadCallback, s.parse(s.vectorTile, a.layerIndex, i.availableImages, a.actor, o)), r(t, n ? e.extend(n, {
                        eTag: null
                    }) : n);
                };
                "parsing" === s.status ? s.reloadCallback = l : "done" === s.status && (s.vectorTile ? (s.eTag = null, s.parse(s.vectorTile, this.layerIndex, this.availableImages, this.actor, l)) : l());
            }
        }, l.prototype.abortTile = function (e, t) {
            var r = this.loading,
                i = e.uid;
            r && r[i] && r[i].abort && (r[i].abort(), delete r[i]), t();
        }, l.prototype.removeTile = function (e, t) {
            var r = this.loaded,
                i = e.uid;
            r && r[i] && delete r[i], t();
        };
        var u = e.window.ImageBitmap,
            h = function () {
                this.loaded = {};
            };

        function c(e, t) {
            if (0 !== e.length) {
                p(e[0], t);
                for (var r = 1; r < e.length; r++) p(e[r], !t);
            }
        }

        function p(e, t) {
            for (var r = 0, i = 0, n = e.length, o = n - 1; i < n; o = i++) r += (e[i][0] - e[o][0]) * (e[o][1] + e[i][1]);
            r >= 0 != !!t && e.reverse();
        }
        h.prototype.loadTile = function (t, r) {
            var i = t.uid,
                n = t.encoding,
                o = t.rawImageData,
                a = u && o instanceof u ? this.getImageData(o) : o,
                s = new e.DEMData(i, a, n);
            this.loaded = this.loaded || {}, this.loaded[i] = s, r(null, s);
        }, h.prototype.getImageData = function (t) {
            this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(t.width, t.height), this.offscreenCanvasContext = this.offscreenCanvas.getContext("2d")), this.offscreenCanvas.width = t.width, this.offscreenCanvas.height = t.height, this.offscreenCanvasContext.drawImage(t, 0, 0, t.width, t.height);
            var r = this.offscreenCanvasContext.getImageData(-1, -1, t.width + 2, t.height + 2);
            return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height), new e.RGBAImage({
                width: r.width,
                height: r.height
            }, r.data)
        }, h.prototype.removeTile = function (e) {
            var t = this.loaded,
                r = e.uid;
            t && t[r] && delete t[r];
        };
        var f = e.vectorTile.VectorTileFeature.prototype.toGeoJSON,
            d = function (t) {
                this._feature = t, this.extent = e.EXTENT, this.type = t.type, this.properties = t.tags, "id" in t && !isNaN(t.id) && (this.id = parseInt(t.id, 10));
            };
        d.prototype.loadGeometry = function () {
            if (1 === this._feature.type) {
                for (var t = [], r = 0, i = this._feature.geometry; r < i.length; r += 1) {
                    var n = i[r];
                    t.push([new e.Point$1(n[0], n[1])]);
                }
                return t
            }
            for (var o = [], a = 0, s = this._feature.geometry; a < s.length; a += 1) {
                for (var l = [], u = 0, h = s[a]; u < h.length; u += 1) {
                    var c = h[u];
                    l.push(new e.Point$1(c[0], c[1]));
                }
                o.push(l);
            }
            return o
        }, d.prototype.toGeoJSON = function (e, t, r) {
            return f.call(this, e, t, r)
        };
        var g = function (t) {
            this.layers = {
                _geojsonTileLayer: this
            }, this.name = "_geojsonTileLayer", this.extent = e.EXTENT, this.length = t.length, this._features = t;
        };
        g.prototype.feature = function (e) {
            return new d(this._features[e])
        };
        var v = e.vectorTile.VectorTileFeature,
            m = y;

        function y(e, t) {
            this.options = t || {}, this.features = e, this.length = e.length;
        }

        function x(e, t) {
            this.id = "number" == typeof e.id ? e.id : void 0, this.type = e.type, this.rawGeometry = 1 === e.type ? [e.geometry] : e.geometry, this.properties = e.tags, this.extent = t || 4096;
        }
        y.prototype.feature = function (e) {
            return new x(this.features[e], this.options.extent)
        }, x.prototype.loadGeometry = function () {
            var t = this.rawGeometry;
            this.geometry = [];
            for (var r = 0; r < t.length; r++) {
                for (var i = t[r], n = [], o = 0; o < i.length; o++) n.push(new e.Point$1(i[o][0], i[o][1]));
                this.geometry.push(n);
            }
            return this.geometry
        }, x.prototype.bbox = function () {
            this.geometry || this.loadGeometry();
            for (var e = this.geometry, t = 1 / 0, r = -1 / 0, i = 1 / 0, n = -1 / 0, o = 0; o < e.length; o++)
                for (var a = e[o], s = 0; s < a.length; s++) {
                    var l = a[s];
                    t = Math.min(t, l.x), r = Math.max(r, l.x), i = Math.min(i, l.y), n = Math.max(n, l.y);
                }
            return [t, i, r, n]
        }, x.prototype.toGeoJSON = v.prototype.toGeoJSON;
        var w = M,
            S = m;

        function M(t) {
            var r = new e.pbf;
            return function (e, t) {
                for (var r in e.layers) t.writeMessage(3, I, e.layers[r]);
            }(t, r), r.finish()
        }

        function I(e, t) {
            var r;
            t.writeVarintField(15, e.version || 1), t.writeStringField(1, e.name || ""), t.writeVarintField(5, e.extent || 4096);
            var i = {
                keys: [],
                values: [],
                keycache: {},
                valuecache: {}
            };
            for (r = 0; r < e.length; r++) i.feature = e.feature(r), t.writeMessage(2, b, i);
            var n = i.keys;
            for (r = 0; r < n.length; r++) t.writeStringField(3, n[r]);
            var o = i.values;
            for (r = 0; r < o.length; r++) t.writeMessage(4, k, o[r]);
        }

        function b(e, t) {
            var r = e.feature;
            void 0 !== r.id && t.writeVarintField(1, r.id), t.writeMessage(2, T, e), t.writeVarintField(3, r.type), t.writeMessage(4, L, r);
        }

        function T(e, t) {
            var r = e.feature,
                i = e.keys,
                n = e.values,
                o = e.keycache,
                a = e.valuecache;
            for (var s in r.properties) {
                var l = o[s];
                void 0 === l && (i.push(s), o[s] = l = i.length - 1), t.writeVarint(l);
                var u = r.properties[s],
                    h = typeof u;
                "string" !== h && "boolean" !== h && "number" !== h && (u = JSON.stringify(u));
                var c = h + ":" + u,
                    p = a[c];
                void 0 === p && (n.push(u), a[c] = p = n.length - 1), t.writeVarint(p);
            }
        }

        function _(e, t) {
            return (t << 3) + (7 & e)
        }

        function P(e) {
            return e << 1 ^ e >> 31
        }

        function L(e, t) {
            for (var r = e.loadGeometry(), i = e.type, n = 0, o = 0, a = r.length, s = 0; s < a; s++) {
                var l = r[s],
                    u = 1;
                1 === i && (u = l.length), t.writeVarint(_(1, u));
                for (var h = 3 === i ? l.length - 1 : l.length, c = 0; c < h; c++) {
                    1 === c && 1 !== i && t.writeVarint(_(2, h - 1));
                    var p = l[c].x - n,
                        f = l[c].y - o;
                    t.writeVarint(P(p)), t.writeVarint(P(f)), n += p, o += f;
                }
                3 === i && t.writeVarint(_(7, 1));
            }
        }

        function k(e, t) {
            var r = typeof e;
            "string" === r ? t.writeStringField(1, e) : "boolean" === r ? t.writeBooleanField(7, e) : "number" === r && (e % 1 != 0 ? t.writeDoubleField(3, e) : e < 0 ? t.writeSVarintField(6, e) : t.writeVarintField(5, e));
        }

        function C(e, t, r, i) {
            D(e, r, i), D(t, 2 * r, 2 * i), D(t, 2 * r + 1, 2 * i + 1);
        }

        function D(e, t, r) {
            var i = e[t];
            e[t] = e[r], e[r] = i;
        }

        function O(e, t, r, i) {
            var n = e - r,
                o = t - i;
            return n * n + o * o
        }
        w.fromVectorTileJs = M, w.fromGeojsonVt = function (e, t) {
            t = t || {};
            var r = {};
            for (var i in e) r[i] = new m(e[i].features, t), r[i].name = i, r[i].version = t.version, r[i].extent = t.extent;
            return M({
                layers: r
            })
        }, w.GeoJSONWrapper = S;
        var z = function (e) {
                return e[0]
            },
            N = function (e) {
                return e[1]
            },
            E = function (e, t, r, i, n) {
                void 0 === t && (t = z), void 0 === r && (r = N), void 0 === i && (i = 64), void 0 === n && (n = Float64Array), this.nodeSize = i, this.points = e;
                for (var o = e.length < 65536 ? Uint16Array : Uint32Array, a = this.ids = new o(e.length), s = this.coords = new n(2 * e.length), l = 0; l < e.length; l++) a[l] = l, s[2 * l] = t(e[l]), s[2 * l + 1] = r(e[l]);
                ! function e(t, r, i, n, o, a) {
                    if (!(o - n <= i)) {
                        var s = n + o >> 1;
                        ! function e(t, r, i, n, o, a) {
                            for (; o > n;) {
                                if (o - n > 600) {
                                    var s = o - n + 1,
                                        l = i - n + 1,
                                        u = Math.log(s),
                                        h = .5 * Math.exp(2 * u / 3),
                                        c = .5 * Math.sqrt(u * h * (s - h) / s) * (l - s / 2 < 0 ? -1 : 1);
                                    e(t, r, i, Math.max(n, Math.floor(i - l * h / s + c)), Math.min(o, Math.floor(i + (s - l) * h / s + c)), a);
                                }
                                var p = r[2 * i + a],
                                    f = n,
                                    d = o;
                                for (C(t, r, n, i), r[2 * o + a] > p && C(t, r, n, o); f < d;) {
                                    for (C(t, r, f, d), f++, d--; r[2 * f + a] < p;) f++;
                                    for (; r[2 * d + a] > p;) d--;
                                }
                                r[2 * n + a] === p ? C(t, r, n, d) : C(t, r, ++d, o), d <= i && (n = d + 1), i <= d && (o = d - 1);
                            }
                        }(t, r, s, n, o, a % 2), e(t, r, i, n, s - 1, a + 1), e(t, r, i, s + 1, o, a + 1);
                    }
                }(a, s, i, 0, a.length - 1, 0);
            };
        E.prototype.range = function (e, t, r, i) {
            return function (e, t, r, i, n, o, a) {
                for (var s, l, u = [0, e.length - 1, 0], h = []; u.length;) {
                    var c = u.pop(),
                        p = u.pop(),
                        f = u.pop();
                    if (p - f <= a)
                        for (var d = f; d <= p; d++) l = t[2 * d + 1], (s = t[2 * d]) >= r && s <= n && l >= i && l <= o && h.push(e[d]);
                    else {
                        var g = Math.floor((f + p) / 2);
                        l = t[2 * g + 1], (s = t[2 * g]) >= r && s <= n && l >= i && l <= o && h.push(e[g]);
                        var v = (c + 1) % 2;
                        (0 === c ? r <= s : i <= l) && (u.push(f), u.push(g - 1), u.push(v)), (0 === c ? n >= s : o >= l) && (u.push(g + 1), u.push(p), u.push(v));
                    }
                }
                return h
            }(this.ids, this.coords, e, t, r, i, this.nodeSize)
        }, E.prototype.within = function (e, t, r) {
            return function (e, t, r, i, n, o) {
                for (var a = [0, e.length - 1, 0], s = [], l = n * n; a.length;) {
                    var u = a.pop(),
                        h = a.pop(),
                        c = a.pop();
                    if (h - c <= o)
                        for (var p = c; p <= h; p++) O(t[2 * p], t[2 * p + 1], r, i) <= l && s.push(e[p]);
                    else {
                        var f = Math.floor((c + h) / 2),
                            d = t[2 * f],
                            g = t[2 * f + 1];
                        O(d, g, r, i) <= l && s.push(e[f]);
                        var v = (u + 1) % 2;
                        (0 === u ? r - n <= d : i - n <= g) && (a.push(c), a.push(f - 1), a.push(v)), (0 === u ? r + n >= d : i + n >= g) && (a.push(f + 1), a.push(h), a.push(v));
                    }
                }
                return s
            }(this.ids, this.coords, e, t, r, this.nodeSize)
        };
        var F = {
                minZoom: 0,
                maxZoom: 16,
                radius: 40,
                extent: 512,
                nodeSize: 64,
                log: !1,
                generateId: !1,
                reduce: null,
                map: function (e) {
                    return e
                },
                isLatLon: !1
            },
            J = function (e) {
                this.options = R(Object.create(F), e), this.trees = new Array(this.options.maxZoom + 1);
            };

        function A(e, t, r, i, n) {
            return {
                x: e,
                y: t,
                zoom: 1 / 0,
                id: r,
                parentId: -1,
                numPoints: i,
                properties: n
            }
        }

        function B(e, t, r) {
            var i = e.geometry.coordinates,
                n = i[1];
            return {
                x: W(i[0]),
                y: (r ? j : Y)(n),
                zoom: 1 / 0,
                index: t,
                parentId: -1
            }
        }

        function Z(e, t) {
            return {
                type: "Feature",
                id: e.id,
                properties: G(e),
                geometry: {
                    type: "Point",
                    coordinates: [(r = e.x, 360 * (r - .5)), (t ? X : V)(e.y)]
                }
            };
            var r;
        }

        function G(e) {
            var t = e.numPoints,
                r = t >= 1e4 ? Math.round(t / 1e3) + "k" : t >= 1e3 ? Math.round(t / 100) / 10 + "k" : t;
            return R(R({}, e.properties), {
                cluster: !0,
                cluster_id: e.id,
                point_count: t,
                point_count_abbreviated: r
            })
        }

        function W(e) {
            return e / 360 + .5
        }

        function Y(e) {
            var t = Math.sin(e * Math.PI / 180),
                r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
            return r < 0 ? 0 : r > 1 ? 1 : r
        }

        function j(e) {
            var t = (90 - e) / 360;
            return t < 0 ? 0 : t > 1 ? 1 : t
        }

        function V(e) {
            var t = (180 - 360 * e) * Math.PI / 180;
            return 360 * Math.atan(Math.exp(t)) / Math.PI - 90
        }

        function X(e) {
            return 90 - 360 * e
        }

        function R(e, t) {
            for (var r in t) e[r] = t[r];
            return e
        }

        function q(e) {
            return e.x
        }

        function U(e) {
            return e.y
        }

        function $(e, t, r, i, n, o) {
            var a = n - r,
                s = o - i;
            if (0 !== a || 0 !== s) {
                var l = ((e - r) * a + (t - i) * s) / (a * a + s * s);
                l > 1 ? (r = n, i = o) : l > 0 && (r += a * l, i += s * l);
            }
            return (a = e - r) * a + (s = t - i) * s
        }

        function H(e, t, r, i) {
            var n = {
                id: null == e ? null : e,
                type: t,
                geometry: r,
                tags: i,
                minX: 1 / 0,
                minY: 1 / 0,
                maxX: -1 / 0,
                maxY: -1 / 0
            };
            if ("Point" === t || "MultiPoint" === t || "LineString" === t) K(n, r);
            else if ("Polygon" === t) K(n, r[0]);
            else if ("MultiLineString" === t)
                for (var o = 0, a = r; o < a.length; o += 1) K(n, a[o]);
            else if ("MultiPolygon" === t)
                for (var s = 0, l = r; s < l.length; s += 1) K(n, l[s][0]);
            return n
        }

        function K(e, t) {
            for (var r = 0; r < t.length; r += 3) e.minX = Math.min(e.minX, t[r]), e.minY = Math.min(e.minY, t[r + 1]), e.maxX = Math.max(e.maxX, t[r]), e.maxY = Math.max(e.maxY, t[r + 1]);
        }

        function Q(e, t, r, i) {
            if (t.geometry) {
                var n = t.geometry.coordinates,
                    o = t.geometry.type,
                    a = Math.pow(r.tolerance / ((1 << r.maxZoom) * r.extent), 2),
                    s = [],
                    l = t.id;
                if (r.promoteId ? l = t.properties[r.promoteId] : r.generateId && (l = i || 0), "Point" === o) ee(n, s, r.isLatLon);
                else if ("MultiPoint" === o)
                    for (var u = 0, h = n; u < h.length; u += 1) ee(h[u], s, r.isLatLon);
                else if ("LineString" === o) te(n, s, a, !1, r.isLatLon);
                else if ("MultiLineString" === o) {
                    if (r.lineMetrics) {
                        for (var c = 0, p = n; c < p.length; c += 1) te(p[c], s = [], a, !1, r.isLatLon), e.push(H(l, "LineString", s, t.properties));
                        return
                    }
                    re(n, s, a, !1, r.isLatLon);
                } else if ("Polygon" === o) re(n, s, a, !0, r.isLatLon);
                else {
                    if ("MultiPolygon" !== o) {
                        if ("GeometryCollection" === o) {
                            for (var f = 0, d = t.geometry.geometries; f < d.length; f += 1) Q(e, {
                                id: l,
                                geometry: d[f],
                                properties: t.properties
                            }, r, i);
                            return
                        }
                        throw new Error("Input data is not a valid GeoJSON object.")
                    }
                    for (var g = 0, v = n; g < v.length; g += 1) {
                        var m = [];
                        re(v[g], m, a, !0, r.isLatLon), s.push(m);
                    }
                }
                e.push(H(l, o, s, t.properties));
            }
        }

        function ee(e, t, r) {
            t.push(ie(e[0]), (r ? oe : ne)(e[1]), 0);
        }

        function te(e, t, r, i, n) {
            for (var o, a, s = 0, l = 0; l < e.length; l++) {
                var u = ie(e[l][0]),
                    h = (n ? oe : ne)(e[l][1]);
                t.push(u, h, 0), l > 0 && (s += i ? (o * h - u * a) / 2 : Math.sqrt(Math.pow(u - o, 2) + Math.pow(h - a, 2))), o = u, a = h;
            }
            var c = t.length - 3;
            t[2] = 1,
                function e(t, r, i, n) {
                    for (var o, a = n, s = i - r >> 1, l = i - r, u = t[r], h = t[r + 1], c = t[i], p = t[i + 1], f = r + 3; f < i; f += 3) {
                        var d = $(t[f], t[f + 1], u, h, c, p);
                        if (d > a) o = f, a = d;
                        else if (d === a) {
                            var g = Math.abs(f - s);
                            g < l && (o = f, l = g);
                        }
                    }
                    a > n && (o - r > 3 && e(t, r, o, n), t[o + 2] = a, i - o > 3 && e(t, o, i, n));
                }(t, 0, c, r), t[c + 2] = 1, t.size = Math.abs(s), t.start = 0, t.end = t.size;
        }

        function re(e, t, r, i, n) {
            for (var o = 0; o < e.length; o++) {
                var a = [];
                te(e[o], a, r, i, n), t.push(a);
            }
        }

        function ie(e) {
            return e / 360 + .5
        }

        function ne(e) {
            var t = Math.sin(e * Math.PI / 180),
                r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
            return r < 0 ? 0 : r > 1 ? 1 : r
        }

        function oe(e) {
            e = 180 - 360 * (e = (90 - e) / .7031250001548544) / 256 / 2, e = 360 / Math.PI * Math.atan(Math.exp(e * Math.PI / 180)) - 90;
            var t = Math.sin(e * Math.PI / 180),
                r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;
            return r < 0 ? 0 : r > 1 ? 1 : r
        }

        function ae(e, t, r, i, n, o, a, s) {
            if (i /= t, o >= (r /= t) && a < i) return e;
            if (a < r || o >= i) return null;
            for (var l = [], u = 0, h = e; u < h.length; u += 1) {
                var c = h[u],
                    p = c.geometry,
                    f = c.type,
                    d = 0 === n ? c.minX : c.minY,
                    g = 0 === n ? c.maxX : c.maxY;
                if (d >= r && g < i) l.push(c);
                else if (!(g < r || d >= i)) {
                    var v = [];
                    if ("Point" === f || "MultiPoint" === f) se(p, v, r, i, n);
                    else if ("LineString" === f) le(p, v, r, i, n, !1, s.lineMetrics);
                    else if ("MultiLineString" === f) he(p, v, r, i, n, !1);
                    else if ("Polygon" === f) he(p, v, r, i, n, !0);
                    else if ("MultiPolygon" === f)
                        for (var m = 0, y = p; m < y.length; m += 1) {
                            var x = [];
                            he(y[m], x, r, i, n, !0), x.length && v.push(x);
                        }
                    if (v.length) {
                        if (s.lineMetrics && "LineString" === f) {
                            for (var w = 0, S = v; w < S.length; w += 1) l.push(H(c.id, f, S[w], c.tags));
                            continue
                        }
                        "LineString" !== f && "MultiLineString" !== f || (1 === v.length ? (f = "LineString", v = v[0]) : f = "MultiLineString"), "Point" !== f && "MultiPoint" !== f || (f = 3 === v.length ? "Point" : "MultiPoint"), l.push(H(c.id, f, v, c.tags));
                    }
                }
            }
            return l.length ? l : null
        }

        function se(e, t, r, i, n) {
            for (var o = 0; o < e.length; o += 3) {
                var a = e[o + n];
                a >= r && a <= i && ce(t, e[o], e[o + 1], e[o + 2]);
            }
        }

        function le(e, t, r, i, n, o, a) {
            for (var s, l, u = ue(e), h = 0 === n ? pe : fe, c = e.start, p = 0; p < e.length - 3; p += 3) {
                var f = e[p],
                    d = e[p + 1],
                    g = e[p + 2],
                    v = e[p + 3],
                    m = e[p + 4],
                    y = 0 === n ? f : d,
                    x = 0 === n ? v : m,
                    w = !1;
                a && (s = Math.sqrt(Math.pow(f - v, 2) + Math.pow(d - m, 2))), y < r ? x > r && (l = h(u, f, d, v, m, r), a && (u.start = c + s * l)) : y > i ? x < i && (l = h(u, f, d, v, m, i), a && (u.start = c + s * l)) : ce(u, f, d, g), x < r && y >= r && (l = h(u, f, d, v, m, r), w = !0), x > i && y <= i && (l = h(u, f, d, v, m, i), w = !0), !o && w && (a && (u.end = c + s * l), t.push(u), u = ue(e)), a && (c += s);
            }
            var S = e.length - 3,
                M = e[S],
                I = e[S + 1],
                b = 0 === n ? M : I;
            b >= r && b <= i && ce(u, M, I, e[S + 2]), S = u.length - 3, o && S >= 3 && (u[S] !== u[0] || u[S + 1] !== u[1]) && ce(u, u[0], u[1], u[2]), u.length && t.push(u);
        }

        function ue(e) {
            var t = [];
            return t.size = e.size, t.start = e.start, t.end = e.end, t
        }

        function he(e, t, r, i, n, o) {
            for (var a = 0, s = e; a < s.length; a += 1) le(s[a], t, r, i, n, o, !1);
        }

        function ce(e, t, r, i) {
            e.push(t, r, i);
        }

        function pe(e, t, r, i, n, o) {
            var a = (o - t) / (i - t);
            return ce(e, o, r + (n - r) * a, 1), a
        }

        function fe(e, t, r, i, n, o) {
            var a = (o - r) / (n - r);
            return ce(e, t + (i - t) * a, o, 1), a
        }

        function de(e, t) {
            for (var r = [], i = 0; i < e.length; i++) {
                var n = e[i],
                    o = n.type,
                    a = void 0;
                if ("Point" === o || "MultiPoint" === o || "LineString" === o) a = ge(n.geometry, t);
                else if ("MultiLineString" === o || "Polygon" === o) {
                    a = [];
                    for (var s = 0, l = n.geometry; s < l.length; s += 1) a.push(ge(l[s], t));
                } else if ("MultiPolygon" === o) {
                    a = [];
                    for (var u = 0, h = n.geometry; u < h.length; u += 1) {
                        for (var c = [], p = 0, f = h[u]; p < f.length; p += 1) c.push(ge(f[p], t));
                        a.push(c);
                    }
                }
                r.push(H(n.id, o, a, n.tags));
            }
            return r
        }

        function ge(e, t) {
            var r = [];
            r.size = e.size, void 0 !== e.start && (r.start = e.start, r.end = e.end);
            for (var i = 0; i < e.length; i += 3) r.push(e[i] + t, e[i + 1], e[i + 2]);
            return r
        }

        function ve(e, t) {
            if (e.transformed) return e;
            for (var r = 1 << e.z, i = e.x, n = e.y, o = 0, a = e.features; o < a.length; o += 1) {
                var s = a[o],
                    l = s.geometry,
                    u = s.type;
                if (s.geometry = [], 1 === u)
                    for (var h = 0; h < l.length; h += 2) s.geometry.push(me(l[h], l[h + 1], t, r, i, n));
                else
                    for (var c = 0; c < l.length; c++) {
                        for (var p = [], f = 0; f < l[c].length; f += 2) p.push(me(l[c][f], l[c][f + 1], t, r, i, n));
                        s.geometry.push(p);
                    }
            }
            return e.transformed = !0, e
        }

        function me(e, t, r, i, n, o) {
            return [Math.round(r * (e * i - n)), Math.round(r * (t * i - o))]
        }

        function ye(e, t, r, i, n) {
            for (var o = t === n.maxZoom ? 0 : n.tolerance / ((1 << t) * n.extent), a = {
                    features: [],
                    numPoints: 0,
                    numSimplified: 0,
                    numFeatures: e.length,
                    source: null,
                    x: r,
                    y: i,
                    z: t,
                    transformed: !1,
                    minX: 2,
                    minY: 1,
                    maxX: -1,
                    maxY: 0
                }, s = 0, l = e; s < l.length; s += 1) xe(a, l[s], o, n);
            return a
        }

        function xe(e, t, r, i) {
            var n = t.geometry,
                o = t.type,
                a = [];
            if (e.minX = Math.min(e.minX, t.minX), e.minY = Math.min(e.minY, t.minY), e.maxX = Math.max(e.maxX, t.maxX), e.maxY = Math.max(e.maxY, t.maxY), "Point" === o || "MultiPoint" === o)
                for (var s = 0; s < n.length; s += 3) a.push(n[s], n[s + 1]), e.numPoints++, e.numSimplified++;
            else if ("LineString" === o) we(a, n, e, r, !1, !1);
            else if ("MultiLineString" === o || "Polygon" === o)
                for (var l = 0; l < n.length; l++) we(a, n[l], e, r, "Polygon" === o, 0 === l);
            else if ("MultiPolygon" === o)
                for (var u = 0; u < n.length; u++)
                    for (var h = n[u], c = 0; c < h.length; c++) we(a, h[c], e, r, !0, 0 === c);
            if (a.length) {
                var p = t.tags || null;
                if ("LineString" === o && i.lineMetrics) {
                    for (var f in p = {}, t.tags) p[f] = t.tags[f];
                    p.minemap_clip_start = n.start / n.size, p.minemap_clip_end = n.end / n.size;
                }
                var d = {
                    geometry: a,
                    type: "Polygon" === o || "MultiPolygon" === o ? 3 : "LineString" === o || "MultiLineString" === o ? 2 : 1,
                    tags: p
                };
                null !== t.id && (d.id = t.id), e.features.push(d);
            }
        }

        function we(e, t, r, i, n, o) {
            var a = i * i;
            if (i > 0 && t.size < (n ? a : i)) r.numPoints += t.length / 3;
            else {
                for (var s = [], l = 0; l < t.length; l += 3)(0 === i || t[l + 2] > a) && (r.numSimplified++, s.push(t[l], t[l + 1])), r.numPoints++;
                n && function (e, t) {
                    for (var r = 0, i = 0, n = e.length, o = n - 2; i < n; o = i, i += 2) r += (e[i] - e[o]) * (e[i + 1] + e[o + 1]);
                    if (r > 0 === t)
                        for (var a = 0, s = e.length; a < s / 2; a += 2) {
                            var l = e[a],
                                u = e[a + 1];
                            e[a] = e[s - 2 - a], e[a + 1] = e[s - 1 - a], e[s - 2 - a] = l, e[s - 1 - a] = u;
                        }
                }(s, o), e.push(s);
            }
        }
        J.prototype.load = function (e) {
            var t = this.options,
                r = t.log,
                i = t.minZoom,
                n = t.maxZoom,
                o = t.nodeSize;
            r && console.time("total time");
            var a = "prepare " + e.length + " points";
            r && console.time(a), this.points = e;
            for (var s = [], l = 0; l < e.length; l++) e[l].geometry && s.push(B(e[l], l, this.options.isLatLon));
            this.trees[n + 1] = new E(s, q, U, o, Float32Array), r && console.timeEnd(a);
            for (var u = n; u >= i; u--) {
                var h = +Date.now();
                s = this._cluster(s, u), this.trees[u] = new E(s, q, U, o, Float32Array), r && console.log("z%d: %d clusters in %dms", u, s.length, +Date.now() - h);
            }
            return r && console.timeEnd("total time"), this
        }, J.prototype.getClusters = function (e, t) {
            var r = ((e[0] + 180) % 360 + 360) % 360 - 180,
                i = Math.max(-90, Math.min(90, e[1])),
                n = 180 === e[2] ? 180 : ((e[2] + 180) % 360 + 360) % 360 - 180,
                o = Math.max(-90, Math.min(90, e[3]));
            if (e[2] - e[0] >= 360) r = -180, n = 180;
            else if (r > n) {
                var a = this.getClusters([r, i, 180, o], t),
                    s = this.getClusters([-180, i, n, o], t);
                return a.concat(s)
            }
            for (var l = this.trees[this._limitZoom(t)], u = [], h = 0, c = l.range(W(r), (this.options.isLatLon ? j : Y)(o), W(n), (this.options.isLatLon ? j : Y)(i)); h < c.length; h += 1) {
                var p = l.points[c[h]];
                u.push(p.numPoints ? Z(p, this.options.isLatLon) : this.points[p.index]);
            }
            return u
        }, J.prototype.getChildren = function (e) {
            var t = this._getOriginId(e),
                r = this._getOriginZoom(e),
                i = "No cluster with the specified id.",
                n = this.trees[r];
            if (!n) throw new Error(i);
            var o = n.points[t];
            if (!o) throw new Error(i);
            for (var a = this.options.radius / (this.options.extent * Math.pow(2, r - 1)), s = [], l = 0, u = n.within(o.x, o.y, a); l < u.length; l += 1) {
                var h = n.points[u[l]];
                h.parentId === e && s.push(h.numPoints ? Z(h, this.options.isLatLon) : this.points[h.index]);
            }
            if (0 === s.length) throw new Error(i);
            return s
        }, J.prototype.getLeaves = function (e, t, r) {
            var i = [];
            return this._appendLeaves(i, e, t = t || 10, r = r || 0, 0), i
        }, J.prototype.getTile = function (e, t, r) {
            var i = this.trees[this._limitZoom(e)],
                n = Math.pow(2, e),
                o = this.options,
                a = o.radius / o.extent,
                s = (r - a) / n,
                l = (r + 1 + a) / n,
                u = {
                    features: []
                };
            return this._addTileFeatures(i.range((t - a) / n, s, (t + 1 + a) / n, l), i.points, t, r, n, u), 0 === t && this._addTileFeatures(i.range(1 - a / n, s, 1, l), i.points, n, r, n, u), t === n - 1 && this._addTileFeatures(i.range(0, s, a / n, l), i.points, -1, r, n, u), u.features.length ? u : null
        }, J.prototype.getClusterExpansionZoom = function (e) {
            for (var t = this._getOriginZoom(e) - 1; t <= this.options.maxZoom;) {
                var r = this.getChildren(e);
                if (t++, 1 !== r.length) break;
                e = r[0].properties.cluster_id;
            }
            return t
        }, J.prototype._appendLeaves = function (e, t, r, i, n) {
            for (var o = 0, a = this.getChildren(t); o < a.length; o += 1) {
                var s = a[o],
                    l = s.properties;
                if (l && l.cluster ? n + l.point_count <= i ? n += l.point_count : n = this._appendLeaves(e, l.cluster_id, r, i, n) : n < i ? n++ : e.push(s), e.length === r) break
            }
            return n
        }, J.prototype._addTileFeatures = function (e, t, r, i, n, o) {
            for (var a = 0, s = e; a < s.length; a += 1) {
                var l = t[s[a]],
                    u = l.numPoints,
                    h = {
                        type: 1,
                        geometry: [
                            [Math.round(this.options.extent * (l.x * n - r)), Math.round(this.options.extent * (l.y * n - i))]
                        ],
                        tags: u ? G(l) : this.points[l.index].properties
                    },
                    c = void 0;
                u ? c = l.id : this.options.generateId ? c = l.index : this.points[l.index].id && (c = this.points[l.index].id), void 0 !== c && (h.id = c), o.features.push(h);
            }
        }, J.prototype._limitZoom = function (e) {
            return Math.max(this.options.minZoom, Math.min(e, this.options.maxZoom + 1))
        }, J.prototype._cluster = function (e, t) {
            for (var r = [], i = this.options, n = i.reduce, o = i.radius / (i.extent * Math.pow(2, t)), a = 0; a < e.length; a++) {
                var s = e[a];
                if (!(s.zoom <= t)) {
                    s.zoom = t;
                    for (var l = this.trees[t + 1], u = l.within(s.x, s.y, o), h = s.numPoints || 1, c = s.x * h, p = s.y * h, f = n && h > 1 ? this._map(s, !0) : null, d = (a << 5) + (t + 1) + this.points.length, g = 0, v = u; g < v.length; g += 1) {
                        var m = l.points[v[g]];
                        if (!(m.zoom <= t)) {
                            m.zoom = t;
                            var y = m.numPoints || 1;
                            c += m.x * y, p += m.y * y, h += y, m.parentId = d, n && (f || (f = this._map(s, !0)), n(f, this._map(m)));
                        }
                    }
                    1 === h ? r.push(s) : (s.parentId = d, r.push(A(c / h, p / h, d, h, f)));
                }
            }
            return r
        }, J.prototype._getOriginId = function (e) {
            return e - this.points.length >> 5
        }, J.prototype._getOriginZoom = function (e) {
            return (e - this.points.length) % 32
        }, J.prototype._map = function (e, t) {
            if (e.numPoints) return t ? R({}, e.properties) : e.properties;
            var r = this.points[e.index].properties,
                i = this.options.map(r);
            return t && i === r ? R({}, i) : i
        };
        var Se = {
                maxZoom: 14,
                indexMaxZoom: 5,
                indexMaxPoints: 1e5,
                tolerance: 3,
                extent: 4096,
                buffer: 64,
                lineMetrics: !1,
                promoteId: null,
                generateId: !1,
                debug: 0
            },
            Me = function (e, t) {
                var r = (t = this.options = function (e, t) {
                    for (var r in t) e[r] = t[r];
                    return e
                }(Object.create(Se), t)).debug;
                if (r && console.time("preprocess data"), t.maxZoom < 0 || t.maxZoom > 24) throw new Error("maxZoom should be in the 0-24 range");
                if (t.promoteId && t.generateId) throw new Error("promoteId and generateId cannot be used together.");
                var i = function (e, t) {
                    var r = [];
                    if ("FeatureCollection" === e.type)
                        for (var i = 0; i < e.features.length; i++) Q(r, e.features[i], t, i);
                    else Q(r, "Feature" === e.type ? e : {
                        geometry: e
                    }, t);
                    return r
                }(e, t);
                this.tiles = {}, this.tileCoords = [], r && (console.timeEnd("preprocess data"), console.log("index: maxZoom: %d, maxPoints: %d", t.indexMaxZoom, t.indexMaxPoints), console.time("generate tiles"), this.stats = {}, this.total = 0), (i = function (e, t) {
                    var r = t.buffer / t.extent,
                        i = e,
                        n = ae(e, 1, -1 - r, r, 0, -1, 2, t),
                        o = ae(e, 1, 1 - r, 2 + r, 0, -1, 2, t);
                    return (n || o) && (i = ae(e, 1, -r, 1 + r, 0, -1, 2, t) || [], n && (i = de(n, 1).concat(i)), o && (i = i.concat(de(o, -1)))), i
                }(i, t)).length && this.splitTile(i, 0, 0, 0), r && (i.length && console.log("features: %d, points: %d", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd("generate tiles"), console.log("tiles generated:", this.total, JSON.stringify(this.stats)));
            };

        function Ie(e, t, r) {
            return 32 * ((1 << e) * r + t) + e
        }

        function be(e, t) {
            var r = e.tileID.canonical;
            if (!this._geoJSONIndex) return t(null, null);
            var i = this._geoJSONIndex.getTile(r.z, r.x, r.y);
            if (!i) return t(null, null);
            var n = new g(i.features),
                o = w(n);
            0 === o.byteOffset && o.byteLength === o.buffer.byteLength || (o = new Uint8Array(o)), t(null, {
                vectorTile: n,
                rawData: o.buffer
            });
        }
        Me.prototype.splitTile = function (e, t, r, i, n, o, a) {
            for (var s = [e, t, r, i], l = this.options, u = l.debug; s.length;) {
                i = s.pop(), r = s.pop(), t = s.pop(), e = s.pop();
                var h = 1 << t,
                    c = Ie(t, r, i),
                    p = this.tiles[c];
                if (!p && (u > 1 && console.time("creation"), p = this.tiles[c] = ye(e, t, r, i, l), this.tileCoords.push({
                        z: t,
                        x: r,
                        y: i
                    }), u)) {
                    u > 1 && (console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)", t, r, i, p.numFeatures, p.numPoints, p.numSimplified), console.timeEnd("creation"));
                    var f = "z" + t;
                    this.stats[f] = (this.stats[f] || 0) + 1, this.total++;
                }
                if (p.source = e, null == n) {
                    if (t === l.indexMaxZoom || p.numPoints <= l.indexMaxPoints) continue
                } else {
                    if (t === l.maxZoom || t === n) continue;
                    if (null != n) {
                        var d = n - t;
                        if (r !== o >> d || i !== a >> d) continue
                    }
                }
                if (p.source = null, 0 !== e.length) {
                    u > 1 && console.time("clipping");
                    var g = .5 * l.buffer / l.extent,
                        v = .5 - g,
                        m = .5 + g,
                        y = 1 + g,
                        x = null,
                        w = null,
                        S = null,
                        M = null,
                        I = ae(e, h, r - g, r + m, 0, p.minX, p.maxX, l),
                        b = ae(e, h, r + v, r + y, 0, p.minX, p.maxX, l);
                    e = null, I && (x = ae(I, h, i - g, i + m, 1, p.minY, p.maxY, l), w = ae(I, h, i + v, i + y, 1, p.minY, p.maxY, l), I = null), b && (S = ae(b, h, i - g, i + m, 1, p.minY, p.maxY, l), M = ae(b, h, i + v, i + y, 1, p.minY, p.maxY, l), b = null), u > 1 && console.timeEnd("clipping"), s.push(x || [], t + 1, 2 * r, 2 * i), s.push(w || [], t + 1, 2 * r, 2 * i + 1), s.push(S || [], t + 1, 2 * r + 1, 2 * i), s.push(M || [], t + 1, 2 * r + 1, 2 * i + 1);
                }
            }
        }, Me.prototype.getTile = function (e, t, r) {
            var i = this.options,
                n = i.extent,
                o = i.debug;
            if ((e = +e) < 0 || e > 24) return null;
            var a = 1 << e,
                s = Ie(e, t = (t = +t) + a & a - 1, r = +r);
            if (this.tiles[s]) return ve(this.tiles[s], n);
            o > 1 && console.log("drilling down to z%d-%d-%d", e, t, r);
            for (var l, u = e, h = t, c = r; !l && u > 0;) u--, l = this.tiles[Ie(u, h >>= 1, c >>= 1)];
            return l && l.source ? (o > 1 && (console.log("found parent tile z%d-%d-%d", u, h, c), console.time("drilling down")), this.splitTile(l.source, u, h, c, e, t, r), o > 1 && console.timeEnd("drilling down"), this.tiles[s] ? ve(this.tiles[s], n) : null) : null
        };
        var Te = function (t) {
                function r(e, r, i, n) {
                    t.call(this, e, r, i, be), n && (this.loadGeoJSON = n);
                }
                return t && (r.__proto__ = t), (r.prototype = Object.create(t && t.prototype)).constructor = r, r.prototype.loadData = function (e, t) {
                    this._pendingCallback && this._pendingCallback(null, {
                        abandoned: !0
                    }), this._pendingCallback = t, this._pendingLoadDataParams = e, this._state && "Idle" !== this._state ? this._state = "NeedsLoadData" : (this._state = "Coalescing", this._loadData());
                }, r.prototype._loadData = function () {
                    var t = this;
                    if (this._pendingCallback && this._pendingLoadDataParams) {
                        var r = this._pendingCallback,
                            i = this._pendingLoadDataParams;
                        delete this._pendingCallback, delete this._pendingLoadDataParams;
                        var n = !!(i && i.request && i.request.collectResourceTiming) && new e.RequestPerformance(i.request);
                        this.loadGeoJSON(i, (function (o, a) {
                            if (o || !a) return r(o);
                            if ("object" != typeof a) return r(new Error("Input data given to '" + i.source + "' is not a valid GeoJSON object."));
                            ! function e(t, r) {
                                var i, n = t && t.type;
                                if ("FeatureCollection" === n)
                                    for (i = 0; i < t.features.length; i++) e(t.features[i], r);
                                else if ("GeometryCollection" === n)
                                    for (i = 0; i < t.geometries.length; i++) e(t.geometries[i], r);
                                else if ("Feature" === n) e(t.geometry, r);
                                else if ("Polygon" === n) c(t.coordinates, r);
                                else if ("MultiPolygon" === n)
                                    for (i = 0; i < t.coordinates.length; i++) c(t.coordinates[i], r);
                                return t
                            }(a, !0);
                            try {
                                t._geoJSONIndex = i.cluster ? new J(function (t) {
                                    var r = t.superclusterOptions,
                                        i = t.clusterProperties;
                                    if (!i || !r) return r;
                                    for (var n = {}, o = {}, a = {
                                            accumulated: null,
                                            zoom: 0
                                        }, s = {
                                            properties: null
                                        }, l = Object.keys(i), u = 0, h = l; u < h.length; u += 1) {
                                        var c = h[u],
                                            p = i[c],
                                            f = p[0],
                                            d = e.createExpression(p[1]),
                                            g = e.createExpression("string" == typeof f ? [f, ["accumulated"],
                                                ["get", c]
                                            ] : f);
                                        n[c] = d.value, o[c] = g.value;
                                    }
                                    return r.map = function (e) {
                                        s.properties = e;
                                        for (var t = {}, r = 0, i = l; r < i.length; r += 1) {
                                            var o = i[r];
                                            t[o] = n[o].evaluate(a, s);
                                        }
                                        return t
                                    }, r.reduce = function (e, t) {
                                        s.properties = t;
                                        for (var r = 0, i = l; r < i.length; r += 1) {
                                            var n = i[r];
                                            a.accumulated = e[n], e[n] = o[n].evaluate(a, s);
                                        }
                                    }, r
                                }(i)).load(a.features) : function (e, t) {
                                    return new Me(e, t)
                                }(a, i.geojsonVtOptions);
                            } catch (o) {
                                return r(o)
                            }
                            t.loaded = {};
                            var s = {};
                            if (n) {
                                var l = n.finish();
                                l && (s.resourceTiming = {}, s.resourceTiming[i.source] = JSON.parse(JSON.stringify(l)));
                            }
                            r(null, s);
                        }));
                    }
                }, r.prototype.coalesce = function () {
                    "Coalescing" === this._state ? this._state = "Idle" : "NeedsLoadData" === this._state && (this._state = "Coalescing", this._loadData());
                }, r.prototype.reloadTile = function (e, r) {
                    var i = this.loaded;
                    return i && i[e.uid] ? t.prototype.reloadTile.call(this, e, r) : this.loadTile(e, r)
                }, r.prototype.loadGeoJSON = function (t, r) {
                    if (t.request) e.getJSON(t.request, r);
                    else {
                        if ("string" != typeof t.data) return r(new Error("Input data given to '" + t.source + "' is not a valid GeoJSON object."));
                        try {
                            return r(null, JSON.parse(t.data))
                        } catch (e) {
                            return r(new Error("Input data given to '" + t.source + "' is not a valid GeoJSON object."))
                        }
                    }
                }, r.prototype.removeSource = function (e, t) {
                    this._pendingCallback && this._pendingCallback(null, {
                        abandoned: !0
                    }), t();
                }, r.prototype.getClusterExpansionZoom = function (e, t) {
                    try {
                        t(null, this._geoJSONIndex.getClusterExpansionZoom(e.clusterId));
                    } catch (e) {
                        t(e);
                    }
                }, r.prototype.getClusterChildren = function (e, t) {
                    try {
                        t(null, this._geoJSONIndex.getChildren(e.clusterId));
                    } catch (e) {
                        t(e);
                    }
                }, r.prototype.getClusterLeaves = function (e, t) {
                    try {
                        t(null, this._geoJSONIndex.getLeaves(e.clusterId, e.limit, e.offset));
                    } catch (e) {
                        t(e);
                    }
                }, r
            }(l),
            _e = function (t) {
                var r = this;
                this.self = t, this.actor = new e.Actor(t, this), this.layerIndexes = {}, this.availableImages = {}, this.workerSourceTypes = {
                    vector: l,
                    geojson: Te
                }, this.workerSources = {}, this.demWorkerSources = {}, this.self.registerWorkerSource = function (e, t) {
                    if (r.workerSourceTypes[e]) throw new Error('Worker source with name "' + e + '" already registered.');
                    r.workerSourceTypes[e] = t;
                }, this.self.registerRTLTextPlugin = function (t) {
                    if (e.plugin.isParsed()) throw new Error("RTL text plugin already registered.");
                    e.plugin.applyArabicShaping = t.applyArabicShaping, e.plugin.processBidirectionalText = t.processBidirectionalText, e.plugin.processStyledBidirectionalText = t.processStyledBidirectionalText;
                };
            };
        return _e.prototype.setReferrer = function (e, t) {
            this.referrer = t;
        }, _e.prototype.setImages = function (e, t, r) {
            this.availableImages[e] = t, r();
        }, _e.prototype.setLayers = function (e, t, r) {
            this.getLayerIndex(e).replace(t), r();
        }, _e.prototype.updateLayers = function (e, t, r) {
            this.getLayerIndex(e).update(t.layers, t.removedIds), r();
        }, _e.prototype.loadTile = function (e, t, r) {
            this.getWorkerSource(e, t.type, t.source).loadTile(t, r);
        }, _e.prototype.loadDEMTile = function (e, t, r) {
            this.getDEMWorkerSource(e, t.source).loadTile(t, r);
        }, _e.prototype.reloadTile = function (e, t, r) {
            this.getWorkerSource(e, t.type, t.source).reloadTile(t, r);
        }, _e.prototype.abortTile = function (e, t, r) {
            this.getWorkerSource(e, t.type, t.source).abortTile(t, r);
        }, _e.prototype.removeTile = function (e, t, r) {
            this.getWorkerSource(e, t.type, t.source).removeTile(t, r);
        }, _e.prototype.removeDEMTile = function (e, t) {
            this.getDEMWorkerSource(e, t.source).removeTile(t);
        }, _e.prototype.removeSource = function (e, t, r) {
            if (this.workerSources[e] && this.workerSources[e][t.type] && this.workerSources[e][t.type][t.source]) {
                var i = this.workerSources[e][t.type][t.source];
                delete this.workerSources[e][t.type][t.source], void 0 !== i.removeSource ? i.removeSource(t, r) : r();
            }
        }, _e.prototype.loadWorkerSource = function (e, t, r) {
            try {
                this.self.importScripts(t.url), r();
            } catch (e) {
                r(e.toString());
            }
        }, _e.prototype.syncRTLPluginState = function (t, r, i) {
            try {
                e.plugin.setState(r);
                var n = e.plugin.getPluginURL();
                if (e.plugin.isLoaded() && !e.plugin.isParsed() && null != n) {
                    this.self.importScripts(n);
                    var o = e.plugin.isParsed();
                    i(o ? void 0 : new Error("RTL Text Plugin failed to import scripts from " + n), o);
                }
            } catch (e) {
                i(e.toString());
            }
        }, _e.prototype.getAvailableImages = function (e) {
            var t = this.availableImages[e];
            return t || (t = []), t
        }, _e.prototype.getLayerIndex = function (e) {
            var t = this.layerIndexes[e];
            return t || (t = this.layerIndexes[e] = new i), t
        }, _e.prototype.getWorkerSource = function (e, t, r) {
            var i = this;
            return this.workerSources[e] || (this.workerSources[e] = {}), this.workerSources[e][t] || (this.workerSources[e][t] = {}), this.workerSources[e][t][r] || (this.workerSources[e][t][r] = new this.workerSourceTypes[t]({
                send: function (t, r, n) {
                    i.actor.send(t, r, n, e);
                }
            }, this.getLayerIndex(e), this.getAvailableImages(e))), this.workerSources[e][t][r]
        }, _e.prototype.getDEMWorkerSource = function (e, t) {
            return this.demWorkerSources[e] || (this.demWorkerSources[e] = {}), this.demWorkerSources[e][t] || (this.demWorkerSources[e][t] = new h), this.demWorkerSources[e][t]
        }, _e.prototype.enforceCacheSizeLimit = function (t, r) {
            e.enforceCacheSizeLimit(r);
        }, "undefined" != typeof WorkerGlobalScope && void 0 !== e.window && e.window instanceof WorkerGlobalScope && (e.window.worker = new _e(e.window)), _e
    }));

    define(["./shared"], (function (t) {
        "use strict";
        var e = t.createCommonjsModule((function (t) {
                function e(t) {
                    return !i(t)
                }

                function i(t) {
                    return "undefined" == typeof window || "undefined" == typeof document ? "not a browser" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? "JSON" in window && "parse" in JSON && "stringify" in JSON ? function () {
                        if (!("Worker" in window && "Blob" in window && "URL" in window)) return !1;
                        var t, e, i = new Blob([""], {
                                type: "text/javascript"
                            }),
                            o = URL.createObjectURL(i);
                        try {
                            e = new Worker(o), t = !0;
                        } catch (e) {
                            t = !1;
                        }
                        return e && e.terminate(), URL.revokeObjectURL(o), t
                    }() ? "Uint8ClampedArray" in window ? ArrayBuffer.isView ? function () {
                        var t = document.createElement("canvas");
                        t.width = t.height = 1;
                        var e = t.getContext("2d");
                        if (!e) return !1;
                        var i = e.getImageData(0, 0, 1, 1);
                        return i && i.width === t.width
                    }() ? (void 0 === o[i = t && t.failIfMajorPerformanceCaveat] && (o[i] = function (t) {
                        var i = function (t) {
                            var i = document.createElement("canvas"),
                                o = Object.create(e.webGLContextAttributes);
                            return o.failIfMajorPerformanceCaveat = t, i.probablySupportsContext ? i.probablySupportsContext("webgl", o) || i.probablySupportsContext("experimental-webgl", o) : i.supportsContext ? i.supportsContext("webgl", o) || i.supportsContext("experimental-webgl", o) : i.getContext("webgl", o) || i.getContext("experimental-webgl", o)
                        }(t);
                        if (!i) return !1;
                        var o = i.createShader(i.VERTEX_SHADER);
                        return !(!o || i.isContextLost()) && (i.shaderSource(o, "void main() {}"), i.compileShader(o), !0 === i.getShaderParameter(o, i.COMPILE_STATUS))
                    }(i)), o[i] ? void 0 : "insufficient WebGL support") : "insufficient Canvas/getImageData support" : "insufficient ArrayBuffer support" : "insufficient Uint8ClampedArray support" : "insufficient worker support" : "insufficient JSON support" : "insufficient Object support" : "insufficient Function support" : "insufficent Array support";
                    var i;
                }
                t.exports ? t.exports = e : window && (window.minemap = window.minemap || {}, window.minemap.supported = e, window.minemap.notSupportedReason = i);
                var o = {};
                e.webGLContextAttributes = {
                    antialias: !1,
                    alpha: !0,
                    stencil: !0,
                    depth: !0
                };
            })),
            i = {
                create: function (e, i, o) {
                    var a = t.window.document.createElement(e);
                    return void 0 !== i && (a.className = i), o && o.appendChild(a), a
                },
                createNS: function (e, i) {
                    return t.window.document.createElementNS(e, i)
                }
            },
            o = t.window.document.documentElement.style;

        function a(t) {
            if (!o) return t[0];
            for (var e = 0; e < t.length; e++)
                if (t[e] in o) return t[e];
            return t[0]
        }
        var r, n = a(["userSelect", "MozUserSelect", "WebkitUserSelect", "msUserSelect"]);
        i.disableDrag = function () {
            o && n && (r = o[n], o[n] = "none");
        }, i.enableDrag = function () {
            o && n && (o[n] = r);
        };
        var s = a(["transform", "WebkitTransform"]);
        i.setTransform = function (t, e) {
            t.style[s] = e;
        };
        var l = a(["transformOrigin", "WebkitTransformOrigin"]);
        i.setTransformOrigin = function (t, e) {
            t.style[l] = e;
        }, i.getAllStyle = function (e) {
            return t.window.getComputedStyle(e)
        };
        var c = !1;
        try {
            var u = Object.defineProperty({}, "passive", {
                get: function () {
                    c = !0;
                }
            });
            t.window.addEventListener("test", u, u), t.window.removeEventListener("test", u, u);
        } catch (t) {
            c = !1;
        }
        i.addEventListener = function (t, e, i, o) {
            void 0 === o && (o = {}), t.addEventListener(e, i, "passive" in o && c ? o : o.capture);
        }, i.removeEventListener = function (t, e, i, o) {
            void 0 === o && (o = {}), t.removeEventListener(e, i, "passive" in o && c ? o : o.capture);
        };
        var h = function (e) {
            e.preventDefault(), e.stopPropagation(), t.window.removeEventListener("click", h, !0);
        };
        i.suppressClick = function () {
            t.window.addEventListener("click", h, !0), t.window.setTimeout((function () {
                t.window.removeEventListener("click", h, !0);
            }), 0);
        }, i.mousePos = function (e, i) {
            var o = e.getBoundingClientRect();
            return new t.Point(i.clientX - o.left - e.clientLeft, i.clientY - o.top - e.clientTop)
        }, i.touchPos = function (e, i) {
            for (var o = e.getBoundingClientRect(), a = [], r = 0; r < i.length; r++) a.push(new t.Point(i[r].clientX - o.left - e.clientLeft, i[r].clientY - o.top - e.clientTop));
            return a
        }, i.mouseButton = function (e) {
            return void 0 !== t.window.InstallTrigger && 2 === e.button && e.ctrlKey && t.window.navigator.platform.toUpperCase().indexOf("MAC") >= 0 ? 0 : e.button
        }, i.remove = function (t) {
            t.parentNode && t.parentNode.removeChild(t);
        };
        var p = "01",
            _ = function (t, e) {
                this._transformRequestFn = t, this._customAccessToken = e, this._createSkuToken();
            };
        _.prototype._createSkuToken = function () {
            var t = function () {
                for (var t = "", e = 0; e < 10; e++) t += "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ" [Math.floor(62 * Math.random())];
                return {
                    token: ["1", p, t].join(""),
                    tokenExpiresAt: Date.now() + 432e5
                }
            }();
            this._skuToken = t.token, this._skuTokenExpiresAt = t.tokenExpiresAt;
        }, _.prototype._isSkuTokenExpired = function () {
            return Date.now() > this._skuTokenExpiresAt
        }, _.prototype.transformRequest = function (t, e) {
            return this._transformRequestFn && this._transformRequestFn(t, e) || {
                url: t
            }
        }, _.prototype.normalizeStyleURL = function (t, e) {
            if (!g(t)) return t;
            var i = y(t);
            return i.path = "/styles/v1" + i.path, f(i, e)
        }, _.prototype.normalizeGlyphsURL = function (e) {
            if (!g(e) && !t.config.fontsUrl) return e;
            var i = y(e);
            return t.config.fontsUrl && t.config.fontsUrl + "/{fontstack}" + i.path.substr(i.path.lastIndexOf("/")) + ".pbf" || (t.config.SRC_URL || "") + "fonts/{fontstack}/" + i.path.substr(i.path.lastIndexOf("/")) + ".pbf"
        }, _.prototype.normalizeSourceURL = function (t, e) {
            if (!g(t)) return t;
            var i = y(t);
            return i.path = "/v4/" + i.authority + ".json", i.params.push("secure"), f(i, e)
        }, _.prototype.normalizeSpriteURL = function (e, i, o) {
            if (!g(e) && !t.config.spriteUrl) return "" + e + i + o;
            var a = y(e);
            return a.path = (t.config.SRC_URL || "") + "sprite/sprite" + i + o, t.config.spriteUrl && "" + t.config.spriteUrl + i + o || a.path
        }, _.prototype.normalizeTileURL = function (e, i, o) {
            if (!e || !g(e)) return 0 === e.indexOf("//") ? "" + t.window.document.location.protocol + e : e;
            var a = y(e);
            return a.path = a.path.replace(m, (t.browser.devicePixelRatio >= 2 || 512 === i ? "@2x" : "") + (t.webpSupported.supported ? ".webp" : "$1")),
                function (e) {
                    for (var i = 0; i < e.length; i++) 0 === e[i].indexOf("access_token=tk.") && (e[i] = "access_token=" + (t.config.ACCESS_TOKEN || ""));
                }(a.params), f(a, void 0, void 0, void 0, o)
        }, _.prototype.canonicalizeTileset = function (t) {
            for (var e = [], i = 0, o = t.tiles || []; i < o.length; i += 1) e.push(o[i]);
            return e
        };
        var m = /(\.(png|jpg)\d*)(?=$)/;

        function d(t, e) {
            return Array.isArray(t) ? e && e.x && e.y ? t[(e.x + e.y) % t.length] : t[0] : t
        }

        function f(e, i, o, a, r) {
            var n = y(t.config.SRC_URL || ""),
                s = y(d(t.config.API_URL, r)),
                l = y(d(t.config.DYN_URL || "", r)),
                c = y(d(t.config.MERGE_URL || "", r)),
                u = y(d(t.config.OTHER_URL || "", r));
            switch (e.protocol) {
                case "minemap":
                    e.protocol = n.protocol, e.authority = n.authority;
                    break;
                case "minemapdata":
                    e.path = s.path + e.authority + e.path, e.protocol = s.protocol, e.authority = s.authority;
                    break;
                case "minemapdatad":
                    e.path = l.path + e.authority + e.path, e.protocol = l.protocol, e.authority = l.authority;
                    break;
                case "minemapdatam":
                    e.path = c.path + e.authority + e.path, e.protocol = c.protocol, e.authority = c.authority;
                    break;
                case "minemapdatao":
                    e.path = u.path + e.authority + e.path, e.protocol = u.protocol, e.authority = u.authority;
            }
            if (!t.config.REQUIRE_ACCESS_TOKEN) return x(e);
            if (o = o || t.config.SOLU, a = a || t.config.DATA_VERSION, !(i = i || t.config.APP_KEY) && !t.config.ACCESS_TOKEN) throw new Error("需要申请appKey. 参见minedata.cn帮助页面");
            return t.config.ACCESS_TOKEN && e.params.push("token=" + t.config.ACCESS_TOKEN), i && e.params.push("appKey=" + i), e.params.push("solu=" + (o || "")), a && e.params.push("version=" + a), x(e)
        }

        function g(t) {
            return 0 === t.indexOf("minemap:") || 0 === t.indexOf("minemapdata:") || 0 === t.indexOf("minemapdatad:") || 0 === t.indexOf("minemapdatam:") || 0 === t.indexOf("minemapdatao:")
        }
        var v = /^(\w+):\/\/([^/?]+)(\/[^?]+)?\??(.+)?/;

        function y(t) {
            var e = t.match(v);
            if (!e) {
                var i = t.match(/^\/\/([^/?]+)(\/[^?]+)?\??(.+)?/);
                if (!i) throw new Error("Unable to parse URL object");
                return {
                    protocol: "",
                    authority: i[1],
                    path: i[2] || "/",
                    params: i[3] ? i[3].split("&") : []
                }
            }
            return {
                protocol: e[1],
                authority: e[2],
                path: e[3] || "/",
                params: e[4] ? e[4].split("&") : []
            }
        }

        function x(e) {
            var i = e.params.length ? "?" + e.params.join("&") : "";
            return e.protocol && e.protocol.length > 0 ? e.protocol + "://" + e.authority + e.path + i : t.window.document.location.protocol + "//" + e.authority + e.path + i
        }

        function w(e) {
            if (!e) return null;
            var i = e.split(".");
            if (!i || 3 !== i.length) return null;
            try {
                return JSON.parse(t.b64DecodeUnicode(i[1]))
            } catch (t) {
                return null
            }
        }
        var b = function (t) {
            this.type = t, this.anonId = null, this.eventData = {}, this.queue = [], this.pendingRequest = null;
        };
        b.prototype.getStorageKey = function (e) {
            var i, o = w(t.config.ACCESS_TOKEN);
            return i = o && o.u ? t.b64EncodeUnicode(o.u) : t.config.ACCESS_TOKEN || "", e ? "minemap.eventData." + e + ":" + i : "minemap.eventData:" + i
        }, b.prototype.fetchEventData = function () {
            var e = t.storageAvailable("localStorage"),
                i = this.getStorageKey(),
                o = this.getStorageKey("uuid");
            if (e) try {
                var a = t.window.localStorage.getItem(i);
                a && (this.eventData = JSON.parse(a));
                var r = t.window.localStorage.getItem(o);
                r && (this.anonId = r);
            } catch (e) {
                t.warnOnce("Unable to read from LocalStorage");
            }
        }, b.prototype.saveEventData = function () {
            var e = t.storageAvailable("localStorage"),
                i = this.getStorageKey(),
                o = this.getStorageKey("uuid");
            if (e) try {
                t.window.localStorage.setItem(o, this.anonId), Object.keys(this.eventData).length >= 1 && t.window.localStorage.setItem(i, JSON.stringify(this.eventData));
            } catch (e) {
                t.warnOnce("Unable to write to LocalStorage");
            }
        }, b.prototype.processRequests = function (t) {}, b.prototype.postEvent = function (e, i, o, a) {
            var r = this;
            if (t.config.EVENTS_URL) {
                var n = y(t.config.EVENTS_URL);
                n.params.push("access_token=" + (a || t.config.ACCESS_TOKEN || ""));
                var s = {
                        event: this.type,
                        created: new Date(e).toISOString(),
                        sdkIdentifier: "minemap",
                        sdkVersion: "2.1.0",
                        skuId: p,
                        userId: this.anonId
                    },
                    l = i ? t.extend(s, i) : s,
                    c = {
                        url: x(n),
                        headers: {
                            "Content-Type": "text/plain"
                        },
                        body: JSON.stringify([l])
                    };
                this.pendingRequest = t.postData(c, (function (t) {
                    r.pendingRequest = null, o(t), r.saveEventData(), r.processRequests(a);
                }));
            }
        }, b.prototype.queueRequest = function (t, e) {
            this.queue.push(t), this.processRequests(e);
        };
        var T = function (e) {
                function i() {
                    e.call(this, "map.load"), this.success = {}, this.skuToken = "";
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.postMapLoadEvent = function (e, i, o, a) {
                    this.skuToken = o, (t.config.EVENTS_URL && a || t.config.ACCESS_TOKEN && Array.isArray(e) && e.some((function (t) {
                        return g(t)
                    }))) && this.queueRequest({
                        id: i,
                        timestamp: Date.now()
                    }, a);
                }, i.prototype.processRequests = function (e) {
                    var i = this;
                    if (!this.pendingRequest && 0 !== this.queue.length) {
                        var o = this.queue.shift(),
                            a = o.id,
                            r = o.timestamp;
                        a && this.success[a] || (this.anonId || this.fetchEventData(), t.validateUuid(this.anonId) || (this.anonId = t.uuid()), this.postEvent(r, {
                            skuToken: this.skuToken
                        }, (function (t) {
                            t || a && (i.success[a] = !0);
                        }), e));
                    }
                }, i
            }(b),
            E = new(function (e) {
                function i(t) {
                    e.call(this, "appUserTurnstile"), this._customAccessToken = t;
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.postTurnstileEvent = function (e, i) {
                    t.config.EVENTS_URL && t.config.ACCESS_TOKEN && Array.isArray(e) && e.some((function (t) {
                        return g(t)
                    })) && this.queueRequest(Date.now(), i);
                }, i.prototype.processRequests = function (e) {
                    var i = this;
                    if (!this.pendingRequest && 0 !== this.queue.length) {
                        this.anonId && this.eventData.lastSuccess && this.eventData.tokenU || this.fetchEventData();
                        var o = w(t.config.ACCESS_TOKEN),
                            a = o ? o.u : t.config.ACCESS_TOKEN,
                            r = a !== this.eventData.tokenU;
                        t.validateUuid(this.anonId) || (this.anonId = t.uuid(), r = !0);
                        var n = this.queue.shift();
                        if (this.eventData.lastSuccess) {
                            var s = new Date(this.eventData.lastSuccess),
                                l = new Date(n),
                                c = (n - this.eventData.lastSuccess) / 864e5;
                            r = r || c >= 1 || c < -1 || s.getDate() !== l.getDate();
                        } else r = !0;
                        if (!r) return this.processRequests();
                        this.postEvent(n, {
                            "enabled.telemetry": !1
                        }, (function (t) {
                            t || (i.eventData.lastSuccess = n, i.eventData.tokenU = a);
                        }), e);
                    }
                }, i
            }(b)),
            S = E.postTurnstileEvent.bind(E),
            I = new T,
            z = I.postMapLoadEvent.bind(I);

        function C(t) {
            var e = t.userImage;
            return !!(e && e.render && e.render()) && (t.data.replace(new Uint8Array(e.data.buffer)), !0)
        }
        var P = function (e) {
                function i() {
                    e.call(this), this.images = {}, this.updatedImages = {}, this.callbackDispatchedThisFrame = {}, this.loaded = !1, this.requestors = [], this.patterns = {}, this.atlasImage = new t.RGBAImage({
                        width: 1,
                        height: 1
                    }), this.dirty = !0;
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.isLoaded = function () {
                    return this.loaded
                }, i.prototype.setLoaded = function (t) {
                    if (this.loaded !== t && (this.loaded = t, t)) {
                        for (var e = 0, i = this.requestors; e < i.length; e += 1) {
                            var o = i[e];
                            this._notify(o.ids, o.callback);
                        }
                        this.requestors = [];
                    }
                }, i.prototype.getImage = function (t) {
                    return this.images[t]
                }, i.prototype.addImage = function (t, e) {
                    this._validate(t, e) && (this.images[t] = e);
                }, i.prototype._validate = function (e, i) {
                    var o = !0;
                    return this._validateStretch(i.stretchX, i.data && i.data.width) || (this.fire(new t.ErrorEvent(new Error('Image "' + e + '" has invalid "stretchX" value'))), o = !1), this._validateStretch(i.stretchY, i.data && i.data.height) || (this.fire(new t.ErrorEvent(new Error('Image "' + e + '" has invalid "stretchY" value'))), o = !1), this._validateContent(i.content, i) || (this.fire(new t.ErrorEvent(new Error('Image "' + e + '" has invalid "content" value'))), o = !1), o
                }, i.prototype._validateStretch = function (t, e) {
                    if (!t) return !0;
                    for (var i = 0, o = 0, a = t; o < a.length; o += 1) {
                        var r = a[o];
                        if (r[0] < i || r[1] < r[0] || e < r[1]) return !1;
                        i = r[1];
                    }
                    return !0
                }, i.prototype._validateContent = function (t, e) {
                    return !(t && (4 !== t.length || t[0] < 0 || e.data.width < t[0] || t[1] < 0 || e.data.height < t[1] || t[2] < 0 || e.data.width < t[2] || t[3] < 0 || e.data.height < t[3] || t[2] < t[0] || t[3] < t[1]))
                }, i.prototype.updateImage = function (t, e) {
                    e.version = this.images[t].version + 1, this.images[t] = e, this.updatedImages[t] = !0;
                }, i.prototype.removeImage = function (t) {
                    var e = this.images[t];
                    delete this.images[t], delete this.patterns[t], e.userImage && e.userImage.onRemove && e.userImage.onRemove();
                }, i.prototype.listImages = function () {
                    return Object.keys(this.images)
                }, i.prototype.getImages = function (t, e) {
                    var i = !0;
                    if (!this.isLoaded())
                        for (var o = 0, a = t; o < a.length; o += 1) this.images[a[o]] || (i = !1);
                    this.isLoaded() || i ? this._notify(t, e) : this.requestors.push({
                        ids: t,
                        callback: e
                    });
                }, i.prototype._notify = function (e, i) {
                    for (var o = {}, a = 0, r = e; a < r.length; a += 1) {
                        var n = r[a];
                        this.images[n] || this.fire(new t.Event("styleimagemissing", {
                            id: n
                        }));
                        var s = this.images[n];
                        s ? o[n] = {
                            data: s.data.clone(),
                            pixelRatio: s.pixelRatio,
                            sdf: s.sdf,
                            version: s.version,
                            stretchX: s.stretchX,
                            stretchY: s.stretchY,
                            content: s.content,
                            hasRenderCallback: Boolean(s.userImage && s.userImage.render)
                        } : t.warnOnce('Image "' + n + '" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.');
                    }
                    i(null, o);
                }, i.prototype.getPixelSize = function () {
                    var t = this.atlasImage;
                    return {
                        width: t.width,
                        height: t.height
                    }
                }, i.prototype.getPattern = function (e) {
                    var i = this.patterns[e],
                        o = this.getImage(e);
                    if (!o) return null;
                    if (i && i.position.version === o.version) return i.position;
                    if (i) i.position.version = o.version;
                    else {
                        var a = {
                                w: o.data.width + 2,
                                h: o.data.height + 2,
                                x: 0,
                                y: 0
                            },
                            r = new t.ImagePosition(a, o);
                        this.patterns[e] = {
                            bin: a,
                            position: r
                        };
                    }
                    return this._updatePatternAtlas(), this.patterns[e].position
                }, i.prototype.bind = function (e) {
                    var i = e.gl;
                    this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage), this.dirty = !1) : this.atlasTexture = new t.Texture(e, this.atlasImage, i.RGBA), this.atlasTexture.bind(i.LINEAR, i.CLAMP_TO_EDGE);
                }, i.prototype._updatePatternAtlas = function () {
                    var e = [];
                    for (var i in this.patterns) e.push(this.patterns[i].bin);
                    var o = t.potpack(e),
                        a = o.w,
                        r = o.h,
                        n = this.atlasImage;
                    for (var s in n.resize({
                            width: a || 1,
                            height: r || 1
                        }), this.patterns) {
                        var l = this.patterns[s].bin,
                            c = l.x + 1,
                            u = l.y + 1,
                            h = this.images[s].data,
                            p = h.width,
                            _ = h.height;
                        t.RGBAImage.copy(h, n, {
                            x: 0,
                            y: 0
                        }, {
                            x: c,
                            y: u
                        }, {
                            width: p,
                            height: _
                        }), t.RGBAImage.copy(h, n, {
                            x: 0,
                            y: _ - 1
                        }, {
                            x: c,
                            y: u - 1
                        }, {
                            width: p,
                            height: 1
                        }), t.RGBAImage.copy(h, n, {
                            x: 0,
                            y: 0
                        }, {
                            x: c,
                            y: u + _
                        }, {
                            width: p,
                            height: 1
                        }), t.RGBAImage.copy(h, n, {
                            x: p - 1,
                            y: 0
                        }, {
                            x: c - 1,
                            y: u
                        }, {
                            width: 1,
                            height: _
                        }), t.RGBAImage.copy(h, n, {
                            x: 0,
                            y: 0
                        }, {
                            x: c + p,
                            y: u
                        }, {
                            width: 1,
                            height: _
                        });
                    }
                    this.dirty = !0;
                }, i.prototype.beginFrame = function () {
                    this.callbackDispatchedThisFrame = {};
                }, i.prototype.dispatchRenderCallbacks = function (t) {
                    for (var e = 0, i = t; e < i.length; e += 1) {
                        var o = i[e];
                        if (!this.callbackDispatchedThisFrame[o]) {
                            this.callbackDispatchedThisFrame[o] = !0;
                            var a = this.images[o];
                            C(a) && this.updateImage(o, a);
                        }
                    }
                }, i
            }(t.Evented),
            L = D,
            A = D,
            M = 1e20;

        function D(t, e, i, o, a, r) {
            this.fontSize = t || 24, this.buffer = void 0 === e ? 3 : e, this.cutoff = o || .25, this.fontFamily = a || "sans-serif", this.fontWeight = r || "normal", this.radius = i || 8;
            var n = this.size = this.fontSize + 2 * this.buffer;
            this.canvas = document.createElement("canvas"), this.canvas.width = this.canvas.height = n, this.ctx = this.canvas.getContext("2d"), this.ctx.font = this.fontWeight + " " + this.fontSize + "px " + this.fontFamily, this.ctx.textBaseline = "middle", this.ctx.fillStyle = "black", this.gridOuter = new Float64Array(n * n), this.gridInner = new Float64Array(n * n), this.f = new Float64Array(n), this.d = new Float64Array(n), this.z = new Float64Array(n + 1), this.v = new Int16Array(n), this.middle = Math.round(n / 2 * (navigator.userAgent.indexOf("Gecko/") >= 0 ? 1.2 : 1));
        }

        function R(t, e, i, o, a, r, n) {
            for (var s = 0; s < e; s++) {
                for (var l = 0; l < i; l++) o[l] = t[l * e + s];
                for (k(o, a, r, n, i), l = 0; l < i; l++) t[l * e + s] = a[l];
            }
            for (l = 0; l < i; l++) {
                for (s = 0; s < e; s++) o[s] = t[l * e + s];
                for (k(o, a, r, n, e), s = 0; s < e; s++) t[l * e + s] = Math.sqrt(a[s]);
            }
        }

        function k(t, e, i, o, a) {
            i[0] = 0, o[0] = -M, o[1] = +M;
            for (var r = 1, n = 0; r < a; r++) {
                for (var s = (t[r] + r * r - (t[i[n]] + i[n] * i[n])) / (2 * r - 2 * i[n]); s <= o[n];) n--, s = (t[r] + r * r - (t[i[n]] + i[n] * i[n])) / (2 * r - 2 * i[n]);
                i[++n] = r, o[n] = s, o[n + 1] = +M;
            }
            for (r = 0, n = 0; r < a; r++) {
                for (; o[n + 1] < r;) n++;
                e[r] = (r - i[n]) * (r - i[n]) + t[i[n]];
            }
        }
        D.prototype.draw = function (t) {
            this.ctx.clearRect(0, 0, this.size, this.size), this.ctx.fillText(t, this.buffer, this.middle);
            for (var e = this.ctx.getImageData(0, 0, this.size, this.size), i = new Uint8ClampedArray(this.size * this.size), o = 0; o < this.size * this.size; o++) {
                var a = e.data[4 * o + 3] / 255;
                this.gridOuter[o] = 1 === a ? 0 : 0 === a ? M : Math.pow(Math.max(0, .5 - a), 2), this.gridInner[o] = 1 === a ? M : 0 === a ? 0 : Math.pow(Math.max(0, a - .5), 2);
            }
            for (R(this.gridOuter, this.size, this.size, this.f, this.d, this.v, this.z), R(this.gridInner, this.size, this.size, this.f, this.d, this.v, this.z), o = 0; o < this.size * this.size; o++) i[o] = Math.max(0, Math.min(255, Math.round(255 - 255 * ((this.gridOuter[o] - this.gridInner[o]) / this.radius + this.cutoff))));
            return i
        }, L.default = A;
        var O = function (t, e) {
            this.requestManager = t, this.localIdeographFontFamily = e, this.entries = {};
        };
        O.prototype.setURL = function (t) {
            this.url = t;
        }, O.prototype.getGlyphs = function (e, i) {
            var o = this,
                a = [];
            for (var r in e)
                for (var n = 0, s = e[r]; n < s.length; n += 1) a.push({
                    stack: r,
                    id: s[n]
                });
            t.asyncAll(a, (function (t, e) {
                var i = t.stack,
                    a = t.id,
                    r = o.entries[i];
                r || (r = o.entries[i] = {
                    glyphs: {},
                    requests: {},
                    ranges: {}
                });
                var n = r.glyphs[a];
                if (void 0 === n) {
                    if (n = o._tinySDF(r, i, a)) return r.glyphs[a] = n, void e(null, {
                        stack: i,
                        id: a,
                        glyph: n
                    });
                    var s = Math.floor(a / 256);
                    if (256 * s > 65535) e(new Error("glyphs > 65535 not supported"));
                    else if (r.ranges[s]) e(null, {
                        stack: i,
                        id: a,
                        glyph: n
                    });
                    else {
                        var l = r.requests[s];
                        l || (l = r.requests[s] = [], O.loadGlyphRange(i, s, o.url, o.requestManager, (function (t, e) {
                            if (e) {
                                for (var i in e) o._doesCharSupportLocalGlyph(+i) || (r.glyphs[+i] = e[+i]);
                                r.ranges[s] = !0;
                            }
                            for (var a = 0, n = l; a < n.length; a += 1)(0, n[a])(t, e);
                            delete r.requests[s];
                        }))), l.push((function (t, o) {
                            t ? e(t) : o && e(null, {
                                stack: i,
                                id: a,
                                glyph: o[a] || null
                            });
                        }));
                    }
                } else e(null, {
                    stack: i,
                    id: a,
                    glyph: n
                });
            }), (function (t, e) {
                if (t) i(t);
                else if (e) {
                    for (var o = {}, a = 0, r = e; a < r.length; a += 1) {
                        var n = r[a],
                            s = n.stack,
                            l = n.id,
                            c = n.glyph;
                        (o[s] || (o[s] = {}))[l] = c && {
                            id: c.id,
                            bitmap: c.bitmap.clone(),
                            metrics: c.metrics
                        };
                    }
                    i(null, o);
                }
            }));
        }, O.prototype._doesCharSupportLocalGlyph = function (e) {
            return !!this.localIdeographFontFamily && (t.isChar["CJK Unified Ideographs"](e) || t.isChar["Hangul Syllables"](e) || t.isChar.Hiragana(e) || t.isChar.Katakana(e))
        }, O.prototype._tinySDF = function (e, i, o) {
            var a = this.localIdeographFontFamily;
            if (a && this._doesCharSupportLocalGlyph(o)) {
                var r = e.tinySDF;
                if (!r) {
                    var n = "400";
                    /bold/i.test(i) ? n = "900" : /medium/i.test(i) ? n = "500" : /light/i.test(i) && (n = "200"), r = e.tinySDF = new O.TinySDF(24, 3, 8, .25, a, n);
                }
                return {
                    id: o,
                    bitmap: new t.AlphaImage({
                        width: 30,
                        height: 30
                    }, r.draw(String.fromCharCode(o))),
                    metrics: {
                        width: 24,
                        height: 24,
                        left: 0,
                        top: -8,
                        advance: 24
                    }
                }
            }
        }, O.loadGlyphRange = function (e, i, o, a, r) {
            var n = 256 * i,
                s = n + 255,
                l = a.transformRequest(a.normalizeGlyphsURL(o).replace("{fontstack}", e).replace("{range}", n + "-" + s), t.ResourceType.Glyphs);
            t.getArrayBuffer(l, (function (e, i) {
                if (e) r(e);
                else if (i) {
                    for (var o = {}, a = 0, n = t.parseGlyphPBF(i); a < n.length; a += 1) {
                        var s = n[a];
                        o[s.id] = s;
                    }
                    r(null, o);
                }
            }));
        }, O.TinySDF = L;
        var B = function () {
            this.specification = t.styleSpec.light.position;
        };
        B.prototype.possiblyEvaluate = function (e, i) {
            return t.sphericalToCartesian(e.expression.evaluate(i))
        }, B.prototype.interpolate = function (e, i, o) {
            return {
                x: t.number(e.x, i.x, o),
                y: t.number(e.y, i.y, o),
                z: t.number(e.z, i.z, o)
            }
        };
        var U = new t.Properties({
                anchor: new t.DataConstantProperty(t.styleSpec.light.anchor),
                position: new B,
                color: new t.DataConstantProperty(t.styleSpec.light.color),
                intensity: new t.DataConstantProperty(t.styleSpec.light.intensity)
            }),
            F = function (e) {
                function i(i) {
                    e.call(this), this._transitionable = new t.Transitionable(U), this.setLight(i), this._transitioning = this._transitionable.untransitioned();
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.getLight = function () {
                    return this._transitionable.serialize()
                }, i.prototype.setLight = function (e, i) {
                    if (void 0 === i && (i = {}), !this._validate(t.validateLight, e, i))
                        for (var o in e) {
                            var a = e[o];
                            t.endsWith(o, "-transition") ? this._transitionable.setTransition(o.slice(0, -"-transition".length), a) : this._transitionable.setValue(o, a);
                        }
                }, i.prototype.updateTransitions = function (t) {
                    this._transitioning = this._transitionable.transitioned(t, this._transitioning);
                }, i.prototype.hasTransition = function () {
                    return this._transitioning.hasTransition()
                }, i.prototype.recalculate = function (t) {
                    this.properties = this._transitioning.possiblyEvaluate(t);
                }, i.prototype._validate = function (e, i, o) {
                    return (!o || !1 !== o.validate) && t.emitValidationErrors(this, e.call(t.validateStyle, t.extend({
                        value: i,
                        style: {
                            glyphs: !0,
                            sprite: !0
                        },
                        styleSpec: t.styleSpec
                    })))
                }, i
            }(t.Evented),
            N = function (t, e) {
                this.width = t, this.height = e, this.nextRow = 0, this.data = new Uint8Array(this.width * this.height), this.dashEntry = {};
            };
        N.prototype.getDash = function (t, e) {
            var i = t.join(",") + String(e);
            return this.dashEntry[i] || (this.dashEntry[i] = this.addDash(t, e)), this.dashEntry[i]
        }, N.prototype.getDashRanges = function (t, e, i) {
            var o = [],
                a = t.length % 2 == 1 ? -t[t.length - 1] * i : 0,
                r = t[0] * i,
                n = !0;
            o.push({
                left: a,
                right: r,
                isDash: n,
                zeroLength: 0 === t[0]
            });
            for (var s = t[0], l = 1; l < t.length; l++) {
                var c = t[l];
                o.push({
                    left: a = s * i,
                    right: r = (s += c) * i,
                    isDash: n = !n,
                    zeroLength: 0 === c
                });
            }
            return o
        }, N.prototype.addRoundDash = function (t, e, i) {
            for (var o = e / 2, a = -i; a <= i; a++)
                for (var r = this.width * (this.nextRow + i + a), n = 0, s = t[n], l = 0; l < this.width; l++) {
                    l / s.right > 1 && (s = t[++n]);
                    var c = Math.abs(l - s.left),
                        u = Math.abs(l - s.right),
                        h = Math.min(c, u),
                        p = void 0,
                        _ = a / i * (o + 1);
                    if (s.isDash) {
                        var m = o - Math.abs(_);
                        p = Math.sqrt(h * h + m * m);
                    } else p = o - Math.sqrt(h * h + _ * _);
                    this.data[r + l] = Math.max(0, Math.min(255, p + 128));
                }
        }, N.prototype.addRegularDash = function (t) {
            for (var e = t.length - 1; e >= 0; --e) {
                var i = t[e],
                    o = t[e + 1];
                i.zeroLength ? t.splice(e, 1) : o && o.isDash === i.isDash && (o.left = i.left, t.splice(e, 1));
            }
            var a = t[0],
                r = t[t.length - 1];
            a.isDash === r.isDash && (a.left = r.left - this.width, r.right = a.right + this.width);
            for (var n = this.width * this.nextRow, s = 0, l = t[s], c = 0; c < this.width; c++) {
                c / l.right > 1 && (l = t[++s]);
                var u = Math.abs(c - l.left),
                    h = Math.abs(c - l.right),
                    p = Math.min(u, h);
                this.data[n + c] = Math.max(0, Math.min(255, (l.isDash ? p : -p) + 128));
            }
        }, N.prototype.addDash = function (e, i) {
            var o = i ? 7 : 0,
                a = 2 * o + 1;
            if (this.nextRow + a > this.height) return t.warnOnce("LineAtlas out of space"), null;
            for (var r = 0, n = 0; n < e.length; n++) r += e[n];
            if (0 !== r) {
                var s = this.width / r,
                    l = this.getDashRanges(e, this.width, s);
                i ? this.addRoundDash(l, s, o) : this.addRegularDash(l);
            }
            var c = {
                y: (this.nextRow + o + .5) / this.height,
                height: 2 * o / this.height,
                width: r
            };
            return this.nextRow += a, this.dirty = !0, c
        }, N.prototype.bind = function (t) {
            var e = t.gl;
            this.texture ? (e.bindTexture(e.TEXTURE_2D, this.texture), this.dirty && (this.dirty = !1, e.texSubImage2D(e.TEXTURE_2D, 0, 0, 0, this.width, this.height, e.ALPHA, e.UNSIGNED_BYTE, this.data))) : (this.texture = e.createTexture(), e.bindTexture(e.TEXTURE_2D, this.texture), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, e.LINEAR), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, e.LINEAR), e.texImage2D(e.TEXTURE_2D, 0, e.ALPHA, this.width, this.height, 0, e.ALPHA, e.UNSIGNED_BYTE, this.data));
        };
        var q = function e(i, o) {
            this.workerPool = i, this.actors = [], this.currentActor = 0, this.id = t.uniqueId();
            for (var a = this.workerPool.acquire(this.id), r = 0; r < a.length; r++) {
                var n = new e.Actor(a[r], o, this.id);
                n.name = "Worker " + r, this.actors.push(n);
            }
        };

        function j(e, i, o) {
            var a = function (a, r) {
                if (a) return o(a);
                if (r) {
                    var n = t.pick(t.extend(r, e), ["tiles", "minzoom", "maxzoom", "attribution", "minemap_logo", "bounds", "scheme", "tileSize", "encoding"]);
                    r.vector_layers && (n.vectorLayers = r.vector_layers, n.vectorLayerIds = n.vectorLayers.map((function (t) {
                        return t.id
                    }))), n.tiles = i.canonicalizeTileset(n), o(null, n);
                }
            };
            return e.url ? t.getJSON(i.transformRequest(i.normalizeSourceURL(e.url), t.ResourceType.Source), a) : t.browser.frame((function () {
                return a(null, e)
            }))
        }
        q.prototype.broadcast = function (e, i, o) {
            t.asyncAll(this.actors, (function (t, o) {
                t.send(e, i, o);
            }), o = o || function () {});
        }, q.prototype.getActor = function () {
            return this.currentActor = (this.currentActor + 1) % this.actors.length, this.actors[this.currentActor]
        }, q.prototype.remove = function () {
            this.actors.forEach((function (t) {
                t.remove();
            })), this.actors = [], this.workerPool.release(this.id);
        }, q.Actor = t.Actor;
        var Z = function (e, i, o, a) {
            this.bounds = t.LngLatBounds.convert(this.validateBounds(e)), this.minzoom = i || 0, this.maxzoom = o || 24, this._isLatLon = a;
        };
        Z.prototype.validateBounds = function (t) {
            return Array.isArray(t) && 4 === t.length ? [Math.max(-180, t[0]), Math.max(-90, t[1]), Math.min(180, t[2]), Math.min(90, t[3])] : [-180, -90, 180, 90]
        }, Z.prototype.contains = function (e) {
            var i = Math.pow(2, e.z),
                o = Math.floor((this._isLatLon ? t.lngLatXfromLng : t.mercatorXfromLng)(this.bounds.getWest()) * i),
                a = Math.floor((this._isLatLon ? t.lngLatYfromLat : t.mercatorYfromLat)(this.bounds.getNorth()) * i),
                r = Math.ceil((this._isLatLon ? t.lngLatXfromLng : t.mercatorXfromLng)(this.bounds.getEast()) * i),
                n = Math.ceil((this._isLatLon ? t.lngLatYfromLat : t.mercatorYfromLat)(this.bounds.getSouth()) * i);
            return e.x >= o && e.x < r && e.y >= a && e.y < n
        };
        var V = function (e) {
                function i(i, o, a, r, n) {
                    if (e.call(this), this.id = i, this.dispatcher = a, this._isLatLon = n, this.type = "vector", this.minzoom = 0, this.maxzoom = 22, this.scheme = "xyz", this.tileSize = 512, this.reparseOverscaled = !0, this.isTileClipped = !0, this._loaded = !1, t.extend(this, t.pick(o, ["url", "scheme", "tileSize", "promoteId"])), this._options = t.extend({
                            type: "vector"
                        }, o), this._collectResourceTiming = o.collectResourceTiming, 512 !== this.tileSize) throw new Error("vector tile sources must have a tileSize of 512");
                    this.setEventedParent(r);
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.load = function () {
                    var e = this;
                    this._loaded = !1, this.fire(new t.Event("dataloading", {
                        dataType: "source"
                    })), this._tileJSONRequest = j(this._options, this.map._requestManager, (function (i, o) {
                        e._tileJSONRequest = null, e._loaded = !0, i ? e.fire(new t.ErrorEvent(i)) : o && (t.extend(e, o), o.bounds && (e.tileBounds = new Z(o.bounds, e.minzoom, e.maxzoom, e._isLatLon)), S(o.tiles, e.map._requestManager._customAccessToken), z(o.tiles, e.map._getMapId(), e.map._requestManager._skuToken, e.map._requestManager._customAccessToken), e.fire(new t.Event("data", {
                            dataType: "source",
                            sourceDataType: "metadata"
                        })), e.fire(new t.Event("data", {
                            dataType: "source",
                            sourceDataType: "content"
                        })));
                    }));
                }, i.prototype.loaded = function () {
                    return this._loaded
                }, i.prototype.hasTile = function (t) {
                    return !this.tileBounds || this.tileBounds.contains(t.canonical)
                }, i.prototype.onAdd = function (t) {
                    this.map = t, this.load();
                }, i.prototype.onRemove = function () {
                    this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
                }, i.prototype.serialize = function () {
                    return t.extend({}, this._options)
                }, i.prototype.loadTile = function (e, i) {
                    var o = e.tileID.canonical.toRealCoord(this.scheme),
                        a = this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles, this.scheme), void 0, o),
                        r = this._options || {},
                        n = {
                            request: this.map._requestManager.transformRequest(a, t.ResourceType.Tile),
                            uid: e.uid,
                            tileID: e.tileID,
                            zoom: e.tileID.overscaledZ,
                            tileSize: this.tileSize * e.tileID.overscaleFactor(),
                            type: this.type,
                            source: this.id,
                            pixelRatio: t.browser.devicePixelRatio,
                            showCollisionBoxes: this.map.showCollisionBoxes,
                            promoteId: this.promoteId,
                            sourceOptions: r,
                            eTag: e.eTag || null
                        };

                    function s(o, a) {
                        return delete e.request, e.aborted ? i(null) : o && 404 !== o.status ? i(o) : (a && a.resourceTiming && (e.resourceTiming = a.resourceTiming), this.map._refreshExpiredTiles && a && e.setExpiryData(a), e.loadVectorData(a, this.map.painter), t.cacheEntryPossiblyAdded(this.dispatcher), i(null), void(e.reloadCallback && (this.loadTile(e, e.reloadCallback), e.reloadCallback = null)))
                    }
                    n.request.collectResourceTiming = this._collectResourceTiming, e.actor && "expired" !== e.state ? "loading" === e.state ? e.reloadCallback = i : e.request = e.actor.send("reloadTile", n, s.bind(this)) : (e.actor = this.dispatcher.getActor(), e.request = e.actor.send("loadTile", n, s.bind(this)));
                }, i.prototype.abortTile = function (t) {
                    t.request && (t.request.cancel(), delete t.request), t.actor && t.actor.send("abortTile", {
                        uid: t.uid,
                        type: this.type,
                        source: this.id
                    }, void 0);
                }, i.prototype.unloadTile = function (t) {
                    t.unloadVectorData(), t.actor && t.actor.send("removeTile", {
                        uid: t.uid,
                        type: this.type,
                        source: this.id
                    }, void 0);
                }, i.prototype.hasTransition = function () {
                    return !1
                }, i
            }(t.Evented),
            G = function (e) {
                function i(i, o, a, r, n) {
                    e.call(this), this.id = i, this.dispatcher = a, this._isLatLon = n, this.setEventedParent(r), this.type = "raster", this.minzoom = 0, this.maxzoom = 22, this.roundZoom = !0, this.scheme = "xyz", this.tileSize = 512, this._loaded = !1, this._options = t.extend({
                        type: "raster"
                    }, o), t.extend(this, t.pick(o, ["url", "scheme", "tileSize"]));
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.load = function () {
                    var e = this;
                    this._loaded = !1, this.fire(new t.Event("dataloading", {
                        dataType: "source"
                    })), this._tileJSONRequest = j(this._options, this.map._requestManager, (function (i, o) {
                        e._tileJSONRequest = null, e._loaded = !0, i ? e.fire(new t.ErrorEvent(i)) : o && (t.extend(e, o), o.bounds && (e.tileBounds = new Z(o.bounds, e.minzoom, e.maxzoom, e._isLatLon)), S(o.tiles), z(o.tiles, e.map._getMapId(), e.map._requestManager._skuToken), e.fire(new t.Event("data", {
                            dataType: "source",
                            sourceDataType: "metadata"
                        })), e.fire(new t.Event("data", {
                            dataType: "source",
                            sourceDataType: "content"
                        })));
                    }));
                }, i.prototype.loaded = function () {
                    return this._loaded
                }, i.prototype.onAdd = function (t) {
                    this.map = t, this.load();
                }, i.prototype.onRemove = function () {
                    this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);
                }, i.prototype.serialize = function () {
                    return t.extend({}, this._options)
                }, i.prototype.hasTile = function (t) {
                    return !this.tileBounds || this.tileBounds.contains(t.canonical)
                }, i.prototype.loadTile = function (e, i) {
                    var o = this,
                        a = e.tileID.canonical.toRealCoord(this.scheme),
                        r = this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles, this.scheme), this.tileSize, a);
                    e.request = t.getImage(this.map._requestManager.transformRequest(r, t.ResourceType.Tile), (function (a, r) {
                        if (delete e.request, e.aborted) e.state = "unloaded", i(null);
                        else if (a) e.state = "errored", i(a);
                        else if (r) {
                            o.map._refreshExpiredTiles && e.setExpiryData(r), delete r.cacheControl, delete r.expires;
                            var n = o.map.painter.context,
                                s = n.gl;
                            e.texture = o.map.painter.getTileTexture(r.width), e.texture ? e.texture.update(r, {
                                useMipmap: !0
                            }) : (e.texture = new t.Texture(n, r, s.RGBA, {
                                useMipmap: !0
                            }), e.texture.bind(s.LINEAR, s.CLAMP_TO_EDGE, s.LINEAR_MIPMAP_NEAREST), n.extTextureFilterAnisotropic && s.texParameterf(s.TEXTURE_2D, n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, n.extTextureFilterAnisotropicMax)), e.state = "loaded", t.cacheEntryPossiblyAdded(o.dispatcher), i(null);
                        }
                    }));
                }, i.prototype.abortTile = function (t, e) {
                    t.request && (t.request.cancel(), delete t.request), e();
                }, i.prototype.unloadTile = function (t, e) {
                    t.texture && this.map.painter.saveTileTexture(t.texture), e();
                }, i.prototype.hasTransition = function () {
                    return !1
                }, i
            }(t.Evented),
            W = function (e) {
                function i(i, o, a, r, n) {
                    e.call(this, i, o, a, r, n), this.type = "raster-dem", this.maxzoom = 22, this._options = t.extend({
                        type: "raster-dem"
                    }, o), this.encoding = o.encoding || "minemap";
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.serialize = function () {
                    return {
                        type: "raster-dem",
                        url: this.url,
                        tileSize: this.tileSize,
                        tiles: this.tiles,
                        bounds: this.bounds,
                        encoding: this.encoding
                    }
                }, i.prototype.loadTile = function (e, i) {
                    var o = e.tileID.canonical.toRealCoord(this.scheme),
                        a = this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles, this.scheme), this.tileSize, o);

                    function r(t, o) {
                        t && (e.state = "errored", i(t)), o && (e.dem = o, e.needsHillshadePrepare = !0, e.state = "loaded", i(null));
                    }
                    e.request = t.getImage(this.map._requestManager.transformRequest(a, t.ResourceType.Tile), function (o, a) {
                        if (delete e.request, e.aborted) e.state = "unloaded", i(null);
                        else if (o) e.state = "errored", i(o);
                        else if (a) {
                            this.map._refreshExpiredTiles && e.setExpiryData(a), delete a.cacheControl, delete a.expires;
                            var n = t.window.ImageBitmap && a instanceof t.window.ImageBitmap && t.offscreenCanvasSupported() ? a : t.browser.getImageData(a, 1),
                                s = {
                                    uid: e.uid,
                                    coord: e.tileID,
                                    source: this.id,
                                    rawImageData: n,
                                    encoding: this.encoding
                                };
                            e.actor && "expired" !== e.state || (e.actor = this.dispatcher.getActor(), e.actor.send("loadDEMTile", s, r.bind(this)));
                        }
                    }.bind(this)), e.neighboringTiles = this._getNeighboringTiles(e.tileID);
                }, i.prototype._getNeighboringTiles = function (e) {
                    var i = e.canonical,
                        o = Math.pow(2, i.z),
                        a = (i.x - 1 + o) % o,
                        r = 0 === i.x ? e.wrap - 1 : e.wrap,
                        n = (i.x + 1 + o) % o,
                        s = i.x + 1 === o ? e.wrap + 1 : e.wrap,
                        l = {};
                    return l[new t.OverscaledTileID(e.overscaledZ, r, i.z, a, i.y).key] = {
                        backfilled: !1
                    }, l[new t.OverscaledTileID(e.overscaledZ, s, i.z, n, i.y).key] = {
                        backfilled: !1
                    }, i.y > 0 && (l[new t.OverscaledTileID(e.overscaledZ, r, i.z, a, i.y - 1).key] = {
                        backfilled: !1
                    }, l[new t.OverscaledTileID(e.overscaledZ, e.wrap, i.z, i.x, i.y - 1).key] = {
                        backfilled: !1
                    }, l[new t.OverscaledTileID(e.overscaledZ, s, i.z, n, i.y - 1).key] = {
                        backfilled: !1
                    }), i.y + 1 < o && (l[new t.OverscaledTileID(e.overscaledZ, r, i.z, a, i.y + 1).key] = {
                        backfilled: !1
                    }, l[new t.OverscaledTileID(e.overscaledZ, e.wrap, i.z, i.x, i.y + 1).key] = {
                        backfilled: !1
                    }, l[new t.OverscaledTileID(e.overscaledZ, s, i.z, n, i.y + 1).key] = {
                        backfilled: !1
                    }), l
                }, i.prototype.unloadTile = function (t) {
                    t.demTexture && this.map.painter.saveTileTexture(t.demTexture), t.fbo && (t.fbo.destroy(), delete t.fbo), t.dem && delete t.dem, delete t.neighboringTiles, t.state = "unloaded", t.actor && t.actor.send("removeDEMTile", {
                        uid: t.uid,
                        source: this.id
                    });
                }, i
            }(G),
            X = function (e) {
                function i(i, o, a, r, n) {
                    e.call(this), this.id = i, this._isLatLon = n, this.type = "geojson", this.minzoom = 0, this.maxzoom = 18, this.tileSize = 512, this.isTileClipped = !0, this.reparseOverscaled = !0, this._removed = !1, this._loaded = !1, this.actor = a.getActor(), this.setEventedParent(r), this._data = o.data, this._options = t.extend({}, o), this._collectResourceTiming = o.collectResourceTiming, this._resourceTiming = [], void 0 !== o.maxzoom && (this.maxzoom = o.maxzoom), o.type && (this.type = o.type), o.attribution && (this.attribution = o.attribution), this.promoteId = o.promoteId;
                    var s = t.EXTENT / this.tileSize;
                    this.workerOptions = t.extend({
                        source: this.id,
                        cluster: o.cluster || !1,
                        geojsonVtOptions: {
                            buffer: (void 0 !== o.buffer ? o.buffer : 128) * s,
                            tolerance: (void 0 !== o.tolerance ? o.tolerance : .375) * s,
                            extent: t.EXTENT,
                            maxZoom: this.maxzoom,
                            lineMetrics: o.lineMetrics || !1,
                            generateId: o.generateId || !1,
                            isLatLon: this._isLatLon
                        },
                        superclusterOptions: {
                            maxZoom: void 0 !== o.clusterMaxZoom ? Math.min(o.clusterMaxZoom, this.maxzoom - 1) : this.maxzoom - 1,
                            extent: t.EXTENT,
                            radius: (o.clusterRadius || 50) * s,
                            log: !1,
                            generateId: o.generateId || !1,
                            isLatLon: this._isLatLon
                        },
                        clusterProperties: o.clusterProperties
                    }, o.workerOptions);
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.load = function () {
                    var e = this;
                    this.fire(new t.Event("dataloading", {
                        dataType: "source"
                    })), this._updateWorkerData((function (i) {
                        if (i) e.fire(new t.ErrorEvent(i));
                        else {
                            var o = {
                                dataType: "source",
                                sourceDataType: "metadata"
                            };
                            e._collectResourceTiming && e._resourceTiming && e._resourceTiming.length > 0 && (o.resourceTiming = e._resourceTiming, e._resourceTiming = []), e.fire(new t.Event("data", o));
                        }
                    }));
                }, i.prototype.onAdd = function (t) {
                    this.map = t, this.load();
                }, i.prototype.setData = function (e) {
                    var i = this;
                    return this._data = e, this.fire(new t.Event("dataloading", {
                        dataType: "source"
                    })), this._updateWorkerData((function (e) {
                        if (e) i.fire(new t.ErrorEvent(e));
                        else {
                            var o = {
                                dataType: "source",
                                sourceDataType: "content"
                            };
                            i._collectResourceTiming && i._resourceTiming && i._resourceTiming.length > 0 && (o.resourceTiming = i._resourceTiming, i._resourceTiming = []), i.fire(new t.Event("data", o));
                        }
                    })), this
                }, i.prototype.getClusterExpansionZoom = function (t, e) {
                    return this.actor.send("geojson.getClusterExpansionZoom", {
                        clusterId: t,
                        source: this.id
                    }, e), this
                }, i.prototype.getClusterChildren = function (t, e) {
                    return this.actor.send("geojson.getClusterChildren", {
                        clusterId: t,
                        source: this.id
                    }, e), this
                }, i.prototype.getClusterLeaves = function (t, e, i, o) {
                    return this.actor.send("geojson.getClusterLeaves", {
                        source: this.id,
                        clusterId: t,
                        limit: e,
                        offset: i
                    }, o), this
                }, i.prototype._updateWorkerData = function (e) {
                    var i = this;
                    this._loaded = !1;
                    var o = t.extend({}, this.workerOptions),
                        a = this._data;
                    "string" == typeof a ? (o.request = this.map._requestManager.transformRequest(t.browser.resolveURL(a), t.ResourceType.Source), o.request.collectResourceTiming = this._collectResourceTiming) : o.data = JSON.stringify(a), this.actor.send(this.type + ".loadData", o, (function (t, a) {
                        i._removed || a && a.abandoned || (i._loaded = !0, a && a.resourceTiming && a.resourceTiming[i.id] && (i._resourceTiming = a.resourceTiming[i.id].slice(0)), i.actor.send(i.type + ".coalesce", {
                            source: o.source
                        }, null), e(t));
                    }));
                }, i.prototype.loaded = function () {
                    return this._loaded
                }, i.prototype.loadTile = function (e, i) {
                    var o = this,
                        a = e.actor ? "reloadTile" : "loadTile";
                    e.actor = this.actor, e.request = this.actor.send(a, {
                        type: this.type,
                        uid: e.uid,
                        tileID: e.tileID,
                        zoom: e.tileID.overscaledZ,
                        maxZoom: this.maxzoom,
                        tileSize: this.tileSize,
                        source: this.id,
                        pixelRatio: t.browser.devicePixelRatio,
                        showCollisionBoxes: this.map.showCollisionBoxes,
                        promoteId: this.promoteId
                    }, (function (t, r) {
                        return delete e.request, e.unloadVectorData(), e.aborted ? i(null) : t ? i(t) : (e.loadVectorData(r, o.map.painter, "reloadTile" === a), i(null))
                    }));
                }, i.prototype.abortTile = function (t) {
                    t.request && (t.request.cancel(), delete t.request), t.aborted = !0;
                }, i.prototype.unloadTile = function (t) {
                    t.unloadVectorData(), this.actor.send("removeTile", {
                        uid: t.uid,
                        type: this.type,
                        source: this.id
                    });
                }, i.prototype.onRemove = function () {
                    this._removed = !0, this.actor.send("removeSource", {
                        type: this.type,
                        source: this.id
                    });
                }, i.prototype.serialize = function () {
                    return t.extend({}, this._options, {
                        type: this.type,
                        data: this._data
                    })
                }, i.prototype.hasTransition = function () {
                    return !1
                }, i
            }(t.Evented),
            H = t.createLayout([{
                name: "a_pos",
                type: "Int16",
                components: 2
            }, {
                name: "a_texture_pos",
                type: "Int16",
                components: 2
            }]),
            K = function (e) {
                function i(t, i, o, a, r) {
                    e.call(this), this.id = t, this.dispatcher = o, this.coordinates = i.coordinates, this.wms = void 0 !== i.wms && i.wms, this.wmsUrl = "", this.type = "image", this.minzoom = 0, this.maxzoom = 22, this.tileSize = 512, this.tiles = {}, this._loaded = !1, this._isLatLon = r, this.setEventedParent(a), this.options = i;
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype._moveFn = function () {
                    var t = this.map,
                        e = t.unproject([0, 0]),
                        i = t.unproject([t.transform.width, 0]),
                        o = t.unproject([t.transform.width, t.transform.height]),
                        a = t.unproject([0, t.transform.height]),
                        r = Math.min(e.lat, i.lat, o.lat, a.lat),
                        n = Math.min(e.lng, i.lng, o.lng, a.lng),
                        s = Math.max(e.lat, i.lat, o.lat, a.lat),
                        l = Math.max(e.lng, i.lng, o.lng, a.lng),
                        c = n + "," + r + "," + l + "," + s,
                        u = Math.ceil(t.transform.width),
                        h = Math.ceil(t.transform.height),
                        p = Math.ceil(t.transform.zoom);
                    this.options.url = this.wmsUrl.replace("{bounds}", c.toString()).replace("{width}", u.toString()).replace("{height}", h.toString()).replace("{z}", p.toString()), this.setUrl(this.options.url, [
                        [n, s],
                        [l, s],
                        [l, r],
                        [n, r]
                    ]);
                }, i.prototype.setUrl = function (e, i) {
                    var o = this;
                    this.url = e, this.options.url = e, t.getImage(this.map._requestManager.transformRequest(this.url, t.ResourceType.Image), (function (e, a) {
                        e ? o.fire(new t.ErrorEvent(e)) : a && (o.image = a, delete o.texture, i && (o.coordinates = i), o._finishLoading());
                    }));
                }, i.prototype.load = function (e, i) {
                    var o = this;
                    this._loaded = !1, this.fire(new t.Event("dataloading", {
                        dataType: "source"
                    })), this.url = this.options.url, t.getImage(this.map._requestManager.transformRequest(this.url, t.ResourceType.Image), (function (a, r) {
                        o._loaded = !0, a ? o.fire(new t.ErrorEvent(a)) : r && (o.image = r, e && (o.coordinates = e), i && i(), o._finishLoading());
                    }));
                }, i.prototype.loaded = function () {
                    return this._loaded
                }, i.prototype.updateImage = function (t) {
                    var e = this;
                    return this.image && t.url ? (this.options.url = t.url, this.load(t.coordinates, (function () {
                        e.texture = null;
                    })), this) : this
                }, i.prototype._finishLoading = function () {
                    this.map && (this.setCoordinates(this.coordinates), this.fire(new t.Event("data", {
                        dataType: "source",
                        sourceDataType: "metadata"
                    })));
                }, i.prototype.onAdd = function (t) {
                    if (this.map = t, this.wms) {
                        this.wmsUrl || (this.wmsUrl = this.options.url);
                        var e = Math.ceil(t.transform.width),
                            i = Math.ceil(t.transform.height),
                            o = Math.ceil(t.transform.zoom),
                            a = t.getBounds()._sw.lng + "," + t.getBounds()._sw.lat + "," + t.getBounds()._ne.lng + "," + t.getBounds()._ne.lat;
                        this.options.url = this.wmsUrl.replace("{bounds}", a).replace("{width}", e.toString()).replace("{height}", i.toString()).replace("{z}", o.toString()), this.coordinates = [t.getBounds().getNorthWest().toArray(), t.getBounds().getNorthEast().toArray(), t.getBounds().getSouthEast().toArray(), t.getBounds().getSouthWest().toArray()], this.setCoordinates(this.coordinates), this.map.on("moveend", this._moveFn.bind(this));
                    }
                    this.load();
                }, i.prototype.setCoordinates = function (e) {
                    var i = this;
                    this.coordinates = e;
                    var o = e.map((this._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate).fromLngLat);
                    this.tileID = function (e) {
                        for (var i = 1 / 0, o = 1 / 0, a = -1 / 0, r = -1 / 0, n = 0, s = e; n < s.length; n += 1) {
                            var l = s[n];
                            i = Math.min(i, l.x), o = Math.min(o, l.y), a = Math.max(a, l.x), r = Math.max(r, l.y);
                        }
                        var c = Math.max(a - i, r - o),
                            u = Math.max(0, Math.floor(-Math.log(c) / Math.LN2)),
                            h = Math.pow(2, u);
                        return new t.CanonicalTileID(u, Math.floor((i + a) / 2 * h), Math.floor((o + r) / 2 * h))
                    }(o), this.minzoom = this.maxzoom = this.tileID.z;
                    var a = o.map((function (t) {
                        return i.tileID.getTilePoint(t)._round()
                    }));
                    return this._boundsArray = new t.StructArrayLayout4i8, this._boundsArray.emplaceBack(a[0].x, a[0].y, 0, 0), this._boundsArray.emplaceBack(a[1].x, a[1].y, t.EXTENT, 0), this._boundsArray.emplaceBack(a[3].x, a[3].y, 0, t.EXTENT), this._boundsArray.emplaceBack(a[2].x, a[2].y, t.EXTENT, t.EXTENT), this.boundsBuffer && (this.boundsBuffer.destroy(), delete this.boundsBuffer), this.fire(new t.Event("data", {
                        dataType: "source",
                        sourceDataType: "content"
                    })), this
                }, i.prototype.prepare = function () {
                    if (0 !== Object.keys(this.tiles).length && this.image) {
                        var e = this.map.painter.context,
                            i = e.gl;
                        for (var o in this.boundsBuffer || (this.boundsBuffer = e.createVertexBuffer(this._boundsArray, H.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture || (this.texture = new t.Texture(e, this.image, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE)), this.tiles) {
                            var a = this.tiles[o];
                            "loaded" !== a.state && (a.state = "loaded", a.texture = this.texture);
                        }
                    }
                }, i.prototype.loadTile = function (t, e) {
                    this.tileID && this.tileID.equals(t.tileID.canonical) ? (this.tiles[String(t.tileID.wrap)] = t, t.buckets = {}, e(null)) : (t.state = "errored", e(null));
                }, i.prototype.serialize = function () {
                    return {
                        type: "image",
                        url: this.options.url,
                        coordinates: this.coordinates,
                        wms: this.wms
                    }
                }, i.prototype.hasTransition = function () {
                    return !1
                }, i
            }(t.Evented),
            Y = function (e) {
                function i(t, i, o, a, r) {
                    e.call(this, t, i, o, a, r), this.roundZoom = !0, this.type = "video", this.options = i;
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.load = function () {
                    var e = this;
                    this._loaded = !1;
                    var i = this.options;
                    this.urls = [];
                    for (var o = 0, a = i.urls; o < a.length; o += 1) this.urls.push(this.map._requestManager.transformRequest(a[o], t.ResourceType.Source).url);
                    t.getVideo(this.urls, (function (i, o) {
                        e._loaded = !0, i ? e.fire(new t.ErrorEvent(i)) : o && (e.video = o, e.video.loop = !0, e.video.addEventListener("playing", (function () {
                            e.map.triggerRepaint();
                        })), e.map && e.video.play(), e._finishLoading());
                    }));
                }, i.prototype.pause = function () {
                    this.video && this.video.pause();
                }, i.prototype.play = function () {
                    this.video && this.video.play();
                }, i.prototype.seek = function (e) {
                    if (this.video) {
                        var i = this.video.seekable;
                        e < i.start(0) || e > i.end(0) ? this.fire(new t.ErrorEvent(new t.ValidationError("sources." + this.id, null, "Playback for this video can be set only between the " + i.start(0) + " and " + i.end(0) + "-second mark."))) : this.video.currentTime = e;
                    }
                }, i.prototype.getVideo = function () {
                    return this.video
                }, i.prototype.onAdd = function (t) {
                    this.map || (this.map = t, this.load(), this.video && (this.video.play(), this.setCoordinates(this.coordinates)));
                }, i.prototype.prepare = function () {
                    if (!(0 === Object.keys(this.tiles).length || this.video.readyState < 2)) {
                        var e = this.map.painter.context,
                            i = e.gl;
                        for (var o in this.boundsBuffer || (this.boundsBuffer = e.createVertexBuffer(this._boundsArray, H.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? this.video.paused || (this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE), i.texSubImage2D(i.TEXTURE_2D, 0, 0, 0, i.RGBA, i.UNSIGNED_BYTE, this.video)) : (this.texture = new t.Texture(e, this.video, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE)), this.tiles) {
                            var a = this.tiles[o];
                            "loaded" !== a.state && (a.state = "loaded", a.texture = this.texture);
                        }
                    }
                }, i.prototype.serialize = function () {
                    return {
                        type: "video",
                        urls: this.urls,
                        coordinates: this.coordinates
                    }
                }, i.prototype.hasTransition = function () {
                    return this.video && !this.video.paused
                }, i
            }(K),
            J = function (e) {
                function i(i, o, a, r, n) {
                    e.call(this, i, o, a, r, n), o.coordinates ? Array.isArray(o.coordinates) && 4 === o.coordinates.length && !o.coordinates.some((function (t) {
                        return !Array.isArray(t) || 2 !== t.length || t.some((function (t) {
                            return "number" != typeof t
                        }))
                    })) || this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i, null, '"coordinates" property must be an array of 4 longitude/latitude array pairs'))) : this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i, null, 'missing required property "coordinates"'))), o.animate && "boolean" != typeof o.animate && this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i, null, 'optional "animate" property must be a boolean value'))), o.canvas ? "string" == typeof o.canvas || o.canvas instanceof t.window.HTMLCanvasElement || this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i, null, '"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : this.fire(new t.ErrorEvent(new t.ValidationError("sources." + i, null, 'missing required property "canvas"'))), this.options = o, this.animate = void 0 === o.animate || o.animate;
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.load = function () {
                    this._loaded = !0, this.canvas || (this.canvas = this.options.canvas instanceof t.window.HTMLCanvasElement ? this.options.canvas : t.window.document.getElementById(this.options.canvas)), this.width = this.canvas.width, this.height = this.canvas.height, this._hasInvalidDimensions() ? this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))) : (this.play = function () {
                        this._playing = !0, this.map.triggerRepaint();
                    }, this.pause = function () {
                        this._playing && (this.prepare(), this._playing = !1);
                    }, this._finishLoading());
                }, i.prototype.getCanvas = function () {
                    return this.canvas
                }, i.prototype.onAdd = function (t) {
                    this.map = t, this.load(), this.canvas && this.animate && this.play();
                }, i.prototype.onRemove = function () {
                    this.pause();
                }, i.prototype.prepare = function () {
                    var e = !1;
                    if (this.canvas.width !== this.width && (this.width = this.canvas.width, e = !0), this.canvas.height !== this.height && (this.height = this.canvas.height, e = !0), !this._hasInvalidDimensions() && 0 !== Object.keys(this.tiles).length) {
                        var i = this.map.painter.context,
                            o = i.gl;
                        for (var a in this.boundsBuffer || (this.boundsBuffer = i.createVertexBuffer(this._boundsArray, H.members)), this.boundsSegments || (this.boundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2)), this.texture ? (e || this._playing) && this.texture.update(this.canvas, {
                                premultiply: !0
                            }) : this.texture = new t.Texture(i, this.canvas, o.RGBA, {
                                premultiply: !0
                            }), this.tiles) {
                            var r = this.tiles[a];
                            "loaded" !== r.state && (r.state = "loaded", r.texture = this.texture);
                        }
                    }
                }, i.prototype.serialize = function () {
                    return {
                        type: "canvas",
                        coordinates: this.coordinates
                    }
                }, i.prototype.hasTransition = function () {
                    return this._playing
                }, i.prototype._hasInvalidDimensions = function () {
                    for (var t = 0, e = [this.canvas.width, this.canvas.height]; t < e.length; t += 1) {
                        var i = e[t];
                        if (isNaN(i) || i <= 0) return !0
                    }
                    return !1
                }, i
            }(K),
            Q = {
                vector: V,
                raster: G,
                "raster-dem": W,
                geojson: X,
                video: Y,
                image: K,
                canvas: J
            };

        function $(e, i) {
            var o = t.identity([]);
            return t.translate(o, o, [1, 1, 0]), t.scale(o, o, [.5 * e.width, .5 * e.height, 1]), t.multiply(o, o, e.calculatePosMatrix(i.toUnwrapped()))
        }

        function tt(t, e, i, o, a, r) {
            var n = function (t, e, i) {
                    if (t)
                        for (var o = 0, a = t; o < a.length; o += 1) {
                            var r = e[a[o]];
                            if (r && r.source === i && "fill-extrusion" === r.type) return !0
                        } else
                            for (var n in e) {
                                var s = e[n];
                                if (s.source === i && "fill-extrusion" === s.type) return !0
                            }
                    return !1
                }(a && a.layers, e, t.id),
                s = r.maxPitchScaleFactor(),
                l = t.tilesIn(o, s, n);
            l.sort(et);
            for (var c = [], u = 0, h = l; u < h.length; u += 1) {
                var p = h[u];
                c.push({
                    wrappedTileID: p.tileID.wrapped().key,
                    queryResults: p.tile.queryRenderedFeatures(e, i, t._state, p.queryGeometry, p.cameraQueryGeometry, p.scale, a, r, s, $(t.transform, p.tileID))
                });
            }
            var _ = function (t) {
                for (var e = {}, i = {}, o = 0, a = t; o < a.length; o += 1) {
                    var r = a[o],
                        n = r.queryResults,
                        s = r.wrappedTileID,
                        l = i[s] = i[s] || {};
                    for (var c in n)
                        for (var u = n[c], h = l[c] = l[c] || {}, p = e[c] = e[c] || [], _ = 0, m = u; _ < m.length; _ += 1) {
                            var d = m[_];
                            h[d.featureIndex] || (h[d.featureIndex] = !0, p.push(d));
                        }
                }
                return e
            }(c);
            for (var m in _) _[m].forEach((function (e) {
                var i = e.feature,
                    o = t.getFeatureState(i.layer["source-layer"], i.id);
                i.source = i.layer.source, i.layer["source-layer"] && (i.sourceLayer = i.layer["source-layer"]), i.state = o;
            }));
            return _
        }

        function et(t, e) {
            var i = t.tileID,
                o = e.tileID;
            return i.overscaledZ - o.overscaledZ || i.canonical.y - o.canonical.y || i.wrap - o.wrap || i.canonical.x - o.canonical.x
        }
        var it = function (t, e) {
            this.max = t, this.onRemove = e, this.reset();
        };
        it.prototype.reset = function () {
            for (var t in this.data)
                for (var e = 0, i = this.data[t]; e < i.length; e += 1) {
                    var o = i[e];
                    o.timeout && clearTimeout(o.timeout), this.onRemove(o.value);
                }
            return this.data = {}, this.order = [], this
        }, it.prototype.add = function (t, e, i) {
            var o = this,
                a = t.wrapped().key;
            void 0 === this.data[a] && (this.data[a] = []);
            var r = {
                value: e,
                timeout: void 0
            };
            if (void 0 !== i && (r.timeout = setTimeout((function () {
                    o.remove(t, r);
                }), i)), this.data[a].push(r), this.order.push(a), this.order.length > this.max) {
                var n = this._getAndRemoveByKey(this.order[0]);
                n && this.onRemove(n);
            }
            return this
        }, it.prototype.has = function (t) {
            return t.wrapped().key in this.data
        }, it.prototype.getAndRemove = function (t) {
            return this.has(t) ? this._getAndRemoveByKey(t.wrapped().key) : null
        }, it.prototype._getAndRemoveByKey = function (t) {
            var e = this.data[t].shift();
            return e.timeout && clearTimeout(e.timeout), 0 === this.data[t].length && delete this.data[t], this.order.splice(this.order.indexOf(t), 1), e.value
        }, it.prototype.getByKey = function (t) {
            var e = this.data[t];
            return e ? e[0].value : null
        }, it.prototype.get = function (t) {
            return this.has(t) ? this.data[t.wrapped().key][0].value : null
        }, it.prototype.remove = function (t, e) {
            if (!this.has(t)) return this;
            var i = t.wrapped().key,
                o = void 0 === e ? 0 : this.data[i].indexOf(e),
                a = this.data[i][o];
            return this.data[i].splice(o, 1), a.timeout && clearTimeout(a.timeout), 0 === this.data[i].length && delete this.data[i], this.onRemove(a.value), this.order.splice(this.order.indexOf(i), 1), this
        }, it.prototype.setMaxSize = function (t) {
            for (this.max = t; this.order.length > this.max;) {
                var e = this._getAndRemoveByKey(this.order[0]);
                e && this.onRemove(e);
            }
            return this
        }, it.prototype.filter = function (t) {
            var e = [];
            for (var i in this.data)
                for (var o = 0, a = this.data[i]; o < a.length; o += 1) {
                    var r = a[o];
                    t(r.value) || e.push(r);
                }
            for (var n = 0, s = e; n < s.length; n += 1) {
                var l = s[n];
                this.remove(l.value.tileID, l);
            }
        };
        var ot = function (t, e, i) {
            this.context = t;
            var o = t.gl;
            this.buffer = o.createBuffer(), this.dynamicDraw = Boolean(i), this.context.unbindVAO(), t.bindElementBuffer.set(this.buffer), o.bufferData(o.ELEMENT_ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? o.DYNAMIC_DRAW : o.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer;
        };
        ot.prototype.bind = function () {
            this.context.bindElementBuffer.set(this.buffer);
        }, ot.prototype.updateData = function (t) {
            var e = this.context.gl;
            this.context.unbindVAO(), this.bind(), e.bufferSubData(e.ELEMENT_ARRAY_BUFFER, 0, t.arrayBuffer);
        }, ot.prototype.destroy = function () {
            this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        };
        var at = {
                Int8: "BYTE",
                Uint8: "UNSIGNED_BYTE",
                Int16: "SHORT",
                Uint16: "UNSIGNED_SHORT",
                Int32: "INT",
                Uint32: "UNSIGNED_INT",
                Float32: "FLOAT"
            },
            rt = function (t, e, i, o) {
                this.length = e.length, this.attributes = i, this.itemSize = e.bytesPerElement, this.dynamicDraw = o, this.context = t;
                var a = t.gl;
                this.buffer = a.createBuffer(), t.bindVertexBuffer.set(this.buffer), a.bufferData(a.ARRAY_BUFFER, e.arrayBuffer, this.dynamicDraw ? a.DYNAMIC_DRAW : a.STATIC_DRAW), this.dynamicDraw || delete e.arrayBuffer;
            };
        rt.prototype.bind = function () {
            this.context.bindVertexBuffer.set(this.buffer);
        }, rt.prototype.updateData = function (t) {
            var e = this.context.gl;
            this.bind(), e.bufferSubData(e.ARRAY_BUFFER, 0, t.arrayBuffer);
        }, rt.prototype.enableAttributes = function (t, e) {
            for (var i = 0; i < this.attributes.length; i++) {
                var o = e.attributes[this.attributes[i].name];
                void 0 !== o && t.enableVertexAttribArray(o);
            }
        }, rt.prototype.setVertexAttribPointers = function (t, e, i) {
            for (var o = 0; o < this.attributes.length; o++) {
                var a = this.attributes[o],
                    r = e.attributes[a.name];
                void 0 !== r && t.vertexAttribPointer(r, a.components, t[at[a.type]], !1, this.itemSize, a.offset + this.itemSize * (i || 0));
            }
        }, rt.prototype.destroy = function () {
            this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);
        };
        var nt = function (t) {
            this.gl = t.gl, this.default = this.getDefault(), this.current = this.default, this.dirty = !1;
        };
        nt.prototype.get = function () {
            return this.current
        }, nt.prototype.set = function (t) {}, nt.prototype.getDefault = function () {
            return this.default
        }, nt.prototype.setDefault = function () {
            this.set(this.default);
        };
        var st = function (e) {
                function i() {
                    e.apply(this, arguments);
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.getDefault = function () {
                    return t.Color.transparent
                }, i.prototype.set = function (t) {
                    var e = this.current;
                    (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.clearColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1);
                }, i
            }(nt),
            lt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return 1
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.clearDepth(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            ct = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return 0
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.clearStencil(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            ut = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return [!0, !0, !0, !0]
                }, e.prototype.set = function (t) {
                    var e = this.current;
                    (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.colorMask(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            ht = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return !0
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.depthMask(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            pt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return 255
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.stencilMask(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            _t = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return {
                        func: this.gl.ALWAYS,
                        ref: 0,
                        mask: 255
                    }
                }, e.prototype.set = function (t) {
                    var e = this.current;
                    (t.func !== e.func || t.ref !== e.ref || t.mask !== e.mask || this.dirty) && (this.gl.stencilFunc(t.func, t.ref, t.mask), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            mt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    var t = this.gl;
                    return [t.KEEP, t.KEEP, t.KEEP]
                }, e.prototype.set = function (t) {
                    var e = this.current;
                    (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || this.dirty) && (this.gl.stencilOp(t[0], t[1], t[2]), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            dt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return !1
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        t ? e.enable(e.STENCIL_TEST) : e.disable(e.STENCIL_TEST), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            ft = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return [0, 1]
                }, e.prototype.set = function (t) {
                    var e = this.current;
                    (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.depthRange(t[0], t[1]), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            gt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return !1
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        t ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            vt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return this.gl.LESS
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.depthFunc(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            yt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return !1
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        t ? e.enable(e.BLEND) : e.disable(e.BLEND), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            xt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    var t = this.gl;
                    return [t.ONE, t.ZERO]
                }, e.prototype.set = function (t) {
                    var e = this.current;
                    (t[0] !== e[0] || t[1] !== e[1] || this.dirty) && (this.gl.blendFunc(t[0], t[1]), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            wt = function (e) {
                function i() {
                    e.apply(this, arguments);
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.getDefault = function () {
                    return t.Color.transparent
                }, i.prototype.set = function (t) {
                    var e = this.current;
                    (t.r !== e.r || t.g !== e.g || t.b !== e.b || t.a !== e.a || this.dirty) && (this.gl.blendColor(t.r, t.g, t.b, t.a), this.current = t, this.dirty = !1);
                }, i
            }(nt),
            bt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return this.gl.FUNC_ADD
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.blendEquation(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            Tt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return !1
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        t ? e.enable(e.CULL_FACE) : e.disable(e.CULL_FACE), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            Et = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return this.gl.BACK
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.cullFace(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            St = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return this.gl.CCW
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.frontFace(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            It = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.useProgram(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            zt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return this.gl.TEXTURE0
                }, e.prototype.set = function (t) {
                    (t !== this.current || this.dirty) && (this.gl.activeTexture(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            Ct = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    var t = this.gl;
                    return [0, 0, t.drawingBufferWidth, t.drawingBufferHeight]
                }, e.prototype.set = function (t) {
                    var e = this.current;
                    (t[0] !== e[0] || t[1] !== e[1] || t[2] !== e[2] || t[3] !== e[3] || this.dirty) && (this.gl.viewport(t[0], t[1], t[2], t[3]), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            Pt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        e.bindFramebuffer(e.FRAMEBUFFER, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            Lt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        e.bindRenderbuffer(e.RENDERBUFFER, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            At = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        e.bindTexture(e.TEXTURE_2D, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            Mt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        e.bindBuffer(e.ARRAY_BUFFER, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            Dt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e.prototype.set = function (t) {
                    var e = this.gl;
                    e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, t), this.current = t, this.dirty = !1;
                }, e
            }(nt),
            Rt = function (t) {
                function e(e) {
                    t.call(this, e), this.vao = e.extVertexArrayObject;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e.prototype.set = function (t) {
                    this.vao && (t !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(t), this.current = t, this.dirty = !1);
                }, e
            }(nt),
            kt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return 4
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        e.pixelStorei(e.UNPACK_ALIGNMENT, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            Ot = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return !1
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            Bt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return !1
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        var e = this.gl;
                        e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(nt),
            Ut = function (t) {
                function e(e, i) {
                    t.call(this, e), this.context = e, this.parent = i;
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.getDefault = function () {
                    return null
                }, e
            }(nt),
            Ft = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.setDirty = function () {
                    this.dirty = !0;
                }, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        this.context.bindFramebuffer.set(this.parent);
                        var e = this.gl;
                        e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0, e.TEXTURE_2D, t, 0), this.current = t, this.dirty = !1;
                    }
                }, e
            }(Ut),
            Nt = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.set = function (t) {
                    if (t !== this.current || this.dirty) {
                        this.context.bindFramebuffer.set(this.parent);
                        var e = this.gl;
                        e.framebufferRenderbuffer(e.FRAMEBUFFER, e.DEPTH_ATTACHMENT, e.RENDERBUFFER, t), this.current = t, this.dirty = !1;
                    }
                }, e
            }(Ut),
            qt = function (t, e, i, o) {
                this.context = t, this.width = e, this.height = i;
                var a = this.framebuffer = t.gl.createFramebuffer();
                this.colorAttachment = new Ft(t, a), o && (this.depthAttachment = new Nt(t, a));
            };
        qt.prototype.destroy = function () {
            var t = this.context.gl,
                e = this.colorAttachment.get();
            if (e && t.deleteTexture(e), this.depthAttachment) {
                var i = this.depthAttachment.get();
                i && t.deleteRenderbuffer(i);
            }
            t.deleteFramebuffer(this.framebuffer);
        };
        var jt = function (t, e, i) {
            this.func = t, this.mask = e, this.range = i;
        };
        jt.ReadOnly = !1, jt.ReadWrite = !0, jt.disabled = new jt(519, jt.ReadOnly, [0, 1]);
        var Zt = function (t, e, i, o, a, r) {
            this.test = t, this.ref = e, this.mask = i, this.fail = o, this.depthFail = a, this.pass = r;
        };
        Zt.disabled = new Zt({
            func: 519,
            mask: 0
        }, 0, 0, 7680, 7680, 7680);
        var Vt = function (t, e, i) {
            this.blendFunction = t, this.blendColor = e, this.mask = i;
        };
        Vt.disabled = new Vt(Vt.Replace = [1, 0], t.Color.transparent, [!1, !1, !1, !1]), Vt.unblended = new Vt(Vt.Replace, t.Color.transparent, [!0, !0, !0, !0]), Vt.alphaBlended = new Vt([1, 771], t.Color.transparent, [!0, !0, !0, !0]);
        var Gt = function (t, e, i) {
            this.enable = t, this.mode = e, this.frontFace = i;
        };
        Gt.disabled = new Gt(!1, 1029, 2305), Gt.backCCW = new Gt(!0, 1029, 2305);
        var Wt = function (t) {
            this.gl = t, this.extVertexArrayObject = this.gl.getExtension("OES_vertex_array_object"), this.clearColor = new st(this), this.clearDepth = new lt(this), this.clearStencil = new ct(this), this.colorMask = new ut(this), this.depthMask = new ht(this), this.stencilMask = new pt(this), this.stencilFunc = new _t(this), this.stencilOp = new mt(this), this.stencilTest = new dt(this), this.depthRange = new ft(this), this.depthTest = new gt(this), this.depthFunc = new vt(this), this.blend = new yt(this), this.blendFunc = new xt(this), this.blendColor = new wt(this), this.blendEquation = new bt(this), this.cullFace = new Tt(this), this.cullFaceSide = new Et(this), this.frontFace = new St(this), this.program = new It(this), this.activeTexture = new zt(this), this.viewport = new Ct(this), this.bindFramebuffer = new Pt(this), this.bindRenderbuffer = new Lt(this), this.bindTexture = new At(this), this.bindVertexBuffer = new Mt(this), this.bindElementBuffer = new Dt(this), this.bindVertexArrayOES = this.extVertexArrayObject && new Rt(this), this.pixelStoreUnpack = new kt(this), this.pixelStoreUnpackPremultiplyAlpha = new Ot(this), this.pixelStoreUnpackFlipY = new Bt(this), this.extTextureFilterAnisotropic = t.getExtension("EXT_texture_filter_anisotropic") || t.getExtension("MOZ_EXT_texture_filter_anisotropic") || t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"), this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)), this.extTextureHalfFloat = t.getExtension("OES_texture_half_float"), this.extTextureHalfFloat && (t.getExtension("OES_texture_half_float_linear"), this.extRenderToTextureHalfFloat = t.getExtension("EXT_color_buffer_half_float")), this.extTimerQuery = t.getExtension("EXT_disjoint_timer_query");
        };
        Wt.prototype.setDefault = function () {
            this.unbindVAO(), this.clearColor.setDefault(), this.clearDepth.setDefault(), this.clearStencil.setDefault(), this.colorMask.setDefault(), this.depthMask.setDefault(), this.stencilMask.setDefault(), this.stencilFunc.setDefault(), this.stencilOp.setDefault(), this.stencilTest.setDefault(), this.depthRange.setDefault(), this.depthTest.setDefault(), this.depthFunc.setDefault(), this.blend.setDefault(), this.blendFunc.setDefault(), this.blendColor.setDefault(), this.blendEquation.setDefault(), this.cullFace.setDefault(), this.cullFaceSide.setDefault(), this.frontFace.setDefault(), this.program.setDefault(), this.activeTexture.setDefault(), this.bindFramebuffer.setDefault(), this.pixelStoreUnpack.setDefault(), this.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.pixelStoreUnpackFlipY.setDefault();
        }, Wt.prototype.setDirty = function () {
            this.clearColor.dirty = !0, this.clearDepth.dirty = !0, this.clearStencil.dirty = !0, this.colorMask.dirty = !0, this.depthMask.dirty = !0, this.stencilMask.dirty = !0, this.stencilFunc.dirty = !0, this.stencilOp.dirty = !0, this.stencilTest.dirty = !0, this.depthRange.dirty = !0, this.depthTest.dirty = !0, this.depthFunc.dirty = !0, this.blend.dirty = !0, this.blendFunc.dirty = !0, this.blendColor.dirty = !0, this.blendEquation.dirty = !0, this.cullFace.dirty = !0, this.cullFaceSide.dirty = !0, this.frontFace.dirty = !0, this.program.dirty = !0, this.activeTexture.dirty = !0, this.viewport.dirty = !0, this.bindFramebuffer.dirty = !0, this.bindRenderbuffer.dirty = !0, this.bindTexture.dirty = !0, this.bindVertexBuffer.dirty = !0, this.bindElementBuffer.dirty = !0, this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = !0), this.pixelStoreUnpack.dirty = !0, this.pixelStoreUnpackPremultiplyAlpha.dirty = !0, this.pixelStoreUnpackFlipY.dirty = !0;
        }, Wt.prototype.createIndexBuffer = function (t, e) {
            return new ot(this, t, e)
        }, Wt.prototype.createVertexBuffer = function (t, e, i) {
            return new rt(this, t, e, i)
        }, Wt.prototype.createRenderbuffer = function (t, e, i) {
            var o = this.gl,
                a = o.createRenderbuffer();
            return this.bindRenderbuffer.set(a), o.renderbufferStorage(o.RENDERBUFFER, t, e, i), this.bindRenderbuffer.set(null), a
        }, Wt.prototype.createFramebuffer = function (t, e, i) {
            return new qt(this, t, e, i)
        }, Wt.prototype.clear = function (t) {
            var e = t.color,
                i = t.depth,
                o = this.gl,
                a = 0;
            e && (a |= o.COLOR_BUFFER_BIT, this.clearColor.set(e), this.colorMask.set([!0, !0, !0, !0])), void 0 !== i && (a |= o.DEPTH_BUFFER_BIT, this.depthRange.set([0, 1]), this.clearDepth.set(i), this.depthMask.set(!0)), o.clear(a);
        }, Wt.prototype.setCullFace = function (t) {
            !1 === t.enable ? this.cullFace.set(!1) : (this.cullFace.set(!0), this.cullFaceSide.set(t.mode), this.frontFace.set(t.frontFace));
        }, Wt.prototype.setDepthMode = function (t) {
            t.func !== this.gl.ALWAYS || t.mask ? (this.depthTest.set(!0), this.depthFunc.set(t.func), this.depthMask.set(t.mask), this.depthRange.set(t.range)) : this.depthTest.set(!1);
        }, Wt.prototype.setStencilMode = function (t) {
            t.test.func !== this.gl.ALWAYS || t.mask ? (this.stencilTest.set(!0), this.stencilMask.set(t.mask), this.stencilOp.set([t.fail, t.depthFail, t.pass]), this.stencilFunc.set({
                func: t.test.func,
                ref: t.ref,
                mask: t.test.mask
            })) : this.stencilTest.set(!1);
        }, Wt.prototype.setColorMode = function (e) {
            t.deepEqual(e.blendFunction, Vt.Replace) ? this.blend.set(!1) : (this.blend.set(!0), this.blendFunc.set(e.blendFunction), this.blendColor.set(e.blendColor)), this.colorMask.set(e.mask);
        }, Wt.prototype.unbindVAO = function () {
            this.extVertexArrayObject && this.bindVertexArrayOES.set(null);
        };
        var Xt = function (e) {
            function i(i, o, a, r) {
                var n = this;
                e.call(this), this.id = i, this.dispatcher = a, this._isLatLon = r, this.on("data", (function (t) {
                    "source" === t.dataType && "metadata" === t.sourceDataType && (n._sourceLoaded = !0), n._sourceLoaded && !n._paused && "source" === t.dataType && "content" === t.sourceDataType && (n.reload(), n.transform && n.update(n.transform));
                })), this.on("error", (function () {
                    n._sourceErrored = !0;
                })), this._source = function (e, i, o, a, r) {
                    var n = new Q[i.type](e, i, o, a, r);
                    if (n.id !== e) throw new Error("Expected Source id to be " + e + " instead of " + n.id);
                    return t.bindAll(["load", "abort", "unload", "serialize", "prepare"], n), n
                }(i, o, a, this, this._isLatLon), this._tiles = {}, this._cache = new it(0, this._unloadTile.bind(this)), this._timers = {}, this._cacheTimers = {}, this._maxTileCacheSize = null, this._loadedParentTiles = {}, this._coveredTiles = {}, this._state = new t.SourceFeatureState;
            }
            return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.onAdd = function (t) {
                this.map = t, this._maxTileCacheSize = t ? t._maxTileCacheSize : null, this._source && this._source.onAdd && this._source.onAdd(t);
            }, i.prototype.onRemove = function (t) {
                this._source && this._source.onRemove && this._source.onRemove(t);
            }, i.prototype.loaded = function () {
                if (this._sourceErrored) return !0;
                if (!this._sourceLoaded) return !1;
                if (!this._source.loaded()) return !1;
                for (var t in this._tiles) {
                    var e = this._tiles[t];
                    if ("loaded" !== e.state && "errored" !== e.state) return !1
                }
                return !0
            }, i.prototype.getSource = function () {
                return this._source
            }, i.prototype.pause = function () {
                this._paused = !0;
            }, i.prototype.resume = function () {
                if (this._paused) {
                    var t = this._shouldReloadOnResume;
                    this._paused = !1, this._shouldReloadOnResume = !1, t && this.reload(), this.transform && this.update(this.transform);
                }
            }, i.prototype._loadTile = function (t, e) {
                return this._source.loadTile(t, e)
            }, i.prototype._unloadTile = function (t) {
                if (this._source.unloadTile) return this._source.unloadTile(t, (function () {}))
            }, i.prototype._abortTile = function (t) {
                if (this._source.abortTile) return this._source.abortTile(t, (function () {}))
            }, i.prototype.serialize = function () {
                return this._source.serialize()
            }, i.prototype.prepare = function (t) {
                for (var e in this._source.prepare && this._source.prepare(), this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null), this._tiles) {
                    var i = this._tiles[e];
                    i.upload(t), i.prepare(this.map.style.imageManager);
                }
            }, i.prototype.getIds = function () {
                return t.values(this._tiles).map((function (t) {
                    return t.tileID
                })).sort(Ht).map((function (t) {
                    return t.key
                }))
            }, i.prototype.getRenderableIds = function (e) {
                var i = this,
                    o = [];
                for (var a in this._tiles) this._isIdRenderable(a, e) && o.push(this._tiles[a]);
                return e ? o.sort((function (e, o) {
                    var a = e.tileID,
                        r = o.tileID,
                        n = new t.Point(a.canonical.x, a.canonical.y)._rotate(i.transform.angle),
                        s = new t.Point(r.canonical.x, r.canonical.y)._rotate(i.transform.angle);
                    return a.overscaledZ - r.overscaledZ || s.y - n.y || s.x - n.x
                })).map((function (t) {
                    return t.tileID.key
                })) : o.map((function (t) {
                    return t.tileID
                })).sort(Ht).map((function (t) {
                    return t.key
                }))
            }, i.prototype.hasRenderableParent = function (t) {
                var e = this.findLoadedParent(t, 0);
                return !!e && this._isIdRenderable(e.tileID.key)
            }, i.prototype._isIdRenderable = function (t, e) {
                return this._tiles[t] && this._tiles[t].hasData() && !this._coveredTiles[t] && (e || !this._tiles[t].holdingForFade())
            }, i.prototype.reload = function () {
                if (this._paused) this._shouldReloadOnResume = !0;
                else if (this._cache.reset(), this._source._options && this._source._options.traffic)
                    for (var t in this._tiles) "errored" !== this._tiles[t].state && this._reloadTile(t, "expired");
                else
                    for (var e in this._tiles) "errored" !== this._tiles[e].state && this._reloadTile(e, "reloading");
            }, i.prototype._reloadTile = function (t, e) {
                var i = this._tiles[t];
                i && ("loading" !== i.state && (i.state = e), this._loadTile(i, this._tileLoaded.bind(this, i, t, e)));
            }, i.prototype._tileLoaded = function (e, i, o, a) {
                if (a) return e.state = "errored", void(404 !== a.status ? this._source.fire(new t.ErrorEvent(a, {
                    tile: e
                })) : this.update(this.transform));
                e.timeAdded = t.browser.now(), "expired" === o && (e.refreshedUponExpiration = !0), this._setTileReloadTimer(i, e), "raster-dem" === this.getSource().type && e.dem && this._backfillDEM(e), this._state.initializeTileState(e, this.map ? this.map.painter : null), this._source.fire(new t.Event("data", {
                    dataType: "source",
                    tile: e,
                    coord: e.tileID
                }));
            }, i.prototype._backfillDEM = function (t) {
                for (var e = this.getRenderableIds(), i = 0; i < e.length; i++) {
                    var o = e[i];
                    if (t.neighboringTiles && t.neighboringTiles[o]) {
                        var a = this.getTileByID(o);
                        r(t, a), r(a, t);
                    }
                }

                function r(t, e) {
                    t.needsHillshadePrepare = !0;
                    var i = e.tileID.canonical.x - t.tileID.canonical.x,
                        o = e.tileID.canonical.y - t.tileID.canonical.y,
                        a = Math.pow(2, t.tileID.canonical.z),
                        r = e.tileID.key;
                    0 === i && 0 === o || Math.abs(o) > 1 || (Math.abs(i) > 1 && (1 === Math.abs(i + a) ? i += a : 1 === Math.abs(i - a) && (i -= a)), e.dem && t.dem && (t.dem.backfillBorder(e.dem, i, o), t.neighboringTiles && t.neighboringTiles[r] && (t.neighboringTiles[r].backfilled = !0)));
                }
            }, i.prototype.getTile = function (t) {
                return this.getTileByID(t.key)
            }, i.prototype.getTileByID = function (t) {
                return this._tiles[t]
            }, i.prototype._retainLoadedChildren = function (t, e, i, o) {
                for (var a in this._tiles) {
                    var r = this._tiles[a];
                    if (!(o[a] || !r.hasData() || r.tileID.overscaledZ <= e || r.tileID.overscaledZ > i)) {
                        for (var n = r.tileID; r && r.tileID.overscaledZ > e + 1;) {
                            var s = r.tileID.scaledTo(r.tileID.overscaledZ - 1);
                            (r = this._tiles[s.key]) && r.hasData() && (n = s);
                        }
                        for (var l = n; l.overscaledZ > e;)
                            if (t[(l = l.scaledTo(l.overscaledZ - 1)).key]) {
                                o[n.key] = n;
                                break
                            }
                    }
                }
            }, i.prototype.findLoadedParent = function (t, e) {
                if (t.key in this._loadedParentTiles) {
                    var i = this._loadedParentTiles[t.key];
                    return i && i.tileID.overscaledZ >= e ? i : null
                }
                for (var o = t.overscaledZ - 1; o >= e; o--) {
                    var a = t.scaledTo(o),
                        r = this._getLoadedTile(a);
                    if (r) return r
                }
            }, i.prototype._getLoadedTile = function (t) {
                var e = this._tiles[t.key];
                return e && e.hasData() ? e : this._cache.getByKey(t.wrapped().key)
            }, i.prototype.updateCacheSize = function (t) {
                var e = Math.ceil(t.width / this._source.tileSize) + 1,
                    i = Math.ceil(t.height / this._source.tileSize) + 1,
                    o = Math.floor(e * i * 5),
                    a = "number" == typeof this._maxTileCacheSize ? Math.min(this._maxTileCacheSize, o) : o;
                this._cache.setMaxSize(a);
            }, i.prototype.handleWrapJump = function (t) {
                var e = Math.round((t - (void 0 === this._prevLng ? t : this._prevLng)) / 360);
                if (this._prevLng = t, e) {
                    var i = {};
                    for (var o in this._tiles) {
                        var a = this._tiles[o];
                        a.tileID = a.tileID.unwrapTo(a.tileID.wrap + e), i[a.tileID.key] = a;
                    }
                    for (var r in this._tiles = i, this._timers) clearTimeout(this._timers[r]), delete this._timers[r];
                    for (var n in this._tiles) this._setTileReloadTimer(n, this._tiles[n]);
                }
            }, i.prototype.update = function (e) {
                var o = this;
                if (this.transform = e, this._sourceLoaded && !this._paused) {
                    var a;
                    this.updateCacheSize(e), this.handleWrapJump(this.transform.center.lng), this._coveredTiles = {}, this.used ? this._source.tileID ? a = e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function (e) {
                        return new t.OverscaledTileID(e.canonical.z, e.wrap, e.canonical.z, e.canonical.x, e.canonical.y)
                    })) : (a = e.coveringTiles({
                        tileSize: this._source.tileSize,
                        minzoom: this._source.minzoom,
                        maxzoom: this._source.maxzoom,
                        roundZoom: this._source.roundZoom,
                        reparseOverscaled: this._source.reparseOverscaled
                    }), this._source.hasTile && (a = a.filter((function (t) {
                        return o._source.hasTile(t)
                    })))) : a = [];
                    var r = e.coveringZoomLevel(this._source),
                        n = Math.max(r - i.maxOverzooming, this._source.minzoom),
                        s = Math.max(r + i.maxUnderzooming, this._source.minzoom),
                        l = this._updateRetainedTiles(a, r);
                    if (Kt(this._source.type)) {
                        for (var c = {}, u = {}, h = 0, p = Object.keys(l); h < p.length; h += 1) {
                            var _ = p[h],
                                m = l[_],
                                d = this._tiles[_];
                            if (d && !(d.fadeEndTime && d.fadeEndTime <= t.browser.now())) {
                                var f = this.findLoadedParent(m, n);
                                f && (this._addTile(f.tileID), c[f.tileID.key] = f.tileID), u[_] = m;
                            }
                        }
                        for (var g in this._retainLoadedChildren(u, r, s, l), c) l[g] || (this._coveredTiles[g] = !0, l[g] = c[g]);
                    }
                    for (var v in l) this._tiles[v].clearFadeHold();
                    for (var y = 0, x = t.keysDifference(this._tiles, l); y < x.length; y += 1) {
                        var w = x[y],
                            b = this._tiles[w];
                        b.hasSymbolBuckets && !b.holdingForFade() ? b.setHoldDuration(this.map._fadeDuration) : b.hasSymbolBuckets && !b.symbolFadeFinished() || this._removeTile(w);
                    }
                    this._updateLoadedParentTileCache();
                }
            }, i.prototype.releaseSymbolFadeTiles = function () {
                for (var t in this._tiles) this._tiles[t].holdingForFade() && this._removeTile(t);
            }, i.prototype._updateRetainedTiles = function (t, e) {
                for (var o = {}, a = {}, r = Math.max(e - i.maxOverzooming, this._source.minzoom), n = Math.max(e + i.maxUnderzooming, this._source.minzoom), s = {}, l = 0, c = t; l < c.length; l += 1) {
                    var u = c[l],
                        h = this._addTile(u);
                    o[u.key] = u, h.hasData() || e < this._source.maxzoom && (s[u.key] = u);
                }
                this._retainLoadedChildren(s, e, n, o);
                for (var p = 0, _ = t; p < _.length; p += 1) {
                    var m = _[p],
                        d = this._tiles[m.key];
                    if (!d.hasData()) {
                        if (e + 1 > this._source.maxzoom) {
                            var f = m.children(this._source.maxzoom)[0],
                                g = this.getTile(f);
                            if (g && g.hasData()) {
                                o[f.key] = f;
                                continue
                            }
                        } else {
                            var v = m.children(this._source.maxzoom);
                            if (o[v[0].key] && o[v[1].key] && o[v[2].key] && o[v[3].key]) continue
                        }
                        for (var y = d.wasRequested(), x = m.overscaledZ - 1; x >= r; --x) {
                            var w = m.scaledTo(x);
                            if (a[w.key]) break;
                            if (a[w.key] = !0, !(d = this.getTile(w)) && y && (d = this._addTile(w)), d && (o[w.key] = w, y = d.wasRequested(), d.hasData())) break
                        }
                    }
                }
                return o
            }, i.prototype._updateLoadedParentTileCache = function () {
                for (var t in this._loadedParentTiles = {}, this._tiles) {
                    for (var e = [], i = void 0, o = this._tiles[t].tileID; o.overscaledZ > 0;) {
                        if (o.key in this._loadedParentTiles) {
                            i = this._loadedParentTiles[o.key];
                            break
                        }
                        e.push(o.key);
                        var a = o.scaledTo(o.overscaledZ - 1);
                        if (i = this._getLoadedTile(a)) break;
                        o = a;
                    }
                    for (var r = 0, n = e; r < n.length; r += 1) this._loadedParentTiles[n[r]] = i;
                }
            }, i.prototype._addTile = function (e) {
                var i = this._tiles[e.key];
                if (i) return i;
                (i = this._cache.getAndRemove(e)) && (this._setTileReloadTimer(e.key, i), i.tileID = e, this._state.initializeTileState(i, this.map ? this.map.painter : null), this._cacheTimers[e.key] && (clearTimeout(this._cacheTimers[e.key]), delete this._cacheTimers[e.key], this._setTileReloadTimer(e.key, i)));
                var o = Boolean(i);
                return o || (i = new t.Tile(e, this._source.tileSize * e.overscaleFactor()), this._loadTile(i, this._tileLoaded.bind(this, i, e.key, i.state))), i ? (i.uses++, this._tiles[e.key] = i, o || this._source.fire(new t.Event("dataloading", {
                    tile: i,
                    coord: i.tileID,
                    dataType: "source"
                })), i) : null
            }, i.prototype._setTileReloadTimer = function (t, e) {
                var i = this;
                t in this._timers && (clearTimeout(this._timers[t]), delete this._timers[t]);
                var o = e.getExpiryTimeout();
                o && (this._timers[t] = setTimeout((function () {
                    i._reloadTile(t, "expired"), delete i._timers[t];
                }), o));
            }, i.prototype._removeTile = function (t) {
                var e = this._tiles[t];
                e && (e.uses--, delete this._tiles[t], this._timers[t] && (clearTimeout(this._timers[t]), delete this._timers[t]), e.uses > 0 || (e.hasData() && "reloading" !== e.state ? this._cache.add(e.tileID, e, e.getExpiryTimeout()) : (e.aborted = !0, this._abortTile(e), this._unloadTile(e))));
            }, i.prototype.clearTiles = function () {
                for (var t in this._shouldReloadOnResume = !1, this._paused = !1, this._tiles) this._removeTile(t);
                this._cache.reset();
            }, i.prototype.tilesIn = function (e, i, o) {
                var a = this,
                    r = [],
                    n = this.transform;
                if (!n) return r;
                for (var s = o ? n.getCameraQueryGeometry(e) : e, l = e.map((function (t) {
                        return n.pointCoordinate(t)
                    })), c = s.map((function (t) {
                        return n.pointCoordinate(t)
                    })), u = this.getIds(), h = 1 / 0, p = 1 / 0, _ = -1 / 0, m = -1 / 0, d = 0, f = c; d < f.length; d += 1) {
                    var g = f[d];
                    h = Math.min(h, g.x), p = Math.min(p, g.y), _ = Math.max(_, g.x), m = Math.max(m, g.y);
                }
                for (var v = function (e) {
                        var o = a._tiles[u[e]];
                        if (!o.holdingForFade()) {
                            var s = o.tileID,
                                d = Math.pow(2, n.zoom - o.tileID.overscaledZ),
                                f = i * o.queryPadding * t.EXTENT / o.tileSize / d,
                                g = [s.getTilePoint(new(a._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate)(h, p)), s.getTilePoint(new(a._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate)(_, m))];
                            if (g[0].x - f < t.EXTENT && g[0].y - f < t.EXTENT && g[1].x + f >= 0 && g[1].y + f >= 0) {
                                var v = l.map((function (t) {
                                        return s.getTilePoint(t)
                                    })),
                                    y = c.map((function (t) {
                                        return s.getTilePoint(t)
                                    }));
                                r.push({
                                    tile: o,
                                    tileID: s,
                                    queryGeometry: v,
                                    cameraQueryGeometry: y,
                                    scale: d
                                });
                            }
                        }
                    }, y = 0; y < u.length; y++) v(y);
                return r
            }, i.prototype.getVisibleCoordinates = function (t) {
                for (var e = this, i = this.getRenderableIds(t).map((function (t) {
                        return e._tiles[t].tileID
                    })), o = 0, a = i; o < a.length; o += 1) {
                    var r = a[o];
                    r.posMatrix = this.transform.calculatePosMatrix(r.toUnwrapped());
                }
                return i
            }, i.prototype.hasTransition = function () {
                if (this._source.hasTransition()) return !0;
                if (Kt(this._source.type))
                    for (var e in this._tiles) {
                        var i = this._tiles[e];
                        if (void 0 !== i.fadeEndTime && i.fadeEndTime >= t.browser.now()) return !0
                    }
                return !1
            }, i.prototype.setFeatureState = function (t, e, i) {
                this._state.updateState(t = t || "_geojsonTileLayer", e, i);
            }, i.prototype.removeFeatureState = function (t, e, i) {
                this._state.removeFeatureState(t = t || "_geojsonTileLayer", e, i);
            }, i.prototype.getFeatureState = function (t, e) {
                return this._state.getState(t = t || "_geojsonTileLayer", e)
            }, i.prototype.setDependencies = function (t, e, i) {
                var o = this._tiles[t];
                o && o.setDependencies(e, i);
            }, i.prototype.reloadTilesForDependencies = function (t, e) {
                for (var i in this._tiles) this._tiles[i].hasDependency(t, e) && this._reloadTile(i, "reloading");
                this._cache.filter((function (i) {
                    return !i.hasDependency(t, e)
                }));
            }, i
        }(t.Evented);

        function Ht(t, e) {
            var i = Math.abs(2 * t.wrap) - +(t.wrap < 0),
                o = Math.abs(2 * e.wrap) - +(e.wrap < 0);
            return t.overscaledZ - e.overscaledZ || o - i || e.canonical.y - t.canonical.y || e.canonical.x - t.canonical.x
        }

        function Kt(t) {
            return "raster" === t || "image" === t || "video" === t
        }

        function Yt() {
            return new t.window.Worker(Wr.workerUrl)
        }
        Xt.maxOverzooming = 10, Xt.maxUnderzooming = 3;
        var Jt = function () {
            this.active = {};
        };
        Jt.prototype.acquire = function (t) {
            if (!this.workers)
                for (this.workers = []; this.workers.length < Jt.workerCount;) this.workers.push(new Yt);
            return this.active[t] = !0, this.workers.slice()
        }, Jt.prototype.release = function (t) {
            delete this.active[t], 0 === this.numActive() && (this.workers.forEach((function (t) {
                t.terminate();
            })), this.workers = null);
        }, Jt.prototype.isPreloaded = function () {
            return !!this.active.minemap_preloaded_worker_pool
        }, Jt.prototype.numActive = function () {
            return Object.keys(this.active).length
        };
        var Qt, $t = Math.floor(t.browser.hardwareConcurrency / 2);

        function te() {
            return Qt || (Qt = new Jt), Qt
        }

        function ee(e, i) {
            var o = {};
            for (var a in e) "ref" !== a && (o[a] = e[a]);
            return t.refProperties.forEach((function (t) {
                t in i && (o[t] = i[t]);
            })), o
        }

        function ie(t) {
            t = t.slice();
            for (var e = Object.create(null), i = 0; i < t.length; i++) e[t[i].id] = t[i];
            for (var o = 0; o < t.length; o++) "ref" in t[o] && (t[o] = ee(t[o], e[t[o].ref]));
            return t
        }
        Jt.workerCount = Math.max(Math.min($t, 6), 1);
        var oe = {
            setStyle: "setStyle",
            addLayer: "addLayer",
            removeLayer: "removeLayer",
            setPaintProperty: "setPaintProperty",
            setLayoutProperty: "setLayoutProperty",
            setFilter: "setFilter",
            addSource: "addSource",
            removeSource: "removeSource",
            setGeoJSONSourceData: "setGeoJSONSourceData",
            setLayerZoomRange: "setLayerZoomRange",
            setLayerProperty: "setLayerProperty",
            setCenter: "setCenter",
            setZoom: "setZoom",
            setBearing: "setBearing",
            setPitch: "setPitch",
            setSprite: "setSprite",
            setGlyphs: "setGlyphs",
            setTransition: "setTransition",
            setLight: "setLight"
        };

        function ae(t, e, i) {
            i.push({
                command: oe.addSource,
                args: [t, e[t]]
            });
        }

        function re(t, e, i) {
            e.push({
                command: oe.removeSource,
                args: [t]
            }), i[t] = !0;
        }

        function ne(t, e, i, o) {
            re(t, i, o), ae(t, e, i);
        }

        function se(e, i, o) {
            var a;
            for (a in e[o])
                if (e[o].hasOwnProperty(a) && "data" !== a && !t.deepEqual(e[o][a], i[o][a])) return !1;
            for (a in i[o])
                if (i[o].hasOwnProperty(a) && "data" !== a && !t.deepEqual(e[o][a], i[o][a])) return !1;
            return !0
        }

        function le(e, i, o, a, r, n) {
            var s;
            for (s in i = i || {}, e = e || {}) e.hasOwnProperty(s) && (t.deepEqual(e[s], i[s]) || o.push({
                command: n,
                args: [a, s, i[s], r]
            }));
            for (s in i) i.hasOwnProperty(s) && !e.hasOwnProperty(s) && (t.deepEqual(e[s], i[s]) || o.push({
                command: n,
                args: [a, s, i[s], r]
            }));
        }

        function ce(t) {
            return t.id
        }

        function ue(t, e) {
            return t[e.id] = e, t
        }
        var he = function (t, e) {
            this.reset(t, e);
        };
        he.prototype.reset = function (t, e) {
            this.points = t || [], this._distances = [0];
            for (var i = 1; i < this.points.length; i++) this._distances[i] = this._distances[i - 1] + this.points[i].dist(this.points[i - 1]);
            this.length = this._distances[this._distances.length - 1], this.padding = Math.min(e || 0, .5 * this.length), this.paddedLength = this.length - 2 * this.padding;
        }, he.prototype.lerp = function (e) {
            if (1 === this.points.length) return this.points[0];
            e = t.clamp(e, 0, 1);
            for (var i = 1, o = this._distances[i], a = e * this.paddedLength + this.padding; o < a && i < this._distances.length;) o = this._distances[++i];
            var r = i - 1,
                n = this._distances[r],
                s = o - n,
                l = s > 0 ? (a - n) / s : 0;
            return this.points[r].mult(1 - l).add(this.points[i].mult(l))
        };
        var pe = function (t, e, i) {
            var o = this.boxCells = [],
                a = this.circleCells = [];
            this.xCellCount = Math.ceil(t / i), this.yCellCount = Math.ceil(e / i);
            for (var r = 0; r < this.xCellCount * this.yCellCount; r++) o.push([]), a.push([]);
            this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = t, this.height = e, this.xScale = this.xCellCount / t, this.yScale = this.yCellCount / e, this.boxUid = 0, this.circleUid = 0;
        };

        function _e(e, i, o, a, r) {
            var n = t.create();
            return i ? (t.scale(n, n, [1 / r, 1 / r, 1]), o || t.rotateZ(n, n, a.angle)) : t.multiply(n, a.labelPlaneMatrix, e), n
        }

        function me(e, i, o, a, r) {
            if (i) {
                var n = t.clone(e);
                return t.scale(n, n, [r, r, 1]), o || t.rotateZ(n, n, -a.angle), n
            }
            return a.glCoordMatrix
        }

        function de(e, i) {
            var o = [e.x, e.y, 0, 1];
            Ie(o, o, i);
            var a = o[3];
            return {
                point: new t.Point(o[0] / a, o[1] / a),
                signedDistanceFromCamera: a
            }
        }

        function fe(t, e) {
            return .5 + t / e * .5
        }

        function ge(t, e) {
            var i = t[0] / t[3],
                o = t[1] / t[3];
            return i >= -e[0] && i <= e[0] && o >= -e[1] && o <= e[1]
        }

        function ve(e, i, o, a, r, n, s, l) {
            var c = a ? e.textSizeData : e.iconSizeData,
                u = t.evaluateSizeForZoom(c, o.transform.zoom),
                h = [256 / o.width * 2 + 1, 256 / o.height * 2 + 1],
                p = a ? e.text.dynamicLayoutVertexArray : e.icon.dynamicLayoutVertexArray;
            p.clear();
            for (var _ = e.lineVertexArray, m = a ? e.text.placedSymbolArray : e.icon.placedSymbolArray, d = o.transform.width / o.transform.height, f = !1, g = 0; g < m.length; g++) {
                var v = m.get(g);
                if (v.hidden || v.writingMode === t.WritingMode.vertical && !f) Se(v.numGlyphs, p);
                else {
                    f = !1;
                    var y = [v.anchorX, v.anchorY, 0, 1];
                    if (t.transformMat4(y, y, i), ge(y, h)) {
                        var x = fe(o.transform.cameraToCenterDistance, y[3]),
                            w = t.evaluateSizeForFeature(c, u, v),
                            b = s ? w / x : w * x,
                            T = new t.Point(v.anchorX, v.anchorY),
                            E = de(T, r).point,
                            S = {},
                            I = we(v, b, !1, l, i, r, n, e.glyphOffsetArray, _, p, E, T, S, d);
                        f = I.useVertical, (I.notEnoughRoom || f || I.needsFlipping && we(v, b, !0, l, i, r, n, e.glyphOffsetArray, _, p, E, T, S, d).notEnoughRoom) && Se(v.numGlyphs, p);
                    } else Se(v.numGlyphs, p);
                }
            }
            a ? e.text.dynamicLayoutVertexBuffer.updateData(p) : e.icon.dynamicLayoutVertexBuffer.updateData(p);
        }

        function ye(t, e, i, o, a, r, n, s, l, c, u) {
            var h = s.glyphStartIndex + s.numGlyphs,
                p = s.lineStartIndex,
                _ = s.lineStartIndex + s.lineLength,
                m = e.getoffsetX(s.glyphStartIndex),
                d = e.getoffsetX(h - 1),
                f = Te(t * m, i, o, a, r, n, s.segment, p, _, l, c, u);
            if (!f) return null;
            var g = Te(t * d, i, o, a, r, n, s.segment, p, _, l, c, u);
            return g ? {
                first: f,
                last: g
            } : null
        }

        function xe(e, i, o, a) {
            return e === t.WritingMode.horizontal && Math.abs(o.y - i.y) > Math.abs(o.x - i.x) * a ? {
                useVertical: !0
            } : (e === t.WritingMode.vertical ? i.y < o.y : i.x > o.x) ? {
                needsFlipping: !0
            } : null
        }

        function we(e, i, o, a, r, n, s, l, c, u, h, p, _, m) {
            var d, f = i / 24,
                g = e.lineOffsetX * f,
                v = e.lineOffsetY * f;
            if (e.numGlyphs > 1) {
                var y = e.glyphStartIndex + e.numGlyphs,
                    x = e.lineStartIndex,
                    w = e.lineStartIndex + e.lineLength,
                    b = ye(f, l, g, v, o, h, p, e, c, n, _);
                if (!b) return {
                    notEnoughRoom: !0
                };
                var T = de(b.first.point, s).point,
                    E = de(b.last.point, s).point;
                if (a && !o) {
                    var S = xe(e.writingMode, T, E, m);
                    if (S) return S
                }
                d = [b.first];
                for (var I = e.glyphStartIndex + 1; I < y - 1; I++) d.push(Te(f * l.getoffsetX(I), g, v, o, h, p, e.segment, x, w, c, n, _));
                d.push(b.last);
            } else {
                if (a && !o) {
                    var z = de(p, r).point,
                        C = e.lineStartIndex + e.segment + 1,
                        P = new t.Point(c.getx(C), c.gety(C)),
                        L = de(P, r),
                        A = L.signedDistanceFromCamera > 0 ? L.point : be(p, P, z, 1, r),
                        M = xe(e.writingMode, z, A, m);
                    if (M) return M
                }
                var D = Te(f * l.getoffsetX(e.glyphStartIndex), g, v, o, h, p, e.segment, e.lineStartIndex, e.lineStartIndex + e.lineLength, c, n, _);
                if (!D) return {
                    notEnoughRoom: !0
                };
                d = [D];
            }
            for (var R = 0, k = d; R < k.length; R += 1) {
                var O = k[R];
                t.addDynamicAttributes(u, O.point, O.angle);
            }
            return {}
        }

        function be(t, e, i, o, a) {
            var r = de(t.add(t.sub(e)._unit()), a).point,
                n = i.sub(r);
            return i.add(n._mult(o / n.mag()))
        }

        function Te(e, i, o, a, r, n, s, l, c, u, h, p) {
            var _ = a ? e - i : e + i,
                m = _ > 0 ? 1 : -1,
                d = 0;
            a && (m *= -1, d = Math.PI), m < 0 && (d += Math.PI);
            for (var f = m > 0 ? l + s : l + s + 1, g = r, v = r, y = 0, x = 0, w = Math.abs(_), b = []; y + x <= w;) {
                if ((f += m) < l || f >= c) return null;
                if (v = g, b.push(g), void 0 === (g = p[f])) {
                    var T = new t.Point(u.getx(f), u.gety(f)),
                        E = de(T, h);
                    if (E.signedDistanceFromCamera > 0) g = p[f] = E.point;
                    else {
                        var S = f - m;
                        g = be(0 === y ? n : new t.Point(u.getx(S), u.gety(S)), T, v, w - y + 1, h);
                    }
                }
                y += x, x = v.dist(g);
            }
            var I = (w - y) / x,
                z = g.sub(v),
                C = z.mult(I)._add(v);
            C._add(z._unit()._perp()._mult(o * m));
            var P = d + Math.atan2(g.y - v.y, g.x - v.x);
            return b.push(C), {
                point: C,
                angle: P,
                path: b
            }
        }
        pe.prototype.keysLength = function () {
            return this.boxKeys.length + this.circleKeys.length
        }, pe.prototype.insert = function (t, e, i, o, a) {
            this._forEachCell(e, i, o, a, this._insertBoxCell, this.boxUid++), this.boxKeys.push(t), this.bboxes.push(e), this.bboxes.push(i), this.bboxes.push(o), this.bboxes.push(a);
        }, pe.prototype.insertCircle = function (t, e, i, o) {
            this._forEachCell(e - o, i - o, e + o, i + o, this._insertCircleCell, this.circleUid++), this.circleKeys.push(t), this.circles.push(e), this.circles.push(i), this.circles.push(o);
        }, pe.prototype._insertBoxCell = function (t, e, i, o, a, r) {
            this.boxCells[a].push(r);
        }, pe.prototype._insertCircleCell = function (t, e, i, o, a, r) {
            this.circleCells[a].push(r);
        }, pe.prototype._query = function (t, e, i, o, a, r) {
            if (i < 0 || t > this.width || o < 0 || e > this.height) return !a && [];
            var n = [];
            if (t <= 0 && e <= 0 && this.width <= i && this.height <= o) {
                if (a) return !0;
                for (var s = 0; s < this.boxKeys.length; s++) n.push({
                    key: this.boxKeys[s],
                    x1: this.bboxes[4 * s],
                    y1: this.bboxes[4 * s + 1],
                    x2: this.bboxes[4 * s + 2],
                    y2: this.bboxes[4 * s + 3]
                });
                for (var l = 0; l < this.circleKeys.length; l++) {
                    var c = this.circles[3 * l],
                        u = this.circles[3 * l + 1],
                        h = this.circles[3 * l + 2];
                    n.push({
                        key: this.circleKeys[l],
                        x1: c - h,
                        y1: u - h,
                        x2: c + h,
                        y2: u + h
                    });
                }
                return r ? n.filter(r) : n
            }
            return this._forEachCell(t, e, i, o, this._queryCell, n, {
                hitTest: a,
                seenUids: {
                    box: {},
                    circle: {}
                }
            }, r), a ? n.length > 0 : n
        }, pe.prototype._queryCircle = function (t, e, i, o, a) {
            var r = t - i,
                n = t + i,
                s = e - i,
                l = e + i;
            if (n < 0 || r > this.width || l < 0 || s > this.height) return !o && [];
            var c = [];
            return this._forEachCell(r, s, n, l, this._queryCellCircle, c, {
                hitTest: o,
                circle: {
                    x: t,
                    y: e,
                    radius: i
                },
                seenUids: {
                    box: {},
                    circle: {}
                }
            }, a), o ? c.length > 0 : c
        }, pe.prototype.query = function (t, e, i, o, a) {
            return this._query(t, e, i, o, !1, a)
        }, pe.prototype.hitTest = function (t, e, i, o, a) {
            return this._query(t, e, i, o, !0, a)
        }, pe.prototype.hitTestCircle = function (t, e, i, o) {
            return this._queryCircle(t, e, i, !0, o)
        }, pe.prototype._queryCell = function (t, e, i, o, a, r, n, s) {
            var l = n.seenUids,
                c = this.boxCells[a];
            if (null !== c)
                for (var u = this.bboxes, h = 0, p = c; h < p.length; h += 1) {
                    var _ = p[h];
                    if (!l.box[_]) {
                        l.box[_] = !0;
                        var m = 4 * _;
                        if (t <= u[m + 2] && e <= u[m + 3] && i >= u[m + 0] && o >= u[m + 1] && (!s || s(this.boxKeys[_]))) {
                            if (n.hitTest) return r.push(!0), !0;
                            r.push({
                                key: this.boxKeys[_],
                                x1: u[m],
                                y1: u[m + 1],
                                x2: u[m + 2],
                                y2: u[m + 3]
                            });
                        }
                    }
                }
            var d = this.circleCells[a];
            if (null !== d)
                for (var f = this.circles, g = 0, v = d; g < v.length; g += 1) {
                    var y = v[g];
                    if (!l.circle[y]) {
                        l.circle[y] = !0;
                        var x = 3 * y;
                        if (this._circleAndRectCollide(f[x], f[x + 1], f[x + 2], t, e, i, o) && (!s || s(this.circleKeys[y]))) {
                            if (n.hitTest) return r.push(!0), !0;
                            var w = f[x],
                                b = f[x + 1],
                                T = f[x + 2];
                            r.push({
                                key: this.circleKeys[y],
                                x1: w - T,
                                y1: b - T,
                                x2: w + T,
                                y2: b + T
                            });
                        }
                    }
                }
        }, pe.prototype._queryCellCircle = function (t, e, i, o, a, r, n, s) {
            var l = n.circle,
                c = n.seenUids,
                u = this.boxCells[a];
            if (null !== u)
                for (var h = this.bboxes, p = 0, _ = u; p < _.length; p += 1) {
                    var m = _[p];
                    if (!c.box[m]) {
                        c.box[m] = !0;
                        var d = 4 * m;
                        if (this._circleAndRectCollide(l.x, l.y, l.radius, h[d + 0], h[d + 1], h[d + 2], h[d + 3]) && (!s || s(this.boxKeys[m]))) return r.push(!0), !0
                    }
                }
            var f = this.circleCells[a];
            if (null !== f)
                for (var g = this.circles, v = 0, y = f; v < y.length; v += 1) {
                    var x = y[v];
                    if (!c.circle[x]) {
                        c.circle[x] = !0;
                        var w = 3 * x;
                        if (this._circlesCollide(g[w], g[w + 1], g[w + 2], l.x, l.y, l.radius) && (!s || s(this.circleKeys[x]))) return r.push(!0), !0
                    }
                }
        }, pe.prototype._forEachCell = function (t, e, i, o, a, r, n, s) {
            for (var l = this._convertToXCellCoord(t), c = this._convertToYCellCoord(e), u = this._convertToXCellCoord(i), h = this._convertToYCellCoord(o), p = l; p <= u; p++)
                for (var _ = c; _ <= h; _++)
                    if (a.call(this, t, e, i, o, this.xCellCount * _ + p, r, n, s)) return
        }, pe.prototype._convertToXCellCoord = function (t) {
            return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(t * this.xScale)))
        }, pe.prototype._convertToYCellCoord = function (t) {
            return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(t * this.yScale)))
        }, pe.prototype._circlesCollide = function (t, e, i, o, a, r) {
            var n = o - t,
                s = a - e,
                l = i + r;
            return l * l > n * n + s * s
        }, pe.prototype._circleAndRectCollide = function (t, e, i, o, a, r, n) {
            var s = (r - o) / 2,
                l = Math.abs(t - (o + s));
            if (l > s + i) return !1;
            var c = (n - a) / 2,
                u = Math.abs(e - (a + c));
            if (u > c + i) return !1;
            if (l <= s || u <= c) return !0;
            var h = l - s,
                p = u - c;
            return h * h + p * p <= i * i
        };
        var Ee = new Float32Array([-1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0, -1 / 0, -1 / 0, 0]);

        function Se(t, e) {
            for (var i = 0; i < t; i++) {
                var o = e.length;
                e.resize(o + 4), e.float32.set(Ee, 3 * o);
            }
        }

        function Ie(t, e, i) {
            var o = e[0],
                a = e[1];
            return t[0] = i[0] * o + i[4] * a + i[12], t[1] = i[1] * o + i[5] * a + i[13], t[3] = i[3] * o + i[7] * a + i[15], t
        }
        var ze = function (t, e, i) {
            void 0 === e && (e = new pe(t.width + 200, t.height + 200, 25)), void 0 === i && (i = new pe(t.width + 200, t.height + 200, 25)), this.transform = t, this.grid = e, this.ignoredGrid = i, this.pitchfactor = Math.cos(t._pitch) * t.cameraToCenterDistance, this.screenRightBoundary = t.width + 100, this.screenBottomBoundary = t.height + 100, this.gridRightBoundary = t.width + 200, this.gridBottomBoundary = t.height + 200;
        };

        function Ce(e, i, o) {
            return i * (t.EXTENT / (e.tileSize * Math.pow(2, o - e.tileID.overscaledZ)))
        }
        ze.prototype.placeCollisionBox = function (t, e, i, o, a) {
            var r = this.projectAndGetPerspectiveRatio(o, t.anchorPointX, t.anchorPointY),
                n = i * r.perspectiveRatio,
                s = t.x1 * n + r.point.x,
                l = t.y1 * n + r.point.y,
                c = t.x2 * n + r.point.x,
                u = t.y2 * n + r.point.y;
            return !this.isInsideGrid(s, l, c, u) || !e && this.grid.hitTest(s, l, c, u, a) ? {
                box: [],
                offscreen: !1
            } : {
                box: [s, l, c, u],
                offscreen: this.isOffscreen(s, l, c, u)
            }
        }, ze.prototype.placeCollisionCircles = function (e, i, o, a, r, n, s, l, c, u, h, p, _) {
            var m = [],
                d = new t.Point(i.anchorX, i.anchorY),
                f = de(d, n),
                g = fe(this.transform.cameraToCenterDistance, f.signedDistanceFromCamera),
                v = (u ? r / g : r * g) / t.ONE_EM,
                y = de(d, s).point,
                x = ye(v, a, i.lineOffsetX * v, i.lineOffsetY * v, !1, y, d, i, o, s, {}),
                w = !1,
                b = !1,
                T = !0;
            if (x) {
                for (var E = .5 * p * g + _, S = new t.Point(-100, -100), I = new t.Point(this.screenRightBoundary, this.screenBottomBoundary), z = new he, C = x.first, P = x.last, L = [], A = C.path.length - 1; A >= 1; A--) L.push(C.path[A]);
                for (var M = 1; M < P.path.length; M++) L.push(P.path[M]);
                var D = 2.5 * E;
                if (l) {
                    var R = L.map((function (t) {
                        return de(t, l)
                    }));
                    L = R.some((function (t) {
                        return t.signedDistanceFromCamera <= 0
                    })) ? [] : R.map((function (t) {
                        return t.point
                    }));
                }
                var k = [];
                if (L.length > 0) {
                    for (var O = L[0].clone(), B = L[0].clone(), U = 1; U < L.length; U++) O.x = Math.min(O.x, L[U].x), O.y = Math.min(O.y, L[U].y), B.x = Math.max(B.x, L[U].x), B.y = Math.max(B.y, L[U].y);
                    k = O.x >= S.x && B.x <= I.x && O.y >= S.y && B.y <= I.y ? [L] : B.x < S.x || O.x > I.x || B.y < S.y || O.y > I.y ? [] : t.clipLine([L], S.x, S.y, I.x, I.y);
                }
                for (var F = 0, N = k; F < N.length; F += 1) {
                    var q;
                    z.reset(N[F], .25 * E), q = z.length <= .5 * E ? 1 : Math.ceil(z.paddedLength / D) + 1;
                    for (var j = 0; j < q; j++) {
                        var Z = j / Math.max(q - 1, 1),
                            V = z.lerp(Z),
                            G = V.x + 100,
                            W = V.y + 100;
                        m.push(G, W, E, 0);
                        var X = G - E,
                            H = W - E,
                            K = G + E,
                            Y = W + E;
                        if (T = T && this.isOffscreen(X, H, K, Y), b = b || this.isInsideGrid(X, H, K, Y), !e && this.grid.hitTestCircle(G, W, E, h) && (w = !0, !c)) return {
                            circles: [],
                            offscreen: !1,
                            collisionDetected: w
                        }
                    }
                }
            }
            return {
                circles: !c && w || !b ? [] : m,
                offscreen: T,
                collisionDetected: w
            }
        }, ze.prototype.queryRenderedSymbols = function (e) {
            if (0 === e.length || 0 === this.grid.keysLength() && 0 === this.ignoredGrid.keysLength()) return {};
            for (var i = [], o = 1 / 0, a = 1 / 0, r = -1 / 0, n = -1 / 0, s = 0, l = e; s < l.length; s += 1) {
                var c = l[s],
                    u = new t.Point(c.x + 100, c.y + 100);
                o = Math.min(o, u.x), a = Math.min(a, u.y), r = Math.max(r, u.x), n = Math.max(n, u.y), i.push(u);
            }
            for (var h = {}, p = {}, _ = 0, m = this.grid.query(o, a, r, n).concat(this.ignoredGrid.query(o, a, r, n)); _ < m.length; _ += 1) {
                var d = m[_],
                    f = d.key;
                if (void 0 === h[f.bucketInstanceId] && (h[f.bucketInstanceId] = {}), !h[f.bucketInstanceId][f.featureIndex]) {
                    var g = [new t.Point(d.x1, d.y1), new t.Point(d.x2, d.y1), new t.Point(d.x2, d.y2), new t.Point(d.x1, d.y2)];
                    t.polygonIntersectsPolygon(i, g) && (h[f.bucketInstanceId][f.featureIndex] = !0, void 0 === p[f.bucketInstanceId] && (p[f.bucketInstanceId] = []), p[f.bucketInstanceId].push(f.featureIndex));
                }
            }
            return p
        }, ze.prototype.insertCollisionBox = function (t, e, i, o, a) {
            (e ? this.ignoredGrid : this.grid).insert({
                bucketInstanceId: i,
                featureIndex: o,
                collisionGroupID: a
            }, t[0], t[1], t[2], t[3]);
        }, ze.prototype.insertCollisionCircles = function (t, e, i, o, a) {
            for (var r = e ? this.ignoredGrid : this.grid, n = {
                    bucketInstanceId: i,
                    featureIndex: o,
                    collisionGroupID: a
                }, s = 0; s < t.length; s += 4) r.insertCircle(n, t[s], t[s + 1], t[s + 2]);
        }, ze.prototype.projectAndGetPerspectiveRatio = function (e, i, o) {
            var a = [i, o, 0, 1];
            return Ie(a, a, e), {
                point: new t.Point((a[0] / a[3] + 1) / 2 * this.transform.width + 100, (-a[1] / a[3] + 1) / 2 * this.transform.height + 100),
                perspectiveRatio: .5 + this.transform.cameraToCenterDistance / a[3] * .5
            }
        }, ze.prototype.isOffscreen = function (t, e, i, o) {
            return i < 100 || t >= this.screenRightBoundary || o < 100 || e > this.screenBottomBoundary
        }, ze.prototype.isInsideGrid = function (t, e, i, o) {
            return i >= 0 && t < this.gridRightBoundary && o >= 0 && e < this.gridBottomBoundary
        }, ze.prototype.getViewportMatrix = function () {
            var e = t.identity([]);
            return t.translate(e, e, [-100, -100, 0]), e
        };
        var Pe = function (t, e, i, o) {
            this.opacity = t ? Math.max(0, Math.min(1, t.opacity + (t.placed ? e : -e))) : o && i ? 1 : 0, this.placed = i;
        };
        Pe.prototype.isHidden = function () {
            return 0 === this.opacity && !this.placed
        };
        var Le = function (t, e, i, o, a) {
            this.text = new Pe(t ? t.text : null, e, i, a), this.icon = new Pe(t ? t.icon : null, e, o, a);
        };
        Le.prototype.isHidden = function () {
            return this.text.isHidden() && this.icon.isHidden()
        };
        var Ae = function (t, e, i) {
                this.text = t, this.icon = e, this.skipFade = i;
            },
            Me = function () {
                this.invProjMatrix = t.create(), this.viewportMatrix = t.create(), this.circles = [];
            },
            De = function (t, e, i, o, a) {
                this.bucketInstanceId = t, this.featureIndex = e, this.sourceLayerIndex = i, this.bucketIndex = o, this.tileID = a;
            },
            Re = function (t) {
                this.crossSourceCollisions = t, this.maxGroupID = 0, this.collisionGroups = {};
            };

        function ke(e, i, o, a, r) {
            var n = t.getAnchorAlignment(e),
                s = -(n.horizontalAlign - .5) * i,
                l = -(n.verticalAlign - .5) * o,
                c = t.evaluateVariableOffset(e, a);
            return new t.Point(s + c[0] * r, l + c[1] * r)
        }

        function Oe(e, i, o, a, r, n) {
            var s = e.x1,
                l = e.x2,
                c = e.y1,
                u = e.y2,
                h = e.anchorPointX,
                p = e.anchorPointY,
                _ = new t.Point(i, o);
            return a && _._rotate(r ? n : -n), {
                x1: s + _.x,
                y1: c + _.y,
                x2: l + _.x,
                y2: u + _.y,
                anchorPointX: h,
                anchorPointY: p
            }
        }
        Re.prototype.get = function (t) {
            if (this.crossSourceCollisions) return {
                ID: 0,
                predicate: null
            };
            if (!this.collisionGroups[t]) {
                var e = ++this.maxGroupID;
                this.collisionGroups[t] = {
                    ID: e,
                    predicate: function (t) {
                        return t.collisionGroupID === e
                    }
                };
            }
            return this.collisionGroups[t]
        };
        var Be = function (t, e, i, o) {
            this.transform = t.clone(), this.collisionIndex = new ze(this.transform), this.placements = {}, this.opacities = {}, this.variableOffsets = {}, this.stale = !1, this.commitTime = 0, this.fadeDuration = e, this.retainedQueryData = {}, this.collisionGroups = new Re(i), this.collisionCircleArrays = {}, this.prevPlacement = o, o && (o.prevPlacement = void 0), this.placedOrientations = {};
        };

        function Ue(t, e, i, o, a) {
            t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, a || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, a || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, a || 0), t.emplaceBack(e ? 1 : 0, i ? 1 : 0, o || 0, a || 0);
        }
        Be.prototype.getBucketParts = function (e, i, o, a) {
            var r = o.getBucket(i),
                n = o.latestFeatureIndex;
            if (r && n && i.id === r.layerIds[0]) {
                var s = o.collisionBoxArray,
                    l = r.layers[0].layout,
                    c = Math.pow(2, this.transform.zoom - o.tileID.overscaledZ),
                    u = o.tileSize / t.EXTENT,
                    h = this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),
                    p = "map" === l.get("text-pitch-alignment"),
                    _ = "map" === l.get("text-rotation-alignment"),
                    m = Ce(o, 1, this.transform.zoom),
                    d = _e(h, p, _, this.transform, m),
                    f = null;
                if (p) {
                    var g = me(h, p, _, this.transform, m);
                    f = t.multiply([], this.transform.labelPlaneMatrix, g);
                }
                this.retainedQueryData[r.bucketInstanceId] = new De(r.bucketInstanceId, n, r.sourceLayerIndex, r.index, o.tileID);
                var v = {
                    bucket: r,
                    layout: l,
                    posMatrix: h,
                    textLabelPlaneMatrix: d,
                    labelToScreenMatrix: f,
                    scale: c,
                    textPixelRatio: u,
                    holdingForFade: o.holdingForFade(),
                    collisionBoxArray: s,
                    partiallyEvaluatedTextSize: t.evaluateSizeForZoom(r.textSizeData, this.transform.zoom),
                    collisionGroup: this.collisionGroups.get(r.sourceID)
                };
                if (a)
                    for (var y = 0, x = r.sortKeyRanges; y < x.length; y += 1) {
                        var w = x[y];
                        e.push({
                            sortKey: w.sortKey,
                            symbolInstanceStart: w.symbolInstanceStart,
                            symbolInstanceEnd: w.symbolInstanceEnd,
                            parameters: v
                        });
                    } else e.push({
                        symbolInstanceStart: 0,
                        symbolInstanceEnd: r.symbolInstances.length,
                        parameters: v
                    });
            }
        }, Be.prototype.attemptAnchorPlacement = function (t, e, i, o, a, r, n, s, l, c, u, h, p, _, m) {
            var d, f = [h.textOffset0, h.textOffset1],
                g = ke(t, i, o, f, a),
                v = this.collisionIndex.placeCollisionBox(Oe(e, g.x, g.y, r, n, this.transform.angle), u, s, l, c.predicate);
            if (!m || 0 !== this.collisionIndex.placeCollisionBox(Oe(m, g.x, g.y, r, n, this.transform.angle), u, s, l, c.predicate).box.length) return v.box.length > 0 ? (this.prevPlacement && this.prevPlacement.variableOffsets[h.crossTileID] && this.prevPlacement.placements[h.crossTileID] && this.prevPlacement.placements[h.crossTileID].text && (d = this.prevPlacement.variableOffsets[h.crossTileID].anchor), this.variableOffsets[h.crossTileID] = {
                textOffset: f,
                width: i,
                height: o,
                anchor: t,
                textBoxScale: a,
                prevAnchor: d
            }, this.markUsedJustification(p, t, h, _), p.allowVerticalPlacement && (this.markUsedOrientation(p, _, h), this.placedOrientations[h.crossTileID] = _), {
                shift: g,
                placedGlyphBoxes: v
            }) : void 0
        }, Be.prototype.placeLayerBucketPart = function (e, i, o) {
            var a = this,
                r = e.parameters,
                n = r.bucket,
                s = r.layout,
                l = r.posMatrix,
                c = r.textLabelPlaneMatrix,
                u = r.labelToScreenMatrix,
                h = r.textPixelRatio,
                p = r.holdingForFade,
                _ = r.collisionBoxArray,
                m = r.partiallyEvaluatedTextSize,
                d = r.collisionGroup,
                f = s.get("text-optional"),
                g = s.get("icon-optional"),
                v = s.get("text-allow-overlap"),
                y = s.get("icon-allow-overlap"),
                x = "map" === s.get("text-rotation-alignment"),
                w = "map" === s.get("text-pitch-alignment"),
                b = "none" !== s.get("icon-text-fit"),
                T = "viewport-y" === s.get("symbol-z-order"),
                E = v && (y || !n.hasIconData() || g),
                S = y && (v || !n.hasTextData() || f);
            !n.collisionArrays && _ && n.deserializeCollisionBoxes(_);
            var I = function (e, r) {
                if (!i[e.crossTileID])
                    if (p) a.placements[e.crossTileID] = new Ae(!1, !1, !1);
                    else {
                        var _, T = !1,
                            I = !1,
                            z = !0,
                            C = null,
                            P = {
                                box: null,
                                offscreen: null
                            },
                            L = {
                                box: null,
                                offscreen: null
                            },
                            A = null,
                            M = null,
                            D = 0,
                            R = 0,
                            k = 0;
                        r.textFeatureIndex ? D = r.textFeatureIndex : e.useRuntimeCollisionCircles && (D = e.featureIndex), r.verticalTextFeatureIndex && (R = r.verticalTextFeatureIndex);
                        var O = r.textBox;
                        if (O) {
                            var B = function (i) {
                                    var o = t.WritingMode.horizontal;
                                    if (n.allowVerticalPlacement && !i && a.prevPlacement) {
                                        var r = a.prevPlacement.placedOrientations[e.crossTileID];
                                        r && (a.placedOrientations[e.crossTileID] = r, a.markUsedOrientation(n, o = r, e));
                                    }
                                    return o
                                },
                                U = function (i, o) {
                                    if (n.allowVerticalPlacement && e.numVerticalGlyphVertices > 0 && r.verticalTextBox)
                                        for (var a = 0, s = n.writingModes; a < s.length && (s[a] === t.WritingMode.vertical ? (P = o(), L = P) : P = i(), !(P && P.box && P.box.length)); a += 1);
                                    else P = i();
                                };
                            if (s.get("text-variable-anchor")) {
                                var F = s.get("text-variable-anchor");
                                if (a.prevPlacement && a.prevPlacement.variableOffsets[e.crossTileID]) {
                                    var N = a.prevPlacement.variableOffsets[e.crossTileID];
                                    F.indexOf(N.anchor) > 0 && (F = F.filter((function (t) {
                                        return t !== N.anchor
                                    }))).unshift(N.anchor);
                                }
                                var q = function (t, i, o) {
                                    for (var r = t.x2 - t.x1, s = t.y2 - t.y1, c = e.textBoxScale, u = b && !y ? i : null, p = {
                                            box: [],
                                            offscreen: !1
                                        }, _ = v ? 2 * F.length : F.length, m = 0; m < _; ++m) {
                                        var f = a.attemptAnchorPlacement(F[m % F.length], t, r, s, c, x, w, h, l, d, m >= F.length, e, n, o, u);
                                        if (f && (p = f.placedGlyphBoxes) && p.box && p.box.length) {
                                            T = !0, C = f.shift;
                                            break
                                        }
                                    }
                                    return p
                                };
                                U((function () {
                                    return q(O, r.iconBox, t.WritingMode.horizontal)
                                }), (function () {
                                    var i = r.verticalTextBox;
                                    return n.allowVerticalPlacement && !(P && P.box && P.box.length) && e.numVerticalGlyphVertices > 0 && i ? q(i, r.verticalIconBox, t.WritingMode.vertical) : {
                                        box: null,
                                        offscreen: null
                                    }
                                })), P && (T = P.box, z = P.offscreen);
                                var j = B(P && P.box);
                                if (!T && a.prevPlacement) {
                                    var Z = a.prevPlacement.variableOffsets[e.crossTileID];
                                    Z && (a.variableOffsets[e.crossTileID] = Z, a.markUsedJustification(n, Z.anchor, e, j));
                                }
                            } else {
                                var V = function (t, i) {
                                    var o = a.collisionIndex.placeCollisionBox(t, v, h, l, d.predicate);
                                    return o && o.box && o.box.length && (a.markUsedOrientation(n, i, e), a.placedOrientations[e.crossTileID] = i), o
                                };
                                U((function () {
                                    return V(O, t.WritingMode.horizontal)
                                }), (function () {
                                    var i = r.verticalTextBox;
                                    return n.allowVerticalPlacement && e.numVerticalGlyphVertices > 0 && i ? V(i, t.WritingMode.vertical) : {
                                        box: null,
                                        offscreen: null
                                    }
                                })), B(P && P.box && P.box.length);
                            }
                        }
                        if (T = (_ = P) && _.box && _.box.length > 0, z = _ && _.offscreen, e.useRuntimeCollisionCircles) {
                            var G = n.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),
                                W = t.evaluateSizeForFeature(n.textSizeData, m, G),
                                X = s.get("text-padding");
                            A = a.collisionIndex.placeCollisionCircles(v, G, n.lineVertexArray, n.glyphOffsetArray, W, l, c, u, o, w, d.predicate, e.collisionCircleDiameter, X), T = v || A.circles.length > 0 && !A.collisionDetected, z = z && A.offscreen;
                        }
                        if (r.iconFeatureIndex && (k = r.iconFeatureIndex), r.iconBox) {
                            var H = function (t) {
                                var e = b && C ? Oe(t, C.x, C.y, x, w, a.transform.angle) : t;
                                return a.collisionIndex.placeCollisionBox(e, y, h, l, d.predicate)
                            };
                            I = L && L.box && L.box.length && r.verticalIconBox ? (M = H(r.verticalIconBox)).box.length > 0 : (M = H(r.iconBox)).box.length > 0, z = z && M.offscreen;
                        }
                        var K = f || 0 === e.numHorizontalGlyphVertices && 0 === e.numVerticalGlyphVertices,
                            Y = g || 0 === e.numIconVertices;
                        if (K || Y ? Y ? K || (I = I && T) : T = I && T : I = T = I && T, T && _ && _.box && a.collisionIndex.insertCollisionBox(_.box, s.get("text-ignore-placement"), n.bucketInstanceId, L && L.box && R ? R : D, d.ID), I && M && a.collisionIndex.insertCollisionBox(M.box, s.get("icon-ignore-placement"), n.bucketInstanceId, k, d.ID), A && (T && a.collisionIndex.insertCollisionCircles(A.circles, s.get("text-ignore-placement"), n.bucketInstanceId, D, d.ID), o)) {
                            var J = n.bucketInstanceId,
                                Q = a.collisionCircleArrays[J];
                            void 0 === Q && (Q = a.collisionCircleArrays[J] = new Me);
                            for (var $ = 0; $ < A.circles.length; $ += 4) Q.circles.push(A.circles[$ + 0]), Q.circles.push(A.circles[$ + 1]), Q.circles.push(A.circles[$ + 2]), Q.circles.push(A.collisionDetected ? 1 : 0);
                        }
                        a.placements[e.crossTileID] = new Ae(T || E, I || S, z || n.justReloaded), i[e.crossTileID] = !0;
                    }
            };
            if (T)
                for (var z = n.getSortedSymbolIndexes(this.transform.angle), C = z.length - 1; C >= 0; --C) {
                    var P = z[C];
                    I(n.symbolInstances.get(P), n.collisionArrays[P]);
                } else
                    for (var L = e.symbolInstanceStart; L < e.symbolInstanceEnd; L++) I(n.symbolInstances.get(L), n.collisionArrays[L]);
            if (o && n.bucketInstanceId in this.collisionCircleArrays) {
                var A = this.collisionCircleArrays[n.bucketInstanceId];
                t.invert(A.invProjMatrix, l), A.viewportMatrix = this.collisionIndex.getViewportMatrix();
            }
            n.justReloaded = !1;
        }, Be.prototype.markUsedJustification = function (e, i, o, a) {
            var r;
            r = a === t.WritingMode.vertical ? o.verticalPlacedTextSymbolIndex : {
                left: o.leftJustifiedTextSymbolIndex,
                center: o.centerJustifiedTextSymbolIndex,
                right: o.rightJustifiedTextSymbolIndex
            } [t.getAnchorJustification(i)];
            for (var n = 0, s = [o.leftJustifiedTextSymbolIndex, o.centerJustifiedTextSymbolIndex, o.rightJustifiedTextSymbolIndex, o.verticalPlacedTextSymbolIndex]; n < s.length; n += 1) {
                var l = s[n];
                l >= 0 && (e.text.placedSymbolArray.get(l).crossTileID = r >= 0 && l !== r ? 0 : o.crossTileID);
            }
        }, Be.prototype.markUsedOrientation = function (e, i, o) {
            for (var a = i === t.WritingMode.horizontal || i === t.WritingMode.horizontalOnly ? i : 0, r = i === t.WritingMode.vertical ? i : 0, n = 0, s = [o.leftJustifiedTextSymbolIndex, o.centerJustifiedTextSymbolIndex, o.rightJustifiedTextSymbolIndex]; n < s.length; n += 1) e.text.placedSymbolArray.get(s[n]).placedOrientation = a;
            o.verticalPlacedTextSymbolIndex && (e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation = r);
        }, Be.prototype.commit = function (t) {
            this.commitTime = t, this.zoomAtLastRecencyCheck = this.transform.zoom;
            var e = this.prevPlacement,
                i = !1;
            this.prevZoomAdjustment = e ? e.zoomAdjustment(this.transform.zoom) : 0;
            var o = e ? e.symbolFadeChange(t) : 1,
                a = e ? e.opacities : {},
                r = e ? e.variableOffsets : {},
                n = e ? e.placedOrientations : {};
            for (var s in this.placements) {
                var l = this.placements[s],
                    c = a[s];
                c ? (this.opacities[s] = new Le(c, o, l.text, l.icon), i = i || l.text !== c.text.placed || l.icon !== c.icon.placed) : (this.opacities[s] = new Le(null, o, l.text, l.icon, l.skipFade), i = i || l.text || l.icon);
            }
            for (var u in a) {
                var h = a[u];
                if (!this.opacities[u]) {
                    var p = new Le(h, o, !1, !1);
                    p.isHidden() || (this.opacities[u] = p, i = i || h.text.placed || h.icon.placed);
                }
            }
            for (var _ in r) this.variableOffsets[_] || !this.opacities[_] || this.opacities[_].isHidden() || (this.variableOffsets[_] = r[_]);
            for (var m in n) this.placedOrientations[m] || !this.opacities[m] || this.opacities[m].isHidden() || (this.placedOrientations[m] = n[m]);
            i ? this.lastPlacementChangeTime = t : "number" != typeof this.lastPlacementChangeTime && (this.lastPlacementChangeTime = e ? e.lastPlacementChangeTime : t);
        }, Be.prototype.updateLayerOpacities = function (t, e) {
            for (var i = {}, o = 0, a = e; o < a.length; o += 1) {
                var r = a[o],
                    n = r.getBucket(t);
                n && r.latestFeatureIndex && t.id === n.layerIds[0] && this.updateBucketOpacities(n, i, r.collisionBoxArray);
            }
        }, Be.prototype.updateBucketOpacities = function (e, i, o) {
            var a = this;
            e.hasTextData() && e.text.opacityVertexArray.clear(), e.hasIconData() && e.icon.opacityVertexArray.clear(), e.hasIconCollisionBoxData() && e.iconCollisionBox.collisionVertexArray.clear(), e.hasTextCollisionBoxData() && e.textCollisionBox.collisionVertexArray.clear();
            var r = e.layers[0].layout,
                n = new Le(null, 0, !1, !1, !0),
                s = r.get("text-allow-overlap"),
                l = r.get("icon-allow-overlap"),
                c = r.get("text-variable-anchor"),
                u = "map" === r.get("text-rotation-alignment"),
                h = "map" === r.get("text-pitch-alignment"),
                p = "none" !== r.get("icon-text-fit"),
                _ = new Le(null, 0, s && (l || !e.hasIconData() || r.get("icon-optional")), l && (s || !e.hasTextData() || r.get("text-optional")), !0);
            !e.collisionArrays && o && (e.hasIconCollisionBoxData() || e.hasTextCollisionBoxData()) && e.deserializeCollisionBoxes(o);
            for (var m = function (t, e, i) {
                    for (var o = 0; o < e / 4; o++) t.opacityVertexArray.emplaceBack(i);
                }, d = function (o) {
                    var r = e.symbolInstances.get(o),
                        s = r.numHorizontalGlyphVertices,
                        l = r.numVerticalGlyphVertices,
                        d = r.crossTileID,
                        f = a.opacities[d];
                    i[d] ? f = n : f || (a.opacities[d] = f = _), i[d] = !0;
                    var g = r.numIconVertices > 0,
                        v = a.placedOrientations[r.crossTileID],
                        y = v === t.WritingMode.vertical,
                        x = v === t.WritingMode.horizontal || v === t.WritingMode.horizontalOnly;
                    if (s > 0 || l > 0) {
                        var w = We(f.text);
                        m(e.text, s, y ? Xe : w), m(e.text, l, x ? Xe : w);
                        var b = f.text.isHidden();
                        [r.rightJustifiedTextSymbolIndex, r.centerJustifiedTextSymbolIndex, r.leftJustifiedTextSymbolIndex].forEach((function (t) {
                            t >= 0 && (e.text.placedSymbolArray.get(t).hidden = b || y ? 1 : 0);
                        })), r.verticalPlacedTextSymbolIndex >= 0 && (e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden = b || x ? 1 : 0);
                        var T = a.variableOffsets[r.crossTileID];
                        T && a.markUsedJustification(e, T.anchor, r, v);
                        var E = a.placedOrientations[r.crossTileID];
                        E && (a.markUsedJustification(e, "left", r, E), a.markUsedOrientation(e, E, r));
                    }
                    if (g) {
                        var S = We(f.icon),
                            I = !(p && r.verticalPlacedIconSymbolIndex && y);
                        r.placedIconSymbolIndex >= 0 && (m(e.icon, r.numIconVertices, I ? S : Xe), e.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden = f.icon.isHidden()), r.verticalPlacedIconSymbolIndex >= 0 && (m(e.icon, r.numVerticalIconVertices, I ? Xe : S), e.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden = f.icon.isHidden());
                    }
                    if (e.hasIconCollisionBoxData() || e.hasTextCollisionBoxData()) {
                        var z = e.collisionArrays[o];
                        if (z) {
                            var C = new t.Point(0, 0);
                            if (z.textBox || z.verticalTextBox) {
                                var P = !0;
                                if (c) {
                                    var L = a.variableOffsets[d];
                                    L ? (C = ke(L.anchor, L.width, L.height, L.textOffset, L.textBoxScale), u && C._rotate(h ? a.transform.angle : -a.transform.angle)) : P = !1;
                                }
                                z.textBox && Ue(e.textCollisionBox.collisionVertexArray, f.text.placed, !P || y, C.x, C.y), z.verticalTextBox && Ue(e.textCollisionBox.collisionVertexArray, f.text.placed, !P || x, C.x, C.y);
                            }
                            var A = Boolean(!x && z.verticalIconBox);
                            z.iconBox && Ue(e.iconCollisionBox.collisionVertexArray, f.icon.placed, A, p ? C.x : 0, p ? C.y : 0), z.verticalIconBox && Ue(e.iconCollisionBox.collisionVertexArray, f.icon.placed, !A, p ? C.x : 0, p ? C.y : 0);
                        }
                    }
                }, f = 0; f < e.symbolInstances.length; f++) d(f);
            if (e.sortFeatures(this.transform.angle), this.retainedQueryData[e.bucketInstanceId] && (this.retainedQueryData[e.bucketInstanceId].featureSortOrder = e.featureSortOrder), e.hasTextData() && e.text.opacityVertexBuffer && e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray), e.hasIconData() && e.icon.opacityVertexBuffer && e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray), e.hasIconCollisionBoxData() && e.iconCollisionBox.collisionVertexBuffer && e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray), e.hasTextCollisionBoxData() && e.textCollisionBox.collisionVertexBuffer && e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray), e.bucketInstanceId in this.collisionCircleArrays) {
                var g = this.collisionCircleArrays[e.bucketInstanceId];
                e.placementInvProjMatrix = g.invProjMatrix, e.placementViewportMatrix = g.viewportMatrix, e.collisionCircleArray = g.circles, delete this.collisionCircleArrays[e.bucketInstanceId];
            }
        }, Be.prototype.symbolFadeChange = function (t) {
            return 0 === this.fadeDuration ? 1 : (t - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment
        }, Be.prototype.zoomAdjustment = function (t) {
            return Math.max(0, (this.transform.zoom - t) / 1.5)
        }, Be.prototype.hasTransitions = function (t) {
            return this.stale || t - this.lastPlacementChangeTime < this.fadeDuration
        }, Be.prototype.stillRecent = function (t, e) {
            var i = this.zoomAtLastRecencyCheck === e ? 1 - this.zoomAdjustment(e) : 1;
            return this.zoomAtLastRecencyCheck = e, this.commitTime + this.fadeDuration * i > t
        }, Be.prototype.setStale = function () {
            this.stale = !0;
        };
        var Fe = Math.pow(2, 25),
            Ne = Math.pow(2, 24),
            qe = Math.pow(2, 17),
            je = Math.pow(2, 16),
            Ze = Math.pow(2, 9),
            Ve = Math.pow(2, 8),
            Ge = Math.pow(2, 1);

        function We(t) {
            if (0 === t.opacity && !t.placed) return 0;
            if (1 === t.opacity && t.placed) return 4294967295;
            var e = t.placed ? 1 : 0,
                i = Math.floor(127 * t.opacity);
            return i * Fe + e * Ne + i * qe + e * je + i * Ze + e * Ve + i * Ge + e
        }
        var Xe = 0,
            He = function (t) {
                this._sortAcrossTiles = "viewport-y" !== t.layout.get("symbol-z-order") && void 0 !== t.layout.get("symbol-sort-key").constantOr(1), this._currentTileIndex = 0, this._currentPartIndex = 0, this._seenCrossTileIDs = {}, this._bucketParts = [];
            };
        He.prototype.continuePlacement = function (t, e, i, o, a) {
            for (var r = this._bucketParts; this._currentTileIndex < t.length;)
                if (e.getBucketParts(r, o, t[this._currentTileIndex], this._sortAcrossTiles), this._currentTileIndex++, a()) return !0;
            for (this._sortAcrossTiles && (this._sortAcrossTiles = !1, r.sort((function (t, e) {
                    return t.sortKey - e.sortKey
                }))); this._currentPartIndex < r.length;)
                if (e.placeLayerBucketPart(r[this._currentPartIndex], this._seenCrossTileIDs, i), this._currentPartIndex++, a()) return !0;
            return !1
        };
        var Ke = function (t, e, i, o, a, r, n) {
            this.placement = new Be(t, a, r, n), this._currentPlacementIndex = e.length - 1, this._forceFullPlacement = i, this._showCollisionBoxes = o, this._done = !1;
        };
        Ke.prototype.isDone = function () {
            return this._done
        }, Ke.prototype.continuePlacement = function (e, i, o) {
            for (var a = this, r = t.browser.now(), n = function () {
                    var e = t.browser.now() - r;
                    return !a._forceFullPlacement && e > 2
                }; this._currentPlacementIndex >= 0;) {
                var s = i[e[this._currentPlacementIndex]],
                    l = this.placement.collisionIndex.transform.zoom;
                if (("symbol" === s.type || "symtracking" === s.type) && (!s.minzoom || s.minzoom <= l) && (!s.maxzoom || s.maxzoom > l)) {
                    if (this._inProgressLayer || (this._inProgressLayer = new He(s)), this._inProgressLayer.continuePlacement(o[s.source], this.placement, this._showCollisionBoxes, s, n)) return;
                    delete this._inProgressLayer;
                }
                this._currentPlacementIndex--;
            }
            this._done = !0;
        }, Ke.prototype.commit = function (t) {
            return this.placement.commit(t), this.placement
        };
        var Ye = 512 / t.EXTENT / 2,
            Je = function (t, e, i) {
                this.tileID = t, this.indexedSymbolInstances = {}, this.bucketInstanceId = i;
                for (var o = 0; o < e.length; o++) {
                    var a = e.get(o),
                        r = a.key;
                    this.indexedSymbolInstances[r] || (this.indexedSymbolInstances[r] = []), this.indexedSymbolInstances[r].push({
                        crossTileID: a.crossTileID,
                        coord: this.getScaledCoordinates(a, t)
                    });
                }
            };
        Je.prototype.getScaledCoordinates = function (e, i) {
            var o = Ye / Math.pow(2, i.canonical.z - this.tileID.canonical.z);
            return {
                x: Math.floor((i.canonical.x * t.EXTENT + e.anchorX) * o),
                y: Math.floor((i.canonical.y * t.EXTENT + e.anchorY) * o)
            }
        }, Je.prototype.findMatches = function (t, e, i) {
            for (var o = this.tileID.canonical.z < e.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - e.canonical.z), a = 0; a < t.length; a++) {
                var r = t.get(a);
                if (!r.crossTileID) {
                    var n = this.indexedSymbolInstances[r.key];
                    if (n)
                        for (var s = this.getScaledCoordinates(r, e), l = 0, c = n; l < c.length; l += 1) {
                            var u = c[l];
                            if (Math.abs(u.coord.x - s.x) <= o && Math.abs(u.coord.y - s.y) <= o && !i[u.crossTileID]) {
                                i[u.crossTileID] = !0, r.crossTileID = u.crossTileID;
                                break
                            }
                        }
                }
            }
        };
        var Qe = function () {
            this.maxCrossTileID = 0;
        };
        Qe.prototype.generate = function () {
            return ++this.maxCrossTileID
        };
        var $e = function () {
            this.indexes = {}, this.usedCrossTileIDs = {}, this.lng = 0;
        };
        $e.prototype.handleWrapJump = function (t) {
            var e = Math.round((t - this.lng) / 360);
            if (0 !== e)
                for (var i in this.indexes) {
                    var o = this.indexes[i],
                        a = {};
                    for (var r in o) {
                        var n = o[r];
                        n.tileID = n.tileID.unwrapTo(n.tileID.wrap + e), a[n.tileID.key] = n;
                    }
                    this.indexes[i] = a;
                }
            this.lng = t;
        }, $e.prototype.addBucket = function (t, e, i) {
            if (this.indexes[t.overscaledZ] && this.indexes[t.overscaledZ][t.key]) {
                if (this.indexes[t.overscaledZ][t.key].bucketInstanceId === e.bucketInstanceId) return !1;
                this.removeBucketCrossTileIDs(t.overscaledZ, this.indexes[t.overscaledZ][t.key]);
            }
            for (var o = 0; o < e.symbolInstances.length; o++) e.symbolInstances.get(o).crossTileID = 0;
            this.usedCrossTileIDs[t.overscaledZ] || (this.usedCrossTileIDs[t.overscaledZ] = {});
            var a = this.usedCrossTileIDs[t.overscaledZ];
            for (var r in this.indexes) {
                var n = this.indexes[r];
                if (Number(r) > t.overscaledZ)
                    for (var s in n) {
                        var l = n[s];
                        l.tileID.isChildOf(t) && l.findMatches(e.symbolInstances, t, a);
                    } else {
                        var c = n[t.scaledTo(Number(r)).key];
                        c && c.findMatches(e.symbolInstances, t, a);
                    }
            }
            for (var u = 0; u < e.symbolInstances.length; u++) {
                var h = e.symbolInstances.get(u);
                h.crossTileID || (h.crossTileID = i.generate(), a[h.crossTileID] = !0);
            }
            return void 0 === this.indexes[t.overscaledZ] && (this.indexes[t.overscaledZ] = {}), this.indexes[t.overscaledZ][t.key] = new Je(t, e.symbolInstances, e.bucketInstanceId), !0
        }, $e.prototype.removeBucketCrossTileIDs = function (t, e) {
            for (var i in e.indexedSymbolInstances)
                for (var o = 0, a = e.indexedSymbolInstances[i]; o < a.length; o += 1) delete this.usedCrossTileIDs[t][a[o].crossTileID];
        }, $e.prototype.removeStaleBuckets = function (t) {
            var e = !1;
            for (var i in this.indexes) {
                var o = this.indexes[i];
                for (var a in o) t[o[a].bucketInstanceId] || (this.removeBucketCrossTileIDs(i, o[a]), delete o[a], e = !0);
            }
            return e
        };
        var ti = function () {
            this.layerIndexes = {}, this.crossTileIDs = new Qe, this.maxBucketInstanceId = 0, this.bucketsInCurrentPlacement = {};
        };
        ti.prototype.addLayer = function (t, e, i) {
            var o = this.layerIndexes[t.id];
            void 0 === o && (o = this.layerIndexes[t.id] = new $e);
            var a = !1,
                r = {};
            o.handleWrapJump(i);
            for (var n = 0, s = e; n < s.length; n += 1) {
                var l = s[n],
                    c = l.getBucket(t);
                c && t.id === c.layerIds[0] && (c.bucketInstanceId || (c.bucketInstanceId = ++this.maxBucketInstanceId), o.addBucket(l.tileID, c, this.crossTileIDs) && (a = !0), r[c.bucketInstanceId] = !0);
            }
            return o.removeStaleBuckets(r) && (a = !0), a
        }, ti.prototype.pruneUnusedLayers = function (t) {
            var e = {};
            for (var i in t.forEach((function (t) {
                    e[t] = !0;
                })), this.layerIndexes) e[i] || delete this.layerIndexes[i];
        };
        var ei = function (e, i) {
                return t.emitValidationErrors(e, i && i.filter((function (t) {
                    return "source.canvas" !== t.identifier
                })))
            },
            ii = t.pick(oe, ["addLayer", "removeLayer", "setPaintProperty", "setLayoutProperty", "setFilter", "addSource", "removeSource", "setLayerZoomRange", "setLight", "setTransition", "setGeoJSONSourceData"]),
            oi = t.pick(oe, ["setCenter", "setZoom", "setBearing", "setPitch"]),
            ai = function () {
                var e = {},
                    i = t.styleSpec.$version;
                for (var o in t.styleSpec.$root) {
                    var a, r = t.styleSpec.$root[o];
                    if (r.required) null != (a = "version" === o ? i : "array" === r.type ? [] : {}) && (e[o] = a);
                }
                return e
            }(),
            ri = function (e) {
                function i(o, a) {
                    var r = this;
                    void 0 === a && (a = {}), e.call(this), this.map = o, this.dispatcher = new q(te(), this), this.imageManager = new P, this.imageManager.setEventedParent(this), this.glyphManager = new O(o._requestManager, a.localIdeographFontFamily), this.lineAtlas = new N(256, 512), this.crossTileSymbolIndex = new ti, this._layers = {}, this._serializedLayers = {}, this._order = [], this.sourceCaches = {}, this.zoomHistory = new t.ZoomHistory, this._loaded = !1, this._availableImages = [], this._originalSource = [], this._originalLayer = [], this._resetUpdates(), this.dispatcher.broadcast("setReferrer", t.getReferrer()), this._isLatLon = o.isLatLon;
                    var n = this;
                    this._rtlTextPluginCallback = i.registerForPluginStateChange((function (e) {
                        n.dispatcher.broadcast("syncRTLPluginState", {
                            pluginStatus: e.pluginStatus,
                            pluginURL: e.pluginURL
                        }, (function (e, i) {
                            if (t.triggerPluginCompletionEvent(e), i && i.every((function (t) {
                                    return t
                                })))
                                for (var o in n.sourceCaches) n.sourceCaches[o].reload();
                        }));
                    })), this.on("data", (function (t) {
                        if ("source" === t.dataType && "metadata" === t.sourceDataType) {
                            var e = r.sourceCaches[t.sourceId];
                            if (e) {
                                var i = e.getSource();
                                if (i && i.vectorLayerIds)
                                    for (var o in r._layers) {
                                        var a = r._layers[o];
                                        a.source === i.id && r._validateLayer(a);
                                    }
                            }
                        }
                    }));
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.loadURL = function (e, i) {
                    var o = this;
                    void 0 === i && (i = {}), this.fire(new t.Event("dataloading", {
                        dataType: "style"
                    }));
                    var a = "boolean" == typeof i.validate ? i.validate : !g(e);
                    e = this.map._requestManager.normalizeStyleURL(e, i.appKey);
                    var r = this.map._requestManager.transformRequest(e, t.ResourceType.Style);
                    this._request = t.getJSON(r, (function (e, i) {
                        o._request = null, e ? o.fire(new t.ErrorEvent(e)) : i && o._load(i, a);
                    }));
                }, i.prototype.loadJSON = function (e, i) {
                    var o = this;
                    void 0 === i && (i = {}), this.fire(new t.Event("dataloading", {
                        dataType: "style"
                    })), this._request = t.browser.frame((function () {
                        o._request = null, o._load(e, !1 !== i.validate);
                    }));
                }, i.prototype.loadEmpty = function () {
                    this.fire(new t.Event("dataloading", {
                        dataType: "style"
                    })), this._load(ai, !1);
                }, i.prototype._load = function (e, i) {
                    if (!i || !ei(this, t.validateStyle(e))) {
                        for (var o in this._loaded = !0, this.stylesheet = e, e.sources) this.addSource(o, e.sources[o], {
                            validate: !1
                        });
                        e.sprite ? this._loadSprite(e.sprite) : this.imageManager.setLoaded(!0), this.glyphManager.setURL(e.glyphs);
                        var a = ie(this.stylesheet.layers);
                        this._order = a.map((function (t) {
                            return t.id
                        })), this._layers = {}, this._serializedLayers = {};
                        for (var r = 0, n = a; r < n.length; r += 1) {
                            var s = n[r];
                            "dynamicLine" !== s.type && "symtracking" !== s.type && "airline" !== s.type && "sprite" !== s.type && "tracking" !== s.type || (this.map.timer.state = !0), (s = t.createStyleLayer(s)).setEventedParent(this, {
                                layer: {
                                    id: s.id
                                }
                            }), this._layers[s.id] = s, this._serializedLayers[s.id] = s.serialize();
                        }
                        this.dispatcher.broadcast("setLayers", this._serializeLayers(this._order)), this._markOriginalStyle(), this.light = new F(this.stylesheet.light), this.fire(new t.Event("data", {
                            dataType: "style"
                        })), this.fire(new t.Event("style.load"));
                    }
                }, i.prototype._loadSprite = function (e) {
                    var i = this;
                    this._spriteRequest = function (e, i, o) {
                        var a, r, n, s = t.browser.devicePixelRatio > 1 ? "@2x" : "",
                            l = t.getJSON(i.transformRequest(i.normalizeSpriteURL(e, s, ".json"), t.ResourceType.SpriteJSON), (function (t, e) {
                                l = null, n || (n = t, a = e, u());
                            })),
                            c = t.getImage(i.transformRequest(i.normalizeSpriteURL(e, s, ".png"), t.ResourceType.SpriteImage), (function (t, e) {
                                c = null, n || (n = t, r = e, u());
                            }));

                        function u() {
                            if (n) o(n);
                            else if (a && r) {
                                var e = t.browser.getImageData(r),
                                    i = {};
                                for (var s in a) {
                                    var l = a[s],
                                        c = l.width,
                                        u = l.height,
                                        h = l.x,
                                        p = l.y,
                                        _ = l.sdf,
                                        m = l.pixelRatio,
                                        d = l.stretchX,
                                        f = l.stretchY,
                                        g = l.content,
                                        v = new t.RGBAImage({
                                            width: c,
                                            height: u
                                        });
                                    t.RGBAImage.copy(e, v, {
                                        x: h,
                                        y: p
                                    }, {
                                        x: 0,
                                        y: 0
                                    }, {
                                        width: c,
                                        height: u
                                    }), i[s] = {
                                        data: v,
                                        pixelRatio: m,
                                        sdf: _,
                                        stretchX: d,
                                        stretchY: f,
                                        content: g
                                    };
                                }
                                o(null, i);
                            }
                        }
                        return {
                            cancel: function () {
                                l && (l.cancel(), l = null), c && (c.cancel(), c = null);
                            }
                        }
                    }(e, this.map._requestManager, (function (e, o) {
                        if (i._spriteRequest = null, e) i.fire(new t.ErrorEvent(e));
                        else if (o)
                            for (var a in o) i.imageManager.addImage(a, o[a]);
                        i.imageManager.setLoaded(!0), i._availableImages = i.imageManager.listImages(), i.dispatcher.broadcast("setImages", i._availableImages), i.fire(new t.Event("data", {
                            dataType: "style"
                        }));
                    }));
                }, i.prototype._validateLayer = function (e) {
                    var i = this.sourceCaches[e.source];
                    if (i) {
                        var o = e.sourceLayer;
                        if (o) {
                            var a = i.getSource();
                            ("geojson" === a.type || a.vectorLayerIds && -1 === a.vectorLayerIds.indexOf(o)) && this.fire(new t.ErrorEvent(new Error('Source layer "' + o + '" does not exist on source "' + a.id + '" as specified by style layer "' + e.id + '"')));
                        }
                    }
                }, i.prototype.loaded = function () {
                    if (!this._loaded) return !1;
                    if (Object.keys(this._updatedSources).length) return !1;
                    for (var t in this.sourceCaches)
                        if (!this.sourceCaches[t].loaded()) return !1;
                    return !!this.imageManager.isLoaded()
                }, i.prototype._serializeLayers = function (t) {
                    for (var e = [], i = 0, o = t; i < o.length; i += 1) {
                        var a = this._layers[o[i]];
                        "custom" !== a.type && e.push(a.serialize());
                    }
                    return e
                }, i.prototype.hasTransitions = function () {
                    if (this.light && this.light.hasTransition()) return !0;
                    for (var t in this.sourceCaches)
                        if (this.sourceCaches[t].hasTransition()) return !0;
                    for (var e in this._layers)
                        if (this._layers[e].hasTransition()) return !0;
                    return !1
                }, i.prototype._checkLoaded = function () {
                    if (!this._loaded) throw new Error("Style is not done loading")
                }, i.prototype.update = function (e) {
                    if (this._loaded) {
                        var i = this._changed;
                        if (this._changed) {
                            var o = Object.keys(this._updatedLayers),
                                a = Object.keys(this._removedLayers);
                            for (var r in (o.length || a.length) && this._updateWorkerLayers(o, a), this._updatedSources) {
                                var n = this._updatedSources[r];
                                "reload" === n ? this._reloadSource(r) : "clear" === n && this._clearSource(r);
                            }
                            for (var s in this._updateTilesForChangedImages(), this._updatedPaintProps) this._layers[s].updateTransitions(e);
                            this.light.updateTransitions(e), this._resetUpdates();
                        }
                        for (var l in this.sourceCaches) this.sourceCaches[l].used = !1;
                        for (var c = 0, u = this._order; c < u.length; c += 1) {
                            var h = this._layers[u[c]];
                            h.recalculate(e, this._availableImages), !h.isHidden(e.zoom) && h.source && (this.sourceCaches[h.source].used = !0);
                        }
                        this.light.recalculate(e), this.z = e.zoom, i && this.fire(new t.Event("data", {
                            dataType: "style"
                        }));
                    }
                }, i.prototype._updateTilesForChangedImages = function () {
                    var t = Object.keys(this._changedImages);
                    if (t.length) {
                        for (var e in this.sourceCaches) this.sourceCaches[e].reloadTilesForDependencies(["icons", "patterns"], t);
                        this._changedImages = {};
                    }
                }, i.prototype._updateWorkerLayers = function (t, e) {
                    this.dispatcher.broadcast("updateLayers", {
                        layers: this._serializeLayers(t),
                        removedIds: e
                    });
                }, i.prototype._resetUpdates = function () {
                    this._changed = !1, this._updatedLayers = {}, this._removedLayers = {}, this._updatedSources = {}, this._updatedPaintProps = {}, this._changedImages = {};
                }, i.prototype.setState = function (e, i) {
                    var o = this;
                    if (this._checkLoaded(), ei(this, t.validateStyle(e))) return !1;
                    (e = t.clone$1(e)).layers = ie(e.layers);
                    var a = function (e, i, o, a, r) {
                        if (!e) return [{
                            command: oe.setStyle,
                            args: [i]
                        }];
                        var n = [];
                        try {
                            if (!t.deepEqual(e.version, i.version)) return [{
                                command: oe.setStyle,
                                args: [i]
                            }];
                            if (t.deepEqual(e.center, i.center) || n.push({
                                    command: oe.setCenter,
                                    args: [i.center]
                                }), t.deepEqual(e.zoom, i.zoom) || n.push({
                                    command: oe.setZoom,
                                    args: [i.zoom]
                                }), t.deepEqual(e.bearing, i.bearing) || n.push({
                                    command: oe.setBearing,
                                    args: [i.bearing]
                                }), t.deepEqual(e.pitch, i.pitch) || n.push({
                                    command: oe.setPitch,
                                    args: [i.pitch]
                                }), t.deepEqual(e.sprite, i.sprite) || n.push({
                                    command: oe.setSprite,
                                    args: [i.sprite]
                                }), t.deepEqual(e.glyphs, i.glyphs) || n.push({
                                    command: oe.setGlyphs,
                                    args: [i.glyphs]
                                }), t.deepEqual(e.transition, i.transition) || n.push({
                                    command: oe.setTransition,
                                    args: [i.transition]
                                }), t.deepEqual(e.light, i.light) || n.push({
                                    command: oe.setLight,
                                    args: [i.light]
                                }), o)
                                for (var s in i.sources) a.indexOf(s) < 0 && a.push(s);
                            var l = {},
                                c = [];
                            ! function (e, i, o, a, r, n) {
                                var s;
                                for (s in i = i || {}, e = e || {}) e.hasOwnProperty(s) && (r && n.indexOf(s) < 0 || i.hasOwnProperty(s) || (Array.isArray(n) && n.splice(n.indexOf(s), 1), re(s, o, a)));
                                for (s in i) i.hasOwnProperty(s) && (e.hasOwnProperty(s) ? t.deepEqual(e[s], i[s]) || ("geojson" === e[s].type && "geojson" === i[s].type && se(e, i, s) ? o.push({
                                    command: oe.setGeoJSONSourceData,
                                    args: [s, i[s].data]
                                }) : ne(s, i, o, a)) : (ae(s, i, o), Array.isArray(n) && n.push(s)));
                            }(e.sources, i.sources, c, l, o, a);
                            var u = [];
                            e.layers && e.layers.forEach((function (t) {
                                    l[t.source] ? (n.push({
                                        command: oe.removeLayer,
                                        args: [t.id]
                                    }), Array.isArray(r) && r.splice(r.indexOf(t.id), 1)) : u.push(t);
                                })), n = n.concat(c), o && (i.layers.forEach((function (t) {
                                    r.indexOf(t.id) < 0 && r.push(t.id);
                                })), u.forEach((function (t) {
                                    r.indexOf(t.id) < 0 && i.layers.push(t);
                                }))),
                                function (e, i, o, a) {
                                    i = i || [];
                                    var r, n, s, l, c, u, h, p = (e = e || []).map(ce),
                                        _ = i.map(ce),
                                        m = e.reduce(ue, {}),
                                        d = i.reduce(ue, {}),
                                        f = p.slice(),
                                        g = Object.create(null);
                                    for (r = 0, n = 0; r < p.length; r++) d.hasOwnProperty(s = p[r]) ? n++ : (o.push({
                                        command: oe.removeLayer,
                                        args: [s]
                                    }), f.splice(f.indexOf(s, n), 1), Array.isArray(a) && a.splice(a.indexOf(s), 1));
                                    for (r = 0, n = 0; r < _.length; r++) f[f.length - 1 - r] !== (s = _[_.length - 1 - r]) && (m.hasOwnProperty(s) ? (o.push({
                                        command: oe.removeLayer,
                                        args: [s]
                                    }), f.splice(f.lastIndexOf(s, f.length - n), 1)) : n++, o.push({
                                        command: oe.addLayer,
                                        args: [d[s], u = f[f.length - r]]
                                    }), f.splice(f.length - r, 0, s), g[s] = !0);
                                    for (r = 0; r < _.length; r++)
                                        if (l = m[s = _[r]], c = d[s], !g[s] && !t.deepEqual(l, c))
                                            if (t.deepEqual(l.source, c.source) && t.deepEqual(l["source-layer"], c["source-layer"]) && t.deepEqual(l.type, c.type)) {
                                                for (h in le(l.layout, c.layout, o, s, null, oe.setLayoutProperty), le(l.paint, c.paint, o, s, null, oe.setPaintProperty), t.deepEqual(l.filter, c.filter) || o.push({
                                                        command: oe.setFilter,
                                                        args: [s, c.filter]
                                                    }), t.deepEqual(l.minzoom, c.minzoom) && t.deepEqual(l.maxzoom, c.maxzoom) || o.push({
                                                        command: oe.setLayerZoomRange,
                                                        args: [s, c.minzoom, c.maxzoom]
                                                    }), l) l.hasOwnProperty(h) && "layout" !== h && "paint" !== h && "filter" !== h && "metadata" !== h && "minzoom" !== h && "maxzoom" !== h && 0 === h.indexOf("paint.") && le(l[h], c[h], o, s, h.slice(6), oe.setPaintProperty);
                                                for (h in c) c.hasOwnProperty(h) && !l.hasOwnProperty(h) && "layout" !== h && "paint" !== h && "filter" !== h && "metadata" !== h && "minzoom" !== h && "maxzoom" !== h && 0 === h.indexOf("paint.") && le(l[h], c[h], o, s, h.slice(6), oe.setPaintProperty);
                                            } else o.push({
                                                command: oe.removeLayer,
                                                args: [s]
                                            }), u = f[f.lastIndexOf(s) + 1], o.push({
                                                command: oe.addLayer,
                                                args: [c, u]
                                            });
                                }(u, i.layers, n, r);
                        } catch (t) {
                            console.warn("Unable to compute style diff:", t), n = [{
                                command: oe.setStyle,
                                args: [i]
                            }];
                        }
                        return n
                    }(this.serialize(), e, i, this._originalSource, this._originalLayer).filter((function (t) {
                        return !(t.command in oi)
                    }));
                    if (0 === a.length) return !1;
                    var r = a.filter((function (t) {
                        return !(t.command in ii)
                    }));
                    if (r.length > 0) throw new Error("Unimplemented: " + r.map((function (t) {
                        return t.command
                    })).join(", ") + ".");
                    return a.forEach((function (t) {
                        "setTransition" !== t.command && o[t.command].apply(o, t.args);
                    })), this.stylesheet = e, !0
                }, i.prototype.addImage = function (e, i) {
                    if (this.getImage(e)) return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));
                    this.imageManager.addImage(e, i), this._availableImages = this.imageManager.listImages(), this._changedImages[e] = !0, this._changed = !0, this.fire(new t.Event("data", {
                        dataType: "style"
                    }));
                }, i.prototype.updateImage = function (t, e) {
                    this.imageManager.updateImage(t, e);
                }, i.prototype.getImage = function (t) {
                    return this.imageManager.getImage(t)
                }, i.prototype.removeImage = function (e) {
                    if (!this.getImage(e)) return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));
                    this.imageManager.removeImage(e), this._availableImages = this.imageManager.listImages(), this._changedImages[e] = !0, this._changed = !0, this.fire(new t.Event("data", {
                        dataType: "style"
                    }));
                }, i.prototype.listImages = function () {
                    return this._checkLoaded(), this.imageManager.listImages()
                }, i.prototype.addSource = function (e, i, o) {
                    var a = this;
                    if (void 0 === o && (o = {}), this._checkLoaded(), void 0 !== this.sourceCaches[e]) throw new Error("There is already a source with this ID");
                    if (!i.type) throw new Error("The type property must be defined, but the only the following properties were given: " + Object.keys(i).join(", ") + ".");
                    if (!(["vector", "raster", "geojson", "video", "image"].indexOf(i.type) >= 0 && this._validate(t.validateStyle.source, "sources." + e, i, null, o))) {
                        this.map && this.map._collectResourceTiming && (i.collectResourceTiming = !0);
                        var r = this.sourceCaches[e] = new Xt(e, i, this.dispatcher, this._isLatLon);
                        r.style = this, r.setEventedParent(this, (function () {
                            return {
                                isSourceLoaded: a.loaded(),
                                source: r.serialize(),
                                sourceId: e
                            }
                        })), r.onAdd(this.map), this._changed = !0;
                    }
                }, i.prototype.removeSource = function (e) {
                    if (this._checkLoaded(), void 0 === this.sourceCaches[e]) throw new Error("There is no source with this ID");
                    var i = this.sourceCaches[e];
                    delete this.sourceCaches[e], delete this._updatedSources[e], i.fire(new t.Event("data", {
                        sourceDataType: "metadata",
                        dataType: "source",
                        sourceId: e
                    })), i.setEventedParent(null), i.clearTiles(), i.onRemove && i.onRemove(this.map), this._changed = !0;
                }, i.prototype.setGeoJSONSourceData = function (t, e) {
                    this._checkLoaded(), this.sourceCaches[t].getSource().setData(e), this._changed = !0;
                }, i.prototype.getSource = function (t) {
                    return this.sourceCaches[t] && this.sourceCaches[t].getSource()
                }, i.prototype.addLayer = function (e, i, o) {
                    void 0 === o && (o = {}), this._checkLoaded();
                    var a = e.id;
                    if (this.getLayer(a)) this.fire(new t.ErrorEvent(new Error('Layer with id "' + a + '" already exists on this map')));
                    else {
                        var r;
                        if ("custom" === e.type) {
                            if (ei(this, t.validateCustomStyleLayer(e))) return;
                            r = t.createStyleLayer(e);
                        } else {
                            if ("object" == typeof e.source && (this.addSource(a, e.source), e = t.clone$1(e), e = t.extend(e, {
                                    source: a
                                })), this._validate(t.validateStyle.layer, "layers." + a, e, {
                                    arrayIndex: -1
                                }, o)) return;
                            r = t.createStyleLayer(e), this._validateLayer(r), r.setEventedParent(this, {
                                layer: {
                                    id: a
                                }
                            }), this._serializedLayers[r.id] = r.serialize();
                        }
                        var n = i ? this._order.indexOf(i) : this._order.length;
                        if (i && -1 === n) this.fire(new t.ErrorEvent(new Error('Layer with id "' + i + '" does not exist on this map.')));
                        else {
                            if (this._order.splice(n, 0, a), this._layerOrderChanged = !0, this._layers[a] = r, this._removedLayers[a] && r.source && "custom" !== r.type) {
                                var s = this._removedLayers[a];
                                delete this._removedLayers[a], s.type !== r.type ? this._updatedSources[r.source] = "clear" : (this._updatedSources[r.source] = "reload", this.sourceCaches[r.source].pause());
                            }
                            this._updateLayer(r), r.onAdd && r.onAdd(this.map);
                        }
                    }
                }, i.prototype.moveLayer = function (e, i) {
                    if (this._checkLoaded(), this._changed = !0, this._layers[e]) {
                        if (e !== i) {
                            var o = this._order.indexOf(e);
                            this._order.splice(o, 1);
                            var a = i ? this._order.indexOf(i) : this._order.length;
                            i && -1 === a ? this.fire(new t.ErrorEvent(new Error('Layer with id "' + i + '" does not exist on this map.'))) : (this._order.splice(a, 0, e), this._layerOrderChanged = !0);
                        }
                    } else this.fire(new t.ErrorEvent(new Error("The layer '" + e + "' does not exist in the map's style and cannot be moved.")));
                }, i.prototype.removeLayer = function (e) {
                    this._checkLoaded();
                    var i = this._layers[e];
                    if (i) {
                        i.setEventedParent(null);
                        var o = this._order.indexOf(e);
                        this._order.splice(o, 1), this._layerOrderChanged = !0, this._changed = !0, this._removedLayers[e] = i, delete this._layers[e], delete this._serializedLayers[e], delete this._updatedLayers[e], delete this._updatedPaintProps[e], i.onRemove && i.onRemove(this.map);
                    } else this.fire(new t.ErrorEvent(new Error("The layer '" + e + "' does not exist in the map's style and cannot be removed.")));
                }, i.prototype.getLayer = function (t) {
                    return this._layers[t]
                }, i.prototype.hasLayer = function (t) {
                    return t in this._layers
                }, i.prototype.setLayerZoomRange = function (e, i, o) {
                    this._checkLoaded();
                    var a = this.getLayer(e);
                    a ? a.minzoom === i && a.maxzoom === o || (null != i && (a.minzoom = i), null != o && (a.maxzoom = o), this._updateLayer(a)) : this.fire(new t.ErrorEvent(new Error("The layer '" + e + "' does not exist in the map's style and cannot have zoom extent.")));
                }, i.prototype.setFilter = function (e, i, o) {
                    void 0 === o && (o = {}), this._checkLoaded();
                    var a = this.getLayer(e);
                    if (a) {
                        if (!t.deepEqual(a.filter, i)) return null == i ? (a.filter = void 0, void this._updateLayer(a)) : void(this._validate(t.validateStyle.filter, "layers." + a.id + ".filter", i, null, o) || (a.filter = t.clone$1(i), this._updateLayer(a)))
                    } else this.fire(new t.ErrorEvent(new Error("The layer '" + e + "' does not exist in the map's style and cannot be filtered.")));
                }, i.prototype.getFilter = function (e) {
                    return t.clone$1(this.getLayer(e).filter)
                }, i.prototype.setLayoutProperty = function (e, i, o, a) {
                    void 0 === a && (a = {}), this._checkLoaded();
                    var r = this.getLayer(e);
                    r ? t.deepEqual(r.getLayoutProperty(i), o) || (r.setLayoutProperty(i, o, a), this._updateLayer(r)) : this.fire(new t.ErrorEvent(new Error("The layer '" + e + "' does not exist in the map's style and cannot be styled.")));
                }, i.prototype.getLayoutProperty = function (e, i) {
                    var o = this.getLayer(e);
                    if (o) return o.getLayoutProperty(i);
                    this.fire(new t.ErrorEvent(new Error("The layer '" + e + "' does not exist in the map's style.")));
                }, i.prototype.setPaintProperty = function (e, i, o, a) {
                    void 0 === a && (a = {}), this._checkLoaded();
                    var r = this.getLayer(e);
                    r ? t.deepEqual(r.getPaintProperty(i), o) || (r.setPaintProperty(i, o, a) && this._updateLayer(r), this._changed = !0, this._updatedPaintProps[e] = !0) : this.fire(new t.ErrorEvent(new Error("The layer '" + e + "' does not exist in the map's style and cannot be styled.")));
                }, i.prototype.getPaintProperty = function (t, e) {
                    return this.getLayer(t).getPaintProperty(e)
                }, i.prototype.setFeatureState = function (e, i) {
                    this._checkLoaded();
                    var o = e.source,
                        a = e.sourceLayer,
                        r = this.sourceCaches[o];
                    if (void 0 !== r) {
                        var n = r.getSource().type;
                        "geojson" === n && a ? this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))) : "vector" !== n || a ? (void 0 === e.id && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))), r.setFeatureState(a, e.id, i)) : this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
                    } else this.fire(new t.ErrorEvent(new Error("The source '" + o + "' does not exist in the map's style.")));
                }, i.prototype.removeFeatureState = function (e, i) {
                    this._checkLoaded();
                    var o = e.source,
                        a = this.sourceCaches[o];
                    if (void 0 !== a) {
                        var r = a.getSource().type,
                            n = "vector" === r ? e.sourceLayer : void 0;
                        "vector" !== r || n ? i && "string" != typeof e.id && "number" != typeof e.id ? this.fire(new t.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))) : a.removeFeatureState(n, e.id, i) : this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
                    } else this.fire(new t.ErrorEvent(new Error("The source '" + o + "' does not exist in the map's style.")));
                }, i.prototype.getFeatureState = function (e) {
                    this._checkLoaded();
                    var i = e.source,
                        o = e.sourceLayer,
                        a = this.sourceCaches[i];
                    if (void 0 !== a) {
                        if ("vector" !== a.getSource().type || o) return void 0 === e.id && this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))), a.getFeatureState(o, e.id);
                        this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));
                    } else this.fire(new t.ErrorEvent(new Error("The source '" + i + "' does not exist in the map's style.")));
                }, i.prototype.getTransition = function () {
                    return t.extend({
                        duration: 300,
                        delay: 0
                    }, this.stylesheet && this.stylesheet.transition)
                }, i.prototype.serialize = function () {
                    return t.filterObject({
                        version: this.stylesheet.version,
                        name: this.stylesheet.name,
                        metadata: this.stylesheet.metadata,
                        light: this.stylesheet.light,
                        center: this.stylesheet.center,
                        zoom: this.stylesheet.zoom,
                        bearing: this.stylesheet.bearing,
                        pitch: this.stylesheet.pitch,
                        sprite: this.stylesheet.sprite,
                        glyphs: this.stylesheet.glyphs,
                        transition: this.stylesheet.transition,
                        sources: t.mapObject(this.sourceCaches, (function (t) {
                            return t.serialize()
                        })),
                        layers: this._serializeLayers(this._order)
                    }, (function (t) {
                        return void 0 !== t
                    }))
                }, i.prototype._updateLayer = function (t) {
                    this._updatedLayers[t.id] = !0, t.source && !this._updatedSources[t.source] && "raster" !== this.sourceCaches[t.source].getSource().type && (this._updatedSources[t.source] = "reload", this.sourceCaches[t.source].pause()), this._changed = !0;
                }, i.prototype._flattenAndSortRenderedFeatures = function (e) {
                    for (var i = this, o = function (t) {
                            return "fill-extrusion" === i._layers[t].type
                        }, a = {}, r = [], n = this._order.length - 1; n >= 0; n--) {
                        var s = this._order[n];
                        if (o(s)) {
                            a[s] = n;
                            for (var l = 0, c = e; l < c.length; l += 1) {
                                var u = c[l][s];
                                if (u)
                                    for (var h = 0, p = u; h < p.length; h += 1) r.push(p[h]);
                            }
                        }
                    }
                    r.sort((function (t, e) {
                        return e.intersectionZ - t.intersectionZ
                    }));
                    for (var _ = [], m = this._order.length - 1; m >= 0; m--) {
                        var d = this._order[m];
                        if (o(d))
                            for (var f = r.length - 1; f >= 0; f--) {
                                var g = r[f].feature;
                                if (a[g.layer.id] < m) break;
                                _.push(g), r.pop();
                            } else
                                for (var v = 0, y = e; v < y.length; v += 1) {
                                    var x = y[v][d];
                                    if (x)
                                        for (var w = 0, b = x; w < b.length; w += 1) _.push(b[w].feature);
                                }
                    }
                    return this._isLatLon && t.resultfakeToReal(_), _
                }, i.prototype.queryRenderedFeatures = function (e, i, o) {
                    i && i.filter && this._validate(t.validateStyle.filter, "queryRenderedFeatures.filter", i.filter, null, i);
                    var a = {};
                    if (i && i.layers) {
                        if (!Array.isArray(i.layers)) return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))), [];
                        for (var r = 0, n = i.layers; r < n.length; r += 1) {
                            var s = n[r],
                                l = this._layers[s];
                            if (!l) return this.fire(new t.ErrorEvent(new Error("The layer '" + s + "' does not exist in the map's style and cannot be queried for features."))), [];
                            a[l.source] = !0;
                        }
                    }
                    var c = [];
                    for (var u in i.availableImages = this._availableImages, this.sourceCaches) i.layers && !a[u] || c.push(tt(this.sourceCaches[u], this._layers, this._serializedLayers, e, i, o));
                    return this.placement && c.push(function (t, e, i, o, a, r, n) {
                        for (var s = {}, l = r.queryRenderedSymbols(o), c = [], u = 0, h = Object.keys(l).map(Number); u < h.length; u += 1) c.push(n[h[u]]);
                        c.sort(et);
                        for (var p = function () {
                                var i = m[_],
                                    o = i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId], e, i.bucketIndex, i.sourceLayerIndex, a.filter, a.layers, a.availableImages, t);
                                for (var r in o) {
                                    var n = s[r] = s[r] || [],
                                        c = o[r];
                                    c.sort((function (t, e) {
                                        var o = i.featureSortOrder;
                                        if (o) {
                                            var a = o.indexOf(t.featureIndex);
                                            return o.indexOf(e.featureIndex) - a
                                        }
                                        return e.featureIndex - t.featureIndex
                                    }));
                                    for (var u = 0, h = c; u < h.length; u += 1) n.push(h[u]);
                                }
                            }, _ = 0, m = c; _ < m.length; _ += 1) p();
                        var d = function (e) {
                            s[e].forEach((function (o) {
                                var a = o.feature,
                                    r = i[t[e].source].getFeatureState(a.layer["source-layer"], a.id);
                                a.source = a.layer.source, a.layer["source-layer"] && (a.sourceLayer = a.layer["source-layer"]), a.state = r;
                            }));
                        };
                        for (var f in s) d(f);
                        return s
                    }(this._layers, this._serializedLayers, this.sourceCaches, e, i, this.placement.collisionIndex, this.placement.retainedQueryData)), this._flattenAndSortRenderedFeatures(c)
                }, i.prototype.querySourceFeatures = function (e, i) {
                    i && i.filter && this._validate(t.validateStyle.filter, "querySourceFeatures.filter", i.filter, null, i);
                    var o = this.sourceCaches[e],
                        a = o ? function (t, e) {
                            for (var i = t.getRenderableIds().map((function (e) {
                                    return t.getTileByID(e)
                                })), o = [], a = {}, r = 0; r < i.length; r++) {
                                var n = i[r],
                                    s = n.tileID.canonical.key;
                                a[s] || (a[s] = !0, n.querySourceFeatures(o, e));
                            }
                            return o
                        }(o, i) : [];
                    return this._isLatLon && t.resultfakeToReal(a), a
                }, i.prototype.addSourceType = function (t, e, o) {
                    return i.getSourceType(t) ? o(new Error('A source type called "' + t + '" already exists.')) : (i.setSourceType(t, e), e.workerSourceURL ? void this.dispatcher.broadcast("loadWorkerSource", {
                        name: t,
                        url: e.workerSourceURL
                    }, o) : o(null, null))
                }, i.prototype.getLight = function () {
                    return this.light.getLight()
                }, i.prototype.setLight = function (e, i) {
                    void 0 === i && (i = {}), this._checkLoaded();
                    var o = this.light.getLight(),
                        a = !1;
                    for (var r in e)
                        if (!t.deepEqual(e[r], o[r])) {
                            a = !0;
                            break
                        } if (a) {
                        var n = {
                            now: t.browser.now(),
                            transition: t.extend({
                                duration: 300,
                                delay: 0
                            }, this.stylesheet.transition)
                        };
                        this.light.setLight(e, i), this.light.updateTransitions(n);
                    }
                }, i.prototype._validate = function (e, i, o, a, r) {
                    return void 0 === r && (r = {}), (!r || !1 !== r.validate) && ei(this, e.call(t.validateStyle, t.extend({
                        key: i,
                        style: this.serialize(),
                        value: o,
                        styleSpec: t.styleSpec
                    }, a)))
                }, i.prototype._remove = function () {
                    for (var e in this._request && (this._request.cancel(), this._request = null), this._spriteRequest && (this._spriteRequest.cancel(), this._spriteRequest = null), t.evented.off("pluginStateChange", this._rtlTextPluginCallback), this._layers) this._layers[e].setEventedParent(null);
                    for (var i in this.sourceCaches) this.sourceCaches[i].clearTiles(), this.sourceCaches[i].setEventedParent(null);
                    this.imageManager.setEventedParent(null), this.setEventedParent(null), this.dispatcher.remove();
                }, i.prototype._clearSource = function (t) {
                    this.sourceCaches[t].clearTiles();
                }, i.prototype._reloadSource = function (t) {
                    this.sourceCaches[t].resume(), this.sourceCaches[t].reload();
                }, i.prototype._updateSources = function (t) {
                    for (var e in this.sourceCaches) this.sourceCaches[e].update(t);
                }, i.prototype._generateCollisionBoxes = function () {
                    for (var t in this.sourceCaches) this._reloadSource(t);
                }, i.prototype._updatePlacement = function (e, i, o, a, r) {
                    void 0 === r && (r = !1);
                    for (var n = !1, s = !1, l = {}, c = 0, u = this._order; c < u.length; c += 1) {
                        var h = this._layers[u[c]];
                        if ("symbol" === h.type || "symtracking" === h.type) {
                            if (!l[h.source]) {
                                var p = this.sourceCaches[h.source];
                                l[h.source] = p.getRenderableIds(!0).map((function (t) {
                                    return p.getTileByID(t)
                                })).sort((function (t, e) {
                                    return e.tileID.overscaledZ - t.tileID.overscaledZ || (t.tileID.isLessThan(e.tileID) ? -1 : 1)
                                }));
                            }
                            var _ = this.crossTileSymbolIndex.addLayer(h, l[h.source], e.center.lng);
                            n = n || _;
                        }
                    }
                    if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order), ((r = r || this._layerOrderChanged || 0 === o) || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(t.browser.now(), e.zoom)) && (this.pauseablePlacement = new Ke(e, this._order, r, i, o, a, this.placement), this._layerOrderChanged = !1), this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, l), this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(t.browser.now()), s = !0), n && this.pauseablePlacement.placement.setStale()), s || n)
                        for (var m = 0, d = this._order; m < d.length; m += 1) {
                            var f = this._layers[d[m]];
                            "symbol" !== f.type && "symtracking" !== f.type || this.placement.updateLayerOpacities(f, l[f.source]);
                        }
                    return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(t.browser.now())
                }, i.prototype._releaseSymbolFadeTiles = function () {
                    for (var t in this.sourceCaches) this.sourceCaches[t].releaseSymbolFadeTiles();
                }, i.prototype.getImages = function (t, e, i) {
                    this.imageManager.getImages(e.icons, i), this._updateTilesForChangedImages();
                    var o = this.sourceCaches[e.source];
                    o && o.setDependencies(e.tileID.key, e.type, e.icons);
                }, i.prototype.getGlyphs = function (t, e, i) {
                    this.glyphManager.getGlyphs(e.stacks, i);
                }, i.prototype.getResource = function (e, i, o) {
                    return t.makeRequest(i, o)
                }, i.prototype._markOriginalStyle = function () {
                    for (var t in this.sourceCaches) this._originalSource.push(t);
                    for (var e in this._layers) this._originalLayer.push(e);
                }, i
            }(t.Evented);
        ri.getSourceType = function (t) {
            return Q[t]
        }, ri.setSourceType = function (t, e) {
            Q[t] = e;
        }, ri.registerForPluginStateChange = t.registerForPluginStateChange;
        var ni = t.createLayout([{
                name: "a_pos",
                type: "Int16",
                components: 2
            }]),
            si = Zi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif", "#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),
            li = Zi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),
            ci = Zi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),
            ui = Zi("varying vec3 v_data;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define mediump float radius\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define highp vec4 stroke_color\n#pragma minemap: define mediump float stroke_width\n#pragma minemap: define lowp float stroke_opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize mediump float radius\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize highp vec4 stroke_color\n#pragma minemap: initialize mediump float stroke_width\n#pragma minemap: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define mediump float radius\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define highp vec4 stroke_color\n#pragma minemap: define mediump float stroke_width\n#pragma minemap: define lowp float stroke_opacity\nvoid main(void) {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize mediump float radius\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize highp vec4 stroke_color\n#pragma minemap: initialize mediump float stroke_width\n#pragma minemap: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),
            hi = Zi("void main() {gl_FragColor=vec4(1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),
            pi = Zi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma minemap: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma minemap: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma minemap: define highp float weight\n#pragma minemap: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma minemap: initialize highp float weight\n#pragma minemap: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),
            _i = Zi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),
            mi = Zi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}", "attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),
            di = Zi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}", "attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),
            fi = Zi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}", "attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),
            gi = Zi("#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),
            vi = Zi("varying vec2 v_pos;\n#pragma minemap: define highp vec4 outline_color\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 outline_color\n#pragma minemap: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma minemap: define highp vec4 outline_color\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 outline_color\n#pragma minemap: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),
            yi = Zi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\nvoid main() {\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\n#pragma minemap: define lowp float pixel_ratio_from\n#pragma minemap: define lowp float pixel_ratio_to\nvoid main() {\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\n#pragma minemap: initialize lowp float pixel_ratio_from\n#pragma minemap: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),
            xi = Zi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\nvoid main() {\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\n#pragma minemap: define lowp float pixel_ratio_from\n#pragma minemap: define lowp float pixel_ratio_to\nvoid main() {\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\n#pragma minemap: initialize lowp float pixel_ratio_from\n#pragma minemap: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),
            wi = Zi("#define TAU 6.28318530718\n#define MAX_ITER 5\n#define INTENSITY 0.004\n#define SCALE 1000.0\nuniform lowp float u_time;void main() {vec2 uv=gl_FragCoord.xy/SCALE;vec2 p=mod(uv*TAU,TAU)-250.0;vec2 i=vec2(p);float c=1.0;for (int n=0; n < MAX_ITER; n++) {float t=0.5*u_time*(1.0-(3.5/float(n+1)));i=p+vec2(cos(t-i.x)+sin(t+i.y),sin(t-i.y)+cos(t+i.x));c+=1.0/length(vec2(p.x/(sin(i.x+t)/INTENSITY),p.y/(cos(i.y+t)/INTENSITY)));}c=1.17-pow(c/float(MAX_ITER),1.4);gl_FragColor=vec4(clamp(vec3(pow(abs(c),8.0))+vec3(0.0,0.35,0.5),0.0,1.0),1.0);}", "attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma minemap: define lowp vec4 color\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize lowp vec4 color\n#pragma minemap: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),
            bi = Zi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma minemap: define highp float base\n#pragma minemap: define highp float height\n#pragma minemap: define highp vec4 color\nvoid main() {\n#pragma minemap: initialize highp float base\n#pragma minemap: initialize highp float height\n#pragma minemap: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),
            Ti = Zi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma minemap: define lowp float base\n#pragma minemap: define lowp float height\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\n#pragma minemap: define lowp float pixel_ratio_from\n#pragma minemap: define lowp float pixel_ratio_to\nvoid main() {\n#pragma minemap: initialize lowp float base\n#pragma minemap: initialize lowp float height\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\n#pragma minemap: initialize lowp float pixel_ratio_from\n#pragma minemap: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma minemap: define lowp float base\n#pragma minemap: define lowp float height\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\n#pragma minemap: define lowp float pixel_ratio_from\n#pragma minemap: define lowp float pixel_ratio_to\nvoid main() {\n#pragma minemap: initialize lowp float base\n#pragma minemap: initialize lowp float height\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\n#pragma minemap: initialize lowp float pixel_ratio_from\n#pragma minemap: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),
            Ei = Zi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),
            Si = Zi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),
            Ii = Zi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define highp vec4 border_color\n#pragma minemap: define mediump float border_width\n#pragma minemap: define lowp float border_opacity\nuniform mediump float u_hasBorder;void main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize highp vec4 border_color\n#pragma minemap: initialize mediump float border_width\n#pragma minemap: initialize lowp float border_opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);if(u_hasBorder !=1.0){gl_FragColor=color*(alpha*opacity);}else {gl_FragColor=border_color*(alpha*border_opacity);}\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform mediump float u_half_render;uniform mediump float u_hasBorder;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define lowp float normal_direction\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float width\n#pragma minemap: define highp vec4 border_color\n#pragma minemap: define mediump float border_width\n#pragma minemap: define lowp float border_opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize lowp float normal_direction\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float width\n#pragma minemap: initialize highp vec4 border_color\n#pragma minemap: initialize mediump float border_width\n#pragma minemap: initialize lowp float border_opacity\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_hasBorder==1.0) ? (border_width*2.0+width)/2.0 : width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);if(u_half_render==1.){if(normal_direction==1.){outset=gapwidth+(normal.y>0.?halfwidth:0.)*(gapwidth > 0.0 ? 2.0 : 1.0)+ANTIALIASING;}else{outset=gapwidth+(normal.y<0.?halfwidth:0.)*(gapwidth > 0.0 ? 2.0 : 1.0)+ANTIALIASING;}}mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
            zi = Zi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float width\nvoid main() {\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
            Ci = Zi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\n#pragma minemap: define lowp float pixel_ratio_from\n#pragma minemap: define lowp float pixel_ratio_to\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\n#pragma minemap: initialize lowp float pixel_ratio_from\n#pragma minemap: initialize lowp float pixel_ratio_to\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define mediump float width\n#pragma minemap: define lowp float floorwidth\n#pragma minemap: define lowp vec4 pattern_from\n#pragma minemap: define lowp vec4 pattern_to\n#pragma minemap: define lowp float pixel_ratio_from\n#pragma minemap: define lowp float pixel_ratio_to\nvoid main() {\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize mediump float width\n#pragma minemap: initialize lowp float floorwidth\n#pragma minemap: initialize mediump vec4 pattern_from\n#pragma minemap: initialize mediump vec4 pattern_to\n#pragma minemap: initialize lowp float pixel_ratio_from\n#pragma minemap: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),
            Pi = Zi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float width\n#pragma minemap: define lowp float floorwidth\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float width\n#pragma minemap: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float width\n#pragma minemap: define lowp float floorwidth\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float width\n#pragma minemap: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),
            Li = Zi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),
            Ai = Zi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),
            Mi = Zi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma minemap: define highp vec4 fill_color\n#pragma minemap: define highp vec4 halo_color\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp float halo_width\n#pragma minemap: define lowp float halo_blur\nvoid main() {\n#pragma minemap: initialize highp vec4 fill_color\n#pragma minemap: initialize highp vec4 halo_color\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize lowp float halo_width\n#pragma minemap: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma minemap: define highp vec4 fill_color\n#pragma minemap: define highp vec4 halo_color\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp float halo_width\n#pragma minemap: define lowp float halo_blur\nvoid main() {\n#pragma minemap: initialize highp vec4 fill_color\n#pragma minemap: initialize highp vec4 halo_color\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize lowp float halo_width\n#pragma minemap: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),
            Di = Zi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma minemap: define highp vec4 fill_color\n#pragma minemap: define highp vec4 halo_color\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp float halo_width\n#pragma minemap: define lowp float halo_blur\nvoid main() {\n#pragma minemap: initialize highp vec4 fill_color\n#pragma minemap: initialize highp vec4 halo_color\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize lowp float halo_width\n#pragma minemap: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma minemap: define highp vec4 fill_color\n#pragma minemap: define highp vec4 halo_color\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp float halo_width\n#pragma minemap: define lowp float halo_blur\nvoid main() {\n#pragma minemap: initialize highp vec4 fill_color\n#pragma minemap: initialize highp vec4 halo_color\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize lowp float halo_width\n#pragma minemap: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),
            Ri = Zi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying float v_height;varying float _is_discard;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\nif(_is_discard<0.0) discard;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_height;attribute vec2 a_seq;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_start;uniform float u_segments;uniform float u_discard;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;varying float _is_discard;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float width\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float width\nfloat count=mod(u_start,a_seq[1]);_is_discard=100.0;if(u_discard==1.0){if((count+u_segments)<=a_seq[1] && (a_seq[0]<(count) || a_seq[0]>(count+u_segments))){_is_discard=-100.0;}else if((count+u_segments)>a_seq[1] && (a_seq[0]> (count+u_segments-a_seq[1]) && a_seq[0]<count)){_is_discard=-100.0;}}float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,float(a_height)*10.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
            ki = Zi("uniform lowp float u_device_pixel_ratio;uniform float u_count;uniform float u_segments;varying float v_seq;varying vec2 v_info;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\nfloat total_count=v_info[0];float offset_count=v_info[1];float actualSeq=v_seq-2.0;float actualCount=u_count+offset_count;float quotient=floor(actualCount/(total_count+u_segments));float mod1=mod(quotient,2.0);float count=mod(actualCount,total_count+u_segments);if(mod1 !=0.0){count=total_count+u_segments-count;}float start=count-u_segments;float end=count;if(actualSeq < start || actualSeq > end){discard;}mediump float drive_opacity=(actualSeq-start)/u_segments;if(mod1 !=0.0){drive_opacity=1.0-drive_opacity;}float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 tmpColor=vec4(color.xyz,0.25);gl_FragColor=tmpColor*(alpha*opacity)*drive_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_seq;attribute vec2 a_info;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_gl_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;varying float v_seq;varying vec2 v_info;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float width\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;v_seq=a_seq;v_info=a_info;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
            Oi = Zi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying float v_opacity;varying float v_discard;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\nif(v_discard<0.0){discard;}float opacity_m=v_opacity;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity)*opacity_m;;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute vec3 a_extra_m;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform lowp float u_count;uniform vec4 u_speed_mat;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;varying float v_opacity;varying float v_discard;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float speed_factor\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float width\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float speed_factor\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float width\nvec3 f_extra_m=vec3(a_extra_m[0]*3.0/255.0,a_extra_m[1],a_extra_m[2]);float status=f_extra_m[2];float link_seq=f_extra_m[1];v_opacity=f_extra_m[0];int speed1;int speed2;int speed3;int speed4;if (speed_factor==1.0) {speed1=int(u_count)-(int(u_count)/20)*20;} else if (speed_factor==2.0) {speed2=int(u_count)-(int(u_count)/80)*80;} else if (speed_factor==3.0) {speed3=int(u_count)-(int(u_count)/150)*150;} else {speed4=int(u_count)-(int(u_count)/240)*240;}speed1=speed1/2;speed2=speed2/8;speed3=speed3/15;speed4=speed4/24;if(status==1.0){if(link_seq!=float(speed1)){v_discard=-100.0;}else{v_discard=100.0;}}else if(status==2.0){if(link_seq!=float(speed2)){v_discard=-100.0;}else{v_discard=100.0;}}else if(status==3.0){if(link_seq!=float(speed3)){v_discard=-100.0;}else{v_discard=100.0;}}else if(status==4.0){if(link_seq!=float(speed4)){v_discard=-100.0;}else{v_discard=100.0;}}float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
            Bi = Zi("uniform lowp float u_device_pixel_ratio;uniform float u_start;uniform float u_end;uniform float u_segments;uniform float u_reverse;uniform float u_reserve;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying float v_seq;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\nmediump float drive_opacity=1.0;if(u_reserve==1.0){if(v_seq>u_end){discard;}}else{if(v_seq<u_start || v_seq>u_end){discard;}drive_opacity=(v_seq-u_start)/u_segments;if(u_reverse==1.0){drive_opacity=1.0-drive_opacity;}}float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 tmpColor=vec4(color.xyz,0.25);gl_FragColor=tmpColor*(alpha*opacity)*drive_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_seq;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;varying float v_seq;\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp float blur\n#pragma minemap: define lowp float opacity\n#pragma minemap: define mediump float gapwidth\n#pragma minemap: define lowp float offset\n#pragma minemap: define mediump float width\nvoid main() {\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp float blur\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize mediump float gapwidth\n#pragma minemap: initialize lowp float offset\n#pragma minemap: initialize mediump float width\nv_seq=a_seq;float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),
            Ui = Zi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;varying float v_seq;\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize lowp float opacity\nif(v_seq<0.0){discard;}lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;attribute float a_extra;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform float u_seq;varying vec2 v_tex;varying float v_fade_opacity;varying float v_seq;\n#pragma minemap: define lowp float opacity\nvoid main() {\n#pragma minemap: initialize lowp float opacity\nfloat a_seq=a_extra;if(a_seq!=u_seq){v_seq=-100.0;}else{v_seq=100.0;}vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),
            Fi = Zi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;varying float v_seq;\n#pragma minemap: define highp vec4 fill_color\n#pragma minemap: define highp vec4 halo_color\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp float halo_width\n#pragma minemap: define lowp float halo_blur\nvoid main() {\n#pragma minemap: initialize highp vec4 fill_color\n#pragma minemap: initialize highp vec4 halo_color\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize lowp float halo_width\n#pragma minemap: initialize lowp float halo_blur\nif(v_seq<0.0){discard;}float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;attribute float a_extra;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform float u_seq;varying vec2 v_data0;varying vec3 v_data1;varying float v_seq;\n#pragma minemap: define highp vec4 fill_color\n#pragma minemap: define highp vec4 halo_color\n#pragma minemap: define lowp float opacity\n#pragma minemap: define lowp float halo_width\n#pragma minemap: define lowp float halo_blur\nvoid main() {\n#pragma minemap: initialize highp vec4 fill_color\n#pragma minemap: initialize highp vec4 halo_color\n#pragma minemap: initialize lowp float opacity\n#pragma minemap: initialize lowp float halo_width\n#pragma minemap: initialize lowp float halo_blur\nfloat a_seq=a_extra;if(a_seq!=u_seq){v_seq=-100.0;}else{v_seq=100.0;}vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),
            Ni = Zi("varying vec4 v_color;uniform lowp float u_depth_render;uniform lowp float u_opacity;varying float v_opacity;void main() {if(u_depth_render==1.0){gl_FragColor=vec4(v_color.rgb*v_opacity*u_opacity,v_color.a);}else{gl_FragColor=v_color*v_opacity*u_opacity;}\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);;\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_is_max_length;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma minemap: define highp float base\n#pragma minemap: define highp float height\n#pragma minemap: define highp vec4 color\nvarying float v_opacity;void main() {\n#pragma minemap: initialize highp float base\n#pragma minemap: initialize highp float height\n#pragma minemap: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? ( u_is_max_length==1.0 ? height*100.0 : height ) : ( u_is_max_length==1.0 ? base*100.0 : base ),1);if(t > 0.0){v_opacity=1.2;}else{v_opacity=0.1;}float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0);}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);}"),
            qi = Zi("uniform vec4 u_color_a;uniform vec4 u_color_b;uniform vec4 u_color_c;uniform vec4 u_color_d;uniform vec4 u_color_e;uniform float u_max_height;varying vec4 v_color;varying float v_opacity;varying float v_height;varying float v_directional;void main() {if (v_height < 0.25*u_max_height) {vec4 tmp=u_color_b-u_color_a;vec4 real=tmp*((v_height)/0.25/u_max_height)+u_color_a;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else if (v_height < 0.5*u_max_height) {vec4 tmp=u_color_c-u_color_b;vec4 real=tmp*((v_height-0.25*u_max_height)/0.25/u_max_height)+u_color_b;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else if (v_height < 0.75*u_max_height) {vec4 tmp=u_color_d-u_color_c;vec4 real=tmp*((v_height-0.5*u_max_height)/0.25/u_max_height)+u_color_c;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else if (v_height < 0.8*u_max_height){vec4 tmp=u_color_e-u_color_d;vec4 real=tmp*((v_height-0.75*u_max_height)/0.25/u_max_height)+u_color_d;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else{gl_FragColor=vec4(u_color_e.rgb*v_directional,1.0);}\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);;\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_is_max_length;uniform float u_vertical_gradient;uniform lowp float u_opacity;varying float v_height;varying float v_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;varying float v_directional;\n#pragma minemap: define highp float base\n#pragma minemap: define highp float height\n#pragma minemap: define highp vec4 color\nvoid main() {\n#pragma minemap: initialize highp float base\n#pragma minemap: initialize highp float height\n#pragma minemap: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? ( u_is_max_length==1.0 ? height*100.0 : height ) : ( u_is_max_length==1.0 ? base*100.0 : base ),1);if(t > 0.0){v_opacity=1.2;v_height=height*3.0;}else{v_opacity=0.1;v_height=0.0;}float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0);}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_directional=directional;}"),
            ji = Zi("varying vec4 v_color;uniform vec4 u_color_a;uniform vec4 u_color_b;uniform vec4 u_color_c;uniform vec4 u_color_d;uniform vec4 u_color_e;uniform float u_max_height;\n#pragma minemap: define lowp float base\n#pragma minemap: define lowp float height\n#pragma minemap: define highp vec4 color\nvarying float v_opacity;varying float v_height;varying float v_directional;void main() {\n#pragma minemap: initialize lowp float base\n#pragma minemap: initialize lowp float height\n#pragma minemap: initialize highp vec4 color\nif (v_height < 0.2*u_max_height) {vec4 tmp=u_color_b-u_color_a;vec4 real=tmp*((v_height)/0.2/u_max_height)+u_color_a;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else if (v_height < 0.4*u_max_height) {vec4 tmp=u_color_c-u_color_b;vec4 real=tmp*((v_height-0.2*u_max_height)/0.2/u_max_height)+u_color_b;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else if (v_height < 0.6*u_max_height) {vec4 tmp=u_color_d-u_color_c;vec4 real=tmp*((v_height-0.4*u_max_height)/0.2/u_max_height)+u_color_c;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else if (v_height < 0.8*u_max_height){vec4 tmp=u_color_e-u_color_d;vec4 real=tmp*((v_height-0.6*u_max_height)/0.2/u_max_height)+u_color_d;gl_FragColor=vec4(real.rgb*v_directional,1.0);} else{gl_FragColor=vec4(u_color_e.rgb*v_directional,1.0);}\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}", "uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform lowp float u_dyn_count;uniform float u_fluorescent;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;varying float v_opacity;varying float v_height;varying float v_directional;\n#pragma minemap: define lowp float base\n#pragma minemap: define lowp float height\n#pragma minemap: define highp vec4 color\n#pragma minemap: define lowp vec4 heightArr1\n#pragma minemap: define lowp vec4 heightArr2\n#pragma minemap: define lowp vec4 heightArr3\nvoid main() {\n#pragma minemap: initialize lowp float base\n#pragma minemap: initialize lowp float height\n#pragma minemap: initialize highp vec4 color\n#pragma minemap: initialize lowp vec4 heightArr1\n#pragma minemap: initialize lowp vec4 heightArr2\n#pragma minemap: initialize lowp vec4 heightArr3\nfloat _height=0.0;float _num=0.0;float _height1=0.0;float _height2=0.0;_num=abs(u_dyn_count)/500.0;if(_num < 1.0){_height1=abs(height);_height2=abs(heightArr1[0]/255.0);}else if(_num < 2.0){_height1=abs(heightArr1[0]/255.0);_height2=abs(heightArr1[1]/255.0);}else if(_num < 3.0){_height1=abs(heightArr1[1]/255.0);_height2=abs(heightArr1[2]/255.0);}else if(_num < 4.0){_height1=abs(heightArr1[2]/255.0);_height2=abs(heightArr1[3]/255.0);}else if(_num < 5.0){_height1=abs(heightArr1[3]/255.0);_height2=abs(heightArr2[0]/255.0);}else if(_num < 6.0){_height1=abs(heightArr2[0]/255.0);_height2=abs(heightArr2[1]/255.0);}else if(_num < 7.0){_height1=abs(heightArr2[1]/255.0);_height2=abs(heightArr2[2]/255.0);}else if(_num < 8.0){_height1=abs(heightArr2[2]/255.0);_height2=abs(heightArr2[3]/255.0);}else if(_num < 9.0){_height1=abs(heightArr2[3]/255.0);_height2=abs(heightArr3[0]/255.0);}else if(_num < 10.0){_height1=abs(heightArr3[0]/255.0);_height2=abs(heightArr3[1]/255.0);}else if(_num < 11.0){_height1=abs(heightArr3[1]/255.0);_height2=abs(heightArr3[2]/255.0);}else if(_num < 12.0){_height1=abs(heightArr3[2]/255.0);_height2=abs(heightArr3[3]/255.0);}_height=20.0+(_height1+(_height2-_height1)/500.0*mod(abs(u_dyn_count),500.0))*1.0;vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? _height : base,1);if(t > 0.0){v_opacity=1.2;v_height=_height*3.0;}else{v_opacity=0.1;v_height=0.0;}float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0);}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_directional=directional;}");

        function Zi(t, e) {
            var i = /#pragma minemap: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,
                o = e.match(/attribute ([\w]+) ([\w]+)/g),
                a = t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),
                r = e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),
                n = r ? r.concat(a) : a,
                s = {};
            return {
                fragmentSource: t = t.replace(i, (function (t, e, i, o, a) {
                    return s[a] = !0, "define" === e ? "\n#ifndef HAS_UNIFORM_u_" + a + "\nvarying " + i + " " + o + " " + a + ";\n#else\nuniform " + i + " " + o + " u_" + a + ";\n#endif\n" : "\n#ifdef HAS_UNIFORM_u_" + a + "\n    " + i + " " + o + " " + a + " = u_" + a + ";\n#endif\n"
                })),
                vertexSource: e = e.replace(i, (function (t, e, i, o, a) {
                    var r = "float" === o ? "vec2" : "vec4",
                        n = a.match(/color/) ? "color" : r;
                    return s[a] ? "define" === e ? "\n#ifndef HAS_UNIFORM_u_" + a + "\nuniform lowp float u_" + a + "_t;\nattribute " + i + " " + r + " a_" + a + ";\nvarying " + i + " " + o + " " + a + ";\n#else\nuniform " + i + " " + o + " u_" + a + ";\n#endif\n" : "vec4" === n ? "\n#ifndef HAS_UNIFORM_u_" + a + "\n    " + a + " = a_" + a + ";\n#else\n    " + i + " " + o + " " + a + " = u_" + a + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + a + "\n    " + a + " = unpack_mix_" + n + "(a_" + a + ", u_" + a + "_t);\n#else\n    " + i + " " + o + " " + a + " = u_" + a + ";\n#endif\n" : "define" === e ? "\n#ifndef HAS_UNIFORM_u_" + a + "\nuniform lowp float u_" + a + "_t;\nattribute " + i + " " + r + " a_" + a + ";\n#else\nuniform " + i + " " + o + " u_" + a + ";\n#endif\n" : "vec4" === n ? "\n#ifndef HAS_UNIFORM_u_" + a + "\n    " + i + " " + o + " " + a + " = a_" + a + ";\n#else\n    " + i + " " + o + " " + a + " = u_" + a + ";\n#endif\n" : "\n#ifndef HAS_UNIFORM_u_" + a + "\n    " + i + " " + o + " " + a + " = unpack_mix_" + n + "(a_" + a + ", u_" + a + "_t);\n#else\n    " + i + " " + o + " " + a + " = u_" + a + ";\n#endif\n"
                })),
                staticAttributes: o,
                staticUniforms: n
            }
        }
        var Vi = Object.freeze({
                __proto__: null,
                prelude: si,
                background: li,
                backgroundPattern: ci,
                circle: ui,
                clippingMask: hi,
                heatmap: pi,
                heatmapTexture: _i,
                collisionBox: mi,
                collisionCircle: di,
                debug: fi,
                fill: gi,
                fillOutline: vi,
                fillOutlinePattern: yi,
                fillPattern: xi,
                fillWater: wi,
                fillExtrusion: bi,
                fillExtrusionPattern: Ti,
                hillshadePrepare: Ei,
                hillshade: Si,
                line: Ii,
                lineGradient: zi,
                linePattern: Ci,
                lineSDF: Pi,
                raster: Li,
                symbolIcon: Ai,
                symbolSDF: Mi,
                symbolTextAndIcon: Di,
                airline: Ri,
                dynamicLine: ki,
                sprite: Oi,
                tracking: Bi,
                symtrackingIcon: Ui,
                symtrackingSDF: Fi,
                histogram: Ni,
                histogramColor: qi,
                histogramDynamic: ji
            }),
            Gi = function () {
                this.boundProgram = null, this.boundLayoutVertexBuffer = null, this.boundPaintVertexBuffers = [], this.boundIndexBuffer = null, this.boundVertexOffset = null, this.boundDynamicVertexBuffer = null, this.vao = null;
            };

        function Wi(t) {
            for (var e = [], i = 0; i < t.length; i++)
                if (null !== t[i]) {
                    var o = t[i].split(" ");
                    e.push(o.pop());
                } return e
        }
        Gi.prototype.bind = function (t, e, i, o, a, r, n, s) {
            this.context = t;
            for (var l = this.boundPaintVertexBuffers.length !== o.length, c = 0; !l && c < o.length; c++) this.boundPaintVertexBuffers[c] !== o[c] && (l = !0);
            t.extVertexArrayObject && this.vao && this.boundProgram === e && this.boundLayoutVertexBuffer === i && !l && this.boundIndexBuffer === a && this.boundVertexOffset === r && this.boundDynamicVertexBuffer === n && this.boundDynamicVertexBuffer2 === s ? (t.bindVertexArrayOES.set(this.vao), n && n.bind(), a && a.dynamicDraw && a.bind(), s && s.bind()) : this.freshBind(e, i, o, a, r, n, s);
        }, Gi.prototype.freshBind = function (t, e, i, o, a, r, n) {
            var s, l = t.numAttributes,
                c = this.context,
                u = c.gl;
            if (c.extVertexArrayObject) this.vao && this.destroy(), this.vao = c.extVertexArrayObject.createVertexArrayOES(), c.bindVertexArrayOES.set(this.vao), s = 0, this.boundProgram = t, this.boundLayoutVertexBuffer = e, this.boundPaintVertexBuffers = i, this.boundIndexBuffer = o, this.boundVertexOffset = a, this.boundDynamicVertexBuffer = r, this.boundDynamicVertexBuffer2 = n;
            else {
                s = c.currentNumAttributes || 0;
                for (var h = l; h < s; h++) u.disableVertexAttribArray(h);
            }
            e.enableAttributes(u, t);
            for (var p = 0, _ = i; p < _.length; p += 1) _[p].enableAttributes(u, t);
            r && r.enableAttributes(u, t), n && n.enableAttributes(u, t), e.bind(), e.setVertexAttribPointers(u, t, a);
            for (var m = 0, d = i; m < d.length; m += 1) {
                var f = d[m];
                f.bind(), f.setVertexAttribPointers(u, t, a);
            }
            r && (r.bind(), r.setVertexAttribPointers(u, t, a)), o && o.bind(), n && (n.bind(), n.setVertexAttribPointers(u, t, a)), c.currentNumAttributes = l;
        }, Gi.prototype.destroy = function () {
            this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao), this.vao = null);
        };
        var Xi = function (t, e, i, o, a, r) {
            var n = t.gl;
            this.program = n.createProgram();
            for (var s = Wi(i.staticAttributes), l = o ? o.getBinderAttributes() : [], c = s.concat(l), u = i.staticUniforms ? Wi(i.staticUniforms) : [], h = o ? o.getBinderUniforms() : [], p = [], _ = 0, m = u.concat(h); _ < m.length; _ += 1) {
                var d = m[_];
                p.indexOf(d) < 0 && p.push(d);
            }
            var f = o ? o.defines() : [];
            r && f.push("#define OVERDRAW_INSPECTOR;");
            var g = f.concat(si.fragmentSource, i.fragmentSource).join("\n"),
                v = f.concat(si.vertexSource, i.vertexSource).join("\n"),
                y = n.createShader(n.FRAGMENT_SHADER);
            if (n.isContextLost()) this.failedToCreate = !0;
            else {
                n.shaderSource(y, g), n.compileShader(y), n.attachShader(this.program, y);
                var x = n.createShader(n.VERTEX_SHADER);
                if (n.isContextLost()) this.failedToCreate = !0;
                else {
                    n.shaderSource(x, v), n.compileShader(x), n.attachShader(this.program, x), this.attributes = {};
                    var w = {};
                    this.numAttributes = c.length;
                    for (var b = 0; b < this.numAttributes; b++) c[b] && (n.bindAttribLocation(this.program, b, c[b]), this.attributes[c[b]] = b);
                    n.linkProgram(this.program), n.deleteShader(x), n.deleteShader(y);
                    for (var T = Array.from(p), E = 0; E < T.length; E++) {
                        var S = T[E];
                        if (S && !w[S]) {
                            var I = n.getUniformLocation(this.program, S);
                            I && (w[S] = I);
                        }
                    }
                    this.fixedUniforms = a(t, w), this.binderUniforms = o ? o.getUniforms(t, w) : [];
                }
            }
        };

        function Hi(t, e, i) {
            var o = 1 / Ce(i, 1, e.transform.tileZoom),
                a = Math.pow(2, i.tileID.overscaledZ),
                r = i.tileSize * Math.pow(2, e.transform.tileZoom) / a,
                n = r * (i.tileID.canonical.x + i.tileID.wrap * a),
                s = r * i.tileID.canonical.y;
            return {
                u_image: 0,
                u_texsize: i.imageAtlasTexture.size,
                u_scale: [o, t.fromScale, t.toScale],
                u_fade: t.t,
                u_pixel_coord_upper: [n >> 16, s >> 16],
                u_pixel_coord_lower: [65535 & n, 65535 & s]
            }
        }
        Xi.prototype.draw = function (t, e, i, o, a, r, n, s, l, c, u, h, p, _, m, d) {
            var f, g = t.gl;
            if (!this.failedToCreate) {
                for (var v in t.program.set(this.program), t.setDepthMode(i), t.setStencilMode(o), t.setColorMode(a), t.setCullFace(r), this.fixedUniforms) this.fixedUniforms[v].set(n[v]);
                _ && _.setUniforms(t, this.binderUniforms, h, {
                    zoom: p
                });
                for (var y = (f = {}, f[g.LINES] = 2, f[g.TRIANGLES] = 3, f[g.LINE_STRIP] = 1, f)[e], x = 0, w = u.get(); x < w.length; x += 1) {
                    var b = w[x],
                        T = b.vaos || (b.vaos = {});
                    (T[s] || (T[s] = new Gi)).bind(t, this, l, _ ? _.getPaintVertexBuffers() : [], c, b.vertexOffset, m, d), g.drawElements(e, b.primitiveLength * y, g.UNSIGNED_SHORT, b.primitiveOffset * y * 2);
                }
            }
        };
        var Ki = function (e, i, o, a) {
                var r = i.style.light,
                    n = r.properties.get("position"),
                    s = [n.x, n.y, n.z],
                    l = t.create$1();
                "viewport" === r.properties.get("anchor") && t.fromRotation(l, -i.transform.angle), t.transformMat3(s, s, l);
                var c = r.properties.get("color");
                return {
                    u_matrix: e,
                    u_lightpos: s,
                    u_lightintensity: r.properties.get("intensity"),
                    u_lightcolor: [c.r, c.g, c.b],
                    u_vertical_gradient: +o,
                    u_opacity: a
                }
            },
            Yi = function (e, i, o, a, r, n, s) {
                return t.extend(Ki(e, i, o, a), Hi(n, i, s), {
                    u_height_factor: -Math.pow(2, r.overscaledZ) / s.tileSize / 8
                })
            },
            Ji = function (t) {
                return {
                    u_matrix: t
                }
            },
            Qi = function (e, i, o, a) {
                return t.extend(Ji(e), Hi(o, i, a))
            },
            $i = function (t, e) {
                return {
                    u_matrix: t,
                    u_world: e
                }
            },
            to = function (e, i, o, a, r) {
                return t.extend(Qi(e, i, o, a), {
                    u_world: r
                })
            },
            eo = function (e, i, o, a) {
                var r, n, s = e.transform;
                if ("map" === a.paint.get("circle-pitch-alignment")) {
                    var l = Ce(o, 1, s.zoom);
                    r = !0, n = [l, l];
                } else r = !1, n = s.pixelsToGLUnits;
                return {
                    u_camera_to_center_distance: s.cameraToCenterDistance,
                    u_scale_with_map: +("map" === a.paint.get("circle-pitch-scale")),
                    u_matrix: e.translatePosMatrix(i.posMatrix, o, a.paint.get("circle-translate"), a.paint.get("circle-translate-anchor")),
                    u_pitch_with_map: +r,
                    u_device_pixel_ratio: t.browser.devicePixelRatio,
                    u_extrude_scale: n
                }
            },
            io = function (t, e, i) {
                var o = Ce(i, 1, e.zoom),
                    a = Math.pow(2, e.zoom - i.tileID.overscaledZ),
                    r = i.tileID.overscaleFactor();
                return {
                    u_matrix: t,
                    u_camera_to_center_distance: e.cameraToCenterDistance,
                    u_pixels_to_tile_units: o,
                    u_extrude_scale: [e.pixelsToGLUnits[0] / (o * a), e.pixelsToGLUnits[1] / (o * a)],
                    u_overscale_factor: r
                }
            },
            oo = function (t, e, i) {
                return {
                    u_matrix: t,
                    u_inv_matrix: e,
                    u_camera_to_center_distance: i.cameraToCenterDistance,
                    u_viewport_size: [i.width, i.height]
                }
            },
            ao = function (t, e, i) {
                return void 0 === i && (i = 1), {
                    u_matrix: t,
                    u_color: e,
                    u_overlay: 0,
                    u_overlay_scale: i
                }
            },
            ro = function (t) {
                return {
                    u_matrix: t
                }
            },
            no = function (t, e, i, o) {
                return {
                    u_matrix: t,
                    u_extrude_scale: Ce(e, 1, i),
                    u_intensity: o
                }
            };

        function so(e, i) {
            var o = Math.pow(2, i.canonical.z),
                a = i.canonical.y;
            return [new(e.isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate)(0, a / o).toLngLat().lat, new(e.isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate)(0, (a + 1) / o).toLngLat().lat]
        }
        var lo = function (e, i, o, a, r) {
                var n = e.transform;
                return {
                    u_matrix: _o(e, i, o),
                    u_ratio: 1 / Ce(i, 1, n.zoom),
                    u_device_pixel_ratio: t.browser.devicePixelRatio,
                    u_units_to_pixels: [1 / n.pixelsToGLUnits[0], 1 / n.pixelsToGLUnits[1]],
                    u_hasBorder: +a,
                    u_half_render: +r
                }
            },
            co = function (e, i, o) {
                return t.extend(lo(e, i, o, !1), {
                    u_image: 0
                })
            },
            uo = function (e, i, o, a) {
                var r = e.transform,
                    n = po(i, r);
                return {
                    u_matrix: _o(e, i, o),
                    u_texsize: i.imageAtlasTexture.size,
                    u_ratio: 1 / Ce(i, 1, r.zoom),
                    u_device_pixel_ratio: t.browser.devicePixelRatio,
                    u_image: 0,
                    u_scale: [n, a.fromScale, a.toScale],
                    u_fade: a.t,
                    u_units_to_pixels: [1 / r.pixelsToGLUnits[0], 1 / r.pixelsToGLUnits[1]]
                }
            },
            ho = function (e, i, o, a, r) {
                var n = e.lineAtlas,
                    s = po(i, e.transform),
                    l = "round" === o.layout.get("line-cap"),
                    c = n.getDash(a.from, l),
                    u = n.getDash(a.to, l),
                    h = c.width * r.fromScale,
                    p = u.width * r.toScale;
                return t.extend(lo(e, i, o, !1), {
                    u_patternscale_a: [s / h, -c.height / 2],
                    u_patternscale_b: [s / p, -u.height / 2],
                    u_sdfgamma: n.width / (256 * Math.min(h, p) * t.browser.devicePixelRatio) / 2,
                    u_image: 0,
                    u_tex_y_a: c.y,
                    u_tex_y_b: u.y,
                    u_mix: r.t
                })
            };

        function po(t, e) {
            return 1 / Ce(t, 1, e.tileZoom)
        }

        function _o(t, e, i) {
            return t.translatePosMatrix(e.tileID.posMatrix, e, i.paint.get("line-translate"), i.paint.get("line-translate-anchor"))
        }
        var mo = function (t, e, i, o, a) {
            return {
                u_matrix: t,
                u_tl_parent: e,
                u_scale_parent: i,
                u_buffer_scale: 1,
                u_fade_t: o.mix,
                u_opacity: o.opacity * a.paint.get("raster-opacity"),
                u_image0: 0,
                u_image1: 1,
                u_brightness_low: a.paint.get("raster-brightness-min"),
                u_brightness_high: a.paint.get("raster-brightness-max"),
                u_saturation_factor: (n = a.paint.get("raster-saturation"), n > 0 ? 1 - 1 / (1.001 - n) : -n),
                u_contrast_factor: (r = a.paint.get("raster-contrast"), r > 0 ? 1 / (1 - r) : 1 + r),
                u_spin_weights: fo(a.paint.get("raster-hue-rotate"))
            };
            var r, n;
        };

        function fo(t) {
            t *= Math.PI / 180;
            var e = Math.sin(t),
                i = Math.cos(t);
            return [(2 * i + 1) / 3, (-Math.sqrt(3) * e - i + 1) / 3, (Math.sqrt(3) * e - i + 1) / 3]
        }
        var go = function (t, e, i, o, a, r, n, s, l, c) {
                var u = a.transform;
                return {
                    u_is_size_zoom_constant: +("constant" === t || "source" === t),
                    u_is_size_feature_constant: +("constant" === t || "camera" === t),
                    u_size_t: e ? e.uSizeT : 0,
                    u_size: e ? e.uSize : 0,
                    u_camera_to_center_distance: u.cameraToCenterDistance,
                    u_pitch: u.pitch / 360 * 2 * Math.PI,
                    u_rotate_symbol: +i,
                    u_aspect_ratio: u.width / u.height,
                    u_fade_change: a.options.fadeDuration ? a.symbolFadeChange : 1,
                    u_matrix: r,
                    u_label_plane_matrix: n,
                    u_coord_matrix: s,
                    u_is_text: +l,
                    u_pitch_with_map: +o,
                    u_texsize: c,
                    u_texture: 0
                }
            },
            vo = function (e, i, o, a, r, n, s, l, c, u, h) {
                var p = r.transform;
                return t.extend(go(e, i, o, a, r, n, s, l, c, u), {
                    u_gamma_scale: a ? Math.cos(p._pitch) * p.cameraToCenterDistance : 1,
                    u_device_pixel_ratio: t.browser.devicePixelRatio,
                    u_is_halo: +h
                })
            },
            yo = function (e, i, o, a, r, n, s, l, c, u) {
                return t.extend(vo(e, i, o, a, r, n, s, l, !0, c, !0), {
                    u_texsize_icon: u,
                    u_texture_icon: 1
                })
            },
            xo = function (t, e, i) {
                return {
                    u_matrix: t,
                    u_opacity: e,
                    u_color: i
                }
            },
            wo = function (e, i, o, a, r, n) {
                return t.extend(function (t, e, i, o) {
                    var a = i.imageManager.getPattern(t.from.toString()),
                        r = i.imageManager.getPattern(t.to.toString()),
                        n = i.imageManager.getPixelSize(),
                        s = n.width,
                        l = n.height,
                        c = Math.pow(2, o.tileID.overscaledZ),
                        u = o.tileSize * Math.pow(2, i.transform.tileZoom) / c,
                        h = u * (o.tileID.canonical.x + o.tileID.wrap * c),
                        p = u * o.tileID.canonical.y;
                    return {
                        u_image: 0,
                        u_pattern_tl_a: a.tl,
                        u_pattern_br_a: a.br,
                        u_pattern_tl_b: r.tl,
                        u_pattern_br_b: r.br,
                        u_texsize: [s, l],
                        u_mix: e.t,
                        u_pattern_size_a: a.displaySize,
                        u_pattern_size_b: r.displaySize,
                        u_scale_a: e.fromScale,
                        u_scale_b: e.toScale,
                        u_tile_units_to_pixels: 1 / Ce(o, 1, i.transform.tileZoom),
                        u_pixel_coord_upper: [h >> 16, p >> 16],
                        u_pixel_coord_lower: [65535 & h, 65535 & p]
                    }
                }(a, n, o, r), {
                    u_matrix: e,
                    u_opacity: i
                })
            },
            bo = function (e, i, o, a) {
                var r = e.transform;
                return {
                    u_matrix: To(e, i, o),
                    u_ratio: 1 / Ce(i, 1, r.zoom),
                    u_device_pixel_ratio: t.browser.devicePixelRatio,
                    u_units_to_pixels: [1 / r.pixelsToGLUnits[0], 1 / r.pixelsToGLUnits[1]],
                    u_start: a.start,
                    u_segments: a.segments,
                    u_discard: a.discard
                }
            };

        function To(t, e, i) {
            return t.translatePosMatrix(e.tileID.posMatrix, e, i.paint.get("airline-translate"), i.paint.get("airline-translate-anchor"))
        }
        var Eo = function (e, i, o, a, r) {
            var n = e.transform;
            return {
                u_matrix: So(e, i, o),
                u_ratio: 1 / Ce(i, 1, n.zoom),
                u_device_pixel_ratio: t.browser.devicePixelRatio,
                u_gl_units_to_pixels: [1 / n.pixelsToGLUnits[0], 1 / n.pixelsToGLUnits[1]],
                u_count: a,
                u_segments: r
            }
        };

        function So(t, e, i) {
            return t.translatePosMatrix(e.tileID.posMatrix, e, i.paint.get("dynamicLine-translate"), i.paint.get("dynamicLine-translate-anchor"))
        }
        var Io = function (e, i, o) {
            var a = e.transform;
            return {
                u_matrix: zo(e, i, o),
                u_ratio: 1 / Ce(i, 1, a.zoom),
                u_device_pixel_ratio: t.browser.devicePixelRatio,
                u_units_to_pixels: [1 / a.pixelsToGLUnits[0], 1 / a.pixelsToGLUnits[1]],
                u_count: o.count
            }
        };

        function zo(t, e, i) {
            return t.translatePosMatrix(e.tileID.posMatrix, e, i.paint.get("sprite-translate"), i.paint.get("sprite-translate-anchor"))
        }
        var Co = function (e, i, o) {
            var a = e.transform;
            return {
                u_matrix: Po(e, i, o),
                u_ratio: 1 / Ce(i, 1, a.zoom),
                u_device_pixel_ratio: t.browser.devicePixelRatio,
                u_units_to_pixels: [1 / a.pixelsToGLUnits[0], 1 / a.pixelsToGLUnits[1]],
                u_start: o.histCount - o.segmentGroup,
                u_end: o.histCount,
                u_segments: o.segmentGroup,
                u_reverse: Number(o.isReverse),
                u_reserve: Number(o.isReserve)
            }
        };

        function Po(t, e, i) {
            return t.translatePosMatrix(e.tileID.posMatrix, e, i.paint.get("tracking-translate"), i.paint.get("tracking-translate-anchor"))
        }
        var Lo, Ao = function (t, e, i, o, a, r, n, s, l, c, u) {
                var h = a.transform;
                return {
                    u_is_size_zoom_constant: +("constant" === t || "source" === t),
                    u_is_size_feature_constant: +("constant" === t || "camera" === t),
                    u_size_t: e ? e.uSizeT : 0,
                    u_size: e ? e.uSize : 0,
                    u_camera_to_center_distance: h.cameraToCenterDistance,
                    u_pitch: h.pitch / 360 * 2 * Math.PI,
                    u_rotate_symbol: +i,
                    u_aspect_ratio: h.width / h.height,
                    u_fade_change: a.options.fadeDuration ? a.symbolFadeChange : 1,
                    u_matrix: r,
                    u_label_plane_matrix: n,
                    u_coord_matrix: s,
                    u_is_text: +l,
                    u_pitch_with_map: +o,
                    u_texsize: c,
                    u_texture: 0,
                    u_seq: u
                }
            },
            Mo = function (e, i, o, a, r, n, s, l, c, u, h, p) {
                var _ = r.transform;
                return t.extend(Ao(e, i, o, a, r, n, s, l, c, u, p), {
                    u_gamma_scale: a ? Math.cos(_._pitch) * _.cameraToCenterDistance : 1,
                    u_device_pixel_ratio: t.browser.devicePixelRatio,
                    u_is_halo: +h
                })
            },
            Do = function (e, i, o, a, r, n) {
                var s = i.style.light,
                    l = s.properties.get("position"),
                    c = [l.x, l.y, l.z],
                    u = t.create$1();
                "viewport" === s.properties.get("anchor") && t.fromRotation(u, -i.transform.angle), t.transformMat3(c, c, u);
                var h = s.properties.get("color");
                return {
                    u_matrix: e,
                    u_lightpos: c,
                    u_lightintensity: s.properties.get("intensity"),
                    u_lightcolor: [h.r, h.g, h.b],
                    u_vertical_gradient: +o,
                    u_opacity: a,
                    u_is_max_length: +r,
                    u_depth_render: +n
                }
            },
            Ro = function (e, i, o, a, r, n, s, l) {
                var c = i.style.light,
                    u = c.properties.get("position"),
                    h = [u.x, u.y, u.z],
                    p = t.create$1();
                "viewport" === c.properties.get("anchor") && t.fromRotation(p, -i.transform.angle), t.transformMat3(h, h, p);
                var _ = c.properties.get("color");
                return {
                    u_matrix: e,
                    u_lightpos: h,
                    u_lightintensity: c.properties.get("intensity"),
                    u_lightcolor: [_.r, _.g, _.b],
                    u_vertical_gradient: +o,
                    u_opacity: a,
                    u_is_max_length: +r,
                    u_max_height: 3 * s,
                    u_depth_render: +n,
                    u_color_a: l[0],
                    u_color_b: l[1],
                    u_color_c: l[2],
                    u_color_d: l[3],
                    u_color_e: l[4]
                }
            },
            ko = function (e, i, o, a, r, n, s) {
                var l = i.style.light,
                    c = l.properties.get("position"),
                    u = [c.x, c.y, c.z],
                    h = t.create$1();
                "viewport" === l.properties.get("anchor") && t.fromRotation(h, -i.transform.angle), t.transformMat3(u, u, h);
                var p = l.properties.get("color");
                return {
                    u_matrix: e,
                    u_lightpos: u,
                    u_lightintensity: l.properties.get("intensity"),
                    u_lightcolor: [p.r, p.g, p.b],
                    u_vertical_gradient: +o,
                    u_opacity: a,
                    u_max_height: 3 * r,
                    u_color_a: n[0],
                    u_color_b: n[1],
                    u_color_c: n[2],
                    u_color_d: n[3],
                    u_color_e: n[4],
                    u_dyn_count: s
                }
            },
            Oo = {
                fillExtrusion: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_lightpos: new t.Uniform3f(e, i.u_lightpos),
                        u_lightintensity: new t.Uniform1f(e, i.u_lightintensity),
                        u_lightcolor: new t.Uniform3f(e, i.u_lightcolor),
                        u_vertical_gradient: new t.Uniform1f(e, i.u_vertical_gradient),
                        u_opacity: new t.Uniform1f(e, i.u_opacity)
                    }
                },
                fillExtrusionPattern: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_lightpos: new t.Uniform3f(e, i.u_lightpos),
                        u_lightintensity: new t.Uniform1f(e, i.u_lightintensity),
                        u_lightcolor: new t.Uniform3f(e, i.u_lightcolor),
                        u_vertical_gradient: new t.Uniform1f(e, i.u_vertical_gradient),
                        u_height_factor: new t.Uniform1f(e, i.u_height_factor),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
                        u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
                        u_scale: new t.Uniform3f(e, i.u_scale),
                        u_fade: new t.Uniform1f(e, i.u_fade),
                        u_opacity: new t.Uniform1f(e, i.u_opacity)
                    }
                },
                fill: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
                    }
                },
                fillPattern: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
                        u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
                        u_scale: new t.Uniform3f(e, i.u_scale),
                        u_fade: new t.Uniform1f(e, i.u_fade)
                    }
                },
                fillOutline: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_world: new t.Uniform2f(e, i.u_world)
                    }
                },
                fillOutlinePattern: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_world: new t.Uniform2f(e, i.u_world),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
                        u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
                        u_scale: new t.Uniform3f(e, i.u_scale),
                        u_fade: new t.Uniform1f(e, i.u_fade)
                    }
                },
                fillWater: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_time: new t.Uniform1f(e, i.u_time)
                    }
                },
                circle: function (e, i) {
                    return {
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_scale_with_map: new t.Uniform1i(e, i.u_scale_with_map),
                        u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
                        u_extrude_scale: new t.Uniform2f(e, i.u_extrude_scale),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
                    }
                },
                collisionBox: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_pixels_to_tile_units: new t.Uniform1f(e, i.u_pixels_to_tile_units),
                        u_extrude_scale: new t.Uniform2f(e, i.u_extrude_scale),
                        u_overscale_factor: new t.Uniform1f(e, i.u_overscale_factor)
                    }
                },
                collisionCircle: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_inv_matrix: new t.UniformMatrix4f(e, i.u_inv_matrix),
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_viewport_size: new t.Uniform2f(e, i.u_viewport_size)
                    }
                },
                debug: function (e, i) {
                    return {
                        u_color: new t.UniformColor(e, i.u_color),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_overlay: new t.Uniform1i(e, i.u_overlay),
                        u_overlay_scale: new t.Uniform1f(e, i.u_overlay_scale)
                    }
                },
                clippingMask: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
                    }
                },
                heatmap: function (e, i) {
                    return {
                        u_extrude_scale: new t.Uniform1f(e, i.u_extrude_scale),
                        u_intensity: new t.Uniform1f(e, i.u_intensity),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix)
                    }
                },
                heatmapTexture: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_world: new t.Uniform2f(e, i.u_world),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_color_ramp: new t.Uniform1i(e, i.u_color_ramp),
                        u_opacity: new t.Uniform1f(e, i.u_opacity)
                    }
                },
                hillshade: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_latrange: new t.Uniform2f(e, i.u_latrange),
                        u_light: new t.Uniform2f(e, i.u_light),
                        u_shadow: new t.UniformColor(e, i.u_shadow),
                        u_highlight: new t.UniformColor(e, i.u_highlight),
                        u_accent: new t.UniformColor(e, i.u_accent)
                    }
                },
                hillshadePrepare: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_dimension: new t.Uniform2f(e, i.u_dimension),
                        u_zoom: new t.Uniform1f(e, i.u_zoom),
                        u_maxzoom: new t.Uniform1f(e, i.u_maxzoom),
                        u_unpack: new t.Uniform4f(e, i.u_unpack)
                    }
                },
                line: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
                        u_hasBorder: new t.Uniform1f(e, i.u_hasBorder),
                        u_half_render: new t.Uniform1f(e, i.u_half_render)
                    }
                },
                lineGradient: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
                        u_image: new t.Uniform1i(e, i.u_image)
                    }
                },
                linePattern: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
                        u_scale: new t.Uniform3f(e, i.u_scale),
                        u_fade: new t.Uniform1f(e, i.u_fade)
                    }
                },
                lineSDF: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
                        u_patternscale_a: new t.Uniform2f(e, i.u_patternscale_a),
                        u_patternscale_b: new t.Uniform2f(e, i.u_patternscale_b),
                        u_sdfgamma: new t.Uniform1f(e, i.u_sdfgamma),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_tex_y_a: new t.Uniform1f(e, i.u_tex_y_a),
                        u_tex_y_b: new t.Uniform1f(e, i.u_tex_y_b),
                        u_mix: new t.Uniform1f(e, i.u_mix)
                    }
                },
                raster: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_tl_parent: new t.Uniform2f(e, i.u_tl_parent),
                        u_scale_parent: new t.Uniform1f(e, i.u_scale_parent),
                        u_buffer_scale: new t.Uniform1f(e, i.u_buffer_scale),
                        u_fade_t: new t.Uniform1f(e, i.u_fade_t),
                        u_opacity: new t.Uniform1f(e, i.u_opacity),
                        u_image0: new t.Uniform1i(e, i.u_image0),
                        u_image1: new t.Uniform1i(e, i.u_image1),
                        u_brightness_low: new t.Uniform1f(e, i.u_brightness_low),
                        u_brightness_high: new t.Uniform1f(e, i.u_brightness_high),
                        u_saturation_factor: new t.Uniform1f(e, i.u_saturation_factor),
                        u_contrast_factor: new t.Uniform1f(e, i.u_contrast_factor),
                        u_spin_weights: new t.Uniform3f(e, i.u_spin_weights)
                    }
                },
                symbolIcon: function (e, i) {
                    return {
                        u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
                        u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
                        u_size_t: new t.Uniform1f(e, i.u_size_t),
                        u_size: new t.Uniform1f(e, i.u_size),
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_pitch: new t.Uniform1f(e, i.u_pitch),
                        u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
                        u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
                        u_fade_change: new t.Uniform1f(e, i.u_fade_change),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
                        u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
                        u_is_text: new t.Uniform1i(e, i.u_is_text),
                        u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_texture: new t.Uniform1i(e, i.u_texture)
                    }
                },
                symbolSDF: function (e, i) {
                    return {
                        u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
                        u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
                        u_size_t: new t.Uniform1f(e, i.u_size_t),
                        u_size: new t.Uniform1f(e, i.u_size),
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_pitch: new t.Uniform1f(e, i.u_pitch),
                        u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
                        u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
                        u_fade_change: new t.Uniform1f(e, i.u_fade_change),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
                        u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
                        u_is_text: new t.Uniform1i(e, i.u_is_text),
                        u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_texture: new t.Uniform1i(e, i.u_texture),
                        u_gamma_scale: new t.Uniform1f(e, i.u_gamma_scale),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_is_halo: new t.Uniform1i(e, i.u_is_halo)
                    }
                },
                symbolTextAndIcon: function (e, i) {
                    return {
                        u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
                        u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
                        u_size_t: new t.Uniform1f(e, i.u_size_t),
                        u_size: new t.Uniform1f(e, i.u_size),
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_pitch: new t.Uniform1f(e, i.u_pitch),
                        u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
                        u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
                        u_fade_change: new t.Uniform1f(e, i.u_fade_change),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
                        u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
                        u_is_text: new t.Uniform1i(e, i.u_is_text),
                        u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_texsize_icon: new t.Uniform2f(e, i.u_texsize_icon),
                        u_texture: new t.Uniform1i(e, i.u_texture),
                        u_texture_icon: new t.Uniform1i(e, i.u_texture_icon),
                        u_gamma_scale: new t.Uniform1f(e, i.u_gamma_scale),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_is_halo: new t.Uniform1i(e, i.u_is_halo)
                    }
                },
                background: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_opacity: new t.Uniform1f(e, i.u_opacity),
                        u_color: new t.UniformColor(e, i.u_color)
                    }
                },
                backgroundPattern: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_opacity: new t.Uniform1f(e, i.u_opacity),
                        u_image: new t.Uniform1i(e, i.u_image),
                        u_pattern_tl_a: new t.Uniform2f(e, i.u_pattern_tl_a),
                        u_pattern_br_a: new t.Uniform2f(e, i.u_pattern_br_a),
                        u_pattern_tl_b: new t.Uniform2f(e, i.u_pattern_tl_b),
                        u_pattern_br_b: new t.Uniform2f(e, i.u_pattern_br_b),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_mix: new t.Uniform1f(e, i.u_mix),
                        u_pattern_size_a: new t.Uniform2f(e, i.u_pattern_size_a),
                        u_pattern_size_b: new t.Uniform2f(e, i.u_pattern_size_b),
                        u_scale_a: new t.Uniform1f(e, i.u_scale_a),
                        u_scale_b: new t.Uniform1f(e, i.u_scale_b),
                        u_pixel_coord_upper: new t.Uniform2f(e, i.u_pixel_coord_upper),
                        u_pixel_coord_lower: new t.Uniform2f(e, i.u_pixel_coord_lower),
                        u_tile_units_to_pixels: new t.Uniform1f(e, i.u_tile_units_to_pixels)
                    }
                },
                airline: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
                        u_start: new t.Uniform1f(e, i.u_start),
                        u_segments: new t.Uniform1f(e, i.u_segments),
                        u_discard: new t.Uniform1f(e, i.u_discard)
                    }
                },
                dynamicLine: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_gl_units_to_pixels: new t.Uniform2f(e, i.u_gl_units_to_pixels),
                        u_count: new t.Uniform1f(e, i.u_count),
                        u_segments: new t.Uniform1f(e, i.u_segments)
                    }
                },
                sprite: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
                        u_count: new t.Uniform1f(e, i.u_count)
                    }
                },
                tracking: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_ratio: new t.Uniform1f(e, i.u_ratio),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_units_to_pixels: new t.Uniform2f(e, i.u_units_to_pixels),
                        u_start: new t.Uniform1f(e, i.u_start),
                        u_end: new t.Uniform1f(e, i.u_end),
                        u_segments: new t.Uniform1f(e, i.u_segments),
                        u_reverse: new t.Uniform1f(e, i.u_reverse),
                        u_reserve: new t.Uniform1f(e, i.u_reserve)
                    }
                },
                symtrackingIcon: function (e, i) {
                    return {
                        u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
                        u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
                        u_size_t: new t.Uniform1f(e, i.u_size_t),
                        u_size: new t.Uniform1f(e, i.u_size),
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_pitch: new t.Uniform1f(e, i.u_pitch),
                        u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
                        u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
                        u_fade_change: new t.Uniform1f(e, i.u_fade_change),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
                        u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
                        u_is_text: new t.Uniform1i(e, i.u_is_text),
                        u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_texture: new t.Uniform1i(e, i.u_texture),
                        u_seq: new t.Uniform1f(e, i.u_seq)
                    }
                },
                symtrackingSDF: function (e, i) {
                    return {
                        u_is_size_zoom_constant: new t.Uniform1i(e, i.u_is_size_zoom_constant),
                        u_is_size_feature_constant: new t.Uniform1i(e, i.u_is_size_feature_constant),
                        u_size_t: new t.Uniform1f(e, i.u_size_t),
                        u_size: new t.Uniform1f(e, i.u_size),
                        u_camera_to_center_distance: new t.Uniform1f(e, i.u_camera_to_center_distance),
                        u_pitch: new t.Uniform1f(e, i.u_pitch),
                        u_rotate_symbol: new t.Uniform1i(e, i.u_rotate_symbol),
                        u_aspect_ratio: new t.Uniform1f(e, i.u_aspect_ratio),
                        u_fade_change: new t.Uniform1f(e, i.u_fade_change),
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_label_plane_matrix: new t.UniformMatrix4f(e, i.u_label_plane_matrix),
                        u_coord_matrix: new t.UniformMatrix4f(e, i.u_coord_matrix),
                        u_is_text: new t.Uniform1i(e, i.u_is_text),
                        u_pitch_with_map: new t.Uniform1i(e, i.u_pitch_with_map),
                        u_texsize: new t.Uniform2f(e, i.u_texsize),
                        u_texture: new t.Uniform1i(e, i.u_texture),
                        u_gamma_scale: new t.Uniform1f(e, i.u_gamma_scale),
                        u_device_pixel_ratio: new t.Uniform1f(e, i.u_device_pixel_ratio),
                        u_is_halo: new t.Uniform1i(e, i.u_is_halo),
                        u_seq: new t.Uniform1f(e, i.u_seq)
                    }
                },
                histogram: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_lightpos: new t.Uniform3f(e, i.u_lightpos),
                        u_lightintensity: new t.Uniform1f(e, i.u_lightintensity),
                        u_lightcolor: new t.Uniform3f(e, i.u_lightcolor),
                        u_vertical_gradient: new t.Uniform1f(e, i.u_vertical_gradient),
                        u_opacity: new t.Uniform1f(e, i.u_opacity),
                        u_is_max_length: new t.Uniform1f(e, i.u_is_max_length),
                        u_depth_render: new t.Uniform1f(e, i.u_depth_render)
                    }
                },
                histogramColor: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_lightpos: new t.Uniform3f(e, i.u_lightpos),
                        u_lightintensity: new t.Uniform1f(e, i.u_lightintensity),
                        u_lightcolor: new t.Uniform3f(e, i.u_lightcolor),
                        u_vertical_gradient: new t.Uniform1f(e, i.u_vertical_gradient),
                        u_opacity: new t.Uniform1f(e, i.u_opacity),
                        u_is_max_length: new t.Uniform1f(e, i.u_is_max_length),
                        u_depth_render: new t.Uniform1f(e, i.u_depth_render),
                        u_max_height: new t.Uniform1f(e, i.u_max_height),
                        u_color_a: new t.Uniform4f(e, i.u_color_a),
                        u_color_b: new t.Uniform4f(e, i.u_color_b),
                        u_color_c: new t.Uniform4f(e, i.u_color_c),
                        u_color_d: new t.Uniform4f(e, i.u_color_d),
                        u_color_e: new t.Uniform4f(e, i.u_color_e)
                    }
                },
                histogramDynamic: function (e, i) {
                    return {
                        u_matrix: new t.UniformMatrix4f(e, i.u_matrix),
                        u_lightpos: new t.Uniform3f(e, i.u_lightpos),
                        u_lightintensity: new t.Uniform1f(e, i.u_lightintensity),
                        u_lightcolor: new t.Uniform3f(e, i.u_lightcolor),
                        u_vertical_gradient: new t.Uniform1f(e, i.u_vertical_gradient),
                        u_opacity: new t.Uniform1f(e, i.u_opacity),
                        u_max_height: new t.Uniform1f(e, i.u_max_height),
                        u_color_a: new t.Uniform4f(e, i.u_color_a),
                        u_color_b: new t.Uniform4f(e, i.u_color_b),
                        u_color_c: new t.Uniform4f(e, i.u_color_c),
                        u_color_d: new t.Uniform4f(e, i.u_color_d),
                        u_color_e: new t.Uniform4f(e, i.u_color_e),
                        u_dyn_count: new t.Uniform1f(e, i.u_dyn_count)
                    }
                }
            };

        function Bo(e, i, o, a, r, n, s) {
            for (var l = e.context, c = l.gl, u = e.useProgram("collisionBox"), h = [], p = 0, _ = 0, m = 0; m < a.length; m++) {
                var d = a[m],
                    f = i.getTile(d),
                    g = f.getBucket(o);
                if (g) {
                    var v = d.posMatrix;
                    0 === r[0] && 0 === r[1] || (v = e.translatePosMatrix(d.posMatrix, f, r, n));
                    var y = s ? g.textCollisionBox : g.iconCollisionBox,
                        x = g.collisionCircleArray;
                    if (x.length > 0) {
                        var w = t.create(),
                            b = v;
                        t.mul(w, g.placementInvProjMatrix, e.transform.glCoordMatrix), t.mul(w, w, g.placementViewportMatrix), h.push({
                            circleArray: x,
                            circleOffset: _,
                            transform: b,
                            invTransform: w
                        }), _ = p += x.length / 4;
                    }
                    y && u.draw(l, c.LINES, jt.disabled, Zt.disabled, e.colorModeForRenderPass(), Gt.disabled, io(v, e.transform, f), o.id, y.layoutVertexBuffer, y.indexBuffer, y.segments, null, e.transform.zoom, null, null, y.collisionVertexBuffer);
                }
            }
            if (s && h.length) {
                var T = e.useProgram("collisionCircle"),
                    E = new t.StructArrayLayout2f1f2i16;
                E.resize(4 * p), E._trim();
                for (var S = 0, I = 0, z = h; I < z.length; I += 1)
                    for (var C = z[I], P = 0; P < C.circleArray.length / 4; P++) {
                        var L = 4 * P,
                            A = C.circleArray[L + 0],
                            M = C.circleArray[L + 1],
                            D = C.circleArray[L + 2],
                            R = C.circleArray[L + 3];
                        E.emplace(S++, A, M, D, R, 0), E.emplace(S++, A, M, D, R, 1), E.emplace(S++, A, M, D, R, 2), E.emplace(S++, A, M, D, R, 3);
                    }(!Lo || Lo.length < 2 * p) && (Lo = function (e) {
                        var i = 2 * e,
                            o = new t.StructArrayLayout3ui6;
                        o.resize(i), o._trim();
                        for (var a = 0; a < i; a++) {
                            var r = 6 * a;
                            o.uint16[r + 0] = 4 * a + 0, o.uint16[r + 1] = 4 * a + 1, o.uint16[r + 2] = 4 * a + 2, o.uint16[r + 3] = 4 * a + 2, o.uint16[r + 4] = 4 * a + 3, o.uint16[r + 5] = 4 * a + 0;
                        }
                        return o
                    }(p));
                for (var k = l.createIndexBuffer(Lo, !0), O = l.createVertexBuffer(E, t.collisionCircleLayout.members, !0), B = 0, U = h; B < U.length; B += 1) {
                    var F = U[B],
                        N = oo(F.transform, F.invTransform, e.transform);
                    T.draw(l, c.TRIANGLES, jt.disabled, Zt.disabled, e.colorModeForRenderPass(), Gt.disabled, N, o.id, O, k, t.SegmentVector.simpleSegment(0, 2 * F.circleOffset, F.circleArray.length, F.circleArray.length / 2), null, e.transform.zoom, null, null, null);
                }
                O.destroy(), k.destroy();
            }
        }
        var Uo = t.identity(new Float32Array(16));

        function Fo(e, i, o, a, r, n) {
            var s = t.getAnchorAlignment(e),
                l = -(s.horizontalAlign - .5) * i,
                c = -(s.verticalAlign - .5) * o,
                u = t.evaluateVariableOffset(e, a);
            return new t.Point((l / r + u[0]) * n, (c / r + u[1]) * n)
        }

        function No(e, i, o, a, r, n, s, l, c, u, h) {
            var p = e.text.placedSymbolArray,
                _ = e.text.dynamicLayoutVertexArray,
                m = e.icon.dynamicLayoutVertexArray,
                d = {};
            _.clear();
            for (var f = 0; f < p.length; f++) {
                var g = p.get(f),
                    v = g.hidden || !g.crossTileID || e.allowVerticalPlacement && !g.placedOrientation ? null : a[g.crossTileID];
                if (v) {
                    var y = new t.Point(g.anchorX, g.anchorY),
                        x = de(y, o ? l : s),
                        w = fe(n.cameraToCenterDistance, x.signedDistanceFromCamera),
                        b = r.evaluateSizeForFeature(e.textSizeData, u, g) * w / t.ONE_EM;
                    o && (b *= e.tilePixelRatio / c);
                    for (var T = Fo(v.anchor, v.width, v.height, v.textOffset, v.textBoxScale, b), E = o ? de(y.add(T), s).point : x.point.add(i ? T.rotate(-n.angle) : T), S = e.allowVerticalPlacement && g.placedOrientation === t.WritingMode.vertical ? Math.PI / 2 : 0, I = 0; I < g.numGlyphs; I++) t.addDynamicAttributes(_, E, S);
                    h && g.associatedIconIndex >= 0 && (d[g.associatedIconIndex] = {
                        shiftedAnchor: E,
                        angle: S
                    });
                } else Se(g.numGlyphs, _);
            }
            if (h) {
                m.clear();
                for (var z = e.icon.placedSymbolArray, C = 0; C < z.length; C++) {
                    var P = z.get(C);
                    if (P.hidden) Se(P.numGlyphs, m);
                    else {
                        var L = d[C];
                        if (L)
                            for (var A = 0; A < P.numGlyphs; A++) t.addDynamicAttributes(m, L.shiftedAnchor, L.angle);
                        else Se(P.numGlyphs, m);
                    }
                }
                e.icon.dynamicLayoutVertexBuffer.updateData(m);
            }
            e.text.dynamicLayoutVertexBuffer.updateData(_);
        }

        function qo(t, e, i) {
            return i.iconsInText && e ? "symbolTextAndIcon" : t ? "symbolSDF" : "symbolIcon"
        }

        function jo(e, i, o, a, r, n, s, l, c, u, h, p) {
            for (var _ = e.context, m = _.gl, d = e.transform, f = "map" === l, g = "map" === c, v = f && "point" !== o.layout.get("symbol-placement"), y = f && !g && !v, x = void 0 !== o.layout.get("symbol-sort-key").constantOr(1), w = e.depthModeForSublayer(0, jt.ReadOnly), b = o.layout.get("text-variable-anchor"), T = [], E = 0, S = a; E < S.length; E += 1) {
                var I = S[E],
                    z = i.getTile(I),
                    C = z.getBucket(o);
                if (C) {
                    var P = r ? C.text : C.icon;
                    if (P && P.segments.get().length) {
                        var L = P.programConfigurations.get(o.id),
                            A = r || C.sdfIcons,
                            M = r ? C.textSizeData : C.iconSizeData,
                            D = g || 0 !== d.pitch,
                            R = e.useProgram(qo(A, r, C), L),
                            k = t.evaluateSizeForZoom(M, d.zoom),
                            O = void 0,
                            B = [0, 0],
                            U = void 0,
                            F = void 0,
                            N = null,
                            q = void 0;
                        if (r) U = z.glyphAtlasTexture, F = m.LINEAR, O = z.glyphAtlasTexture.size, C.iconsInText && (B = z.imageAtlasTexture.size, N = z.imageAtlasTexture, q = D || e.options.rotating || e.options.zooming || "composite" === M.kind || "camera" === M.kind ? m.LINEAR : m.NEAREST);
                        else {
                            var j = 1 !== o.layout.get("icon-size").constantOr(0) || C.iconsNeedLinear;
                            U = z.imageAtlasTexture, F = A || e.options.rotating || e.options.zooming || j || D ? m.LINEAR : m.NEAREST, O = z.imageAtlasTexture.size;
                        }
                        var Z = Ce(z, 1, e.transform.zoom),
                            V = _e(I.posMatrix, g, f, e.transform, Z),
                            G = me(I.posMatrix, g, f, e.transform, Z),
                            W = b && C.hasTextData(),
                            X = "none" !== o.layout.get("icon-text-fit") && W && C.hasIconData();
                        v && ve(C, I.posMatrix, e, r, V, G, g, u);
                        var H = e.translatePosMatrix(I.posMatrix, z, n, s),
                            K = v || r && b || X ? Uo : V,
                            Y = e.translatePosMatrix(G, z, n, s, !0),
                            J = A && 0 !== o.paint.get(r ? "text-halo-width" : "icon-halo-width").constantOr(1),
                            Q = {
                                program: R,
                                buffers: P,
                                uniformValues: A ? C.iconsInText ? yo(M.kind, k, y, g, e, H, K, Y, O, B) : vo(M.kind, k, y, g, e, H, K, Y, r, O, !0) : go(M.kind, k, y, g, e, H, K, Y, r, O),
                                atlasTexture: U,
                                atlasTextureIcon: N,
                                atlasInterpolation: F,
                                atlasInterpolationIcon: q,
                                isSDF: A,
                                hasHalo: J
                            };
                        if (x)
                            for (var $ = 0, tt = P.segments.get(); $ < tt.length; $ += 1) {
                                var et = tt[$];
                                T.push({
                                    segments: new t.SegmentVector([et]),
                                    sortKey: et.sortKey,
                                    state: Q
                                });
                            } else T.push({
                                segments: P.segments,
                                sortKey: 0,
                                state: Q
                            });
                    }
                }
            }
            x && T.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var it = 0, ot = T; it < ot.length; it += 1) {
                var at = ot[it],
                    rt = at.state;
                if (_.activeTexture.set(m.TEXTURE0), rt.atlasTexture.bind(rt.atlasInterpolation, m.CLAMP_TO_EDGE), rt.atlasTextureIcon && (_.activeTexture.set(m.TEXTURE1), rt.atlasTextureIcon && rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon, m.CLAMP_TO_EDGE)), rt.isSDF) {
                    var nt = rt.uniformValues;
                    rt.hasHalo && (nt.u_is_halo = 1, Zo(rt.buffers, at.segments, o, e, rt.program, w, h, p, nt)), nt.u_is_halo = 0;
                }
                Zo(rt.buffers, at.segments, o, e, rt.program, w, h, p, rt.uniformValues);
            }
        }

        function Zo(t, e, i, o, a, r, n, s, l) {
            var c = o.context;
            a.draw(c, c.gl.TRIANGLES, r, n, s, Gt.disabled, l, i.id, t.layoutVertexBuffer, t.indexBuffer, e, i.paint, o.transform.zoom, t.programConfigurations.get(i.id), t.dynamicLayoutVertexBuffer, t.opacityVertexBuffer);
        }

        function Vo(t, e, i, o, a, r, n, s) {
            var l, c, u, h, p, _ = t.context.gl,
                m = i.paint.get("fill-pattern"),
                d = m && m.constantOr(1),
                f = i.getCrossfadeParameters();
            s ? (c = "fillWater", l = _.TRIANGLES) : n ? (c = d && !i.getPaintProperty("fill-outline-color") ? "fillOutlinePattern" : "fillOutline", l = _.LINES) : (c = d ? "fillPattern" : "fill", l = _.TRIANGLES);
            for (var g = 0, v = o; g < v.length; g += 1) {
                var y = v[g],
                    x = e.getTile(y);
                if (!d || x.patternsLoaded()) {
                    var w = x.getBucket(i);
                    if (w) {
                        var b = w.programConfigurations.get(i.id),
                            T = t.useProgram(c, b);
                        d && (t.context.activeTexture.set(_.TEXTURE0), x.imageAtlasTexture.bind(_.LINEAR, _.CLAMP_TO_EDGE), b.updatePaintBuffers(f));
                        var E = m.constantOr(null);
                        if (E && x.imageAtlas) {
                            var S = x.imageAtlas,
                                I = S.patternPositions[E.to.toString()],
                                z = S.patternPositions[E.from.toString()];
                            I && z && b.setConstantPatternPositions(I, z);
                        }
                        var C = t.translatePosMatrix(y.posMatrix, x, i.paint.get("fill-translate"), i.paint.get("fill-translate-anchor"));
                        if (s) h = w.indexBuffer, p = w.segments, u = {
                            u_matrix: C,
                            u_time: performance.now() / 1e3
                        };
                        else if (n) {
                            h = w.indexBuffer2, p = w.segments2;
                            var P = [_.drawingBufferWidth, _.drawingBufferHeight];
                            u = "fillOutlinePattern" === c && d ? to(C, t, f, x, P) : $i(C, P);
                        } else h = w.indexBuffer, p = w.segments, u = d ? Qi(C, t, f, x) : Ji(C);
                        T.draw(t.context, l, a, t.stencilModeForClipping(y), r, Gt.disabled, u, i.id, w.layoutVertexBuffer, h, p, i.paint, t.transform.zoom, b);
                    }
                }
            }
        }

        function Go(t, e, i, o, a, r, n) {
            for (var s = t.context, l = s.gl, c = i.paint.get("extrusion-pattern"), u = c.constantOr(1), h = i.getCrossfadeParameters(), p = i.paint.get("extrusion-opacity"), _ = 0, m = o; _ < m.length; _ += 1) {
                var d = m[_],
                    f = e.getTile(d),
                    g = f.getBucket(i);
                if (g) {
                    var v = g.programConfigurations.get(i.id),
                        y = t.useProgram(u ? "fillExtrusionPattern" : "fillExtrusion", v);
                    u && (t.context.activeTexture.set(l.TEXTURE0), f.imageAtlasTexture.bind(l.LINEAR, l.CLAMP_TO_EDGE), v.updatePaintBuffers(h));
                    var x = c.constantOr(null);
                    if (x && f.imageAtlas) {
                        var w = f.imageAtlas,
                            b = w.patternPositions[x.to.toString()],
                            T = w.patternPositions[x.from.toString()];
                        b && T && v.setConstantPatternPositions(b, T);
                    }
                    var E = t.translatePosMatrix(d.posMatrix, f, i.paint.get("extrusion-translate"), i.paint.get("extrusion-translate-anchor")),
                        S = i.paint.get("extrusion-vertical-gradient"),
                        I = u ? Yi(E, t, S, p, d, h, f) : Ki(E, t, S, p);
                    y.draw(s, s.gl.TRIANGLES, a, r, n, Gt.backCCW, I, i.id, g.layoutVertexBuffer, g.indexBuffer, g.segments, i.paint, t.transform.zoom, v);
                }
            }
        }

        function Wo(t, e, i, o, a, r) {
            var n = t.context,
                s = n.gl,
                l = e.fbo;
            if (l) {
                var c = t.useProgram("hillshade");
                n.activeTexture.set(s.TEXTURE0), s.bindTexture(s.TEXTURE_2D, l.colorAttachment.get());
                var u = function (t, e, i) {
                    var o = i.paint.get("hillshade-shadow-color"),
                        a = i.paint.get("hillshade-highlight-color"),
                        r = i.paint.get("hillshade-accent-color"),
                        n = i.paint.get("hillshade-illumination-direction") * (Math.PI / 180);
                    "viewport" === i.paint.get("hillshade-illumination-anchor") && (n -= t.transform.angle);
                    var s = !t.options.moving;
                    return {
                        u_matrix: t.transform.calculatePosMatrix(e.tileID.toUnwrapped(), s),
                        u_image: 0,
                        u_latrange: so(t, e.tileID),
                        u_light: [i.paint.get("hillshade-exaggeration"), n],
                        u_shadow: o,
                        u_highlight: a,
                        u_accent: r
                    }
                }(t, e, i);
                c.draw(n, s.TRIANGLES, o, a, r, Gt.disabled, u, i.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments);
            }
        }

        function Xo(e, i, o, a, r, n, s) {
            var l = e.context,
                c = l.gl,
                u = i.dem;
            if (u && u.data) {
                var h = u.dim,
                    p = u.stride,
                    _ = u.getPixels();
                if (l.activeTexture.set(c.TEXTURE1), l.pixelStoreUnpackPremultiplyAlpha.set(!1), i.demTexture = i.demTexture || e.getTileTexture(p), i.demTexture) {
                    var m = i.demTexture;
                    m.update(_, {
                        premultiply: !1
                    }), m.bind(c.NEAREST, c.CLAMP_TO_EDGE);
                } else i.demTexture = new t.Texture(l, _, c.RGBA, {
                    premultiply: !1
                }), i.demTexture.bind(c.NEAREST, c.CLAMP_TO_EDGE);
                l.activeTexture.set(c.TEXTURE0);
                var d = i.fbo;
                if (!d) {
                    var f = new t.Texture(l, {
                        width: h,
                        height: h,
                        data: null
                    }, c.RGBA);
                    f.bind(c.LINEAR, c.CLAMP_TO_EDGE), (d = i.fbo = l.createFramebuffer(h, h, !0)).colorAttachment.set(f.texture);
                }
                l.bindFramebuffer.set(d.framebuffer), l.viewport.set([0, 0, h, h]), e.useProgram("hillshadePrepare").draw(l, c.TRIANGLES, r, n, s, Gt.disabled, function (e, i, o) {
                    var a = i.stride,
                        r = t.create();
                    return t.ortho(r, 0, t.EXTENT, -t.EXTENT, 0, 0, 1), t.translate(r, r, [0, -t.EXTENT, 0]), {
                        u_matrix: r,
                        u_image: 1,
                        u_dimension: [a, a],
                        u_zoom: e.overscaledZ,
                        u_maxzoom: o,
                        u_unpack: i.getUnpackVector()
                    }
                }(i.tileID, u, a), o.id, e.rasterBoundsBuffer, e.quadTriangleIndexBuffer, e.rasterBoundsSegments), i.needsHillshadePrepare = !1;
            }
        }

        function Ho(e, i, o, a, r) {
            var n = a.paint.get("raster-fade-duration");
            if (n > 0) {
                var s = t.browser.now(),
                    l = (s - e.timeAdded) / n,
                    c = i ? (s - i.timeAdded) / n : -1,
                    u = o.getSource(),
                    h = r.coveringZoomLevel({
                        tileSize: u.tileSize,
                        roundZoom: u.roundZoom
                    }),
                    p = !i || Math.abs(i.tileID.overscaledZ - h) > Math.abs(e.tileID.overscaledZ - h),
                    _ = p && e.refreshedUponExpiration ? 1 : t.clamp(p ? l : 1 - c, 0, 1);
                return e.refreshedUponExpiration && l >= 1 && (e.refreshedUponExpiration = !1), i ? {
                    opacity: 1,
                    mix: 1 - _
                } : {
                    opacity: _,
                    mix: 0
                }
            }
            return {
                opacity: 1,
                mix: 0
            }
        }
        var Ko = new t.Color(1, 0, 0, 1),
            Yo = new t.Color(0, 1, 0, 1),
            Jo = new t.Color(0, 0, 1, 1),
            Qo = new t.Color(1, 0, 1, 1),
            $o = new t.Color(0, 1, 1, 1);

        function ta(t, e, i, o) {
            ia(t, 0, e + i / 2, t.transform.width, i, o);
        }

        function ea(t, e, i, o) {
            ia(t, e - i / 2, 0, i, t.transform.height, o);
        }

        function ia(e, i, o, a, r, n) {
            var s = e.context,
                l = s.gl;
            l.enable(l.SCISSOR_TEST), l.scissor(i * t.browser.devicePixelRatio, o * t.browser.devicePixelRatio, a * t.browser.devicePixelRatio, r * t.browser.devicePixelRatio), s.clear({
                color: n
            }), l.disable(l.SCISSOR_TEST);
        }

        function oa(e, i, o) {
            var a = e.context,
                r = a.gl,
                n = o.posMatrix,
                s = e.useProgram("debug"),
                l = jt.disabled,
                c = Zt.disabled,
                u = e.colorModeForRenderPass();
            a.activeTexture.set(r.TEXTURE0), e.emptyTexture.bind(r.LINEAR, r.CLAMP_TO_EDGE), s.draw(a, r.LINE_STRIP, l, c, u, Gt.disabled, ao(n, t.Color.red), "$debug", e.debugBuffer, e.tileBorderIndexBuffer, e.debugSegments);
            var h = i.getTileByID(o.key).latestRawTileData,
                p = Math.floor((h && h.byteLength || 0) / 1024),
                _ = i.getTile(o).tileSize,
                m = 512 / Math.min(_, 512) * (o.overscaledZ / e.transform.zoom) * .5,
                d = o.canonical.toString();
            o.overscaledZ !== o.canonical.z && (d += " => " + o.overscaledZ),
                function (t, e) {
                    t.initDebugOverlayCanvas();
                    var i = t.debugOverlayCanvas,
                        o = t.context.gl,
                        a = t.debugOverlayCanvas.getContext("2d");
                    a.clearRect(0, 0, i.width, i.height), a.shadowColor = "white", a.shadowBlur = 2, a.lineWidth = 1.5, a.strokeStyle = "white", a.textBaseline = "top", a.font = "bold 36px Open Sans, sans-serif", a.fillText(e, 5, 5), a.strokeText(e, 5, 5), t.debugOverlayTexture.update(i), t.debugOverlayTexture.bind(o.LINEAR, o.CLAMP_TO_EDGE);
                }(e, d + " " + p + "kb"), s.draw(a, r.TRIANGLES, l, c, Vt.alphaBlended, Gt.disabled, ao(n, t.Color.transparent, m), "$debug", e.debugBuffer, e.quadTriangleIndexBuffer, e.debugSegments);
        }
        var aa = 20,
            ra = t.identity(new Float32Array(16));

        function na(e, i, o, a, r, n) {
            var s = t.getAnchorAlignment(e),
                l = -(s.horizontalAlign - .5) * i,
                c = -(s.verticalAlign - .5) * o,
                u = t.evaluateVariableOffset(e, a);
            return new t.Point((l / r + u[0]) * n, (c / r + u[1]) * n)
        }

        function sa(e, i, o, a, r, n, s, l, c, u, h) {
            var p = e.text.placedSymbolArray,
                _ = e.text.dynamicLayoutVertexArray,
                m = e.icon.dynamicLayoutVertexArray,
                d = {};
            _.clear();
            for (var f = 0; f < p.length; f++) {
                var g = p.get(f),
                    v = g.hidden || !g.crossTileID || e.allowVerticalPlacement && !g.placedOrientation ? null : a[g.crossTileID];
                if (v) {
                    var y = new t.Point(g.anchorX, g.anchorY),
                        x = de(y, o ? l : s),
                        w = fe(n.cameraToCenterDistance, x.signedDistanceFromCamera),
                        b = r.evaluateSizeForFeature(e.textSizeData, u, g) * w / t.ONE_EM;
                    o && (b *= e.tilePixelRatio / c);
                    for (var T = na(v.anchor, v.width, v.height, v.textOffset, v.textBoxScale, b), E = o ? de(y.add(T), s).point : x.point.add(i ? T.rotate(-n.angle) : T), S = e.allowVerticalPlacement && g.placedOrientation === t.WritingMode.vertical ? Math.PI / 2 : 0, I = 0; I < g.numGlyphs; I++) t.addDynamicAttributes$1(_, E, S);
                    h && g.associatedIconIndex >= 0 && (d[g.associatedIconIndex] = {
                        shiftedAnchor: E,
                        angle: S
                    });
                } else Se(g.numGlyphs, _);
            }
            if (h) {
                m.clear();
                for (var z = e.icon.placedSymbolArray, C = 0; C < z.length; C++) {
                    var P = z.get(C);
                    if (P.hidden) Se(P.numGlyphs, m);
                    else {
                        var L = d[C];
                        if (L)
                            for (var A = 0; A < P.numGlyphs; A++) t.addDynamicAttributes$1(m, L.shiftedAnchor, L.angle);
                        else Se(P.numGlyphs, m);
                    }
                }
                e.icon.dynamicLayoutVertexBuffer.updateData(m);
            }
            e.text.dynamicLayoutVertexBuffer.updateData(_);
        }

        function la(t, e, i) {
            return i.iconsInText && e ? "symbolTextAndIcon" : t ? "symtrackingSDF" : "symtrackingIcon"
        }

        function ca(e, i, o, a, r, n, s, l, c, u, h, p, _) {
            for (var m = e.context, d = m.gl, f = e.transform, g = "map" === l, v = "map" === c, y = g && !v && !0, x = void 0 !== o.layout.get("symbol-sort-key").constantOr(1), w = e.depthModeForSublayer(0, jt.ReadOnly), b = o.layout.get("text-variable-anchor"), T = [], E = 0, S = a; E < S.length; E += 1) {
                var I = S[E],
                    z = i.getTile(I),
                    C = z.getBucket(o);
                if (C) {
                    var P = r ? C.text : C.icon;
                    if (P && P.segments.get().length) {
                        var L = P.programConfigurations.get(o.id),
                            A = r || C.sdfIcons,
                            M = r ? C.textSizeData : C.iconSizeData,
                            D = v || 0 !== f.pitch,
                            R = e.useProgram(la(A, r, C), L),
                            k = t.evaluateSizeForZoom(M, f.zoom),
                            O = void 0,
                            B = void 0,
                            U = void 0,
                            F = null,
                            N = void 0;
                        if (r) B = z.glyphAtlasTexture, U = d.LINEAR, O = z.glyphAtlasTexture.size, C.iconsInText && (F = z.imageAtlasTexture, N = D || e.options.rotating || e.options.zooming || "composite" === M.kind || "camera" === M.kind ? d.LINEAR : d.NEAREST);
                        else {
                            var q = 1 !== o.layout.get("icon-size").constantOr(0) || C.iconsNeedLinear;
                            B = z.imageAtlasTexture, U = A || e.options.rotating || e.options.zooming || q || D ? d.LINEAR : d.NEAREST, O = z.imageAtlasTexture.size;
                        }
                        var j = Ce(z, 1, e.transform.zoom),
                            Z = _e(I.posMatrix, v, g, e.transform, j),
                            V = me(I.posMatrix, v, g, e.transform, j),
                            G = b && C.hasTextData(),
                            W = "none" !== o.layout.get("icon-text-fit") && G && C.hasIconData(),
                            X = e.translatePosMatrix(I.posMatrix, z, n, s),
                            H = r && b || W ? ra : Z,
                            K = e.translatePosMatrix(V, z, n, s, !0),
                            Y = A && 0 !== o.paint.get(r ? "text-halo-width" : "icon-halo-width").constantOr(1),
                            J = void 0;
                        A ? C.iconsInText || (J = Mo(M.kind, k, y, v, e, X, H, K, r, O, !0, _)) : J = Ao(M.kind, k, y, v, e, X, H, K, r, O, _);
                        var Q = {
                            program: R,
                            buffers: P,
                            uniformValues: J,
                            atlasTexture: B,
                            atlasTextureIcon: F,
                            atlasInterpolation: U,
                            atlasInterpolationIcon: N,
                            isSDF: A,
                            hasHalo: Y
                        };
                        if (x)
                            for (var $ = 0, tt = P.segments.get(); $ < tt.length; $ += 1) {
                                var et = tt[$];
                                T.push({
                                    segments: new t.SegmentVector([et]),
                                    sortKey: et.sortKey,
                                    state: Q
                                });
                            } else T.push({
                                segments: P.segments,
                                sortKey: 0,
                                state: Q
                            });
                    }
                }
            }
            x && T.sort((function (t, e) {
                return t.sortKey - e.sortKey
            }));
            for (var it = 0, ot = T; it < ot.length; it += 1) {
                var at = ot[it],
                    rt = at.state;
                if (m.activeTexture.set(d.TEXTURE0), rt.atlasTexture.bind(rt.atlasInterpolation, d.CLAMP_TO_EDGE), rt.atlasTextureIcon && (m.activeTexture.set(d.TEXTURE1), rt.atlasTextureIcon && rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon, d.CLAMP_TO_EDGE)), rt.isSDF) {
                    var nt = rt.uniformValues;
                    rt.hasHalo && (nt.u_is_halo = 1, ua(rt.buffers, at.segments, o, e, rt.program, w, h, p, nt)), nt.u_is_halo = 0;
                }
                ua(rt.buffers, at.segments, o, e, rt.program, w, h, p, rt.uniformValues);
            }
        }

        function ua(t, e, i, o, a, r, n, s, l) {
            var c = o.context;
            a.draw(c, c.gl.TRIANGLES, r, n, s, Gt.disabled, l, i.id, t.layoutVertexBuffer, t.indexBuffer, e, i.paint, o.transform.zoom, t.programConfigurations.get(i.id), t.dynamicLayoutVertexBuffer, t.opacityVertexBuffer);
        }

        function ha(e, i, o, a, r, n, s) {
            var l = e.context,
                c = o.paint.get("histogram-opacity"),
                u = o.layout.get("histogram-max-height-render"),
                h = o.paint.get("depth-change"),
                p = o.layout.get("histogram-color-render"),
                _ = p ? o.paint.get("histogram-max-height") : 1,
                m = o.paint.get("histogram-dynamic"),
                d = [];
            if (p)
                for (var f = o.paint.get("histogram-colors"), g = 0; g < f.length; g++) {
                    var v = t.colorParser.parseCSSColor(f[g]);
                    v[0] /= 255, v[1] /= 255, v[2] /= 255, v[3] = 0, d.push(v);
                }
            for (var y = 0, x = a; y < x.length; y += 1) {
                var w = x[y],
                    b = i.getTile(w),
                    T = b.getBucket(o);
                if (T) {
                    var E = T.programConfigurations.get(o.id),
                        S = null;
                    S = e.useProgram(m ? "histogramDynamic" : p ? "histogramColor" : "histogram", E);
                    var I, z = e.translatePosMatrix(w.posMatrix, b, o.paint.get("histogram-translate"), o.paint.get("histogram-translate-anchor")),
                        C = o.paint.get("histogram-vertical-gradient");
                    I = m ? ko(z, e, C, c, _, d, o.histCount) : p ? Ro(z, e, C, c, u, h, _, d) : Do(z, e, C, c, u, h), S.draw(l, l.gl.TRIANGLES, r, n, s, Gt.backCCW, I, o.id, T.layoutVertexBuffer, T.indexBuffer, T.segments, o.paint, e.transform.zoom, E);
                }
            }
        }
        var pa = {
                symbol: function (e, i, o, a, r) {
                    if ("translucent" === e.renderPass) {
                        var n = Zt.disabled,
                            s = e.colorModeForRenderPass();
                        o.layout.get("text-variable-anchor") && function (e, i, o, a, r, n, s) {
                            for (var l = i.transform, c = "map" === r, u = "map" === n, h = 0, p = e; h < p.length; h += 1) {
                                var _ = p[h],
                                    m = a.getTile(_),
                                    d = m.getBucket(o);
                                if (d && d.text && d.text.segments.get().length) {
                                    var f = t.evaluateSizeForZoom(d.textSizeData, l.zoom),
                                        g = Ce(m, 1, i.transform.zoom),
                                        v = _e(_.posMatrix, u, c, i.transform, g),
                                        y = "none" !== o.layout.get("icon-text-fit") && d.hasIconData();
                                    if (f) {
                                        var x = Math.pow(2, l.zoom - m.tileID.overscaledZ);
                                        No(d, c, u, s, t.symbolSize, l, v, _.posMatrix, x, f, y);
                                    }
                                }
                            }
                        }(a, e, o, i, o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), r), 0 !== o.paint.get("icon-opacity").constantOr(1) && jo(e, i, o, a, !1, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), o.layout.get("icon-rotation-alignment"), o.layout.get("icon-pitch-alignment"), o.layout.get("icon-keep-upright"), n, s), 0 !== o.paint.get("text-opacity").constantOr(1) && jo(e, i, o, a, !0, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), o.layout.get("text-keep-upright"), n, s), i.map.showCollisionBoxes && (Bo(e, i, o, a, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), !0), Bo(e, i, o, a, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), !1));
                    }
                },
                circle: function (e, i, o, a) {
                    if ("translucent" === e.renderPass) {
                        var r = o.paint.get("circle-opacity"),
                            n = o.paint.get("circle-stroke-width"),
                            s = o.paint.get("circle-stroke-opacity"),
                            l = void 0 !== o.layout.get("circle-sort-key").constantOr(1);
                        if (0 !== r.constantOr(1) || 0 !== n.constantOr(1) && 0 !== s.constantOr(1)) {
                            for (var c = e.context, u = c.gl, h = e.depthModeForSublayer(0, jt.ReadOnly), p = Zt.disabled, _ = e.colorModeForRenderPass(), m = [], d = 0; d < a.length; d++) {
                                var f = a[d],
                                    g = i.getTile(f),
                                    v = g.getBucket(o);
                                if (v) {
                                    var y = v.programConfigurations.get(o.id),
                                        x = {
                                            programConfiguration: y,
                                            program: e.useProgram("circle", y),
                                            layoutVertexBuffer: v.layoutVertexBuffer,
                                            indexBuffer: v.indexBuffer,
                                            uniformValues: eo(e, f, g, o)
                                        };
                                    if (l)
                                        for (var w = 0, b = v.segments.get(); w < b.length; w += 1) {
                                            var T = b[w];
                                            m.push({
                                                segments: new t.SegmentVector([T]),
                                                sortKey: T.sortKey,
                                                state: x
                                            });
                                        } else m.push({
                                            segments: v.segments,
                                            sortKey: 0,
                                            state: x
                                        });
                                }
                            }
                            l && m.sort((function (t, e) {
                                return t.sortKey - e.sortKey
                            }));
                            for (var E = 0, S = m; E < S.length; E += 1) {
                                var I = S[E],
                                    z = I.state;
                                z.program.draw(c, u.TRIANGLES, h, p, _, Gt.disabled, z.uniformValues, o.id, z.layoutVertexBuffer, z.indexBuffer, I.segments, o.paint, e.transform.zoom, z.programConfiguration);
                            }
                        }
                    }
                },
                heatmap: function (e, i, o, a) {
                    if (0 !== o.paint.get("heatmap-opacity"))
                        if ("offscreen" === e.renderPass) {
                            var r = e.context,
                                n = r.gl,
                                s = Zt.disabled,
                                l = new Vt([n.ONE, n.ONE], t.Color.transparent, [!0, !0, !0, !0]);
                            ! function (t, e, i) {
                                var o = t.gl;
                                t.activeTexture.set(o.TEXTURE1), t.viewport.set([0, 0, e.width / 4, e.height / 4]);
                                var a = i.heatmapFbo;
                                if (a) o.bindTexture(o.TEXTURE_2D, a.colorAttachment.get()), t.bindFramebuffer.set(a.framebuffer);
                                else {
                                    var r = o.createTexture();
                                    o.bindTexture(o.TEXTURE_2D, r), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_S, o.CLAMP_TO_EDGE), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_T, o.CLAMP_TO_EDGE), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MIN_FILTER, o.LINEAR), o.texParameteri(o.TEXTURE_2D, o.TEXTURE_MAG_FILTER, o.LINEAR), a = i.heatmapFbo = t.createFramebuffer(e.width / 4, e.height / 4, !1),
                                        function (t, e, i, o) {
                                            var a = t.gl;
                                            a.texImage2D(a.TEXTURE_2D, 0, a.RGBA, e.width / 4, e.height / 4, 0, a.RGBA, t.extRenderToTextureHalfFloat ? t.extTextureHalfFloat.HALF_FLOAT_OES : a.UNSIGNED_BYTE, null), o.colorAttachment.set(i);
                                        }(t, e, r, a);
                                }
                            }(r, e, o), r.clear({
                                color: t.Color.transparent
                            });
                            for (var c = 0; c < a.length; c++) {
                                var u = a[c];
                                if (!i.hasRenderableParent(u)) {
                                    var h = i.getTile(u),
                                        p = h.getBucket(o);
                                    if (p) {
                                        var _ = p.programConfigurations.get(o.id);
                                        e.useProgram("heatmap", _).draw(r, n.TRIANGLES, jt.disabled, s, l, Gt.disabled, no(u.posMatrix, h, e.transform.zoom, o.paint.get("heatmap-intensity")), o.id, p.layoutVertexBuffer, p.indexBuffer, p.segments, o.paint, e.transform.zoom, _);
                                    }
                                }
                            }
                            r.viewport.set([0, 0, e.width, e.height]);
                        } else "translucent" === e.renderPass && (e.context.setColorMode(e.colorModeForRenderPass()), function (e, i) {
                            var o = e.context,
                                a = o.gl,
                                r = i.heatmapFbo;
                            if (r) {
                                o.activeTexture.set(a.TEXTURE0), a.bindTexture(a.TEXTURE_2D, r.colorAttachment.get()), o.activeTexture.set(a.TEXTURE1);
                                var n = i.colorRampTexture;
                                n || (n = i.colorRampTexture = new t.Texture(o, i.colorRamp, a.RGBA)), n.bind(a.LINEAR, a.CLAMP_TO_EDGE), e.useProgram("heatmapTexture").draw(o, a.TRIANGLES, jt.disabled, Zt.disabled, e.colorModeForRenderPass(), Gt.disabled, function (e, i, o, a) {
                                    var r = t.create();
                                    t.ortho(r, 0, e.width, e.height, 0, 0, 1);
                                    var n = e.context.gl;
                                    return {
                                        u_matrix: r,
                                        u_world: [n.drawingBufferWidth, n.drawingBufferHeight],
                                        u_image: 0,
                                        u_color_ramp: 1,
                                        u_opacity: i.paint.get("heatmap-opacity")
                                    }
                                }(e, i), i.id, e.viewportBuffer, e.quadTriangleIndexBuffer, e.viewportSegments, i.paint, e.transform.zoom);
                            }
                        }(e, o));
                },
                line: function (e, i, o, a) {
                    if ("translucent" === e.renderPass) {
                        var r = o.paint.get("line-opacity"),
                            n = o.paint.get("line-width");
                        if (0 !== r.constantOr(1) && 0 !== n.constantOr(1)) {
                            var s = e.depthModeForSublayer(0, jt.ReadOnly),
                                l = e.colorModeForRenderPass(),
                                c = o.paint.get("line-dasharray"),
                                u = o.paint.get("line-pattern"),
                                h = u.constantOr(1),
                                p = o.paint.get("line-gradient"),
                                _ = o.getCrossfadeParameters(),
                                m = h ? "linePattern" : c ? "lineSDF" : p ? "lineGradient" : "line",
                                d = e.context,
                                f = d.gl,
                                g = !0,
                                v = !1,
                                y = !1;
                            if (p) {
                                d.activeTexture.set(f.TEXTURE0);
                                var x = o.gradientTexture;
                                if (!o.gradient) return;
                                x || (x = o.gradientTexture = new t.Texture(d, o.gradient, f.RGBA)), x.bind(f.LINEAR, f.CLAMP_TO_EDGE);
                            }
                            "visible" !== o.layout.get("border-visibility") || c || (v = !0), !0 === o.paint.get("half-render") && (y = !0);
                            for (var w = 0, b = a; w < b.length; w += 1) {
                                var T = b[w],
                                    E = i.getTile(T);
                                if (!h || E.patternsLoaded()) {
                                    var S = E.getBucket(o);
                                    if (S) {
                                        var I = S.programConfigurations.get(o.id),
                                            z = e.context.program.get(),
                                            C = e.useProgram(m, I),
                                            P = g || C.program !== z,
                                            L = u.constantOr(null);
                                        if (L && E.imageAtlas) {
                                            var A = E.imageAtlas,
                                                M = A.patternPositions[L.to.toString()],
                                                D = A.patternPositions[L.from.toString()];
                                            M && D && I.setConstantPatternPositions(M, D);
                                        }
                                        if (v) {
                                            var R = lo(e, E, o, v, y);
                                            C.draw(d, f.TRIANGLES, s, e.stencilModeForClipping(T), l, Gt.disabled, R, o.id, S.layoutVertexBuffer, S.indexBuffer, S.segments, o.paint, e.transform.zoom, I), g = !1;
                                        }
                                        var k = h ? uo(e, E, o, _) : c ? ho(e, E, o, c, _) : p ? co(e, E, o) : lo(e, E, o, !1, y);
                                        h ? (d.activeTexture.set(f.TEXTURE0), E.imageAtlasTexture.bind(f.LINEAR, f.CLAMP_TO_EDGE), I.updatePaintBuffers(_)) : c && (P || e.lineAtlas.dirty) && (d.activeTexture.set(f.TEXTURE0), e.lineAtlas.bind(d)), C.draw(d, f.TRIANGLES, s, e.stencilModeForClipping(T), l, Gt.disabled, k, o.id, S.layoutVertexBuffer, S.indexBuffer, S.segments, o.paint, e.transform.zoom, I), g = !1;
                                    }
                                }
                            }
                        }
                    }
                },
                fill: function (e, i, o, a) {
                    var r = o.paint.get("fill-color"),
                        n = o.paint.get("fill-opacity"),
                        s = "water" === o.paint.get("fill-water");
                    if (0 !== n.constantOr(1)) {
                        var l = e.colorModeForRenderPass(),
                            c = o.paint.get("fill-pattern"),
                            u = e.opaquePassEnabledForLayer() && !c.constantOr(1) && 1 === r.constantOr(t.Color.transparent).a && 1 === n.constantOr(0) ? "opaque" : "translucent";
                        if (e.renderPass === u) {
                            var h = e.depthModeForSublayer(1, "opaque" === e.renderPass ? jt.ReadWrite : jt.ReadOnly);
                            Vo(e, i, o, a, h, l, !1, s);
                        }
                        if ("translucent" === e.renderPass && o.paint.get("fill-antialias")) {
                            var p = e.depthModeForSublayer(o.getPaintProperty("fill-outline-color") ? 2 : 0, jt.ReadOnly);
                            Vo(e, i, o, a, p, l, !0, s);
                        }
                    }
                },
                extrusion: function (t, e, i, o) {
                    var a = i.paint.get("extrusion-opacity");
                    if (0 !== a && "translucent" === t.renderPass) {
                        var r = new jt(t.context.gl.LEQUAL, jt.ReadWrite, t.depthRangeFor3D);
                        if (1 !== a || i.paint.get("extrusion-pattern").constantOr(1)) Go(t, e, i, o, r, Zt.disabled, Vt.disabled), Go(t, e, i, o, r, t.stencilModeFor3D(), t.colorModeForRenderPass());
                        else {
                            var n = t.colorModeForRenderPass();
                            Go(t, e, i, o, r, Zt.disabled, n);
                        }
                    }
                },
                hillshade: function (t, e, i, o) {
                    if ("offscreen" === t.renderPass || "translucent" === t.renderPass) {
                        for (var a = t.context, r = e.getSource().maxzoom, n = t.depthModeForSublayer(0, jt.ReadOnly), s = t.colorModeForRenderPass(), l = "translucent" === t.renderPass ? t.stencilConfigForOverlap(o) : [{}, o], c = l[0], u = 0, h = l[1]; u < h.length; u += 1) {
                            var p = h[u],
                                _ = e.getTile(p);
                            _.needsHillshadePrepare && "offscreen" === t.renderPass ? Xo(t, _, i, r, n, Zt.disabled, s) : "translucent" === t.renderPass && Wo(t, _, i, n, c[p.overscaledZ], s);
                        }
                        a.viewport.set([0, 0, t.width, t.height]);
                    }
                },
                raster: function (t, e, i, o) {
                    if ("translucent" === t.renderPass && 0 !== i.paint.get("raster-opacity") && o.length)
                        for (var a = t.context, r = a.gl, n = e.getSource(), s = t.useProgram("raster"), l = t.colorModeForRenderPass(), c = n instanceof K ? [{}, o] : t.stencilConfigForOverlap(o), u = c[0], h = c[1], p = h[h.length - 1].overscaledZ, _ = !t.options.moving, m = 0, d = h; m < d.length; m += 1) {
                            var f = d[m],
                                g = t.depthModeForSublayer(f.overscaledZ - p, 1 === i.paint.get("raster-opacity") ? jt.ReadWrite : jt.ReadOnly, r.LESS),
                                v = e.getTile(f),
                                y = t.transform.calculatePosMatrix(f.toUnwrapped(), _);
                            v.registerFadeDuration(i.paint.get("raster-fade-duration"));
                            var x = e.findLoadedParent(f, 0),
                                w = Ho(v, x, e, i, t.transform),
                                b = void 0,
                                T = void 0,
                                E = "nearest" === i.paint.get("raster-resampling") ? r.NEAREST : r.LINEAR;
                            a.activeTexture.set(r.TEXTURE0), v.texture.bind(E, r.CLAMP_TO_EDGE, r.LINEAR_MIPMAP_NEAREST), a.activeTexture.set(r.TEXTURE1), x ? (x.texture.bind(E, r.CLAMP_TO_EDGE, r.LINEAR_MIPMAP_NEAREST), b = Math.pow(2, x.tileID.overscaledZ - v.tileID.overscaledZ), T = [v.tileID.canonical.x * b % 1, v.tileID.canonical.y * b % 1]) : v.texture.bind(E, r.CLAMP_TO_EDGE, r.LINEAR_MIPMAP_NEAREST);
                            var S = mo(y, T || [0, 0], b || 1, w, i);
                            n instanceof K ? s.draw(a, r.TRIANGLES, g, Zt.disabled, l, Gt.disabled, S, i.id, n.boundsBuffer, t.quadTriangleIndexBuffer, n.boundsSegments) : s.draw(a, r.TRIANGLES, g, u[f.overscaledZ], l, Gt.disabled, S, i.id, t.rasterBoundsBuffer, t.quadTriangleIndexBuffer, t.rasterBoundsSegments);
                        }
                },
                background: function (t, e, i) {
                    var o = i.paint.get("background-color"),
                        a = i.paint.get("background-opacity");
                    if (0 !== a) {
                        var r = t.context,
                            n = r.gl,
                            s = t.transform,
                            l = s.tileSize,
                            c = i.paint.get("background-pattern");
                        if (!t.isPatternMissing(c)) {
                            var u = !c && 1 === o.a && 1 === a && t.opaquePassEnabledForLayer() ? "opaque" : "translucent";
                            if (t.renderPass === u) {
                                var h = Zt.disabled,
                                    p = t.depthModeForSublayer(0, "opaque" === u ? jt.ReadWrite : jt.ReadOnly),
                                    _ = t.colorModeForRenderPass(),
                                    m = t.useProgram(c ? "backgroundPattern" : "background"),
                                    d = s.coveringTiles({
                                        tileSize: l
                                    });
                                c && (r.activeTexture.set(n.TEXTURE0), t.imageManager.bind(t.context));
                                for (var f = i.getCrossfadeParameters(), g = 0, v = d; g < v.length; g += 1) {
                                    var y = v[g],
                                        x = t.transform.calculatePosMatrix(y.toUnwrapped()),
                                        w = c ? wo(x, a, t, c, {
                                            tileID: y,
                                            tileSize: l
                                        }, f) : xo(x, a, o);
                                    m.draw(r, n.TRIANGLES, p, h, _, Gt.disabled, w, i.id, t.tileExtentBuffer, t.quadTriangleIndexBuffer, t.tileExtentSegments);
                                }
                            }
                        }
                    }
                },
                debug: function (t, e, i) {
                    for (var o = 0; o < i.length; o++) oa(t, e, i[o]);
                },
                custom: function (t, e, i) {
                    var o = t.context,
                        a = i.implementation;
                    if ("offscreen" === t.renderPass) {
                        var r = a.prerender;
                        r && (t.setCustomLayerDefaults(), o.setColorMode(t.colorModeForRenderPass()), r.call(a, o.gl, t.transform.customLayerMatrix()), o.setDirty(), t.setBaseState());
                    } else if ("translucent" === t.renderPass) {
                        t.setCustomLayerDefaults(), o.setColorMode(t.colorModeForRenderPass()), o.setStencilMode(Zt.disabled);
                        var n = "3d" === a.renderingMode ? new jt(t.context.gl.LEQUAL, jt.ReadWrite, t.depthRangeFor3D) : t.depthModeForSublayer(0, jt.ReadOnly);
                        o.setDepthMode(n), a.render(o.gl, t.transform.customLayerMatrix()), o.setDirty(), t.setBaseState(), o.bindFramebuffer.set(null);
                    }
                },
                airline: function (t, e, i, o) {
                    if ("translucent" === t.renderPass) {
                        var a = i.paint.get("airline-opacity"),
                            r = i.paint.get("airline-width");
                        if (0 !== a.constantOr(1) && 0 !== r.constantOr(1))
                            for (var n = t.depthModeForSublayer(0, jt.ReadOnly), s = t.colorModeForRenderPass(), l = t.context, c = l.gl, u = i.paint.get("airline-seg-group"), h = "none" === i.paint.get("airline-type") ? 0 : 1, p = t.timer.counter * i.paint.get("airline-speed"), _ = 0, m = o; _ < m.length; _ += 1) {
                                var d = e.getTile(m[_]),
                                    f = d.getBucket(i);
                                if (f) {
                                    var g = f.programConfigurations.get(i.id),
                                        v = t.useProgram("airline", g),
                                        y = bo(t, d, i, {
                                            start: p - u,
                                            segments: u,
                                            discard: h
                                        });
                                    v.draw(l, c.TRIANGLES, n, Zt.disabled, s, Gt.disabled, y, i.id, f.layoutVertexBuffer, f.indexBuffer, f.segments, i.paint, t.transform.zoom, g);
                                }
                            }
                    }
                },
                dynamicLine: function (t, e, i, o) {
                    if ("translucent" === t.renderPass) {
                        var a = i.paint.get("dynamicLine-opacity"),
                            r = i.paint.get("dynamicLine-width");
                        if (0 !== a.constantOr(1) && 0 !== r.constantOr(1)) {
                            var n = t.context,
                                s = n.gl,
                                l = t.depthModeForSublayer(0, jt.ReadOnly),
                                c = t.colorModeForRenderPass();
                            aa = i.paint.get("dynamicLine-seg-group") || 20;
                            for (var u = t.timer.counter * i.paint.get("dynamicLine-speed"), h = 0, p = o; h < p.length; h += 1) {
                                var _ = p[h],
                                    m = e.getTile(_),
                                    d = m.getBucket(i);
                                if (d) {
                                    var f = d.programConfigurations.get(i.id),
                                        g = t.useProgram("dynamicLine", f),
                                        v = Eo(t, m, i, u, aa);
                                    g.draw(n, s.TRIANGLES, l, t.stencilModeForClipping(_), c, Gt.disabled, v, i.id, d.layoutVertexBuffer, d.indexBuffer, d.segments, i.paint, t.transform.zoom, f);
                                }
                            }
                        }
                    }
                },
                sprite: function (t, e, i, o) {
                    if ("translucent" === t.renderPass) {
                        var a = i.paint.get("sprite-opacity"),
                            r = i.paint.get("sprite-width");
                        if (0 !== a.constantOr(1) && 0 !== r.constantOr(1)) {
                            var n = t.depthModeForSublayer(0, jt.ReadOnly),
                                s = t.colorModeForRenderPass(),
                                l = t.context,
                                c = l.gl;
                            i.hasOwnProperty("count") || (i.count = 0), i.count = t.timer.counter * i.paint.get("sprite-speed");
                            for (var u = 0, h = o; u < h.length; u += 1) {
                                var p = h[u],
                                    _ = e.getTile(p),
                                    m = _.getBucket(i);
                                if (m) {
                                    var d = m.programConfigurations.get(i.id),
                                        f = t.useProgram("sprite", d),
                                        g = Io(t, _, i);
                                    f.draw(l, c.TRIANGLES, n, t.stencilModeForClipping(p), s, Gt.disabled, g, i.id, m.layoutVertexBuffer, m.indexBuffer, m.segments, i.paint, t.transform.zoom, d);
                                }
                            }
                        }
                    }
                },
                tracking: function (t, e, i, o) {
                    if ("translucent" === t.renderPass) {
                        var a = i.paint.get("tracking-opacity"),
                            r = i.paint.get("tracking-width");
                        if (0 !== a.constantOr(1) && 0 !== r.constantOr(1)) {
                            var n = t.depthModeForSublayer(0, jt.ReadOnly),
                                s = t.colorModeForRenderPass(),
                                l = t.context,
                                c = l.gl;
                            i.segmentGroup = i.paint.get("tracking-seg-group"), i.first || (i.first = !0, i.histCount = 0, i.isReverse = !1, i.isReserve = !1);
                            var u = t.timer.counter * i.paint.get("tracking-speed");
                            "loop" === i.layout.get("tracking-display-mode") ? (i.histCount = u, i.histCount %= i.paint.get("tracking-seg-count"), i.histCount = 0 === i.histCount ? 1 : i.histCount) : "reverse" === i.layout.get("tracking-display-mode") ? (i.histCount >= i.paint.get("tracking-seg-count") + i.paint.get("tracking-seg-group") ? i.isReverse = !0 : i.histCount <= 1 && (i.isReverse = !1), i.histCount = i.isReverse ? i.histCount - 1 : i.histCount + 1) : "loop-reserve" === i.layout.get("tracking-display-mode") ? (i.isReserve = !0, i.histCount = u, i.histCount %= i.paint.get("tracking-seg-count"), i.histCount = 0 === i.histCount ? 1 : i.histCount) : "reverse-reserve" === i.layout.get("tracking-display-mode") && (i.isReserve = !0, i.histCount >= i.paint.get("tracking-seg-count") + i.paint.get("tracking-seg-group") ? i.isReverse = !0 : i.histCount <= 1 && (i.isReverse = !1), i.histCount = i.isReverse ? i.histCount - 1 : i.histCount + 1);
                            for (var h = 0, p = o; h < p.length; h += 1) {
                                var _ = p[h],
                                    m = e.getTile(_),
                                    d = m.getBucket(i);
                                if (d) {
                                    var f = d.programConfigurations.get(i.id),
                                        g = t.useProgram("tracking", f),
                                        v = Co(t, m, i);
                                    g.draw(l, c.TRIANGLES, n, t.stencilModeForClipping(_), s, Gt.disabled, v, i.id, d.layoutVertexBuffer, d.indexBuffer, d.segments, i.paint, t.transform.zoom, f);
                                }
                            }
                        }
                    }
                },
                symtracking: function (e, i, o, a, r) {
                    if ("translucent" === e.renderPass) {
                        o._count = o._count ? o._count : 0, void 0 === o.first && (o.first = !0), o.startOffset = o.startOffset ? o.startOffset : 0, o.preFps = o.preFps ? o.preFps : 0, o.fpsDifference = o.fpsDifference ? o.fpsDifference : 0, o.fpsOffset = o.fpsOffset ? o.fpsOffset : 0, console.log("每一次", o.first, o.offset);
                        var n = o.layout.get("symtracking-fps"),
                            s = o.layout.get("symtracking-time-segment");
                        o.offset = o.paint.get("symtracking-delay"), console.log("fps", n);
                        var l = n * (s + o.offset);
                        o.first && (o.startOffset = e.timer.counter * n, console.log("first", o.first), o.first = !1), o.preFps && o.preFps < o.layout.get("symtracking-fps") && (o.fpsDifference = o.layout.get("symtracking-fps") - o.preFps, o.fpsOffset = e.timer.counter * o.fpsDifference, console.log("一次")), o.preFps = n, console.log("重要", o.startOffset, o.fpsDifference, o), o._count = Math.round(e.timer.counter * n - o.startOffset - o.fpsOffset), o._count %= l, console.log("count2", o._count, l);
                        var c = Zt.disabled,
                            u = e.colorModeForRenderPass();
                        o.layout.get("text-variable-anchor") && function (e, i, o, a, r, n, s) {
                            for (var l = i.transform, c = "map" === r, u = "map" === n, h = 0, p = e; h < p.length; h += 1) {
                                var _ = p[h],
                                    m = a.getTile(_),
                                    d = m.getBucket(o);
                                if (d && d.text && d.text.segments.get().length) {
                                    var f = t.evaluateSizeForZoom(d.textSizeData, l.zoom),
                                        g = Ce(m, 1, i.transform.zoom),
                                        v = _e(_.posMatrix, u, c, i.transform, g),
                                        y = "none" !== o.layout.get("icon-text-fit") && d.hasIconData();
                                    if (f) {
                                        var x = Math.pow(2, l.zoom - m.tileID.overscaledZ);
                                        sa(d, c, u, s, t.symbolSize, l, v, _.posMatrix, x, f, y);
                                    }
                                }
                            }
                        }(a, e, o, i, o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), r), 0 !== o.paint.get("icon-opacity").constantOr(1) && ca(e, i, o, a, !1, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), o.layout.get("icon-rotation-alignment"), o.layout.get("icon-pitch-alignment"), o.layout.get("icon-keep-upright"), c, u, o._count), 0 !== o.paint.get("text-opacity").constantOr(1) && ca(e, i, o, a, !0, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), o.layout.get("text-rotation-alignment"), o.layout.get("text-pitch-alignment"), o.layout.get("text-keep-upright"), c, u, o._count), i.map.showCollisionBoxes && (Bo(e, i, o, a, o.paint.get("text-translate"), o.paint.get("text-translate-anchor"), !0), Bo(e, i, o, a, o.paint.get("icon-translate"), o.paint.get("icon-translate-anchor"), !1));
                    }
                },
                histogram: function (t, e, i, o) {
                    var a = i.paint.get("histogram-opacity");
                    if (0 !== a) {
                        var r = t.timer.counter * i.paint.get("histogram-speed");
                        if (i.hasRendered = !1, i.hasOwnProperty("_hasRendered") || (i.hasRendered = !0), i.paint.get("histogram-dynamic") && (i.histCount = r, i.histCount %= i.paint.get("histogram-count") * i.paint.get("histogram-speed"), i.histCount = 0 === i.histCount ? 1 : i.histCount), "translucent" === t.renderPass) {
                            var n = new jt(t.context.gl.LEQUAL, jt.ReadWrite, t.depthRangeFor3D);
                            if (1 === a) {
                                var s = t.colorModeForRenderPass();
                                ha(t, e, i, o, n, Zt.disabled, s);
                            } else ha(t, e, i, o, n, Zt.disabled, Vt.disabled), ha(t, e, i, o, n, t.stencilModeFor3D(), t.colorModeForRenderPass());
                        }
                    }
                }
            },
            _a = function (t, e, i, o) {
                this.context = new Wt(t), this.transform = e, this._tileTextures = {}, this.timer = i, this.isLatLon = o, this.setup(), this.numSublayers = Xt.maxUnderzooming + Xt.maxOverzooming + 1, this.depthEpsilon = 1 / Math.pow(2, 16), this.crossTileSymbolIndex = new ti, this.gpuTimers = {};
            };
        _a.prototype.resize = function (e, i) {
            if (this.width = e * t.browser.devicePixelRatio, this.height = i * t.browser.devicePixelRatio, this.context.viewport.set([0, 0, this.width, this.height]), this.style)
                for (var o = 0, a = this.style._order; o < a.length; o += 1) this.style._layers[a[o]].resize();
        }, _a.prototype.setup = function () {
            var e = this.context,
                i = new t.StructArrayLayout2i4;
            i.emplaceBack(0, 0), i.emplaceBack(t.EXTENT, 0), i.emplaceBack(0, t.EXTENT), i.emplaceBack(t.EXTENT, t.EXTENT), this.tileExtentBuffer = e.createVertexBuffer(i, ni.members), this.tileExtentSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
            var o = new t.StructArrayLayout2i4;
            o.emplaceBack(0, 0), o.emplaceBack(t.EXTENT, 0), o.emplaceBack(0, t.EXTENT), o.emplaceBack(t.EXTENT, t.EXTENT), this.debugBuffer = e.createVertexBuffer(o, ni.members), this.debugSegments = t.SegmentVector.simpleSegment(0, 0, 4, 5);
            var a = new t.StructArrayLayout4i8;
            a.emplaceBack(0, 0, 0, 0), a.emplaceBack(t.EXTENT, 0, t.EXTENT, 0), a.emplaceBack(0, t.EXTENT, 0, t.EXTENT), a.emplaceBack(t.EXTENT, t.EXTENT, t.EXTENT, t.EXTENT), this.rasterBoundsBuffer = e.createVertexBuffer(a, H.members), this.rasterBoundsSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
            var r = new t.StructArrayLayout2i4;
            r.emplaceBack(0, 0), r.emplaceBack(1, 0), r.emplaceBack(0, 1), r.emplaceBack(1, 1), this.viewportBuffer = e.createVertexBuffer(r, ni.members), this.viewportSegments = t.SegmentVector.simpleSegment(0, 0, 4, 2);
            var n = new t.StructArrayLayout1ui2;
            n.emplaceBack(0), n.emplaceBack(1), n.emplaceBack(3), n.emplaceBack(2), n.emplaceBack(0), this.tileBorderIndexBuffer = e.createIndexBuffer(n);
            var s = new t.StructArrayLayout3ui6;
            s.emplaceBack(0, 1, 2), s.emplaceBack(2, 1, 3), this.quadTriangleIndexBuffer = e.createIndexBuffer(s), this.emptyTexture = new t.Texture(e, {
                width: 1,
                height: 1,
                data: new Uint8Array([0, 0, 0, 0])
            }, e.gl.RGBA);
            var l = this.context.gl;
            this.stencilClearMode = new Zt({
                func: l.ALWAYS,
                mask: 0
            }, 0, 255, l.ZERO, l.ZERO, l.ZERO);
        }, _a.prototype.clearStencil = function () {
            var e = this.context,
                i = e.gl;
            this.nextStencilID = 1, this.currentStencilSource = void 0;
            var o = t.create();
            t.ortho(o, 0, this.width, this.height, 0, 0, 1), t.scale(o, o, [i.drawingBufferWidth, i.drawingBufferHeight, 0]), this.useProgram("clippingMask").draw(e, i.TRIANGLES, jt.disabled, this.stencilClearMode, Vt.disabled, Gt.disabled, ro(o), "$clipping", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments);
        }, _a.prototype._renderTileClippingMasks = function (t, e) {
            if (this.currentStencilSource !== t.source && t.isTileClipped() && e && e.length) {
                this.currentStencilSource = t.source;
                var i = this.context,
                    o = i.gl;
                this.nextStencilID + e.length > 256 && this.clearStencil(), i.setColorMode(Vt.disabled), i.setDepthMode(jt.disabled);
                var a = this.useProgram("clippingMask");
                this._tileClippingMaskIDs = {};
                for (var r = 0, n = e; r < n.length; r += 1) {
                    var s = n[r],
                        l = this._tileClippingMaskIDs[s.key] = this.nextStencilID++;
                    a.draw(i, o.TRIANGLES, jt.disabled, new Zt({
                        func: o.ALWAYS,
                        mask: 0
                    }, l, 255, o.KEEP, o.KEEP, o.REPLACE), Vt.disabled, Gt.disabled, ro(s.posMatrix), "$clipping", this.tileExtentBuffer, this.quadTriangleIndexBuffer, this.tileExtentSegments);
                }
            }
        }, _a.prototype.stencilModeFor3D = function () {
            this.currentStencilSource = void 0, this.nextStencilID + 1 > 256 && this.clearStencil();
            var t = this.nextStencilID++,
                e = this.context.gl;
            return new Zt({
                func: e.NOTEQUAL,
                mask: 255
            }, t, 255, e.KEEP, e.KEEP, e.REPLACE)
        }, _a.prototype.stencilModeForClipping = function (t) {
            var e = this.context.gl;
            return new Zt({
                func: e.EQUAL,
                mask: 255
            }, this._tileClippingMaskIDs[t.key], 0, e.KEEP, e.KEEP, e.REPLACE)
        }, _a.prototype.stencilConfigForOverlap = function (t) {
            var e, i = this.context.gl,
                o = t.sort((function (t, e) {
                    return e.overscaledZ - t.overscaledZ
                })),
                a = o[o.length - 1].overscaledZ,
                r = o[0].overscaledZ - a + 1;
            if (r > 1) {
                this.currentStencilSource = void 0, this.nextStencilID + r > 256 && this.clearStencil();
                for (var n = {}, s = 0; s < r; s++) n[s + a] = new Zt({
                    func: i.GEQUAL,
                    mask: 255
                }, s + this.nextStencilID, 255, i.KEEP, i.KEEP, i.REPLACE);
                return this.nextStencilID += r, [n, o]
            }
            return [(e = {}, e[a] = Zt.disabled, e), o]
        }, _a.prototype.colorModeForRenderPass = function () {
            var e = this.context.gl;
            return this._showOverdrawInspector ? new Vt([e.CONSTANT_COLOR, e.ONE], new t.Color(1 / 8, 1 / 8, 1 / 8, 0), [!0, !0, !0, !0]) : "opaque" === this.renderPass ? Vt.unblended : Vt.alphaBlended
        }, _a.prototype.depthModeForSublayer = function (t, e, i) {
            if (!this.opaquePassEnabledForLayer()) return jt.disabled;
            var o = 1 - ((1 + this.currentLayer) * this.numSublayers + t) * this.depthEpsilon;
            return new jt(i || this.context.gl.LEQUAL, e, [o, o])
        }, _a.prototype.opaquePassEnabledForLayer = function () {
            return this.currentLayer < this.opaquePassCutoff
        }, _a.prototype.render = function (e, i) {
            var o = this;
            this.style = e, this.options = i, this.lineAtlas = e.lineAtlas, this.imageManager = e.imageManager, this.glyphManager = e.glyphManager, this.symbolFadeChange = e.placement.symbolFadeChange(t.browser.now()), this.imageManager.beginFrame();
            var a = this.style._order,
                r = this.style.sourceCaches;
            for (var n in r) {
                var s = r[n];
                s.used && s.prepare(this.context);
            }
            var l, c, u = {},
                h = {},
                p = {};
            for (var _ in r) {
                var m = r[_];
                u[_] = m.getVisibleCoordinates(), h[_] = u[_].slice().reverse(), p[_] = m.getVisibleCoordinates(!0).reverse();
            }
            this.opaquePassCutoff = 1 / 0;
            for (var d = 0; d < a.length; d++)
                if (this.style._layers[a[d]].is3D()) {
                    this.opaquePassCutoff = d;
                    break
                } this.renderPass = "offscreen";
            for (var f = 0, g = a; f < g.length; f += 1) {
                var v = this.style._layers[g[f]];
                if (v.hasOffscreenPass() && !v.isHidden(this.transform.zoom)) {
                    var y = h[v.source];
                    ("custom" === v.type || y.length) && this.renderLayer(this, r[v.source], v, y);
                }
            }
            for (this.context.bindFramebuffer.set(null), this.context.clear({
                    color: i.showOverdrawInspector ? t.Color.black : t.Color.transparent,
                    depth: 1
                }), this.clearStencil(), this._showOverdrawInspector = i.showOverdrawInspector, this.depthRangeFor3D = [0, 1 - (e._order.length + 2) * this.numSublayers * this.depthEpsilon], this.renderPass = "opaque", this.currentLayer = a.length - 1; this.currentLayer >= 0; this.currentLayer--) {
                var x = this.style._layers[a[this.currentLayer]],
                    w = r[x.source],
                    b = u[x.source];
                this._renderTileClippingMasks(x, b), this.renderLayer(this, w, x, b);
            }
            for (this.renderPass = "translucent", this.currentLayer = 0; this.currentLayer < a.length; this.currentLayer++) {
                var T = this.style._layers[a[this.currentLayer]],
                    E = r[T.source],
                    S = ("symbol" === T.type ? p : h)[T.source];
                this._renderTileClippingMasks(T, u[T.source]), this.renderLayer(this, E, T, S);
            }
            this.options.showTileBoundaries && (t.values(this.style._layers).forEach((function (t) {
                t.source && !t.isHidden(o.transform.zoom) && (t.source !== (c && c.id) && (c = o.style.sourceCaches[t.source]), (!l || l.getSource().maxzoom < c.getSource().maxzoom) && (l = c));
            })), l && pa.debug(this, l, l.getVisibleCoordinates())), this.options.showPadding && function (t) {
                var e = t.transform.padding;
                ta(t, t.transform.height - (e.top || 0), 3, Ko), ta(t, e.bottom || 0, 3, Yo), ea(t, e.left || 0, 3, Jo), ea(t, t.transform.width - (e.right || 0), 3, Qo);
                var i = t.transform.centerPoint;
                ! function (t, e, i, o) {
                    ia(t, e - 1, i - 10, 2, 20, o), ia(t, e - 10, i - 1, 20, 2, o);
                }(t, i.x, t.transform.height - i.y, $o);
            }(this), this.context.setDefault();
        }, _a.prototype.renderLayer = function (t, e, i, o) {
            i.isHidden(this.transform.zoom) || ("background" === i.type || "custom" === i.type || o.length) && (this.id = i.id, this.gpuTimingStart(i), pa[i.type](t, e, i, o, this.style.placement.variableOffsets), this.gpuTimingEnd());
        }, _a.prototype.gpuTimingStart = function (t) {
            if (this.options.gpuTiming) {
                var e = this.context.extTimerQuery,
                    i = this.gpuTimers[t.id];
                i || (i = this.gpuTimers[t.id] = {
                    calls: 0,
                    cpuTime: 0,
                    query: e.createQueryEXT()
                }), i.calls++, e.beginQueryEXT(e.TIME_ELAPSED_EXT, i.query);
            }
        }, _a.prototype.gpuTimingEnd = function () {
            if (this.options.gpuTiming) {
                var t = this.context.extTimerQuery;
                t.endQueryEXT(t.TIME_ELAPSED_EXT);
            }
        }, _a.prototype.collectGpuTimers = function () {
            var t = this.gpuTimers;
            return this.gpuTimers = {}, t
        }, _a.prototype.queryGpuTimers = function (t) {
            var e = {};
            for (var i in t) {
                var o = t[i],
                    a = this.context.extTimerQuery,
                    r = a.getQueryObjectEXT(o.query, a.QUERY_RESULT_EXT) / 1e6;
                a.deleteQueryEXT(o.query), e[i] = r;
            }
            return e
        }, _a.prototype.translatePosMatrix = function (e, i, o, a, r) {
            if (!o[0] && !o[1]) return e;
            var n = r ? "map" === a ? this.transform.angle : 0 : "viewport" === a ? -this.transform.angle : 0;
            if (n) {
                var s = Math.sin(n),
                    l = Math.cos(n);
                o = [o[0] * l - o[1] * s, o[0] * s + o[1] * l];
            }
            var c = [r ? o[0] : Ce(i, o[0], this.transform.zoom), r ? o[1] : Ce(i, o[1], this.transform.zoom), 0],
                u = new Float32Array(16);
            return t.translate(u, e, c), u
        }, _a.prototype.saveTileTexture = function (t) {
            var e = this._tileTextures[t.size[0]];
            e ? e.push(t) : this._tileTextures[t.size[0]] = [t];
        }, _a.prototype.getTileTexture = function (t) {
            var e = this._tileTextures[t];
            return e && e.length > 0 ? e.pop() : null
        }, _a.prototype.isPatternMissing = function (t) {
            if (!t) return !1;
            if (!t.from || !t.to) return !0;
            var e = this.imageManager.getPattern(t.from.toString()),
                i = this.imageManager.getPattern(t.to.toString());
            return !e || !i
        }, _a.prototype.useProgram = function (t, e) {
            this.cache = this.cache || {};
            var i = "" + t + (e ? e.cacheKey : "") + (this._showOverdrawInspector ? "/overdraw" : "");
            return this.cache[i] || (this.cache[i] = new Xi(this.context, t, Vi[t], e, Oo[t], this._showOverdrawInspector)), this.cache[i]
        }, _a.prototype.setCustomLayerDefaults = function () {
            this.context.unbindVAO(), this.context.cullFace.setDefault(), this.context.activeTexture.setDefault(), this.context.pixelStoreUnpack.setDefault(), this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.context.pixelStoreUnpackFlipY.setDefault();
        }, _a.prototype.setBaseState = function () {
            var t = this.context.gl;
            this.context.cullFace.set(!1), this.context.viewport.set([0, 0, this.width, this.height]), this.context.blendEquation.set(t.FUNC_ADD);
        }, _a.prototype.initDebugOverlayCanvas = function () {
            null == this.debugOverlayCanvas && (this.debugOverlayCanvas = t.window.document.createElement("canvas"), this.debugOverlayCanvas.width = 512, this.debugOverlayCanvas.height = 512, this.debugOverlayTexture = new t.Texture(this.context, this.debugOverlayCanvas, this.context.gl.RGBA));
        }, _a.prototype.destroy = function () {
            this.emptyTexture.destroy(), this.debugOverlayTexture && this.debugOverlayTexture.destroy();
        };
        var ma = function (t, e) {
            this.points = t, this.planes = e;
        };
        ma.fromInvProjectionMatrix = function (e, i, o) {
            var a = Math.pow(2, o),
                r = [
                    [-1, 1, -1, 1],
                    [1, 1, -1, 1],
                    [1, -1, -1, 1],
                    [-1, -1, -1, 1],
                    [-1, 1, 1, 1],
                    [1, 1, 1, 1],
                    [1, -1, 1, 1],
                    [-1, -1, 1, 1]
                ].map((function (i) {
                    return t.transformMat4([], i, e)
                })).map((function (e) {
                    return t.scale$1([], e, 1 / e[3] / i * a)
                })),
                n = [
                    [0, 1, 2],
                    [6, 5, 4],
                    [0, 3, 7],
                    [2, 1, 5],
                    [3, 2, 6],
                    [0, 4, 5]
                ].map((function (e) {
                    var i = t.sub([], r[e[0]], r[e[1]]),
                        o = t.sub([], r[e[2]], r[e[1]]),
                        a = t.normalize([], t.cross([], i, o)),
                        n = -t.dot(a, r[e[1]]);
                    return a.concat(n)
                }));
            return new ma(r, n)
        };
        var da = function (e, i) {
            this.min = e, this.max = i, this.center = t.scale$2([], t.add([], this.min, this.max), .5);
        };
        da.prototype.quadrant = function (e) {
            for (var i = [e % 2 == 0, e < 2], o = t.clone$2(this.min), a = t.clone$2(this.max), r = 0; r < i.length; r++) o[r] = i[r] ? this.min[r] : this.center[r], a[r] = i[r] ? this.center[r] : this.max[r];
            return a[2] = this.max[2], new da(o, a)
        }, da.prototype.distanceX = function (t) {
            return Math.max(Math.min(this.max[0], t[0]), this.min[0]) - t[0]
        }, da.prototype.distanceY = function (t) {
            return Math.max(Math.min(this.max[1], t[1]), this.min[1]) - t[1]
        }, da.prototype.intersects = function (e) {
            for (var i = [
                    [this.min[0], this.min[1], 0, 1],
                    [this.max[0], this.min[1], 0, 1],
                    [this.max[0], this.max[1], 0, 1],
                    [this.min[0], this.max[1], 0, 1]
                ], o = !0, a = 0; a < e.planes.length; a++) {
                for (var r = e.planes[a], n = 0, s = 0; s < i.length; s++) n += t.dot$1(r, i[s]) >= 0;
                if (0 === n) return 0;
                n !== i.length && (o = !1);
            }
            if (o) return 2;
            for (var l = 0; l < 3; l++) {
                for (var c = Number.MAX_VALUE, u = -Number.MAX_VALUE, h = 0; h < e.points.length; h++) {
                    var p = e.points[h][l] - this.min[l];
                    c = Math.min(c, p), u = Math.max(u, p);
                }
                if (u < 0 || c > this.max[l] - this.min[l]) return 0
            }
            return 1
        };
        var fa = function (t, e, i, o) {
            if (void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === o && (o = 0), isNaN(t) || t < 0 || isNaN(e) || e < 0 || isNaN(i) || i < 0 || isNaN(o) || o < 0) throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");
            this.top = t, this.bottom = e, this.left = i, this.right = o;
        };
        fa.prototype.interpolate = function (e, i, o) {
            return null != i.top && null != e.top && (this.top = t.number(e.top, i.top, o)), null != i.bottom && null != e.bottom && (this.bottom = t.number(e.bottom, i.bottom, o)), null != i.left && null != e.left && (this.left = t.number(e.left, i.left, o)), null != i.right && null != e.right && (this.right = t.number(e.right, i.right, o)), this
        }, fa.prototype.getCenter = function (e, i) {
            var o = t.clamp((this.left + e - this.right) / 2, 0, e),
                a = t.clamp((this.top + i - this.bottom) / 2, 0, i);
            return new t.Point(o, a)
        }, fa.prototype.equals = function (t) {
            return this.top === t.top && this.bottom === t.bottom && this.left === t.left && this.right === t.right
        }, fa.prototype.clone = function () {
            return new fa(this.top, this.bottom, this.left, this.right)
        }, fa.prototype.toJSON = function () {
            return {
                top: this.top,
                bottom: this.bottom,
                left: this.left,
                right: this.right
            }
        };
        var ga = function (e, i, o, a, r, n) {
                this.tileSize = 512, this._isLatLon = n, this.maxValidLatitude = this._isLatLon ? 90 : 85.051129, this._renderWorldCopies = void 0 === r || r, this._minZoom = e || 0, this._maxZoom = i || 22, this._minPitch = null == o ? 0 : o, this._maxPitch = null == a ? 60 : a, this.setMaxBounds(), this.width = 0, this.height = 0, this._center = new t.LngLat(0, 0), this.zoom = 0, this.angle = 0, this._fov = .6435011087932844, this._pitch = 0, this._unmodified = !0, this._edgeInsets = new fa, this._posMatrixCache = {}, this._alignedPosMatrixCache = {};
            },
            va = {
                minZoom: {
                    configurable: !0
                },
                maxZoom: {
                    configurable: !0
                },
                minPitch: {
                    configurable: !0
                },
                maxPitch: {
                    configurable: !0
                },
                renderWorldCopies: {
                    configurable: !0
                },
                worldSize: {
                    configurable: !0
                },
                centerOffset: {
                    configurable: !0
                },
                size: {
                    configurable: !0
                },
                bearing: {
                    configurable: !0
                },
                pitch: {
                    configurable: !0
                },
                fov: {
                    configurable: !0
                },
                zoom: {
                    configurable: !0
                },
                center: {
                    configurable: !0
                },
                padding: {
                    configurable: !0
                },
                centerPoint: {
                    configurable: !0
                },
                unmodified: {
                    configurable: !0
                },
                point: {
                    configurable: !0
                }
            };
        ga.prototype.clone = function () {
            var t = new ga(this._minZoom, this._maxZoom, this._minPitch, this.maxPitch, this._renderWorldCopies, this._isLatLon);
            return t.tileSize = this.tileSize, t.latRange = this.latRange, t.width = this.width, t.height = this.height, t._center = this._center, t.zoom = this.zoom, t.angle = this.angle, t._fov = this._fov, t._pitch = this._pitch, t._unmodified = this._unmodified, t._edgeInsets = this._edgeInsets.clone(), t._calcMatrices(), t
        }, va.minZoom.get = function () {
            return this._minZoom
        }, va.minZoom.set = function (t) {
            this._minZoom !== t && (this._minZoom = t, this.zoom = Math.max(this.zoom, t));
        }, va.maxZoom.get = function () {
            return this._maxZoom
        }, va.maxZoom.set = function (t) {
            this._maxZoom !== t && (this._maxZoom = t, this.zoom = Math.min(this.zoom, t));
        }, va.minPitch.get = function () {
            return this._minPitch
        }, va.minPitch.set = function (t) {
            this._minPitch !== t && (this._minPitch = t, this.pitch = Math.max(this.pitch, t));
        }, va.maxPitch.get = function () {
            return this._maxPitch
        }, va.maxPitch.set = function (t) {
            this._maxPitch !== t && (this._maxPitch = t, this.pitch = Math.min(this.pitch, t));
        }, va.renderWorldCopies.get = function () {
            return this._renderWorldCopies
        }, va.renderWorldCopies.set = function (t) {
            void 0 === t ? t = !0 : null === t && (t = !1), this._renderWorldCopies = t;
        }, va.worldSize.get = function () {
            return this.tileSize * this.scale
        }, va.centerOffset.get = function () {
            return this.centerPoint._sub(this.size._div(2))
        }, va.size.get = function () {
            return new t.Point(this.width, this.height)
        }, va.bearing.get = function () {
            return -this.angle / Math.PI * 180
        }, va.bearing.set = function (e) {
            var i = -t.wrap(e, -180, 180) * Math.PI / 180;
            this.angle !== i && (this._unmodified = !1, this.angle = i, this._calcMatrices(), this.rotationMatrix = t.create$2(), t.rotate(this.rotationMatrix, this.rotationMatrix, this.angle));
        }, va.pitch.get = function () {
            return this._pitch / Math.PI * 180
        }, va.pitch.set = function (e) {
            var i = t.clamp(e, this.minPitch, this.maxPitch) / 180 * Math.PI;
            this._pitch !== i && (this._unmodified = !1, this._pitch = i, this._calcMatrices());
        }, va.fov.get = function () {
            return this._fov / Math.PI * 180
        }, va.fov.set = function (t) {
            t = Math.max(.01, Math.min(60, t)), this._fov !== t && (this._unmodified = !1, this._fov = t / 180 * Math.PI, this._calcMatrices());
        }, va.zoom.get = function () {
            return this._zoom
        }, va.zoom.set = function (t) {
            var e = Math.min(Math.max(t, this.minZoom), this.maxZoom);
            this._zoom !== e && (this._unmodified = !1, this._zoom = e, this.scale = this.zoomScale(e), this.tileZoom = Math.floor(e), this.zoomFraction = e - this.tileZoom, this._constrain(), this._calcMatrices());
        }, va.center.get = function () {
            return this._center
        }, va.center.set = function (t) {
            t.lat === this._center.lat && t.lng === this._center.lng || (this._unmodified = !1, this._center = t, this._constrain(), this._calcMatrices());
        }, va.padding.get = function () {
            return this._edgeInsets.toJSON()
        }, va.padding.set = function (t) {
            this._edgeInsets.equals(t) || (this._unmodified = !1, this._edgeInsets.interpolate(this._edgeInsets, t, 1), this._calcMatrices());
        }, va.centerPoint.get = function () {
            return this._edgeInsets.getCenter(this.width, this.height)
        }, ga.prototype.isPaddingEqual = function (t) {
            return this._edgeInsets.equals(t)
        }, ga.prototype.interpolatePadding = function (t, e, i) {
            this._unmodified = !1, this._edgeInsets.interpolate(t, e, i), this._constrain(), this._calcMatrices();
        }, ga.prototype.coveringZoomLevel = function (t) {
            var e = (t.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / t.tileSize));
            return Math.max(0, e)
        }, ga.prototype.getVisibleUnwrappedCoordinates = function (e) {
            var i = [new t.UnwrappedTileID(0, e)];
            if (this._renderWorldCopies)
                for (var o = this.pointCoordinate(new t.Point(0, 0)), a = this.pointCoordinate(new t.Point(this.width, 0)), r = this.pointCoordinate(new t.Point(this.width, this.height)), n = this.pointCoordinate(new t.Point(0, this.height)), s = Math.floor(Math.min(o.x, a.x, r.x, n.x)), l = Math.floor(Math.max(o.x, a.x, r.x, n.x)), c = s - 1; c <= l + 1; c++) 0 !== c && i.push(new t.UnwrappedTileID(c, e));
            return i
        }, ga.prototype.coveringTiles = function (e) {
            var i = this.coveringZoomLevel(e),
                o = i;
            if (void 0 !== e.minzoom && i < e.minzoom) return [];
            void 0 !== e.maxzoom && i > e.maxzoom && (i = e.maxzoom);
            var a = (this._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate).fromLngLat(this.center),
                r = Math.pow(2, i),
                n = [r * a.x, r * a.y, 0],
                s = ma.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, i),
                l = e.minzoom || 0;
            this.pitch <= 60 && this._edgeInsets.top < .1 && (l = i);
            var c = function (t) {
                    return {
                        aabb: new da([t * r, 0, 0], [(t + 1) * r, r, 0]),
                        zoom: 0,
                        x: 0,
                        y: 0,
                        wrap: t,
                        fullyVisible: !1
                    }
                },
                u = [],
                h = [],
                p = i,
                _ = e.reparseOverscaled ? o : i;
            if (this._renderWorldCopies)
                for (var m = 1; m <= 3; m++) u.push(c(-m)), u.push(c(m));
            for (u.push(c(0)); u.length > 0;) {
                var d = u.pop(),
                    f = d.x,
                    g = d.y,
                    v = d.fullyVisible;
                if (!v) {
                    var y = d.aabb.intersects(s);
                    if (0 === y) continue;
                    v = 2 === y;
                }
                var x = d.aabb.distanceX(n),
                    w = d.aabb.distanceY(n),
                    b = Math.max(Math.abs(x), Math.abs(w));
                if (d.zoom === p || b > 3 + (1 << p - d.zoom) - 2 && d.zoom >= l) h.push({
                    tileID: new t.OverscaledTileID(d.zoom === p ? _ : d.zoom, d.wrap, d.zoom, f, g),
                    distanceSq: t.sqrLen([n[0] - .5 - f, n[1] - .5 - g])
                });
                else
                    for (var T = 0; T < 4; T++) {
                        var E = (f << 1) + T % 2,
                            S = (g << 1) + (T >> 1);
                        u.push({
                            aabb: d.aabb.quadrant(T),
                            zoom: d.zoom + 1,
                            x: E,
                            y: S,
                            wrap: d.wrap,
                            fullyVisible: v
                        });
                    }
            }
            return h.sort((function (t, e) {
                return t.distanceSq - e.distanceSq
            })).map((function (t) {
                return t.tileID
            }))
        }, ga.prototype.resize = function (t, e) {
            this.width = t, this.height = e, this.pixelsToGLUnits = [2 / t, -2 / e], this._constrain(), this._calcMatrices();
        }, va.unmodified.get = function () {
            return this._unmodified
        }, ga.prototype.zoomScale = function (t) {
            return Math.pow(2, t)
        }, ga.prototype.scaleZoom = function (t) {
            return Math.log(t) / Math.LN2
        }, ga.prototype.project = function (e) {
            var i = t.clamp(e.lat, -this.maxValidLatitude, this.maxValidLatitude);
            return new t.Point((this._isLatLon ? t.lngLatXfromLng : t.mercatorXfromLng)(e.lng) * this.worldSize, (this._isLatLon ? t.lngLatYfromLat : t.mercatorYfromLat)(i) * this.worldSize)
        }, ga.prototype.unproject = function (e) {
            return new(this._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate)(e.x / this.worldSize, e.y / this.worldSize).toLngLat()
        }, va.point.get = function () {
            return this.project(this.center)
        }, ga.prototype.setLocationAtPoint = function (e, i) {
            var o = this.pointCoordinate(i),
                a = this.pointCoordinate(this.centerPoint),
                r = this.locationCoordinate(e),
                n = new(this._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate)(r.x - (o.x - a.x), r.y - (o.y - a.y));
            this.center = this.coordinateLocation(n), this._renderWorldCopies && (this.center = this.center.wrap());
        }, ga.prototype.locationPoint = function (t) {
            return this.coordinatePoint(this.locationCoordinate(t))
        }, ga.prototype.pointLocation = function (t) {
            return this.coordinateLocation(this.pointCoordinate(t))
        }, ga.prototype.locationCoordinate = function (e) {
            return (this._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate).fromLngLat(e)
        }, ga.prototype.coordinateLocation = function (t) {
            return t.toLngLat()
        }, ga.prototype.pointCoordinate = function (e) {
            var i = [e.x, e.y, 0, 1],
                o = [e.x, e.y, 1, 1];
            t.transformMat4(i, i, this.pixelMatrixInverse), t.transformMat4(o, o, this.pixelMatrixInverse);
            var a = i[3],
                r = o[3],
                n = i[1] / a,
                s = o[1] / r,
                l = i[2] / a,
                c = o[2] / r,
                u = l === c ? 0 : (0 - l) / (c - l);
            return new(this._isLatLon ? t.LngLatCoordinate : t.MercatorCoordinate)(t.number(i[0] / a, o[0] / r, u) / this.worldSize, t.number(n, s, u) / this.worldSize)
        }, ga.prototype.coordinatePoint = function (e) {
            var i = [e.x * this.worldSize, e.y * this.worldSize, 0, 1];
            return t.transformMat4(i, i, this.pixelMatrix), new t.Point(i[0] / i[3], i[1] / i[3])
        }, ga.prototype.getBounds = function () {
            return (new t.LngLatBounds).extend(this.pointLocation(new t.Point(0, 0))).extend(this.pointLocation(new t.Point(this.width, 0))).extend(this.pointLocation(new t.Point(this.width, this.height))).extend(this.pointLocation(new t.Point(0, this.height)))
        }, ga.prototype.getMaxBounds = function () {
            return this.latRange && 2 === this.latRange.length && this.lngRange && 2 === this.lngRange.length ? new t.LngLatBounds([this.lngRange[0], this.latRange[0]], [this.lngRange[1], this.latRange[1]]) : null
        }, ga.prototype.setMaxBounds = function (t) {
            t ? (this.lngRange = [t.getWest(), t.getEast()], this.latRange = [t.getSouth(), t.getNorth()], this._constrain()) : (this.lngRange = null, this.latRange = [-this.maxValidLatitude, this.maxValidLatitude]);
        }, ga.prototype.calculatePosMatrix = function (e, i) {
            void 0 === i && (i = !1);
            var o = e.key,
                a = i ? this._alignedPosMatrixCache : this._posMatrixCache;
            if (a[o]) return a[o];
            var r = e.canonical,
                n = this.worldSize / this.zoomScale(r.z),
                s = r.x + Math.pow(2, r.z) * e.wrap,
                l = t.identity(new Float64Array(16));
            return t.translate(l, l, [s * n, r.y * n, 0]), t.scale(l, l, [n / t.EXTENT, n / t.EXTENT, 1]), t.multiply(l, i ? this.alignedProjMatrix : this.projMatrix, l), a[o] = new Float32Array(l), a[o]
        }, ga.prototype.customLayerMatrix = function () {
            return this.mercatorMatrix.slice()
        }, ga.prototype._constrain = function () {
            if (this.center && this.width && this.height && !this._constraining) {
                this._constraining = !0;
                var e, i, o, a, r = -90,
                    n = 90,
                    s = -180,
                    l = 180,
                    c = this.size,
                    u = this._unmodified;
                if (this.latRange) {
                    var h = this.latRange;
                    r = (this._isLatLon ? t.lngLatYfromLat : t.mercatorYfromLat)(h[1]) * this.worldSize, e = (n = (this._isLatLon ? t.lngLatYfromLat : t.mercatorYfromLat)(h[0]) * this.worldSize) - r < c.y ? c.y / (n - r) : 0;
                }
                if (this.lngRange) {
                    var p = this.lngRange;
                    s = (this._isLatLon ? t.lngLatXfromLng : t.mercatorXfromLng)(p[0]) * this.worldSize, i = (l = (this._isLatLon ? t.lngLatXfromLng : t.mercatorXfromLng)(p[1]) * this.worldSize) - s < c.x ? c.x / (l - s) : 0;
                }
                var _ = this.point,
                    m = Math.max(i || 0, e || 0);
                if (m) return this.center = this.unproject(new t.Point(i ? (l + s) / 2 : _.x, e ? (n + r) / 2 : _.y)), this.zoom += this.scaleZoom(m), this._unmodified = u, void(this._constraining = !1);
                if (this.latRange) {
                    var d = _.y,
                        f = c.y / 2;
                    d - f < r && (a = r + f), d + f > n && (a = n - f);
                }
                if (this.lngRange) {
                    var g = _.x,
                        v = c.x / 2;
                    g - v < s && (o = s + v), g + v > l && (o = l - v);
                }
                void 0 === o && void 0 === a || (this.center = this.unproject(new t.Point(void 0 !== o ? o : _.x, void 0 !== a ? a : _.y))), this._unmodified = u, this._constraining = !1;
            }
        }, ga.prototype._calcMatrices = function () {
            if (this.height) {
                var e = this.centerOffset;
                this.cameraToCenterDistance = .5 / Math.tan(this._fov / 2) * this.height;
                var i = Math.PI / 2 + this._pitch,
                    o = this._fov * (.5 + e.y / this.height),
                    a = Math.sin(o) * this.cameraToCenterDistance / Math.sin(t.clamp(Math.PI - i - o, .01, Math.PI - .01)),
                    r = this.point,
                    n = r.x,
                    s = r.y,
                    l = 1.01 * (Math.cos(Math.PI / 2 - this._pitch) * a + this.cameraToCenterDistance),
                    c = this.height / 50,
                    u = new Float64Array(16);
                t.perspective(u, this._fov, this.width / this.height, c, l), u[8] = 2 * -e.x / this.width, u[9] = 2 * e.y / this.height, t.scale(u, u, [1, -1, 1]), t.translate(u, u, [0, 0, -this.cameraToCenterDistance]), t.rotateX(u, u, this._pitch), t.rotateZ(u, u, this.angle), t.translate(u, u, [-n, -s, 0]), this.mercatorMatrix = t.scale([], u, [this.worldSize, this.worldSize, this.worldSize]), t.scale(u, u, [1, 1, t.mercatorZfromAltitude(1, this.center.lat) * this.worldSize, 1]), this.projMatrix = u, this.invProjMatrix = t.invert([], this.projMatrix);
                var h = this.width % 2 / 2,
                    p = this.height % 2 / 2,
                    _ = Math.cos(this.angle),
                    m = Math.sin(this.angle),
                    d = n - Math.round(n) + _ * h + m * p,
                    f = s - Math.round(s) + _ * p + m * h,
                    g = new Float64Array(u);
                if (t.translate(g, g, [d > .5 ? d - 1 : d, f > .5 ? f - 1 : f, 0]), this.alignedProjMatrix = g, u = t.create(), t.scale(u, u, [this.width / 2, -this.height / 2, 1]), t.translate(u, u, [1, -1, 0]), this.labelPlaneMatrix = u, u = t.create(), t.scale(u, u, [1, -1, 1]), t.translate(u, u, [-1, -1, 0]), t.scale(u, u, [2 / this.width, 2 / this.height, 1]), this.glCoordMatrix = u, this.pixelMatrix = t.multiply(new Float64Array(16), this.labelPlaneMatrix, this.projMatrix), !(u = t.invert(new Float64Array(16), this.pixelMatrix))) throw new Error("failed to invert matrix");
                this.pixelMatrixInverse = u, this._posMatrixCache = {}, this._alignedPosMatrixCache = {};
            }
        }, ga.prototype.maxPitchScaleFactor = function () {
            if (!this.pixelMatrixInverse) return 1;
            var e = this.pointCoordinate(new t.Point(0, 0)),
                i = [e.x * this.worldSize, e.y * this.worldSize, 0, 1];
            return t.transformMat4(i, i, this.pixelMatrix)[3] / this.cameraToCenterDistance
        }, ga.prototype.getCameraPoint = function () {
            var e = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);
            return this.centerPoint.add(new t.Point(0, e))
        }, ga.prototype.getCameraQueryGeometry = function (e) {
            var i = this.getCameraPoint();
            if (1 === e.length) return [e[0], i];
            for (var o = i.x, a = i.y, r = i.x, n = i.y, s = 0, l = e; s < l.length; s += 1) {
                var c = l[s];
                o = Math.min(o, c.x), a = Math.min(a, c.y), r = Math.max(r, c.x), n = Math.max(n, c.y);
            }
            return [new t.Point(o, a), new t.Point(r, a), new t.Point(r, n), new t.Point(o, n), new t.Point(o, a)]
        }, Object.defineProperties(ga.prototype, va);
        var ya = function (e) {
            var i, o, a, r;
            this._hashName = e && encodeURIComponent(e), t.bindAll(["_getCurrentHash", "_onHashChange", "_updateHash"], this), this._updateHash = (i = this._updateHashUnthrottled.bind(this), o = !1, a = null, r = function () {
                a = null, o && (i(), a = setTimeout(r, 300), o = !1);
            }, function () {
                return o = !0, a || r(), a
            });
        };
        ya.prototype.addTo = function (e) {
            return this._map = e, t.window.addEventListener("hashchange", this._onHashChange, !1), this._map.on("moveend", this._updateHash), this
        }, ya.prototype.remove = function () {
            return t.window.removeEventListener("hashchange", this._onHashChange, !1), this._map.off("moveend", this._updateHash), clearTimeout(this._updateHash()), delete this._map, this
        }, ya.prototype.getHashString = function (e) {
            var i = this._map.getCenter(),
                o = Math.round(100 * this._map.getZoom()) / 100,
                a = Math.ceil((o * Math.LN2 + Math.log(512 / 360 / .5)) / Math.LN10),
                r = Math.pow(10, a),
                n = Math.round(i.lng * r) / r,
                s = Math.round(i.lat * r) / r,
                l = this._map.getBearing(),
                c = this._map.getPitch(),
                u = "";
            if (u += e ? "/" + n + "/" + s + "/" + o : o + "/" + s + "/" + n, (l || c) && (u += "/" + Math.round(10 * l) / 10), c && (u += "/" + Math.round(c)), this._hashName) {
                var h = this._hashName,
                    p = !1,
                    _ = t.window.location.hash.slice(1).split("&").map((function (t) {
                        var e = t.split("=")[0];
                        return e === h ? (p = !0, e + "=" + u) : t
                    })).filter((function (t) {
                        return t
                    }));
                return p || _.push(h + "=" + u), "#" + _.join("&")
            }
            return "#" + u
        }, ya.prototype._getCurrentHash = function () {
            var e, i = this,
                o = t.window.location.hash.replace("#", "");
            return this._hashName ? (o.split("&").map((function (t) {
                return t.split("=")
            })).forEach((function (t) {
                t[0] === i._hashName && (e = t);
            })), (e && e[1] || "").split("/")) : o.split("/")
        }, ya.prototype._onHashChange = function () {
            var t = this._getCurrentHash();
            if (t.length >= 3 && !t.some((function (t) {
                    return isNaN(t)
                }))) {
                var e = this._map.dragRotate.isEnabled() && this._map.touchZoomRotate.isEnabled() ? +(t[3] || 0) : this._map.getBearing();
                return this._map.jumpTo({
                    center: [+t[2], +t[1]],
                    zoom: +t[0],
                    bearing: e,
                    pitch: +(t[4] || 0)
                }), !0
            }
            return !1
        }, ya.prototype._updateHashUnthrottled = function () {
            var e = this.getHashString();
            try {
                t.window.history.replaceState(t.window.history.state, "", e);
            } catch (t) {}
        };
        var xa = {
                linearity: .3,
                easing: t.bezier(0, 0, .3, 1)
            },
            wa = t.extend({
                deceleration: 2500,
                maxSpeed: 1400
            }, xa),
            ba = t.extend({
                deceleration: 20,
                maxSpeed: 1400
            }, xa),
            Ta = t.extend({
                deceleration: 1e3,
                maxSpeed: 360
            }, xa),
            Ea = t.extend({
                deceleration: 1e3,
                maxSpeed: 90
            }, xa),
            Sa = function (t) {
                this._map = t, this.clear();
            };

        function Ia(t, e) {
            (!t.duration || t.duration < e.duration) && (t.duration = e.duration, t.easing = e.easing);
        }

        function za(e, i, o) {
            var a = o.maxSpeed,
                r = o.linearity,
                n = o.deceleration,
                s = t.clamp(e * r / (i / 1e3), -a, a),
                l = Math.abs(s) / (n * r);
            return {
                easing: o.easing,
                duration: 1e3 * l,
                amount: s * (l / 2)
            }
        }
        Sa.prototype.clear = function () {
            this._inertiaBuffer = [];
        }, Sa.prototype.record = function (e) {
            this._drainInertiaBuffer(), this._inertiaBuffer.push({
                time: t.browser.now(),
                settings: e
            });
        }, Sa.prototype._drainInertiaBuffer = function () {
            for (var e = this._inertiaBuffer, i = t.browser.now(); e.length > 0 && i - e[0].time > 160;) e.shift();
        }, Sa.prototype._onMoveEnd = function (e) {
            if (this._drainInertiaBuffer(), !(this._inertiaBuffer.length < 2)) {
                for (var i = {
                        zoom: 0,
                        bearing: 0,
                        pitch: 0,
                        pan: new t.Point(0, 0),
                        pinchAround: void 0,
                        around: void 0
                    }, o = 0, a = this._inertiaBuffer; o < a.length; o += 1) {
                    var r = a[o].settings;
                    i.zoom += r.zoomDelta || 0, i.bearing += r.bearingDelta || 0, i.pitch += r.pitchDelta || 0, r.panDelta && i.pan._add(r.panDelta), r.around && (i.around = r.around), r.pinchAround && (i.pinchAround = r.pinchAround);
                }
                var n = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time,
                    s = {};
                if (i.pan.mag()) {
                    var l = za(i.pan.mag(), n, t.extend({}, wa, e || {}));
                    s.offset = i.pan.mult(l.amount / i.pan.mag()), s.center = this._map.transform.center, Ia(s, l);
                }
                if (i.zoom) {
                    var c = za(i.zoom, n, ba);
                    s.zoom = this._map.transform.zoom + c.amount, Ia(s, c);
                }
                if (i.bearing) {
                    var u = za(i.bearing, n, Ta);
                    s.bearing = this._map.transform.bearing + t.clamp(u.amount, -179, 179), Ia(s, u);
                }
                if (i.pitch) {
                    var h = za(i.pitch, n, Ea);
                    s.pitch = this._map.transform.pitch + h.amount, Ia(s, h);
                }
                if (s.zoom || s.bearing) {
                    var p = void 0 === i.pinchAround ? i.around : i.pinchAround;
                    s.around = p ? this._map.unproject(p) : this._map.getCenter();
                }
                return this.clear(), t.extend(s, {
                    noMoveStart: !0
                })
            }
        };
        var Ca = function (e) {
                function o(o, a, r, n) {
                    void 0 === n && (n = {});
                    var s = i.mousePos(a.getCanvasContainer(), r),
                        l = a.unproject(s);
                    e.call(this, o, t.extend({
                        point: s,
                        lngLat: l,
                        originalEvent: r
                    }, n)), this._defaultPrevented = !1, this.target = a;
                }
                e && (o.__proto__ = e), (o.prototype = Object.create(e && e.prototype)).constructor = o;
                var a = {
                    defaultPrevented: {
                        configurable: !0
                    }
                };
                return o.prototype.preventDefault = function () {
                    this._defaultPrevented = !0;
                }, a.defaultPrevented.get = function () {
                    return this._defaultPrevented
                }, Object.defineProperties(o.prototype, a), o
            }(t.Event),
            Pa = function (e) {
                function o(o, a, r) {
                    var n = "touchend" === o ? r.changedTouches : r.touches,
                        s = i.touchPos(a.getCanvasContainer(), n),
                        l = s.map((function (t) {
                            return a.unproject(t)
                        })),
                        c = s.reduce((function (t, e, i, o) {
                            return t.add(e.div(o.length))
                        }), new t.Point(0, 0)),
                        u = a.unproject(c);
                    e.call(this, o, {
                        points: s,
                        point: c,
                        lngLats: l,
                        lngLat: u,
                        originalEvent: r
                    }), this._defaultPrevented = !1;
                }
                e && (o.__proto__ = e), (o.prototype = Object.create(e && e.prototype)).constructor = o;
                var a = {
                    defaultPrevented: {
                        configurable: !0
                    }
                };
                return o.prototype.preventDefault = function () {
                    this._defaultPrevented = !0;
                }, a.defaultPrevented.get = function () {
                    return this._defaultPrevented
                }, Object.defineProperties(o.prototype, a), o
            }(t.Event),
            La = function (t) {
                function e(e, i, o) {
                    t.call(this, e, {
                        originalEvent: o
                    }), this._defaultPrevented = !1;
                }
                t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e;
                var i = {
                    defaultPrevented: {
                        configurable: !0
                    }
                };
                return e.prototype.preventDefault = function () {
                    this._defaultPrevented = !0;
                }, i.defaultPrevented.get = function () {
                    return this._defaultPrevented
                }, Object.defineProperties(e.prototype, i), e
            }(t.Event),
            Aa = function (t, e) {
                this._map = t, this._clickTolerance = e.clickTolerance;
            };
        Aa.prototype.reset = function () {
            delete this._mousedownPos;
        }, Aa.prototype.wheel = function (t) {
            return this._firePreventable(new La(t.type, this._map, t))
        }, Aa.prototype.mousedown = function (t, e) {
            return this._mousedownPos = e, this._firePreventable(new Ca(t.type, this._map, t))
        }, Aa.prototype.mouseup = function (t) {
            this._map.fire(new Ca(t.type, this._map, t));
        }, Aa.prototype.click = function (t, e) {
            this._mousedownPos && this._mousedownPos.dist(e) >= this._clickTolerance || this._map.fire(new Ca(t.type, this._map, t));
        }, Aa.prototype.dblclick = function (t) {
            return this._firePreventable(new Ca(t.type, this._map, t))
        }, Aa.prototype.mouseover = function (t) {
            this._map.fire(new Ca(t.type, this._map, t));
        }, Aa.prototype.mouseout = function (t) {
            this._map.fire(new Ca(t.type, this._map, t));
        }, Aa.prototype.touchstart = function (t) {
            return this._firePreventable(new Pa(t.type, this._map, t))
        }, Aa.prototype.touchend = function (t) {
            this._map.fire(new Pa(t.type, this._map, t));
        }, Aa.prototype.touchcancel = function (t) {
            this._map.fire(new Pa(t.type, this._map, t));
        }, Aa.prototype._firePreventable = function (t) {
            if (this._map.fire(t), t.defaultPrevented) return {}
        }, Aa.prototype.isEnabled = function () {
            return !0
        }, Aa.prototype.isActive = function () {
            return !1
        }, Aa.prototype.enable = function () {}, Aa.prototype.disable = function () {};
        var Ma = function (t) {
            this._map = t;
        };
        Ma.prototype.reset = function () {
            this._delayContextMenu = !1, delete this._contextMenuEvent;
        }, Ma.prototype.mousemove = function (t) {
            this._map.fire(new Ca(t.type, this._map, t));
        }, Ma.prototype.touchmove = function (t) {
            this._map.fire(new Pa(t.type, this._map, t));
        }, Ma.prototype.mousedown = function () {
            this._delayContextMenu = !0;
        }, Ma.prototype.mouseup = function () {
            this._delayContextMenu = !1, this._contextMenuEvent && (this._map.fire(new Ca("contextmenu", this._map, this._contextMenuEvent)), delete this._contextMenuEvent);
        }, Ma.prototype.contextmenu = function (t) {
            this._delayContextMenu ? this._contextMenuEvent = t : this._map.fire(new Ca(t.type, this._map, t)), this._map.listens("contextmenu") && t.preventDefault();
        }, Ma.prototype.isEnabled = function () {
            return !0
        }, Ma.prototype.isActive = function () {
            return !1
        }, Ma.prototype.enable = function () {}, Ma.prototype.disable = function () {};
        var Da = function (t, e) {
            this._map = t, this._el = t.getCanvasContainer(), this._container = t.getContainer(), this._clickTolerance = e.clickTolerance || 1;
        };

        function Ra(t, e) {
            for (var i = {}, o = 0; o < t.length; o++) i[t[o].identifier] = e[o];
            return i
        }
        Da.prototype.isEnabled = function () {
            return !!this._enabled
        }, Da.prototype.isActive = function () {
            return !!this._active
        }, Da.prototype.enable = function () {
            this.isEnabled() || (this._enabled = !0);
        }, Da.prototype.disable = function () {
            this.isEnabled() && (this._enabled = !1);
        }, Da.prototype.mousedown = function (t, e) {
            this.isEnabled() && t.shiftKey && 0 === t.button && (i.disableDrag(), this._startPos = this._lastPos = e, this._active = !0);
        }, Da.prototype.mousemoveWindow = function (t, e) {
            if (this._active) {
                var o = e;
                if (!(this._lastPos.equals(o) || !this._box && o.dist(this._startPos) < this._clickTolerance)) {
                    var a = this._startPos;
                    this._lastPos = o, this._box || (this._box = i.create("div", "minemap-boxzoom", this._container), this._container.classList.add("minemap-crosshair"), this._fireEvent("boxzoomstart", t));
                    var r = Math.min(a.x, o.x),
                        n = Math.max(a.x, o.x),
                        s = Math.min(a.y, o.y),
                        l = Math.max(a.y, o.y);
                    i.setTransform(this._box, "translate(" + r + "px," + s + "px)"), this._box.style.width = n - r + "px", this._box.style.height = l - s + "px";
                }
            }
        }, Da.prototype.mouseupWindow = function (e, o) {
            var a = this;
            if (this._active && 0 === e.button) {
                var r = this._startPos,
                    n = o;
                if (this.reset(), i.suppressClick(), r.x !== n.x || r.y !== n.y) return this._map.fire(new t.Event("boxzoomend", {
                    originalEvent: e
                })), {
                    cameraAnimation: function (t) {
                        return t.fitScreenCoordinates(r, n, a._map.getBearing(), {
                            linear: !0
                        })
                    }
                };
                this._fireEvent("boxzoomcancel", e);
            }
        }, Da.prototype.keydown = function (t) {
            this._active && 27 === t.keyCode && (this.reset(), this._fireEvent("boxzoomcancel", t));
        }, Da.prototype.reset = function () {
            this._active = !1, this._container.classList.remove("minemap-crosshair"), this._box && (i.remove(this._box), this._box = null), i.enableDrag(), delete this._startPos, delete this._lastPos;
        }, Da.prototype._fireEvent = function (e, i) {
            return this._map.fire(new t.Event(e, {
                originalEvent: i
            }))
        };
        var ka = function (t) {
            this.reset(), this.numTouches = t.numTouches;
        };
        ka.prototype.reset = function () {
            delete this.centroid, delete this.startTime, delete this.touches, this.aborted = !1;
        }, ka.prototype.touchstart = function (e, i) {
            (this.centroid || e.targetTouches.length > this.numTouches) && (this.aborted = !0), this.aborted || (void 0 === this.startTime && (this.startTime = e.timeStamp), e.targetTouches.length === this.numTouches && (this.centroid = function (e) {
                for (var i = new t.Point(0, 0), o = 0, a = e; o < a.length; o += 1) i._add(a[o]);
                return i.div(e.length)
            }(i), this.touches = Ra(e.targetTouches, i)));
        }, ka.prototype.touchmove = function (t, e) {
            if (!this.aborted && this.centroid) {
                var i = Ra(t.targetTouches, e);
                for (var o in this.touches) {
                    var a = i[o];
                    (!a || a.dist(this.touches[o]) > 30) && (this.aborted = !0);
                }
            }
        }, ka.prototype.touchend = function (t) {
            if ((!this.centroid || t.timeStamp - this.startTime > 500) && (this.aborted = !0), 0 === t.targetTouches.length) {
                var e = !this.aborted && this.centroid;
                if (this.reset(), e) return e
            }
        };
        var Oa = function (t) {
            this.singleTap = new ka(t), this.numTaps = t.numTaps, this.reset();
        };
        Oa.prototype.reset = function () {
            this.lastTime = 1 / 0, delete this.lastTap, this.count = 0, this.singleTap.reset();
        }, Oa.prototype.touchstart = function (t, e) {
            this.singleTap.touchstart(t, e);
        }, Oa.prototype.touchmove = function (t, e) {
            this.singleTap.touchmove(t, e);
        }, Oa.prototype.touchend = function (t) {
            var e = this.singleTap.touchend(t);
            if (e) {
                var i = t.timeStamp - this.lastTime < 500,
                    o = !this.lastTap || this.lastTap.dist(e) < 30;
                if (i && o || this.reset(), this.count++, this.lastTime = t.timeStamp, this.lastTap = e, this.count === this.numTaps) return this.reset(), e
            }
        };
        var Ba = function () {
            this._zoomIn = new Oa({
                numTouches: 1,
                numTaps: 2
            }), this._zoomOut = new Oa({
                numTouches: 2,
                numTaps: 1
            }), this.reset();
        };
        Ba.prototype.reset = function () {
            this._active = !1, this._zoomIn.reset(), this._zoomOut.reset();
        }, Ba.prototype.touchstart = function (t, e) {
            this._zoomIn.touchstart(t, e), this._zoomOut.touchstart(t, e);
        }, Ba.prototype.touchmove = function (t, e) {
            this._zoomIn.touchmove(t, e), this._zoomOut.touchmove(t, e);
        }, Ba.prototype.touchend = function (t) {
            var e = this,
                i = this._zoomIn.touchend(t),
                o = this._zoomOut.touchend(t);
            return i ? (this._active = !0, t.preventDefault(), setTimeout((function () {
                return e.reset()
            }), 0), {
                cameraAnimation: function (e) {
                    return e.easeTo({
                        duration: 300,
                        zoom: e.getZoom() + 1,
                        around: e.unproject(i)
                    }, {
                        originalEvent: t
                    })
                }
            }) : o ? (this._active = !0, t.preventDefault(), setTimeout((function () {
                return e.reset()
            }), 0), {
                cameraAnimation: function (e) {
                    return e.easeTo({
                        duration: 300,
                        zoom: e.getZoom() - 1,
                        around: e.unproject(o)
                    }, {
                        originalEvent: t
                    })
                }
            }) : void 0
        }, Ba.prototype.touchcancel = function () {
            this.reset();
        }, Ba.prototype.enable = function () {
            this._enabled = !0;
        }, Ba.prototype.disable = function () {
            this._enabled = !1, this.reset();
        }, Ba.prototype.isEnabled = function () {
            return this._enabled
        }, Ba.prototype.isActive = function () {
            return this._active
        };
        var Ua = {
                0: 1,
                2: 2
            },
            Fa = function (t) {
                this.reset(), this._clickTolerance = t.clickTolerance || 1;
            };
        Fa.prototype.reset = function () {
            this._active = !1, this._moved = !1, delete this._lastPoint, delete this._eventButton;
        }, Fa.prototype._correctButton = function (t, e) {
            return !1
        }, Fa.prototype._move = function (t, e) {
            return {}
        }, Fa.prototype.mousedown = function (t, e) {
            if (!this._lastPoint) {
                var o = i.mouseButton(t);
                this._correctButton(t, o) && (this._lastPoint = e, this._eventButton = o);
            }
        }, Fa.prototype.mousemoveWindow = function (t, e) {
            var i = this._lastPoint;
            if (i)
                if (t.preventDefault(), function (t, e) {
                        var i = Ua[e];
                        return void 0 === t.buttons || (t.buttons & i) !== i
                    }(t, this._eventButton)) this.reset();
                else if (this._moved || !(e.dist(i) < this._clickTolerance)) return this._moved = !0, this._lastPoint = e, this._move(i, e)
        }, Fa.prototype.mouseupWindow = function (t) {
            this._lastPoint && i.mouseButton(t) === this._eventButton && (this._moved && i.suppressClick(), this.reset());
        }, Fa.prototype.enable = function () {
            this._enabled = !0;
        }, Fa.prototype.disable = function () {
            this._enabled = !1, this.reset();
        }, Fa.prototype.isEnabled = function () {
            return this._enabled
        }, Fa.prototype.isActive = function () {
            return this._active
        };
        var Na = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.mousedown = function (e, i) {
                    t.prototype.mousedown.call(this, e, i), this._lastPoint && (this._active = !0);
                }, e.prototype._correctButton = function (t, e) {
                    return 0 === e && !t.ctrlKey
                }, e.prototype._move = function (t, e) {
                    return {
                        around: e,
                        panDelta: e.sub(t)
                    }
                }, e
            }(Fa),
            qa = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._correctButton = function (t, e) {
                    return 0 === e && t.ctrlKey || 2 === e
                }, e.prototype._move = function (t, e) {
                    var i = .8 * (e.x - t.x);
                    if (i) return this._active = !0, {
                        bearingDelta: i
                    }
                }, e.prototype.contextmenu = function (t) {
                    t.preventDefault();
                }, e
            }(Fa),
            ja = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype._correctButton = function (t, e) {
                    return 0 === e && t.ctrlKey || 2 === e
                }, e.prototype._move = function (t, e) {
                    var i = -.5 * (e.y - t.y);
                    if (i) return this._active = !0, {
                        pitchDelta: i
                    }
                }, e.prototype.contextmenu = function (t) {
                    t.preventDefault();
                }, e
            }(Fa),
            Za = function (t) {
                this._minTouches = 1, this._clickTolerance = t.clickTolerance || 1, this.reset();
            };
        Za.prototype.reset = function () {
            this._active = !1, this._touches = {}, this._sum = new t.Point(0, 0);
        }, Za.prototype.touchstart = function (t, e) {
            return this._calculateTransform(t, e)
        }, Za.prototype.touchmove = function (t, e) {
            if (this._active) return t.preventDefault(), this._calculateTransform(t, e)
        }, Za.prototype.touchend = function (t, e) {
            this._calculateTransform(t, e), this._active && t.targetTouches.length < this._minTouches && this.reset();
        }, Za.prototype.touchcancel = function () {
            this.reset();
        }, Za.prototype._calculateTransform = function (e, i) {
            e.targetTouches.length > 0 && (this._active = !0);
            var o = Ra(e.targetTouches, i),
                a = new t.Point(0, 0),
                r = new t.Point(0, 0),
                n = 0;
            for (var s in o) {
                var l = o[s],
                    c = this._touches[s];
                c && (a._add(l), r._add(l.sub(c)), n++, o[s] = l);
            }
            if (this._touches = o, !(n < this._minTouches) && r.mag()) {
                var u = r.div(n);
                if (this._sum._add(u), !(this._sum.mag() < this._clickTolerance)) return {
                    around: a.div(n),
                    panDelta: u
                }
            }
        }, Za.prototype.enable = function () {
            this._enabled = !0;
        }, Za.prototype.disable = function () {
            this._enabled = !1, this.reset();
        }, Za.prototype.isEnabled = function () {
            return this._enabled
        }, Za.prototype.isActive = function () {
            return this._active
        };
        var Va = function () {
            this.reset();
        };

        function Ga(t, e, i) {
            for (var o = 0; o < t.targetTouches.length; o++)
                if (t.targetTouches[o].identifier === i) return e[o]
        }

        function Wa(t, e) {
            return Math.log(t / e) / Math.LN2
        }
        Va.prototype.reset = function () {
            this._active = !1, delete this._firstTwoTouches;
        }, Va.prototype._start = function (t) {}, Va.prototype._move = function (t, e, i) {
            return {}
        }, Va.prototype.touchstart = function (t, e) {
            this._firstTwoTouches || t.targetTouches.length < 2 || (this._firstTwoTouches = [t.targetTouches[0].identifier, t.targetTouches[1].identifier], this._start([e[0], e[1]]));
        }, Va.prototype.touchmove = function (t, e) {
            if (this._firstTwoTouches) {
                t.preventDefault();
                var i = this._firstTwoTouches,
                    o = i[1],
                    a = Ga(t, e, i[0]),
                    r = Ga(t, e, o);
                if (a && r) {
                    var n = this._aroundCenter ? null : a.add(r).div(2);
                    return this._move([a, r], n, t)
                }
            }
        }, Va.prototype.touchend = function (t, e) {
            if (this._firstTwoTouches) {
                var o = this._firstTwoTouches,
                    a = o[1],
                    r = Ga(t, e, o[0]),
                    n = Ga(t, e, a);
                r && n || (this._active && i.suppressClick(), this.reset());
            }
        }, Va.prototype.touchcancel = function () {
            this.reset();
        }, Va.prototype.enable = function (t) {
            this._enabled = !0, this._aroundCenter = !!t && "center" === t.around;
        }, Va.prototype.disable = function () {
            this._enabled = !1, this.reset();
        }, Va.prototype.isEnabled = function () {
            return this._enabled
        }, Va.prototype.isActive = function () {
            return this._active
        };
        var Xa = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.reset = function () {
                t.prototype.reset.call(this), delete this._distance, delete this._startDistance;
            }, e.prototype._start = function (t) {
                this._startDistance = this._distance = t[0].dist(t[1]);
            }, e.prototype._move = function (t, e) {
                var i = this._distance;
                if (this._distance = t[0].dist(t[1]), this._active || !(Math.abs(Wa(this._distance, this._startDistance)) < .1)) return this._active = !0, {
                    zoomDelta: Wa(this._distance, i),
                    pinchAround: e
                }
            }, e
        }(Va);

        function Ha(t, e) {
            return 180 * t.angleWith(e) / Math.PI
        }
        var Ka = function (t) {
            function e() {
                t.apply(this, arguments);
            }
            return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.reset = function () {
                t.prototype.reset.call(this), delete this._minDiameter, delete this._startVector, delete this._vector;
            }, e.prototype._start = function (t) {
                this._startVector = this._vector = t[0].sub(t[1]), this._minDiameter = t[0].dist(t[1]);
            }, e.prototype._move = function (t, e) {
                var i = this._vector;
                if (this._vector = t[0].sub(t[1]), this._active || !this._isBelowThreshold(this._vector)) return this._active = !0, {
                    bearingDelta: Ha(this._vector, i),
                    pinchAround: e
                }
            }, e.prototype._isBelowThreshold = function (t) {
                this._minDiameter = Math.min(this._minDiameter, t.mag());
                var e = 25 / (Math.PI * this._minDiameter) * 360,
                    i = Ha(t, this._startVector);
                return Math.abs(i) < e
            }, e
        }(Va);

        function Ya(t) {
            return Math.abs(t.y) > Math.abs(t.x)
        }
        var Ja = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e.prototype.reset = function () {
                    t.prototype.reset.call(this), this._valid = void 0, delete this._firstMove, delete this._lastPoints;
                }, e.prototype._start = function (t) {
                    this._lastPoints = t, Ya(t[0].sub(t[1])) && (this._valid = !1);
                }, e.prototype._move = function (t, e, i) {
                    var o = t[0].sub(this._lastPoints[0]),
                        a = t[1].sub(this._lastPoints[1]);
                    if (this._valid = this.gestureBeginsVertically(o, a, i.timeStamp), this._valid) return this._lastPoints = t, this._active = !0, {
                        pitchDelta: (o.y + a.y) / 2 * -.5
                    }
                }, e.prototype.gestureBeginsVertically = function (t, e, i) {
                    if (void 0 !== this._valid) return this._valid;
                    var o = t.mag() >= 2,
                        a = e.mag() >= 2;
                    if (o || a) {
                        if (!o || !a) return void 0 === this._firstMove && (this._firstMove = i), i - this._firstMove < 100 && void 0;
                        var r = t.y > 0 == e.y > 0;
                        return Ya(t) && Ya(e) && r
                    }
                }, e
            }(Va),
            Qa = {
                panStep: 100,
                bearingStep: 15,
                pitchStep: 10
            },
            $a = function () {
                var t = Qa;
                this._panStep = t.panStep, this._bearingStep = t.bearingStep, this._pitchStep = t.pitchStep;
            };

        function tr(t) {
            return t * (2 - t)
        }
        $a.prototype.reset = function () {
            this._active = !1;
        }, $a.prototype.keydown = function (t) {
            var e = this;
            if (!(t.altKey || t.ctrlKey || t.metaKey)) {
                var i = 0,
                    o = 0,
                    a = 0,
                    r = 0,
                    n = 0;
                switch (t.keyCode) {
                    case 61:
                    case 107:
                    case 171:
                    case 187:
                        i = 1;
                        break;
                    case 189:
                    case 109:
                    case 173:
                        i = -1;
                        break;
                    case 37:
                        t.shiftKey ? o = -1 : (t.preventDefault(), r = -1);
                        break;
                    case 39:
                        t.shiftKey ? o = 1 : (t.preventDefault(), r = 1);
                        break;
                    case 38:
                        t.shiftKey ? a = 1 : (t.preventDefault(), n = -1);
                        break;
                    case 40:
                        t.shiftKey ? a = -1 : (t.preventDefault(), n = 1);
                        break;
                    default:
                        return
                }
                return {
                    cameraAnimation: function (s) {
                        var l = s.getZoom();
                        s.easeTo({
                            duration: 300,
                            easeId: "keyboardHandler",
                            easing: tr,
                            zoom: i ? Math.round(l) + i * (t.shiftKey ? 2 : 1) : l,
                            bearing: s.getBearing() + o * e._bearingStep,
                            pitch: s.getPitch() + a * e._pitchStep,
                            offset: [-r * e._panStep, -n * e._panStep],
                            center: s.getCenter()
                        }, {
                            originalEvent: t
                        });
                    }
                }
            }
        }, $a.prototype.enable = function () {
            this._enabled = !0;
        }, $a.prototype.disable = function () {
            this._enabled = !1, this.reset();
        }, $a.prototype.isEnabled = function () {
            return this._enabled
        }, $a.prototype.isActive = function () {
            return this._active
        };
        var er = function (e, i) {
            this._map = e, this._el = e.getCanvasContainer(), this._handler = i, this._delta = 0, this._defaultZoomRate = .01, this._wheelZoomRate = 1 / 450, t.bindAll(["_onWheel", "_onTimeout", "_onScrollFrame", "_onScrollFinished"], this);
        };
        er.prototype.setZoomRate = function (t) {
            this._defaultZoomRate = t;
        }, er.prototype.setWheelZoomRate = function (t) {
            this._wheelZoomRate = t;
        }, er.prototype.isEnabled = function () {
            return !!this._enabled
        }, er.prototype.isActive = function () {
            return !!this._active || void 0 !== this._finishTimeout
        }, er.prototype.isZooming = function () {
            return !!this._zooming
        }, er.prototype.enable = function (t) {
            this.isEnabled() || (this._enabled = !0, this._aroundCenter = t && "center" === t.around);
        }, er.prototype.disable = function () {
            this.isEnabled() && (this._enabled = !1);
        }, er.prototype.wheel = function (e) {
            if (this.isEnabled()) {
                var i = e.deltaMode === t.window.WheelEvent.DOM_DELTA_LINE ? 40 * e.deltaY : e.deltaY,
                    o = t.browser.now(),
                    a = o - (this._lastWheelEventTime || 0);
                this._lastWheelEventTime = o, 0 !== i && i % 4.000244140625 == 0 ? this._type = "wheel" : 0 !== i && Math.abs(i) < 4 ? this._type = "trackpad" : a > 400 ? (this._type = null, this._lastValue = i, this._timeout = setTimeout(this._onTimeout, 40, e)) : this._type || (this._type = Math.abs(a * i) < 200 ? "trackpad" : "wheel", this._timeout && (clearTimeout(this._timeout), this._timeout = null, i += this._lastValue)), e.shiftKey && i && (i /= 4), this._type && (this._lastWheelEvent = e, this._delta -= i, this._active || this._start(e)), e.preventDefault();
            }
        }, er.prototype._onTimeout = function (t) {
            this._type = "wheel", this._delta -= this._lastValue, this._active || this._start(t);
        }, er.prototype._start = function (e) {
            if (this._delta) {
                this._frameId && (this._frameId = null), this._active = !0, this.isZooming() || (this._zooming = !0), this._finishTimeout && (clearTimeout(this._finishTimeout), delete this._finishTimeout);
                var o = i.mousePos(this._el, e);
                this._around = t.LngLat.convert(this._aroundCenter ? this._map.getCenter() : this._map.unproject(o)), this._aroundPoint = this._map.transform.locationPoint(this._around), this._frameId || (this._frameId = !0, this._handler._triggerRenderFrame());
            }
        }, er.prototype.renderFrame = function () {
            return this._onScrollFrame()
        }, er.prototype._onScrollFrame = function () {
            var e = this;
            if (this._frameId && (this._frameId = null, this.isActive())) {
                var i = this._map.transform;
                if (0 !== this._delta) {
                    var o = "wheel" === this._type && Math.abs(this._delta) > 4.000244140625 ? this._wheelZoomRate : this._defaultZoomRate,
                        a = 2 / (1 + Math.exp(-Math.abs(this._delta * o)));
                    this._delta < 0 && 0 !== a && (a = 1 / a);
                    var r = "number" == typeof this._targetZoom ? i.zoomScale(this._targetZoom) : i.scale;
                    this._targetZoom = Math.min(i.maxZoom, Math.max(i.minZoom, i.scaleZoom(r * a))), "wheel" === this._type && (this._startZoom = i.zoom, this._easing = this._smoothOutEasing(200)), this._delta = 0;
                }
                var n, s = "number" == typeof this._targetZoom ? this._targetZoom : i.zoom,
                    l = this._startZoom,
                    c = this._easing,
                    u = !1;
                if ("wheel" === this._type && l && c) {
                    var h = Math.min((t.browser.now() - this._lastWheelEventTime) / 200, 1),
                        p = c(h);
                    n = t.number(l, s, p), h < 1 ? this._frameId || (this._frameId = !0) : u = !0;
                } else n = s, u = !0;
                return this._active = !0, u && (this._active = !1, this._finishTimeout = setTimeout((function () {
                    e._zooming = !1, e._handler._triggerRenderFrame(), delete e._targetZoom, delete e._finishTimeout;
                }), 200)), {
                    noInertia: !0,
                    needsRenderFrame: !u,
                    zoomDelta: n - i.zoom,
                    around: this._aroundPoint,
                    originalEvent: this._lastWheelEvent
                }
            }
        }, er.prototype._smoothOutEasing = function (e) {
            var i = t.ease;
            if (this._prevEase) {
                var o = this._prevEase,
                    a = (t.browser.now() - o.start) / o.duration,
                    r = o.easing(a + .01) - o.easing(a),
                    n = .27 / Math.sqrt(r * r + 1e-4) * .01,
                    s = Math.sqrt(.0729 - n * n);
                i = t.bezier(n, s, .25, 1);
            }
            return this._prevEase = {
                start: t.browser.now(),
                duration: e,
                easing: i
            }, i
        }, er.prototype.reset = function () {
            this._active = !1;
        };
        var ir = function (t, e) {
            this._clickZoom = t, this._tapZoom = e;
        };
        ir.prototype.enable = function () {
            this._clickZoom.enable(), this._tapZoom.enable();
        }, ir.prototype.disable = function () {
            this._clickZoom.disable(), this._tapZoom.disable();
        }, ir.prototype.isEnabled = function () {
            return this._clickZoom.isEnabled() && this._tapZoom.isEnabled()
        }, ir.prototype.isActive = function () {
            return this._clickZoom.isActive() || this._tapZoom.isActive()
        };
        var or = function () {
            this.reset();
        };
        or.prototype.reset = function () {
            this._active = !1;
        }, or.prototype.dblclick = function (t, e) {
            return t.preventDefault(), {
                cameraAnimation: function (i) {
                    i.easeTo({
                        duration: 300,
                        zoom: i.getZoom() + (t.shiftKey ? -1 : 1),
                        around: i.unproject(e)
                    }, {
                        originalEvent: t
                    });
                }
            }
        }, or.prototype.enable = function () {
            this._enabled = !0;
        }, or.prototype.disable = function () {
            this._enabled = !1, this.reset();
        }, or.prototype.isEnabled = function () {
            return this._enabled
        }, or.prototype.isActive = function () {
            return this._active
        };
        var ar = function () {
            this._tap = new Oa({
                numTouches: 1,
                numTaps: 1
            }), this.reset();
        };
        ar.prototype.reset = function () {
            this._active = !1, delete this._swipePoint, delete this._swipeTouch, delete this._tapTime, this._tap.reset();
        }, ar.prototype.touchstart = function (t, e) {
            this._swipePoint || (this._tapTime && t.timeStamp - this._tapTime > 500 && this.reset(), this._tapTime ? t.targetTouches.length > 0 && (this._swipePoint = e[0], this._swipeTouch = t.targetTouches[0].identifier) : this._tap.touchstart(t, e));
        }, ar.prototype.touchmove = function (t, e) {
            if (this._tapTime) {
                if (this._swipePoint) {
                    if (t.targetTouches[0].identifier !== this._swipeTouch) return;
                    var i = e[0],
                        o = i.y - this._swipePoint.y;
                    return this._swipePoint = i, t.preventDefault(), this._active = !0, {
                        zoomDelta: o / 128
                    }
                }
            } else this._tap.touchmove(t, e);
        }, ar.prototype.touchend = function (t) {
            this._tapTime ? this._swipePoint && 0 === t.targetTouches.length && this.reset() : this._tap.touchend(t) && (this._tapTime = t.timeStamp);
        }, ar.prototype.touchcancel = function () {
            this.reset();
        }, ar.prototype.enable = function () {
            this._enabled = !0;
        }, ar.prototype.disable = function () {
            this._enabled = !1, this.reset();
        }, ar.prototype.isEnabled = function () {
            return this._enabled
        }, ar.prototype.isActive = function () {
            return this._active
        };
        var rr = function (t, e, i) {
            this._el = t, this._mousePan = e, this._touchPan = i;
        };
        rr.prototype.enable = function (t) {
            this._inertiaOptions = t || {}, this._mousePan.enable(), this._touchPan.enable(), this._el.classList.add("minemap-touch-drag-pan");
        }, rr.prototype.disable = function () {
            this._mousePan.disable(), this._touchPan.disable(), this._el.classList.remove("minemap-touch-drag-pan");
        }, rr.prototype.isEnabled = function () {
            return this._mousePan.isEnabled() && this._touchPan.isEnabled()
        }, rr.prototype.isActive = function () {
            return this._mousePan.isActive() || this._touchPan.isActive()
        };
        var nr = function (t, e, i) {
            this._pitchWithRotate = t.pitchWithRotate, this._mouseRotate = e, this._mousePitch = i;
        };
        nr.prototype.enable = function () {
            this._mouseRotate.enable(), this._pitchWithRotate && this._mousePitch.enable();
        }, nr.prototype.disable = function () {
            this._mouseRotate.disable(), this._mousePitch.disable();
        }, nr.prototype.isEnabled = function () {
            return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled())
        }, nr.prototype.isActive = function () {
            return this._mouseRotate.isActive() || this._mousePitch.isActive()
        };
        var sr = function (t, e, i, o) {
            this._el = t, this._touchZoom = e, this._touchRotate = i, this._tapDragZoom = o, this._rotationDisabled = !1, this._enabled = !0;
        };
        sr.prototype.enable = function (t) {
            this._touchZoom.enable(t), this._rotationDisabled || this._touchRotate.enable(t), this._tapDragZoom.enable(), this._el.classList.add("minemap-touch-zoom-rotate");
        }, sr.prototype.disable = function () {
            this._touchZoom.disable(), this._touchRotate.disable(), this._tapDragZoom.disable(), this._el.classList.remove("minemap-touch-zoom-rotate");
        }, sr.prototype.isEnabled = function () {
            return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled()
        }, sr.prototype.isActive = function () {
            return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive()
        }, sr.prototype.disableRotation = function () {
            this._rotationDisabled = !0, this._touchRotate.disable();
        }, sr.prototype.enableRotation = function () {
            this._rotationDisabled = !1, this._touchZoom.isEnabled() && this._touchRotate.enable();
        };
        var lr = function (t) {
                return t.zoom || t.drag || t.pitch || t.rotate
            },
            cr = function (t) {
                function e() {
                    t.apply(this, arguments);
                }
                return t && (e.__proto__ = t), (e.prototype = Object.create(t && t.prototype)).constructor = e, e
            }(t.Event);

        function ur(t) {
            return t.panDelta && t.panDelta.mag() || t.zoomDelta || t.bearingDelta || t.pitchDelta
        }
        var hr = function (e, o) {
            this._map = e, this._el = this._map.getCanvasContainer(), this._handlers = [], this._handlersById = {}, this._changes = [], this._inertia = new Sa(e), this._bearingSnap = o.bearingSnap, this._previousActiveHandlers = {}, this._eventsInProgress = {}, this._addDefaultHandlers(o), t.bindAll(["handleEvent", "handleWindowEvent"], this);
            var a = this._el;
            this._listeners = [
                [a, "touchstart", {
                    passive: !1
                }],
                [a, "touchmove", {
                    passive: !1
                }],
                [a, "touchend", void 0],
                [a, "touchcancel", void 0],
                [a, "mousedown", void 0],
                [a, "mousemove", void 0],
                [a, "mouseup", void 0],
                [t.window.document, "mousemove", {
                    capture: !0
                }],
                [t.window.document, "mouseup", void 0],
                [a, "mouseover", void 0],
                [a, "mouseout", void 0],
                [a, "dblclick", void 0],
                [a, "click", void 0],
                [a, "keydown", {
                    capture: !1
                }],
                [a, "keyup", void 0],
                [a, "wheel", {
                    passive: !1
                }],
                [a, "contextmenu", void 0],
                [t.window, "blur", void 0]
            ];
            for (var r = 0, n = this._listeners; r < n.length; r += 1) {
                var s = n[r],
                    l = s[0];
                i.addEventListener(l, s[1], l === t.window.document ? this.handleWindowEvent : this.handleEvent, s[2]);
            }
        };
        hr.prototype.destroy = function () {
            for (var e = 0, o = this._listeners; e < o.length; e += 1) {
                var a = o[e],
                    r = a[0];
                i.removeEventListener(r, a[1], r === t.window.document ? this.handleWindowEvent : this.handleEvent, a[2]);
            }
        }, hr.prototype._addDefaultHandlers = function (t) {
            var e = this._map,
                i = e.getCanvasContainer();
            this._add("mapEvent", new Aa(e, t));
            var o = e.boxZoom = new Da(e, t);
            this._add("boxZoom", o);
            var a = new Ba,
                r = new or;
            e.doubleClickZoom = new ir(r, a), this._add("tapZoom", a), this._add("clickZoom", r);
            var n = new ar;
            this._add("tapDragZoom", n);
            var s = e.touchPitch = new Ja;
            this._add("touchPitch", s);
            var l = new qa(t),
                c = new ja(t);
            e.dragRotate = new nr(t, l, c), this._add("mouseRotate", l, ["mousePitch"]), this._add("mousePitch", c, ["mouseRotate"]);
            var u = new Na(t),
                h = new Za(t);
            e.dragPan = new rr(i, u, h), this._add("mousePan", u), this._add("touchPan", h, ["touchZoom", "touchRotate"]);
            var p = new Ka,
                _ = new Xa;
            e.touchZoomRotate = new sr(i, _, p, n), this._add("touchRotate", p, ["touchPan", "touchZoom"]), this._add("touchZoom", _, ["touchPan", "touchRotate"]);
            var m = e.scrollZoom = new er(e, this);
            this._add("scrollZoom", m, ["mousePan"]);
            var d = e.keyboard = new $a;
            this._add("keyboard", d), this._add("blockableMapEvent", new Ma(e));
            for (var f = 0, g = ["boxZoom", "doubleClickZoom", "tapDragZoom", "touchPitch", "dragRotate", "dragPan", "touchZoomRotate", "scrollZoom", "keyboard"]; f < g.length; f += 1) {
                var v = g[f];
                t.interactive && t[v] && e[v].enable(t[v]);
            }
        }, hr.prototype._add = function (t, e, i) {
            this._handlers.push({
                handlerName: t,
                handler: e,
                allowed: i
            }), this._handlersById[t] = e;
        }, hr.prototype.stop = function () {
            if (!this._updatingCamera) {
                for (var t = 0, e = this._handlers; t < e.length; t += 1) e[t].handler.reset();
                this._inertia.clear(), this._fireEvents({}, {}), this._changes = [];
            }
        }, hr.prototype.isActive = function () {
            for (var t = 0, e = this._handlers; t < e.length; t += 1)
                if (e[t].handler.isActive()) return !0;
            return !1
        }, hr.prototype.isZooming = function () {
            return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming()
        }, hr.prototype.isRotating = function () {
            return !!this._eventsInProgress.rotate
        }, hr.prototype._blockedByActive = function (t, e, i) {
            for (var o in t)
                if (o !== i && (!e || e.indexOf(o) < 0)) return !0;
            return !1
        }, hr.prototype.handleWindowEvent = function (t) {
            this.handleEvent(t, t.type + "Window");
        }, hr.prototype.handleEvent = function (t, e) {
            if ("blur" !== t.type) {
                this._updatingCamera = !0;
                for (var o = "renderFrame" === t.type ? void 0 : t, a = {
                        needsRenderFrame: !1
                    }, r = {}, n = {}, s = t ? t.targetTouches ? i.touchPos(this._el, t.targetTouches) : i.mousePos(this._el, t) : null, l = 0, c = this._handlers; l < c.length; l += 1) {
                    var u = c[l],
                        h = u.handlerName,
                        p = u.handler,
                        _ = u.allowed;
                    if (p.isEnabled()) {
                        var m = void 0;
                        this._blockedByActive(n, _, h) ? p.reset() : p[e || t.type] && (m = p[e || t.type](t, s), this.mergeHandlerResult(a, r, m, h, o), m && m.needsRenderFrame && this._triggerRenderFrame()), (m || p.isActive()) && (n[h] = p);
                    }
                }
                var d = {};
                for (var f in this._previousActiveHandlers) n[f] || (d[f] = o);
                this._previousActiveHandlers = n, (Object.keys(d).length || ur(a)) && (this._changes.push([a, r, d]), this._triggerRenderFrame()), (Object.keys(n).length || ur(a)) && this._map._stop(!0), this._updatingCamera = !1;
                var g = a.cameraAnimation;
                g && (this._inertia.clear(), this._fireEvents({}, {}), this._changes = [], g(this._map));
            } else this.stop();
        }, hr.prototype.mergeHandlerResult = function (e, i, o, a, r) {
            if (o) {
                t.extend(e, o);
                var n = {
                    handlerName: a,
                    originalEvent: o.originalEvent || r
                };
                void 0 !== o.zoomDelta && (i.zoom = n), void 0 !== o.panDelta && (i.drag = n), void 0 !== o.pitchDelta && (i.pitch = n), void 0 !== o.bearingDelta && (i.rotate = n);
            }
        }, hr.prototype._applyChanges = function () {
            for (var e = {}, i = {}, o = {}, a = 0, r = this._changes; a < r.length; a += 1) {
                var n = r[a],
                    s = n[0],
                    l = n[1],
                    c = n[2];
                s.panDelta && (e.panDelta = (e.panDelta || new t.Point(0, 0))._add(s.panDelta)), s.zoomDelta && (e.zoomDelta = (e.zoomDelta || 0) + s.zoomDelta), s.bearingDelta && (e.bearingDelta = (e.bearingDelta || 0) + s.bearingDelta), s.pitchDelta && (e.pitchDelta = (e.pitchDelta || 0) + s.pitchDelta), void 0 !== s.around && (e.around = s.around), void 0 !== s.pinchAround && (e.pinchAround = s.pinchAround), s.noInertia && (e.noInertia = s.noInertia), t.extend(i, l), t.extend(o, c);
            }
            this._updateMapTransform(e, i, o), this._changes = [];
        }, hr.prototype._updateMapTransform = function (t, e, i) {
            var o = this._map,
                a = o.transform;
            if (!ur(t)) return this._fireEvents(e, i);
            var r = t.panDelta,
                n = t.zoomDelta,
                s = t.bearingDelta,
                l = t.pitchDelta,
                c = t.around,
                u = t.pinchAround;
            void 0 !== u && (c = u), o._stop(!0), c = c || o.transform.centerPoint;
            var h = a.pointLocation(r ? c.sub(r) : c);
            s && (a.bearing += s), l && (a.pitch += l), n && (a.zoom += n), a.setLocationAtPoint(h, c), this._map._update(), t.noInertia || this._inertia.record(t), this._fireEvents(e, i);
        }, hr.prototype._fireEvents = function (e, i) {
            var o, a = this,
                r = lr(this._eventsInProgress),
                n = lr(e);
            for (var s in !r && n && this._fireEvent("movestart", n.originalEvent), e) {
                var l = e[s].originalEvent,
                    c = !this._eventsInProgress[s];
                this._eventsInProgress[s] = e[s], c && this._fireEvent(s + "start", l);
            }
            for (var u in e.rotate && (this._bearingChanged = !0), n && this._fireEvent("move", n.originalEvent), e) this._fireEvent(u, e[u].originalEvent);
            for (var h in this._eventsInProgress) {
                var p = this._eventsInProgress[h],
                    _ = p.handlerName,
                    m = p.originalEvent;
                this._handlersById[_].isActive() || (delete this._eventsInProgress[h], this._fireEvent(h + "end", o = i[_] || m));
            }
            var d = lr(this._eventsInProgress);
            if ((r || n) && !d) {
                this._updatingCamera = !0;
                var f = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),
                    g = function (t) {
                        return 0 !== t && -a._bearingSnap < t && t < a._bearingSnap
                    };
                f ? (g(f.bearing || this._map.getBearing()) && (f.bearing = 0), this._map.easeTo(f, {
                    originalEvent: o
                })) : (this._map.fire(new t.Event("moveend", {
                    originalEvent: o
                })), g(this._map.getBearing()) && this._map.resetNorth()), this._bearingChanged = !1, this._updatingCamera = !1;
            }
        }, hr.prototype._fireEvent = function (e, i) {
            this._map.fire(new t.Event(e, i ? {
                originalEvent: i
            } : {}));
        }, hr.prototype._triggerRenderFrame = function () {
            var t = this;
            void 0 === this._frameId && (this._frameId = this._map._requestRenderFrame((function (e) {
                delete t._frameId, t.handleEvent(new cr("renderFrame", {
                    timeStamp: e
                })), t._applyChanges();
            })));
        };
        var pr = function (e) {
                function i(i, o) {
                    e.call(this), this._moving = !1, this._zooming = !1, this.transform = i, this._bearingSnap = o.bearingSnap, t.bindAll(["_renderFrameCallback"], this);
                }
                return e && (i.__proto__ = e), (i.prototype = Object.create(e && e.prototype)).constructor = i, i.prototype.getCenter = function () {
                    return new t.LngLat(this.transform.center.lng, this.transform.center.lat)
                }, i.prototype.setCenter = function (t, e) {
                    return this.jumpTo({
                        center: t
                    }, e)
                }, i.prototype.panBy = function (e, i, o) {
                    return e = t.Point.convert(e).mult(-1), this.panTo(this.transform.center, t.extend({
                        offset: e
                    }, i), o)
                }, i.prototype.panTo = function (e, i, o) {
                    return this.easeTo(t.extend({
                        center: e
                    }, i), o)
                }, i.prototype.getZoom = function () {
                    return this.transform.zoom
                }, i.prototype.setZoom = function (t, e) {
                    return this.jumpTo({
                        zoom: t
                    }, e), this
                }, i.prototype.zoomTo = function (e, i, o) {
                    return this.easeTo(t.extend({
                        zoom: e
                    }, i), o)
                }, i.prototype.zoomIn = function (t, e) {
                    return this.zoomTo(this.getZoom() + 1, t, e), this
                }, i.prototype.zoomOut = function (t, e) {
                    return this.zoomTo(this.getZoom() - 1, t, e), this
                }, i.prototype.getBearing = function () {
                    return this.transform.bearing
                }, i.prototype.setBearing = function (t, e) {
                    return this.jumpTo({
                        bearing: t
                    }, e), this
                }, i.prototype.getPadding = function () {
                    return this.transform.padding
                }, i.prototype.setPadding = function (t, e) {
                    return this.jumpTo({
                        padding: t
                    }, e), this
                }, i.prototype.rotateTo = function (e, i, o) {
                    return this.easeTo(t.extend({
                        bearing: e
                    }, i), o)
                }, i.prototype.resetNorth = function (e, i) {
                    return this.rotateTo(0, t.extend({
                        duration: 1e3
                    }, e), i), this
                }, i.prototype.resetNorthPitch = function (e, i) {
                    return this.easeTo(t.extend({
                        bearing: 0,
                        pitch: 0,
                        duration: 1e3
                    }, e), i), this
                }, i.prototype.snapToNorth = function (t, e) {
                    return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(t, e) : this
                }, i.prototype.getPitch = function () {
                    return this.transform.pitch
                }, i.prototype.setPitch = function (t, e) {
                    return this.jumpTo({
                        pitch: t
                    }, e), this
                }, i.prototype.cameraForBounds = function (e, i) {
                    return e = t.LngLatBounds.convert(e), this._cameraForBoxAndBearing(e.getNorthWest(), e.getSouthEast(), 0, i)
                }, i.prototype._cameraForBoxAndBearing = function (e, i, o, a) {
                    var r = {
                        top: 0,
                        bottom: 0,
                        right: 0,
                        left: 0
                    };
                    if ("number" == typeof (a = t.extend({
                            padding: r,
                            offset: [0, 0],
                            maxZoom: this.transform.maxZoom
                        }, a)).padding) {
                        var n = a.padding;
                        a.padding = {
                            top: n,
                            bottom: n,
                            right: n,
                            left: n
                        };
                    }
                    a.padding = t.extend(r, a.padding);
                    var s = this.transform,
                        l = s.padding,
                        c = s.project(t.LngLat.convert(e)),
                        u = s.project(t.LngLat.convert(i)),
                        h = c.rotate(-o * Math.PI / 180),
                        p = u.rotate(-o * Math.PI / 180),
                        _ = new t.Point(Math.max(h.x, p.x), Math.max(h.y, p.y)),
                        m = new t.Point(Math.min(h.x, p.x), Math.min(h.y, p.y)),
                        d = _.sub(m),
                        f = (s.width - (l.left + l.right + a.padding.left + a.padding.right)) / d.x,
                        g = (s.height - (l.top + l.bottom + a.padding.top + a.padding.bottom)) / d.y;
                    if (!(g < 0 || f < 0)) {
                        var v = Math.min(s.scaleZoom(s.scale * Math.min(f, g)), a.maxZoom),
                            y = t.Point.convert(a.offset),
                            x = new t.Point(y.x + (a.padding.left - a.padding.right) / 2, y.y + (a.padding.top - a.padding.bottom) / 2).mult(s.scale / s.zoomScale(v));
                        return {
                            center: s.unproject(c.add(u).div(2).sub(x)),
                            zoom: v,
                            bearing: o
                        }
                    }
                    t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");
                }, i.prototype.fitBounds = function (t, e, i) {
                    return this._fitInternal(this.cameraForBounds(t, e), e, i)
                }, i.prototype.fitScreenCoordinates = function (e, i, o, a, r) {
                    return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)), this.transform.pointLocation(t.Point.convert(i)), o, a), a, r)
                }, i.prototype._fitInternal = function (e, i, o) {
                    return e ? (delete(i = t.extend(e, i)).padding, i.linear ? this.easeTo(i, o) : this.flyTo(i, o)) : this
                }, i.prototype.jumpTo = function (e, i) {
                    this.stop();
                    var o = this.transform,
                        a = !1,
                        r = !1,
                        n = !1;
                    return "zoom" in e && o.zoom !== +e.zoom && (a = !0, o.zoom = +e.zoom), void 0 !== e.center && (o.center = t.LngLat.convert(e.center)), "bearing" in e && o.bearing !== +e.bearing && (r = !0, o.bearing = +e.bearing), "pitch" in e && o.pitch !== +e.pitch && (n = !0, o.pitch = +e.pitch), null == e.padding || o.isPaddingEqual(e.padding) || (o.padding = e.padding), this.fire(new t.Event("movestart", i)).fire(new t.Event("move", i)), a && this.fire(new t.Event("zoomstart", i)).fire(new t.Event("zoom", i)).fire(new t.Event("zoomend", i)), r && this.fire(new t.Event("rotatestart", i)).fire(new t.Event("rotate", i)).fire(new t.Event("rotateend", i)), n && this.fire(new t.Event("pitchstart", i)).fire(new t.Event("pitch", i)).fire(new t.Event("pitchend", i)), this.fire(new t.Event("moveend", i))
                }, i.prototype.easeTo = function (e, i) {
                    var o = this;
                    this._stop(!1, e.easeId), (!1 === (e = t.extend({
                        offset: [0, 0],
                        duration: 500,
                        easing: t.ease
                    }, e)).animate || !e.essential && t.browser.prefersReducedMotion) && (e.duration = 0);
                    var a = this.transform,
                        r = this.getZoom(),
                        n = this.getBearing(),
                        s = this.getPitch(),
                        l = this.getPadding(),
                        c = "zoom" in e ? +e.zoom : r,
                        u = "bearing" in e ? this._normalizeBearing(e.bearing, n) : n,
                        h = "pitch" in e ? +e.pitch : s,
                        p = "padding" in e ? e.padding : a.padding,
                        _ = t.Point.convert(e.offset),
                        m = a.centerPoint.add(_),
                        d = a.pointLocation(m),
                        f = t.LngLat.convert(e.center || d);
                    this._normalizeCenter(f);
                    var g, v, y = a.project(d),
                        x = a.project(f).sub(y),
                        w = a.zoomScale(c - r);
                    e.around && (g = t.LngLat.convert(e.around), v = a.locationPoint(g));
                    var b = {
                        moving: this._moving,
                        zooming: this._zooming,
                        rotating: this._rotating,
                        pitching: this._pitching
                    };
                    return this._zooming = this._zooming || c !== r, this._rotating = this._rotating || n !== u, this._pitching = this._pitching || h !== s, this._padding = !a.isPaddingEqual(p), this._easeId = e.easeId, this._prepareEase(i, e.noMoveStart, b), clearTimeout(this._easeEndTimeoutID), this._ease((function (e) {
                        if (o._zooming && (a.zoom = t.number(r, c, e)), o._rotating && (a.bearing = t.number(n, u, e)), o._pitching && (a.pitch = t.number(s, h, e)), o._padding && (a.interpolatePadding(l, p, e), m = a.centerPoint.add(_)), g) a.setLocationAtPoint(g, v);
                        else {
                            var d = a.zoomScale(a.zoom - r),
                                f = c > r ? Math.min(2, w) : Math.max(.5, w),
                                b = Math.pow(f, 1 - e),
                                T = a.unproject(y.add(x.mult(e * b)).mult(d));
                            a.setLocationAtPoint(a.renderWorldCopies ? T.wrap() : T, m);
                        }
                        o._fireMoveEvents(i);
                    }), (function (t) {
                        o._afterEase(i, t);
                    }), e), this
                }, i.prototype._prepareEase = function (e, i, o) {
                    void 0 === o && (o = {}), this._moving = !0, i || o.moving || this.fire(new t.Event("movestart", e)), this._zooming && !o.zooming && this.fire(new t.Event("zoomstart", e)), this._rotating && !o.rotating && this.fire(new t.Event("rotatestart", e)), this._pitching && !o.pitching && this.fire(new t.Event("pitchstart", e));
                }, i.prototype._fireMoveEvents = function (e) {
                    this.fire(new t.Event("move", e)), this._zooming && this.fire(new t.Event("zoom", e)), this._rotating && this.fire(new t.Event("rotate", e)), this._pitching && this.fire(new t.Event("pitch", e));
                }, i.prototype._afterEase = function (e, i) {
                    if (!this._easeId || !i || this._easeId !== i) {
                        delete this._easeId;
                        var o = this._zooming,
                            a = this._rotating,
                            r = this._pitching;
                        this._moving = !1, this._zooming = !1, this._rotating = !1, this._pitching = !1, this._padding = !1, o && this.fire(new t.Event("zoomend", e)), a && this.fire(new t.Event("rotateend", e)), r && this.fire(new t.Event("pitchend", e)), this.fire(new t.Event("moveend", e));
                    }
                }, i.prototype.flyTo = function (e, i) {
                    var o = this;
                    if (!e.essential && t.browser.prefersReducedMotion) {
                        var a = t.pick(e, ["center", "zoom", "bearing", "pitch", "around"]);
                        return this.jumpTo(a, i)
                    }
                    this.stop(), e = t.extend({
                        offset: [0, 0],
                        speed: 1.2,
                        curve: 1.42,
                        easing: t.ease
                    }, e);
                    var r = this.transform,
                        n = this.getZoom(),
                        s = this.getBearing(),
                        l = this.getPitch(),
                        c = this.getPadding(),
                        u = "zoom" in e ? t.clamp(+e.zoom, r.minZoom, r.maxZoom) : n,
                        h = "bearing" in e ? this._normalizeBearing(e.bearing, s) : s,
                        p = "pitch" in e ? +e.pitch : l,
                        _ = "padding" in e ? e.padding : r.padding,
                        m = r.zoomScale(u - n),
                        d = t.Point.convert(e.offset),
                        f = r.centerPoint.add(d),
                        g = r.pointLocation(f),
                        v = t.LngLat.convert(e.center || g);
                    this._normalizeCenter(v);
                    var y = r.project(g),
                        x = r.project(v).sub(y),
                        w = e.curve,
                        b = Math.max(r.width, r.height),
                        T = b / m,
                        E = x.mag();
                    if ("minZoom" in e) {
                        var S = t.clamp(Math.min(e.minZoom, n, u), r.minZoom, r.maxZoom),
                            I = b / r.zoomScale(S - n);
                        w = Math.sqrt(I / E * 2);
                    }
                    var z = w * w;

                    function C(t) {
                        var e = (T * T - b * b + (t ? -1 : 1) * z * z * E * E) / (2 * (t ? T : b) * z * E);
                        return Math.log(Math.sqrt(e * e + 1) - e)
                    }

                    function P(t) {
                        return (Math.exp(t) - Math.exp(-t)) / 2
                    }

                    function L(t) {
                        return (Math.exp(t) + Math.exp(-t)) / 2
                    }
                    var A = C(0),
                        M = function (t) {
                            return L(A) / L(A + w * t)
                        },
                        D = function (t) {
                            return b * ((L(A) * (P(e = A + w * t) / L(e)) - P(A)) / z) / E;
                            var e;
                        },
                        R = (C(1) - A) / w;
                    if (Math.abs(E) < 1e-6 || !isFinite(R)) {
                        if (Math.abs(b - T) < 1e-6) return this.easeTo(e, i);
                        var k = T < b ? -1 : 1;
                        R = Math.abs(Math.log(T / b)) / w, D = function () {
                            return 0
                        }, M = function (t) {
                            return Math.exp(k * w * t)
                        };
                    }
                    return e.duration = "duration" in e ? +e.duration : 1e3 * R / ("screenSpeed" in e ? +e.screenSpeed / w : +e.speed), e.maxDuration && e.duration > e.maxDuration && (e.duration = 0), this._zooming = !0, this._rotating = s !== h, this._pitching = p !== l, this._padding = !r.isPaddingEqual(_), this._prepareEase(i, !1), this._ease((function (e) {
                        var a = e * R,
                            m = 1 / M(a);
                        r.zoom = 1 === e ? u : n + r.scaleZoom(m), o._rotating && (r.bearing = t.number(s, h, e)), o._pitching && (r.pitch = t.number(l, p, e)), o._padding && (r.interpolatePadding(c, _, e), f = r.centerPoint.add(d));
                        var g = 1 === e ? v : r.unproject(y.add(x.mult(D(a))).mult(m));
                        r.setLocationAtPoint(r.renderWorldCopies ? g.wrap() : g, f), o._fireMoveEvents(i);
                    }), (function () {
                        return o._afterEase(i)
                    }), e), this
                }, i.prototype.isEasing = function () {
                    return !!this._easeFrameId
                }, i.prototype.stop = function () {
                    return this._stop()
                }, i.prototype._stop = function (t, e) {
                    if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId), delete this._easeFrameId, delete this._onEaseFrame), this._onEaseEnd) {
                        var i = this._onEaseEnd;
                        delete this._onEaseEnd, i.call(this, e);
                    }
                    if (!t) {
                        var o = this.handlers;
                        o && o.stop();
                    }
                    return this
                }, i.prototype._ease = function (e, i, o) {
                    !1 === o.animate || 0 === o.duration ? (e(1), i()) : (this._easeStart = t.browser.now(), this._easeOptions = o, this._onEaseFrame = e, this._onEaseEnd = i, this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback));
                }, i.prototype._renderFrameCallback = function () {
                    var e = Math.min((t.browser.now() - this._easeStart) / this._easeOptions.duration, 1);
                    this._onEaseFrame(this._easeOptions.easing(e)), e < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop();
                }, i.prototype._normalizeBearing = function (e, i) {
                    e = t.wrap(e, -180, 180);
                    var o = Math.abs(e - i);
                    return Math.abs(e - 360 - i) < o && (e -= 360), Math.abs(e + 360 - i) < o && (e += 360), e
                }, i.prototype._normalizeCenter = function (t) {
                    var e = this.transform;
                    if (e.renderWorldCopies && !e.lngRange) {
                        var i = t.lng - e.center.lng;
                        t.lng += i > 180 ? -360 : i < -180 ? 360 : 0;
                    }
                }, i
            }(t.Evented),
            _r = function (e) {
                void 0 === e && (e = {}), this.options = e, t.bindAll(["_updateEditLink", "_updateData", "_updateCompact"], this);
            };
        _r.prototype.getDefaultPosition = function () {
            return "bottom-right"
        }, _r.prototype.onAdd = function (t) {
            var e = this.options && this.options.compact;
            return this._map = t, this._container = i.create("div", "minemap-ctrl minemap-ctrl-attrib"), this._innerContainer = i.create("div", "minemap-ctrl-attrib-inner", this._container), e && this._container.classList.add("minemap-compact"), this._updateAttributions(), this._updateEditLink(), this._map.on("styledata", this._updateData), this._map.on("sourcedata", this._updateData), this._map.on("moveend", this._updateEditLink), void 0 === e && (this._map.on("resize", this._updateCompact), this._updateCompact()), this._container
        }, _r.prototype.onRemove = function () {
            i.remove(this._container), this._map.off("styledata", this._updateData), this._map.off("sourcedata", this._updateData), this._map.off("moveend", this._updateEditLink), this._map.off("resize", this._updateCompact), this._map = void 0, this._attribHTML = void 0;
        }, _r.prototype._updateEditLink = function () {
            var e = this._editLink;
            e || (e = this._editLink = this._container.querySelector(".minemap-improve-map"));
            var i = [{
                key: "owner",
                value: this.styleOwner
            }, {
                key: "id",
                value: this.styleId
            }, {
                key: "access_token",
                value: this._map._requestManager._customAccessToken || t.config.ACCESS_TOKEN
            }];
            if (e) {
                var o = i.reduce((function (t, e, o) {
                    return e.value && (t += e.key + "=" + e.value + (o < i.length - 1 ? "&" : "")), t
                }), "?");
                e.href = "https://www.minedata.cn/feedback/" + o + (this._map._hash ? this._map._hash.getHashString(!0) : ""), e.rel = "noopener nofollow";
            }
        }, _r.prototype._updateData = function (t) {
            !t || "metadata" !== t.sourceDataType && "style" !== t.dataType || (this._updateAttributions(), this._updateEditLink());
        }, _r.prototype._updateAttributions = function () {
            if (this._map.style) {
                var t = [];
                if (this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? t = t.concat(this.options.customAttribution.map((function (t) {
                        return "string" != typeof t ? "" : t
                    }))) : "string" == typeof this.options.customAttribution && t.push(this.options.customAttribution)), this._map.style.stylesheet) {
                    var e = this._map.style.stylesheet;
                    this.styleOwner = e.owner, this.styleId = e.id;
                }
                var i = this._map.style.sourceCaches;
                for (var o in i) {
                    var a = i[o];
                    if (a.used) {
                        var r = a.getSource();
                        r.attribution && t.indexOf(r.attribution) < 0 && t.push(r.attribution);
                    }
                }
                t.sort((function (t, e) {
                    return t.length - e.length
                }));
                var n = (t = t.filter((function (e, i) {
                    for (var o = i + 1; o < t.length; o++)
                        if (t[o].indexOf(e) >= 0) return !1;
                    return !0
                }))).join(" | ");
                n !== this._attribHTML && (this._attribHTML = n, t.length ? (this._innerContainer.innerHTML = n, this._container.classList.remove("minemap-attrib-empty")) : this._container.classList.add("minemap-attrib-empty"), this._editLink = null);
            }
        }, _r.prototype._updateCompact = function () {
            this._map.getCanvasContainer().offsetWidth <= 640 ? this._container.classList.add("minemap-compact") : this._container.classList.remove("minemap-compact");
        };
        var mr = function () {
            t.bindAll(["_updateLogo"], this), t.bindAll(["_updateCompact"], this);
        };
        mr.prototype.onAdd = function (t) {
            this._map = t, this._container = i.create("div", "minemap-ctrl");
            var e = i.create("a", "minemap-ctrl-logo");
            return e.target = "_blank", e.rel = "noopener nofollow", e.href = "https://www.minedata.cn/", e.setAttribute("aria-label", this._map._getUIString("LogoControl.Title")), e.setAttribute("rel", "noopener nofollow"), this._container.appendChild(e), this._map.on("resize", this._updateCompact), this._updateCompact(), this._container
        }, mr.prototype.onRemove = function () {
            i.remove(this._container), this._map.off("resize", this._updateCompact);
        }, mr.prototype.getDefaultPosition = function () {
            return "bottom-left"
        }, mr.prototype._updateCompact = function () {
            var t = this._container.children;
            if (t.length) {
                var e = t[0];
                this._map.getCanvasContainer().offsetWidth < 250 ? e.classList.add("minemap-compact") : e.classList.remove("minemap-compact");
            }
        };
        var dr = function () {
            this._queue = [], this._id = 0, this._cleared = !1, this._currentlyRunning = !1;
        };
        dr.prototype.add = function (t) {
            var e = ++this._id;
            return this._queue.push({
                callback: t,
                id: e,
                cancelled: !1
            }), e
        }, dr.prototype.remove = function (t) {
            for (var e = this._currentlyRunning, i = 0, o = e ? this._queue.concat(e) : this._queue; i < o.length; i += 1) {
                var a = o[i];
                if (a.id === t) return void(a.cancelled = !0)
            }
        }, dr.prototype.run = function (t) {
            void 0 === t && (t = 0);
            var e = this._currentlyRunning = this._queue;
            this._queue = [];
            for (var i = 0, o = e; i < o.length; i += 1) {
                var a = o[i];
                if (!a.cancelled && (a.callback(t), this._cleared)) break
            }
            this._cleared = !1, this._currentlyRunning = !1;
        }, dr.prototype.clear = function () {
            this._currentlyRunning && (this._cleared = !0), this._queue = [];
        };
        var fr = function (t) {
            this.cb = t.cb, this.restrictX = t.restrictX, this.restrictY = t.restrictY, this.handler = t.handler, this.root = t.root, this.lastMouseX = 0, this.lastMouseY = 0, this.drag = this.drag.bind(this), this.end = this.end.bind(this), this.handler.onmousedown = this.start.bind(this), t.onDragStart && (this.onDragStart = t.onDragStart), t.onDrag && (this.onDrag = t.onDrag), t.onDragEnd && (this.onDragEnd = t.onDragEnd);
        };
        fr.prototype.start = function (e) {
            this.handler.style.cursor = "move";
            var i = (e = e || this.fixEvent(t.window.event)).pageY;
            this.lastMouseX = e.pageX, this.lastMouseY = i;
            var o = this.root.offsetLeft,
                a = this.root.offsetTop;
            this.root.style.left = o + "px", this.root.style.top = a + "px", t.window.document.addEventListener("mouseup", this.end), t.window.document.addEventListener("mousemove", this.drag), this.onDragStart && this.onDragStart(o, a);
        }, fr.prototype.drag = function (e) {
            var i = (e = e || this.fixEvent(t.window.event)).pageX,
                o = e.pageY,
                a = this.root.style.left ? parseInt(this.root.style.left) : 0,
                r = this.root.style.top ? parseInt(this.root.style.top) : 0;
            a <= -1 && (a = -1), r <= -1 && (r = -1), a >= this.restrictX && (a = this.restrictX), r >= this.restrictY && (r = this.restrictY);
            var n = i - this.lastMouseX + a,
                s = o - this.lastMouseY + r;
            this.root.style.left = n + "px", this.root.style.top = s + "px", this.onDrag && this.onDrag(n, s), this.lastMouseX = i, this.lastMouseY = o;
        }, fr.prototype.end = function () {
            var e = this,
                i = this.root.style.left ? parseInt(this.root.style.left) : 0,
                o = this.root.style.top ? parseInt(this.root.style.top) : 0;
            this.onDragEnd && this.onDragEnd(i, o), t.window.setTimeout((function () {
                e.cb(i, o);
            }), 100), t.window.document.removeEventListener("mouseup", this.end), t.window.document.removeEventListener("mousemove", this.drag);
        }, fr.prototype.fixEvent = function (e) {
            return e.pageX = e.clientX + t.window.document.documentElement.scrollLeft, e.pageY = e.clientY + t.window.document.documentElement.scrollTop, e
        }, fr.prototype.remove = function () {
            t.window.document.removeEventListener("mouseup", this.end), t.window.document.removeEventListener("mousemove", this.drag);
        };
        var gr = {
                "FullscreenControl.Enter": "开启全屏模式",
                "FullscreenControl.Exit": "退出全屏模式",
                "GeolocateControl.FindMyLocation": "定位您的位置",
                "GeolocateControl.LocationNotAvailable": "位置不可用",
                "LogoControl.Title": "MineMap logo",
                "NavigationControl.ResetBearing": "将地图旋转到正北方向",
                "NavigationControl.ZoomIn": "放大一级",
                "NavigationControl.ZoomOut": "缩小一级",
                "ScaleControl.Feet": "英尺",
                "ScaleControl.Meters": "米",
                "ScaleControl.Kilometers": "公里",
                "ScaleControl.Miles": "英里",
                "ScaleControl.NauticalMiles": "海里"
            },
            vr = function () {
                this.counter = 0, this.timeSave = Date.now(), this._state = !1, this.needClearTime = !0, this._pause = !1;
            },
            yr = {
                state: {
                    configurable: !0
                }
            };
        vr.prototype.update = function () {
            if (this._state) {
                var t = Date.now();
                this.needClearTime ? this.needClearTime = !1 : this.counter += (t - this.timeSave) / 1e3, this.timeSave = t;
            }
        }, yr.state.get = function () {
            return this._state
        }, yr.state.set = function (t) {
            this._state = t, t || (this.needClearTime = !0);
        }, vr.prototype.pauseTimer = function () {
            this.state = !1;
        }, vr.prototype.resumeTimer = function () {
            this.state = !0;
        }, Object.defineProperties(vr.prototype, yr);
        var xr = t.window.HTMLImageElement,
            wr = t.window.HTMLElement,
            br = t.window.ImageBitmap,
            Tr = {
                center: [0, 0],
                zoom: 0,
                bearing: 0,
                pitch: 0,
                minZoom: -2,
                maxZoom: 22,
                minPitch: 0,
                maxPitch: 60,
                interactive: !0,
                scrollZoom: !0,
                boxZoom: !0,
                dragRotate: !0,
                dragPan: !0,
                keyboard: !0,
                doubleClickZoom: !0,
                touchZoomRotate: !0,
                touchPitch: !0,
                bearingSnap: 7,
                clickTolerance: 3,
                pitchWithRotate: !0,
                hash: !1,
                attributionControl: !0,
                failIfMajorPerformanceCaveat: !1,
                preserveDrawingBuffer: !1,
                trackResize: !0,
                renderWorldCopies: !0,
                refreshExpiredTiles: !0,
                maxTileCacheSize: null,
                localIdeographFontFamily: "PingFang SC,Microsoft YaHei,微软雅黑,Arial,sans-serif,黑体",
                transformRequest: null,
                accessToken: null,
                fadeDuration: 0,
                crossSourceCollisions: !0,
                logoControl: !0,
                projection: "MERCATOR",
                defaultCursor: null
            },
            Er = function (o) {
                function a(e) {
                    var i = this;
                    if (null != (e = t.extend({}, Tr, e)).minZoom && null != e.maxZoom && e.minZoom > e.maxZoom) throw new Error("maxZoom must be greater than or equal to minZoom");
                    if (null != e.minPitch && null != e.maxPitch && e.minPitch > e.maxPitch) throw new Error("maxPitch must be greater than or equal to minPitch");
                    if (null != e.minPitch && e.minPitch < 0) throw new Error("minPitch must be greater than or equal to 0");
                    if (null != e.maxPitch && e.maxPitch > 60) throw new Error("maxPitch must be less than or equal to 60");
                    var a = new ga(e.minZoom, e.maxZoom, e.minPitch, e.maxPitch, e.renderWorldCopies, "LATLON" === e.projection);
                    if (o.call(this, a, e), this._interactive = e.interactive, this._maxTileCacheSize = e.maxTileCacheSize, this._failIfMajorPerformanceCaveat = e.failIfMajorPerformanceCaveat, this._preserveDrawingBuffer = e.preserveDrawingBuffer, this._antialias = e.antialias, this._trackResize = e.trackResize, this._bearingSnap = e.bearingSnap, this._refreshExpiredTiles = e.refreshExpiredTiles, this._fadeDuration = e.fadeDuration, this._crossSourceCollisions = e.crossSourceCollisions, this._crossFadingFactor = 1, this._collectResourceTiming = e.collectResourceTiming, this._renderTaskQueue = new dr, this._controls = [], this._mapId = t.uniqueId(), this._locale = t.extend({}, gr, e.locale), this.isLatLon = "LATLON" === e.projection, this._css3TransformScaleNum = 0, this.timer = new vr, this._requestManager = new _(e.transformRequest, e.accessToken), "string" == typeof e.container) {
                        if (this._container = t.window.document.getElementById(e.container), !this._container) throw new Error("Container '" + e.container + "' not found.")
                    } else {
                        if (!(e.container instanceof wr)) throw new Error("Invalid type: 'container' must be a String or HTMLElement.");
                        this._container = e.container;
                    }
                    if (e.maxBounds && this.setMaxBounds(e.maxBounds), t.bindAll(["_onWindowOnline", "_onWindowResize", "_contextLost", "_contextRestored"], this), this._setupContainer(), this._setupPainter(), void 0 === this.painter) throw new Error("Failed to initialize WebGL.");
                    this.on("move", (function () {
                        return i._update(!1)
                    })), this.on("moveend", (function () {
                        return i._update(!1)
                    })), this.on("zoom", (function () {
                        return i._update(!0)
                    })), void 0 !== t.window && (t.window.addEventListener("online", this._onWindowOnline, !1), t.window.addEventListener("resize", this._onWindowResize, !1)), this.handlers = new hr(this, e), this._hash = e.hash && new ya("string" == typeof e.hash && e.hash || void 0).addTo(this), this._hash && this._hash._onHashChange() || (this.jumpTo({
                        center: e.center,
                        zoom: e.zoom,
                        bearing: e.bearing,
                        pitch: e.pitch
                    }), e.bounds && (this.resize(), this.fitBounds(e.bounds, t.extend({}, e.fitBoundsOptions, {
                        duration: 0
                    })))), this.resize(), this._localIdeographFontFamily = e.localIdeographFontFamily, e.style && this.setStyle(e.style, {
                        localIdeographFontFamily: e.localIdeographFontFamily
                    }), e.attributionControl && this.addControl(new _r({
                        customAttribution: e.customAttribution
                    })), e.logoControl && this.addControl(new mr, e.logoPosition), this.on("style.load", (function () {
                        i.transform.unmodified && i.jumpTo(i.style.stylesheet);
                    })), this.on("data", (function (e) {
                        i._update("style" === e.dataType), i.fire(new t.Event(e.dataType + "data", e));
                    })), this.on("dataloading", (function (e) {
                        i.fire(new t.Event(e.dataType + "dataloading", e));
                    })), this._overviewMapOptions = e, e.overviewMap ? (this._overviewMap = !0, this.addOverviewMap()) : this._overviewMap = !1, this.setMapCursor(e.defaultCursor);
                }
                o && (a.__proto__ = o), (a.prototype = Object.create(o && o.prototype)).constructor = a;
                var r = {
                    overviewMap: {
                        configurable: !0
                    },
                    showTileBoundaries: {
                        configurable: !0
                    },
                    showPadding: {
                        configurable: !0
                    },
                    showCollisionBoxes: {
                        configurable: !0
                    },
                    showOverdrawInspector: {
                        configurable: !0
                    },
                    repaint: {
                        configurable: !0
                    },
                    vertices: {
                        configurable: !0
                    },
                    version: {
                        configurable: !0
                    },
                    css3TransformScaleNumber: {
                        configurable: !0
                    }
                };
                return a.prototype._getMapId = function () {
                    return this._mapId
                }, a.prototype.addControl = function (e, i) {
                    if (void 0 === i && e.getDefaultPosition && (i = e.getDefaultPosition()), void 0 === i && (i = "top-right"), !e || !e.onAdd) return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));
                    var o = e.onAdd(this);
                    this._controls.push(e);
                    var a = this._controlPositions[i];
                    return -1 !== i.indexOf("bottom") ? a.insertBefore(o, a.firstChild) : a.appendChild(o), this
                }, a.prototype.removeControl = function (e) {
                    if (!e || !e.onRemove) return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));
                    var i = this._controls.indexOf(e);
                    return i > -1 && this._controls.splice(i, 1), e.onRemove(this), this
                }, a.prototype.resize = function (e) {
                    var i = this._containerDimensions(),
                        o = i[0],
                        a = i[1];
                    this._resizeCanvas(o, a), this.transform.resize(o, a), this.painter.resize(o, a);
                    var r = !this._moving;
                    return r && (this.stop(), this.fire(new t.Event("movestart", e)).fire(new t.Event("move", e))), this.fire(new t.Event("resize", e)), r && this.fire(new t.Event("moveend", e)), this
                }, a.prototype.getBounds = function () {
                    return this.transform.getBounds()
                }, a.prototype.getMaxBounds = function () {
                    return this.transform.getMaxBounds()
                }, a.prototype.setMaxBounds = function (e) {
                    return this.transform.setMaxBounds(t.LngLatBounds.convert(e)), this._update()
                }, a.prototype.setMinZoom = function (t) {
                    if ((t = null == t ? -2 : t) >= -2 && t <= this.transform.maxZoom) return this.transform.minZoom = t, this._update(), this.getZoom() < t && this.setZoom(t), this;
                    throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")
                }, a.prototype.getMinZoom = function () {
                    return this.transform.minZoom
                }, a.prototype.setMaxZoom = function (t) {
                    if ((t = null == t ? 22 : t) >= this.transform.minZoom) return this.transform.maxZoom = t, this._update(), this.getZoom() > t && this.setZoom(t), this;
                    throw new Error("maxZoom must be greater than the current minZoom")
                }, a.prototype.getMaxZoom = function () {
                    return this.transform.maxZoom
                }, a.prototype.setMinPitch = function (t) {
                    if ((t = null == t ? 0 : t) < 0) throw new Error("minPitch must be greater than or equal to 0");
                    if (t >= 0 && t <= this.transform.maxPitch) return this.transform.minPitch = t, this._update(), this.getPitch() < t && this.setPitch(t), this;
                    throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")
                }, a.prototype.getMinPitch = function () {
                    return this.transform.minPitch
                }, a.prototype.setMaxPitch = function (t) {
                    if ((t = null == t ? 60 : t) > 60) throw new Error("maxPitch must be less than or equal to 60");
                    if (t >= this.transform.minPitch) return this.transform.maxPitch = t, this._update(), this.getPitch() > t && this.setPitch(t), this;
                    throw new Error("maxPitch must be greater than the current minPitch")
                }, a.prototype.getMaxPitch = function () {
                    return this.transform.maxPitch
                }, a.prototype.getRenderWorldCopies = function () {
                    return this.transform.renderWorldCopies
                }, a.prototype.setRenderWorldCopies = function (t) {
                    return this.transform.renderWorldCopies = t, this._update()
                }, a.prototype.project = function (e) {
                    return this.transform.locationPoint(t.LngLat.convert(e))
                }, a.prototype.unproject = function (e) {
                    return this.transform.pointLocation(t.Point.convert(e))
                }, a.prototype.isMoving = function () {
                    return this._moving || this.handlers.isActive()
                }, a.prototype.isZooming = function () {
                    return this._zooming || this.handlers.isZooming()
                }, a.prototype.isRotating = function () {
                    return this._rotating || this.handlers.isRotating()
                }, a.prototype._createDelegatedListener = function (t, e, i) {
                    var o, a = this;
                    if ("mouseenter" === t || "mouseover" === t) {
                        var r = !1;
                        return {
                            layer: e,
                            listener: i,
                            delegates: {
                                mousemove: function (o) {
                                    var n = a.getLayer(e) ? a.queryRenderedFeatures(o.point, {
                                        layers: [e]
                                    }) : [];
                                    n.length ? r || (r = !0, i.call(a, new Ca(t, a, o.originalEvent, {
                                        features: n
                                    }))) : r = !1;
                                },
                                mouseout: function () {
                                    r = !1;
                                }
                            }
                        }
                    }
                    if ("mouseleave" === t || "mouseout" === t) {
                        var n = !1;
                        return {
                            layer: e,
                            listener: i,
                            delegates: {
                                mousemove: function (o) {
                                    (a.getLayer(e) ? a.queryRenderedFeatures(o.point, {
                                        layers: [e]
                                    }) : []).length ? n = !0 : n && (n = !1, i.call(a, new Ca(t, a, o.originalEvent)));
                                },
                                mouseout: function (e) {
                                    n && (n = !1, i.call(a, new Ca(t, a, e.originalEvent)));
                                }
                            }
                        }
                    }
                    return {
                        layer: e,
                        listener: i,
                        delegates: (o = {}, o[t] = function (t) {
                            var o = a.getLayer(e) ? a.queryRenderedFeatures(t.point, {
                                layers: [e]
                            }) : [];
                            o.length && (t.features = o, i.call(a, t), delete t.features);
                        }, o)
                    }
                }, a.prototype.on = function (t, e, i) {
                    if (void 0 === i) return o.prototype.on.call(this, t, e);
                    var a = this._createDelegatedListener(t, e, i);
                    for (var r in this._delegatedListeners = this._delegatedListeners || {}, this._delegatedListeners[t] = this._delegatedListeners[t] || [], this._delegatedListeners[t].push(a), a.delegates) this.on(r, a.delegates[r]);
                    return this
                }, a.prototype.once = function (t, e, i) {
                    if (void 0 === i) return o.prototype.once.call(this, t, e);
                    var a = this._createDelegatedListener(t, e, i);
                    for (var r in a.delegates) this.once(r, a.delegates[r]);
                    return this
                }, a.prototype.off = function (t, e, i) {
                    var a = this;
                    return void 0 === i ? o.prototype.off.call(this, t, e) : (this._delegatedListeners && this._delegatedListeners[t] && function (o) {
                        for (var r = o[t], n = 0; n < r.length; n++) {
                            var s = r[n];
                            if (s.layer === e && s.listener === i) {
                                for (var l in s.delegates) a.off(l, s.delegates[l]);
                                return r.splice(n, 1), a
                            }
                        }
                    }(this._delegatedListeners), this)
                }, a.prototype.queryRenderedFeatures = function (e, i) {
                    if (!this.style) return [];
                    var o;
                    if (0 === this._css3TransformScaleNum && (this._css3TransformScaleNum = this._getCSS3Transform(this._container)), void 0 !== i || void 0 === e || e instanceof t.Point || Array.isArray(e) || (i = e, e = void 0), i = i || {}, (e = e || [
                            [0, 0],
                            [this.transform.width * this._css3TransformScaleNum, this.transform.height * this._css3TransformScaleNum]
                        ]) instanceof t.Point || "number" == typeof e[0]) e = t.Point.convert(e), o = [new t.Point(e.x * this._css3TransformScaleNum, e.y * this._css3TransformScaleNum, 0)];
                    else {
                        var a = t.Point.convert(e[0]),
                            r = t.Point.convert(e[1]);
                        o = [new t.Point(a.x * this._css3TransformScaleNum, a.y * this._css3TransformScaleNum), new t.Point(r.x * this._css3TransformScaleNum, a.y * this._css3TransformScaleNum), new t.Point(r.x * this._css3TransformScaleNum, r.y * this._css3TransformScaleNum), new t.Point(a.x * this._css3TransformScaleNum, r.y * this._css3TransformScaleNum), new t.Point(a.x * this._css3TransformScaleNum, a.y * this._css3TransformScaleNum)];
                    }
                    return this.style.queryRenderedFeatures(o, i, this.transform)
                }, a.prototype.querySourceFeatures = function (t, e) {
                    return this.style.querySourceFeatures(t, e)
                }, a.prototype.setStyle = function (e, i) {
                    return ((i = t.extend({}, {
                        localIdeographFontFamily: this._localIdeographFontFamily,
                        diff: !0
                    }, i)).keepUserInfo || !1 !== i.diff) && this.style && e ? (this._diffStyle(e, i), this) : (this._localIdeographFontFamily = i.localIdeographFontFamily, this._updateStyle(e, i))
                }, a.prototype._getUIString = function (t) {
                    var e = this._locale[t];
                    if (null == e) throw new Error("Missing UI string '" + t + "'");
                    return e
                }, a.prototype._updateStyle = function (t, e) {
                    return this.style && (this.style.setEventedParent(null), this.style._remove()), t ? (this.style = new ri(this, e || {}), this.style.setEventedParent(this, {
                        style: this.style
                    }), "string" == typeof t ? this.style.loadURL(t) : this.style.loadJSON(t), this) : (delete this.style, this)
                }, a.prototype._lazyInitEmptyStyle = function () {
                    this.style || (this.style = new ri(this, {}), this.style.setEventedParent(this, {
                        style: this.style
                    }), this.style.loadEmpty());
                }, a.prototype._diffStyle = function (e, i) {
                    var o = this;
                    if ("string" == typeof e) {
                        var a = this._requestManager.normalizeStyleURL(e),
                            r = this._requestManager.transformRequest(a, t.ResourceType.Style);
                        t.getJSON(r, (function (e, a) {
                            e ? o.fire(new t.ErrorEvent(e)) : a && o._updateDiff(a, i);
                        }));
                    } else "object" == typeof e && this._updateDiff(e, i);
                }, a.prototype._updateDiff = function (e, i) {
                    try {
                        this.style.setState(e, i && i.keepUserInfo) && this._update(!0);
                    } catch (o) {
                        t.warnOnce("Unable to perform style diff: " + (o.message || o.error || o) + ".  Rebuilding the style from scratch."), this._updateStyle(e, i);
                    }
                }, a.prototype.getStyle = function () {
                    if (this.style) return this.style.serialize()
                }, a.prototype.isStyleLoaded = function () {
                    return this.style ? this.style.loaded() : t.warnOnce("There is no style added to the map.")
                }, a.prototype.addSource = function (t, e) {
                    return this._lazyInitEmptyStyle(), this.style.addSource(t, e), this._update(!0)
                }, a.prototype.isSourceLoaded = function (e) {
                    var i = this.style && this.style.sourceCaches[e];
                    if (void 0 !== i) return i.loaded();
                    this.fire(new t.ErrorEvent(new Error("There is no source with ID '" + e + "'")));
                }, a.prototype.areTilesLoaded = function () {
                    var t = this.style && this.style.sourceCaches;
                    for (var e in t) {
                        var i = t[e]._tiles;
                        for (var o in i) {
                            var a = i[o];
                            if ("loaded" !== a.state && "errored" !== a.state) return !1
                        }
                    }
                    return !0
                }, a.prototype.addSourceType = function (t, e, i) {
                    return this._lazyInitEmptyStyle(), this.style.addSourceType(t, e, i)
                }, a.prototype.removeSource = function (t) {
                    return this.style.removeSource(t), this._update(!0)
                }, a.prototype.getSource = function (t) {
                    return this.style.getSource(t)
                }, a.prototype.addImage = function (e, i, o) {
                    void 0 === o && (o = {});
                    var a = o.pixelRatio;
                    void 0 === a && (a = 1);
                    var r = o.sdf;
                    void 0 === r && (r = !1);
                    var n = o.stretchX,
                        s = o.stretchY,
                        l = o.content;
                    if (this._lazyInitEmptyStyle(), i instanceof xr || br && i instanceof br) {
                        var c = t.browser.getImageData(i);
                        this.style.addImage(e, {
                            data: new t.RGBAImage({
                                width: c.width,
                                height: c.height
                            }, c.data),
                            pixelRatio: a,
                            stretchX: n,
                            stretchY: s,
                            content: l,
                            sdf: r,
                            version: 0
                        });
                    } else {
                        if (void 0 === i.width || void 0 === i.height) return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));
                        var u = i;
                        this.style.addImage(e, {
                            data: new t.RGBAImage({
                                width: i.width,
                                height: i.height
                            }, new Uint8Array(i.data)),
                            pixelRatio: a,
                            stretchX: n,
                            stretchY: s,
                            content: l,
                            sdf: r,
                            version: 0,
                            userImage: u
                        }), u.onAdd && u.onAdd(this, e);
                    }
                }, a.prototype.updateImage = function (e, i) {
                    var o = this.style.getImage(e);
                    if (!o) return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));
                    var a = i instanceof xr || br && i instanceof br ? t.browser.getImageData(i) : i,
                        r = a.width,
                        n = a.height,
                        s = a.data;
                    return void 0 === r || void 0 === n ? this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))) : r !== o.data.width || n !== o.data.height ? this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))) : (o.data.replace(s, !(i instanceof xr || br && i instanceof br)), void this.style.updateImage(e, o))
                }, a.prototype.hasImage = function (e) {
                    return e ? !!this.style.getImage(e) : (this.fire(new t.ErrorEvent(new Error("Missing required image id"))), !1)
                }, a.prototype.removeImage = function (t) {
                    this.style.removeImage(t);
                }, a.prototype.loadImage = function (e, i) {
                    t.getImage(this._requestManager.transformRequest(e, t.ResourceType.Image), i);
                }, a.prototype.listImages = function () {
                    return this.style.listImages()
                }, a.prototype.addLayer = function (t, e) {
                    return this._lazyInitEmptyStyle(), this.style.addLayer(t, e), "dynamicLine" !== t.type && "symtracking" !== t.type && "airline" !== t.type && "sprite" !== t.type && "tracking" !== t.type || (this.timer.state = !0), this._update(!0)
                }, a.prototype.moveLayer = function (t, e) {
                    return this.style.moveLayer(t, e), this._update(!0)
                }, a.prototype.removeLayer = function (t) {
                    return this.style.removeLayer(t), this._update(!0)
                }, a.prototype.getLayer = function (t) {
                    return this.style.getLayer(t)
                }, a.prototype.setLayerZoomRange = function (t, e, i) {
                    return this.style.setLayerZoomRange(t, e, i), this._update(!0)
                }, a.prototype.setFilter = function (t, e, i) {
                    return void 0 === i && (i = {}), this.style.setFilter(t, e, i), this._update(!0)
                }, a.prototype.getFilter = function (t) {
                    return this.style.getFilter(t)
                }, a.prototype.setPaintProperty = function (t, e, i, o) {
                    return void 0 === o && (o = {}), this.style.setPaintProperty(t, e, i, o), this._update(!0)
                }, a.prototype.getPaintProperty = function (t, e) {
                    return this.style.getPaintProperty(t, e)
                }, a.prototype.setLayoutProperty = function (t, e, i, o) {
                    return void 0 === o && (o = {}), this.style.setLayoutProperty(t, e, i, o), this._update(!0)
                }, a.prototype.getLayoutProperty = function (t, e) {
                    return this.style.getLayoutProperty(t, e)
                }, a.prototype.setLight = function (t, e) {
                    return void 0 === e && (e = {}), this._lazyInitEmptyStyle(), this.style.setLight(t, e), this._update(!0)
                }, a.prototype.getLight = function () {
                    return this.style.getLight()
                }, a.prototype.setFeatureState = function (t, e) {
                    return this.style.setFeatureState(t, e), this._update()
                }, a.prototype.removeFeatureState = function (t, e) {
                    return this.style.removeFeatureState(t, e), this._update()
                }, a.prototype.getFeatureState = function (t) {
                    return this.style.getFeatureState(t)
                }, a.prototype.getContainer = function () {
                    return this._container
                }, a.prototype.getCanvasContainer = function () {
                    return this._canvasContainer
                }, a.prototype.getCanvas = function () {
                    return this._canvas
                }, a.prototype._containerDimensions = function () {
                    var t = 0,
                        e = 0;
                    return this._container && (t = this._container.clientWidth || 400, e = this._container.clientHeight || 300), [t, e]
                }, a.prototype._detectMissingCSS = function () {
                    "rgb(250, 128, 114)" !== t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color") && t.warnOnce("This page appears to be missing CSS declarations for MineMap, which may cause the map to display incorrectly. Please ensure your page includes minemap.css, as described in https:http://minedata.cn/api/dev/js/guide/introduction/prepare.");
                }, a.prototype._setupContainer = function () {
                    var t = this._container;
                    t.classList.add("minemap-map"), (this._missingCSSCanary = i.create("div", "minemap-canary", t)).style.visibility = "hidden", this._detectMissingCSS();
                    var e = this._canvasContainer = i.create("div", "minemap-canvas-container", t);
                    this._interactive && e.classList.add("minemap-interactive"), this._canvas = i.create("canvas", "minemap-canvas", e), this._canvas.addEventListener("webglcontextlost", this._contextLost, !1), this._canvas.addEventListener("webglcontextrestored", this._contextRestored, !1), this._canvas.setAttribute("tabindex", "0"), this._canvas.setAttribute("aria-label", "Map");
                    var o = this._containerDimensions();
                    this._resizeCanvas(o[0], o[1]);
                    var a = this._controlContainer = i.create("div", "minemap-control-container", t),
                        r = this._controlPositions = {};
                    ["top-left", "top-right", "bottom-left", "bottom-right"].forEach((function (t) {
                        r[t] = i.create("div", "minemap-ctrl-" + t, a);
                    }));
                }, a.prototype._resizeCanvas = function (e, i) {
                    var o = t.browser.devicePixelRatio || 1;
                    this._canvas.width = o * e, this._canvas.height = o * i, this._canvas.style.width = e + "px", this._canvas.style.height = i + "px";
                }, a.prototype._setupPainter = function () {
                    var i = t.extend({}, e.webGLContextAttributes, {
                            failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat,
                            preserveDrawingBuffer: this._preserveDrawingBuffer,
                            antialias: this._antialias || !1
                        }),
                        o = this._canvas.getContext("webgl", i) || this._canvas.getContext("experimental-webgl", i);
                    o ? (this.painter = new _a(o, this.transform, this.timer, this.isLatLon), t.webpSupported.testSupport(o)) : this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")));
                }, a.prototype._contextLost = function (e) {
                    e.preventDefault(), this._frame && (this._frame.cancel(), this._frame = null), this.fire(new t.Event("webglcontextlost", {
                        originalEvent: e
                    }));
                }, a.prototype._contextRestored = function (e) {
                    this._setupPainter(), this.resize(), this._update(), this.fire(new t.Event("webglcontextrestored", {
                        originalEvent: e
                    }));
                }, a.prototype.loaded = function () {
                    return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded()
                }, a.prototype._update = function (t) {
                    return this.style ? (this._styleDirty = this._styleDirty || t, this._sourcesDirty = !0, this.triggerRepaint(), this) : this
                }, a.prototype._requestRenderFrame = function (t) {
                    return this._update(), this._renderTaskQueue.add(t)
                }, a.prototype._cancelRenderFrame = function (t) {
                    this._renderTaskQueue.remove(t);
                }, a.prototype._render = function (e) {
                    var i, o = this,
                        a = 0,
                        r = this.painter.context.extTimerQuery;
                    if (this.listens("gpu-timing-frame") && (i = r.createQueryEXT(), r.beginQueryEXT(r.TIME_ELAPSED_EXT, i), a = t.browser.now()), this.painter.context.setDirty(), this.painter.setBaseState(), this._renderTaskQueue.run(e), !this._removed) {
                        var n = !1;
                        if (this.style && this._styleDirty) {
                            this._styleDirty = !1;
                            var s = this.transform.zoom,
                                l = t.browser.now();
                            this.style.zoomHistory.update(s, l);
                            var c = new t.EvaluationParameters(s, {
                                    now: l,
                                    fadeDuration: this._fadeDuration,
                                    zoomHistory: this.style.zoomHistory,
                                    transition: this.style.getTransition()
                                }),
                                u = c.crossFadingFactor();
                            1 === u && u === this._crossFadingFactor || (n = !0, this._crossFadingFactor = u), this.style.update(c);
                        }
                        if (this.style && this._sourcesDirty && (this._sourcesDirty = !1, this.style._updateSources(this.transform)), this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, this._fadeDuration, this._crossSourceCollisions), this.painter.render(this.style, {
                                showTileBoundaries: this.showTileBoundaries,
                                showOverdrawInspector: this._showOverdrawInspector,
                                rotating: this.isRotating(),
                                zooming: this.isZooming(),
                                moving: this.isMoving(),
                                fadeDuration: this._fadeDuration,
                                showPadding: this.showPadding,
                                gpuTiming: !!this.listens("gpu-timing-layer")
                            }), this.fire(new t.Event("render")), this.loaded() && !this._loaded && (this._loaded = !0, this.fire(new t.Event("load"))), this.style && (this.style.hasTransitions() || n) && (this._styleDirty = !0), this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(), this.listens("gpu-timing-frame")) {
                            var h = t.browser.now() - a;
                            r.endQueryEXT(r.TIME_ELAPSED_EXT, i), setTimeout((function () {
                                var e = r.getQueryObjectEXT(i, r.QUERY_RESULT_EXT) / 1e6;
                                r.deleteQueryEXT(i), o.fire(new t.Event("gpu-timing-frame", {
                                    cpuTime: h,
                                    gpuTime: e
                                }));
                            }), 50);
                        }
                        if (this.listens("gpu-timing-layer")) {
                            var p = this.painter.collectGpuTimers();
                            setTimeout((function () {
                                var e = o.painter.queryGpuTimers(p);
                                o.fire(new t.Event("gpu-timing-layer", {
                                    layerTimes: e
                                }));
                            }), 50);
                        }
                        var _ = this._sourcesDirty || this._styleDirty || this._placementDirty;
                        return _ || this._repaint ? this.triggerRepaint() : !this.isMoving() && this.loaded() && this.fire(new t.Event("idle")), !this._loaded || this._fullyLoaded || _ || (this._fullyLoaded = !0), this
                    }
                }, a.prototype.remove = function () {
                    this._hash && this._hash.remove();
                    for (var e = 0, i = this._controls; e < i.length; e += 1) i[e].onRemove(this);
                    this._controls = [], this._frame && (this._frame.cancel(), this._frame = null), this._renderTaskQueue.clear(), this.painter.destroy(), this.handlers.destroy(), delete this.handlers, this.setStyle(null), void 0 !== t.window && (t.window.removeEventListener("resize", this._onWindowResize, !1), t.window.removeEventListener("online", this._onWindowOnline, !1));
                    var o = this.painter.context.gl.getExtension("WEBGL_lose_context");
                    o && o.loseContext(), Sr(this._canvasContainer), Sr(this._controlContainer), Sr(this._missingCSSCanary), this._container.classList.remove("minemap-map"), this._removed = !0, this.fire(new t.Event("remove")), this.overviewMapInstance && (this._overviewDrag.remove(), this.off("moveend", this.__onMove), this.overviewMapInstance.remove(), this.getContainer().parentNode.parentNode.removeChild(this._overviewMapElement));
                }, a.prototype.triggerRepaint = function () {
                    var e = this;
                    this.style && !this._frame && (this._frame = t.browser.frame((function (t) {
                        e._frame = null, e.timer.update(), e._render(t);
                    })));
                }, a.prototype._onWindowOnline = function () {
                    this._update();
                }, a.prototype._onWindowResize = function (t) {
                    this._trackResize && this.resize({
                        originalEvent: t
                    })._update();
                }, a.prototype._getCSS3Transform = function (e) {
                    var i = t.window.getComputedStyle(e).transform;
                    return "none" !== i ? 1 / parseFloat(i.substring(7, i.indexOf(","))) : "HTML" !== e.tagName.toUpperCase() ? this._getCSS3Transform(e.parentElement) : 1
                }, a.prototype.addOverviewMap = function () {
                    var e = this;
                    this._overviewMapElement = t.window.document.createElement("div"), this._overviewMapElement.id = "overviewMap_" + Math.random(), this._overviewMapElement.style.position = "absolute", this._overviewMapElement.style.width = "160px", this._overviewMapElement.style.height = "160px", this._overviewMapElement.style.bottom = "0px", this._overviewMapElement.style.right = "0px", this._overviewMapElement.style.zIndex = 200, this._overviewMapElement.style.boxSizing = "border-box", this._overviewMapElement.style.border = "2px solid rgba(187,187,187,0.5)", this._overviewMapElement.style.borderRadius = "2px", this.getContainer().parentNode.parentNode.appendChild(this._overviewMapElement), this.overviewMapInstance = new a({
                        container: this._overviewMapElement,
                        style: this._overviewMapOptions.style,
                        center: this.getCenter(),
                        zoom: this.getZoom() < 7 ? 3 : this.getZoom() - 4,
                        pitch: 0,
                        doubleClickZoom: !1,
                        scrollZoom: !1,
                        dragRotate: !1,
                        maxZoom: 17,
                        minZoom: 3,
                        logoControl: !1,
                        preserveDrawingBuffer: !0,
                        accessToken: null
                    }), this.overviewMapInstance.disableDrag(), this.on("moveend", this.__onMove), setTimeout((function () {
                        var i = t.window.document.createElement("div");
                        e.overviewMapInstance.getCanvas().style.cursor = "";
                        var o = e.getBounds(),
                            a = e.overviewMapInstance.project(o.getSouthWest()),
                            r = e.overviewMapInstance.project(o.getNorthEast());
                        r.y <= 45 && (r = new t.Point(r.x, 45)), a.x <= 45 && (a = new t.Point(45, a.y)), i.style.top = Math.round(r.y) + "px", i.style.left = Math.round(a.x) + "px", i.style.width = Math.round(160 - 2 * a.x) + "px", i.style.height = Math.round(160 - 2 * r.y) + "px", i.style.border = "2px solid red", i.style.position = "absolute", e._overviewMapElement.appendChild(i), e._overviewDrag = new fr({
                            handler: e._overviewMapElement,
                            root: i,
                            restrictX: 2 * Math.round(a.x),
                            restrictY: 2 * Math.round(r.y),
                            cb: function (t, o) {
                                if (t - Math.round(a.x) != 0 || o - Math.round(r.y) != 0) {
                                    var n = e.overviewMapInstance.unproject([t - Math.round(a.x) + 80, o - Math.round(r.y) + 80]);
                                    e.flyTo({
                                        center: n,
                                        bearing: e.overviewMapInstance.getBearing()
                                    }), i.style.top = Math.round(r.y) + "px", i.style.left = Math.round(a.x) + "px";
                                }
                            }
                        });
                    }), 1e3);
                }, a.prototype.__onMove = function () {
                    this.overviewMapInstance.setCenter(this.getCenter()), this.overviewMapInstance.setBearing(this.getBearing()), this.overviewMapInstance.setZoom(this.getZoom() < 6 ? 3 : this.getZoom() - 4);
                }, a.prototype.disableDrag = function () {
                    this.dragPan.disable();
                }, a.prototype.enableDrag = function () {
                    this.dragPan.enable();
                }, a.prototype.getMapCursor = function () {
                    return this.getCanvas().style.cursor
                }, a.prototype.setMapCursor = function (t) {
                    this.getCanvas().style.cursor = t;
                }, a.prototype.getMapPoisByPoint = function (t) {
                    for (var e = this.queryRenderedFeatures(t), i = [], o = 0; o < e.length; o++) "Point" === e[o].geometry.type && i.push(e[o]);
                    return i
                }, a.prototype.setZoomAndCenter = function (t, e) {
                    this.setZoom(t), this.setCenter(e);
                }, a.prototype.setTimerCount = function (t) {
                    this.timer.counter = t, this._stopTimerCount = !1, this.timer.resumeTimer();
                }, a.prototype.pauseTimerCount = function () {
                    this._stopTimerCount || this.timer.pauseTimer();
                }, a.prototype.resumeTimerCount = function () {
                    this._stopTimerCount || this.timer.resumeTimer();
                }, a.prototype.stopTimerCount = function () {
                    this._stopTimerCount = !0, this.timer.pauseTimer();
                }, r.overviewMap.set = function (t) {
                    this._overviewMap = t, this.overviewMapInstance ? this._overviewMapElement.style.display = t ? "block" : "none" : t && this.addOverviewMap();
                }, r.overviewMap.get = function () {
                    return this._overviewMap
                }, r.showTileBoundaries.get = function () {
                    return !!this._showTileBoundaries
                }, r.showTileBoundaries.set = function (t) {
                    this._showTileBoundaries !== t && (this._showTileBoundaries = t, this._update());
                }, r.showPadding.get = function () {
                    return !!this._showPadding
                }, r.showPadding.set = function (t) {
                    this._showPadding !== t && (this._showPadding = t, this._update());
                }, r.showCollisionBoxes.get = function () {
                    return !!this._showCollisionBoxes
                }, r.showCollisionBoxes.set = function (t) {
                    this._showCollisionBoxes !== t && (this._showCollisionBoxes = t, t ? this.style._generateCollisionBoxes() : this._update());
                }, r.showOverdrawInspector.get = function () {
                    return !!this._showOverdrawInspector
                }, r.showOverdrawInspector.set = function (t) {
                    this._showOverdrawInspector !== t && (this._showOverdrawInspector = t, this._update());
                }, r.repaint.get = function () {
                    return !!this._repaint
                }, r.repaint.set = function (t) {
                    this._repaint !== t && (this._repaint = t, this.triggerRepaint());
                }, r.vertices.get = function () {
                    return !!this._vertices
                }, r.vertices.set = function (t) {
                    this._vertices = t, this._update();
                }, a.prototype._setCacheLimits = function (e, i) {
                    t.setCacheLimits(e, i);
                }, r.version.get = function () {
                    return "2.1.0"
                }, r.css3TransformScaleNumber.set = function (t) {
                    this._css3TransformScaleNum = 0 !== t ? 1 / t : this._css3TransformScaleNum;
                }, r.css3TransformScaleNumber.get = function () {
                    return this._css3TransformScaleNum
                }, Object.defineProperties(a.prototype, r), a
            }(pr);

        function Sr(t) {
            t.parentNode && t.parentNode.removeChild(t);
        }
        var Ir = {
                showCompass: !0,
                showZoom: !0,
                visualizePitch: !1
            },
            zr = function (e) {
                var o = this;
                this.options = t.extend({}, Ir, e), this._container = i.create("div", "minemap-ctrl minemap-ctrl-group"), this._container.addEventListener("contextmenu", (function (t) {
                    return t.preventDefault()
                })), this.options.showZoom && (t.bindAll(["_setButtonTitle", "_updateZoomButtons"], this), this._zoomInButton = this._createButton("minemap-ctrl-icon minemap-ctrl-zoom-in", (function (t) {
                    return o._map.zoomIn({}, {
                        originalEvent: t
                    })
                })), this._zoomOutButton = this._createButton("minemap-ctrl-icon minemap-ctrl-zoom-out", (function (t) {
                    return o._map.zoomOut({}, {
                        originalEvent: t
                    })
                }))), this.options.showCompass && (t.bindAll(["_rotateCompassArrow"], this), this._compass = this._createButton("minemap-ctrl-icon minemap-ctrl-compass", (function (t) {
                    o.options.visualizePitch ? o._map.resetNorthPitch({}, {
                        originalEvent: t
                    }) : o._map.resetNorth({}, {
                        originalEvent: t
                    });
                })), this._compassIcon = i.create("span", "minemap-ctrl-compass-arrow", this._compass), this._compassIcon.setAttribute("aria-hidden", !0));
            };
        zr.prototype._updateZoomButtons = function () {
            var t = this._map.getZoom();
            this._zoomInButton.disabled = t === this._map.getMaxZoom(), this._zoomOutButton.disabled = t === this._map.getMinZoom();
        }, zr.prototype._rotateCompassArrow = function () {
            var t = this.options.visualizePitch ? "scale(" + 1 / Math.pow(Math.cos(this._map.transform.pitch * (Math.PI / 180)), .5) + ") rotateX(" + this._map.transform.pitch + "deg) rotateZ(" + this._map.transform.angle * (180 / Math.PI) + "deg)" : "rotate(" + this._map.transform.angle * (180 / Math.PI) + "deg)";
            this._compassIcon.style.transform = t;
        }, zr.prototype.onAdd = function (t) {
            return this._map = t, this.options.showZoom && (this._setButtonTitle(this._zoomInButton, "ZoomIn"), this._setButtonTitle(this._zoomOutButton, "ZoomOut"), this._map.on("zoom", this._updateZoomButtons), this._updateZoomButtons()), this.options.showCompass && (this._setButtonTitle(this._compass, "ResetBearing"), this.options.visualizePitch && this._map.on("pitch", this._rotateCompassArrow), this._map.on("rotate", this._rotateCompassArrow), this._rotateCompassArrow(), this._handler = new Cr(this._map, this._compass, this.options.visualizePitch)), this._container
        }, zr.prototype.onRemove = function () {
            i.remove(this._container), this.options.showZoom && this._map.off("zoom", this._updateZoomButtons), this.options.showCompass && (this.options.visualizePitch && this._map.off("pitch", this._rotateCompassArrow), this._map.off("rotate", this._rotateCompassArrow), this._handler.off(), delete this._handler), delete this._map;
        }, zr.prototype._createButton = function (t, e) {
            var o = i.create("button", t, this._container);
            return o.type = "button", o.addEventListener("click", e), o
        }, zr.prototype._setButtonTitle = function (t, e) {
            var i = this._map._getUIString("NavigationControl." + e);
            t.title = i, t.setAttribute("aria-label", i);
        };
        var Cr = function (e, o, a) {
            void 0 === a && (a = !1), this._clickTolerance = 10, this.element = o, this.mouseRotate = new qa({
                clickTolerance: e.dragRotate._mouseRotate._clickTolerance
            }), this.map = e, a && (this.mousePitch = new ja({
                clickTolerance: e.dragRotate._mousePitch._clickTolerance
            })), t.bindAll(["mousedown", "mousemove", "mouseup", "touchstart", "touchmove", "touchend", "reset"], this), i.addEventListener(o, "mousedown", this.mousedown), i.addEventListener(o, "touchstart", this.touchstart, {
                passive: !1
            }), i.addEventListener(o, "touchmove", this.touchmove), i.addEventListener(o, "touchend", this.touchend), i.addEventListener(o, "touchcancel", this.reset);
        };

        function Pr(e, i, o) {
            if (e = new t.LngLat(e.lng, e.lat), i) {
                var a = new t.LngLat(e.lng - 360, e.lat),
                    r = new t.LngLat(e.lng + 360, e.lat),
                    n = o.locationPoint(e).distSqr(i);
                o.locationPoint(a).distSqr(i) < n ? e = a : o.locationPoint(r).distSqr(i) < n && (e = r);
            }
            for (; Math.abs(e.lng - o.center.lng) > 180;) {
                var s = o.locationPoint(e);
                if (s.x >= 0 && s.y >= 0 && s.x <= o.width && s.y <= o.height) break;
                e.lng > o.center.lng ? e.lng -= 360 : e.lng += 360;
            }
            return e
        }
        Cr.prototype.down = function (t, e) {
            this.mouseRotate.mousedown(t, e), this.mousePitch && this.mousePitch.mousedown(t, e), i.disableDrag();
        }, Cr.prototype.move = function (t, e) {
            var i = this.map,
                o = this.mouseRotate.mousemoveWindow(t, e);
            if (o && o.bearingDelta && i.setBearing(i.getBearing() + o.bearingDelta), this.mousePitch) {
                var a = this.mousePitch.mousemoveWindow(t, e);
                a && a.pitchDelta && i.setPitch(i.getPitch() + a.pitchDelta);
            }
        }, Cr.prototype.off = function () {
            var t = this.element;
            i.removeEventListener(t, "mousedown", this.mousedown), i.removeEventListener(t, "touchstart", this.touchstart, {
                passive: !1
            }), i.removeEventListener(t, "touchmove", this.touchmove), i.removeEventListener(t, "touchend", this.touchend), i.removeEventListener(t, "touchcancel", this.reset), this.offTemp();
        }, Cr.prototype.offTemp = function () {
            i.enableDrag(), i.removeEventListener(t.window, "mousemove", this.mousemove), i.removeEventListener(t.window, "mouseup", this.mouseup);
        }, Cr.prototype.mousedown = function (e) {
            this.down(t.extend({}, e, {
                ctrlKey: !0,
                preventDefault: function () {
                    return e.preventDefault()
                }
            }), i.mousePos(this.element, e)), i.addEventListener(t.window, "mousemove", this.mousemove), i.addEventListener(t.window, "mouseup", this.mouseup);
        }, Cr.prototype.mousemove = function (t) {
            this.move(t, i.mousePos(this.element, t));
        }, Cr.prototype.mouseup = function (t) {
            this.mouseRotate.mouseupWindow(t), this.mousePitch && this.mousePitch.mouseupWindow(t), this.offTemp();
        }, Cr.prototype.touchstart = function (t) {
            1 !== t.targetTouches.length ? this.reset() : (this._startPos = this._lastPos = i.touchPos(this.element, t.targetTouches)[0], this.down({
                type: "mousedown",
                button: 0,
                ctrlKey: !0,
                preventDefault: function () {
                    return t.preventDefault()
                }
            }, this._startPos));
        }, Cr.prototype.touchmove = function (t) {
            1 !== t.targetTouches.length ? this.reset() : (this._lastPos = i.touchPos(this.element, t.targetTouches)[0], this.move({
                preventDefault: function () {
                    return t.preventDefault()
                }
            }, this._lastPos));
        }, Cr.prototype.touchend = function (t) {
            0 === t.targetTouches.length && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(), this.reset();
        }, Cr.prototype.reset = function () {
            this.mouseRotate.reset(), this.mousePitch && this.mousePitch.reset(), delete this._startPos, delete this._lastPos, this.offTemp();
        };
        var Lr = {
            center: "translate(-50%,-50%)",
            top: "translate(-50%,0)",
            "top-left": "translate(0,0)",
            "top-right": "translate(-100%,0)",
            bottom: "translate(-50%,-100%)",
            "bottom-left": "translate(0,-100%)",
            "bottom-right": "translate(-100%,-100%)",
            left: "translate(0,-50%)",
            right: "translate(-100%,-50%)"
        };

        function Ar(t, e, i) {
            var o = t.classList;
            for (var a in Lr) o.remove("minemap-" + i + "-anchor-" + a);
            o.add("minemap-" + i + "-anchor-" + e);
        }
        var Mr, Dr = function (e) {
                function o(o, a) {
                    var r = this;
                    if (e.call(this), (o instanceof t.window.HTMLElement || a) && (o = t.extend({
                            element: o
                        }, a)), t.bindAll(["_update", "_onMove", "_onUp", "_addDragHandler", "_onMapClick", "_onKeyPress"], this), this._anchor = o && o.anchor || "top-left", this._color = o && o.color || "#3FB1CE", this._scale = o && o.scale || 1, this._draggable = o && o.draggable || !1, this._state = "inactive", this._rotation = o && o.rotation || 0, this._rotationAlignment = o && o.rotationAlignment || "auto", this._pitchAlignment = o && o.pitchAlignment && "auto" !== o.pitchAlignment ? o.pitchAlignment : this._rotationAlignment, this._title = o && o.title || "", this._titleColor = o && o.titleColor || "black", this._titleFontSize = o && o.titleFontSize || 10, this._titleOffset = o && o.titleOffset || [0, 0], this._titleLabel = i.create("span"), this._titleLabel.style.display = "block", this._titleLabel.style.position = "absolute", this._titleLabel.style.padding = "0px 2px", this._titleLabel.style.width = "100px", this._titleLabel.added = !1, this._titleLabel.style.color = this._titleColor, this._titleLabel.style["font-size"] = this._titleFontSize + "px", o && o.element) this._element = o.element, this._offset = t.Point.convert(o && o.offset || [0, 0]);
                    else {
                        this._defaultMarker = !0, this._element = i.create("div"), this._element.setAttribute("aria-label", "Map marker");
                        var n = i.createNS("http://www.w3.org/2000/svg", "svg");
                        n.setAttributeNS(null, "display", "block"), n.setAttributeNS(null, "height", "41px"), n.setAttributeNS(null, "width", "27px"), n.setAttributeNS(null, "viewBox", "0 0 27 41");
                        var s = i.createNS("http://www.w3.org/2000/svg", "g");
                        s.setAttributeNS(null, "stroke", "none"), s.setAttributeNS(null, "stroke-width", "1"), s.setAttributeNS(null, "fill", "none"), s.setAttributeNS(null, "fill-rule", "evenodd");
                        var l = i.createNS("http://www.w3.org/2000/svg", "g");
                        l.setAttributeNS(null, "fill-rule", "nonzero");
                        var c = i.createNS("http://www.w3.org/2000/svg", "g");
                        c.setAttributeNS(null, "transform", "translate(3.0, 29.0)"), c.setAttributeNS(null, "fill", "#000000");
                        for (var u = 0, h = [{
                                rx: "10.5",
                                ry: "5.25002273"
                            }, {
                                rx: "10.5",
                                ry: "5.25002273"
                            }, {
                                rx: "9.5",
                                ry: "4.77275007"
                            }, {
                                rx: "8.5",
                                ry: "4.29549936"
                            }, {
                                rx: "7.5",
                                ry: "3.81822308"
                            }, {
                                rx: "6.5",
                                ry: "3.34094679"
                            }, {
                                rx: "5.5",
                                ry: "2.86367051"
                            }, {
                                rx: "4.5",
                                ry: "2.38636864"
                            }]; u < h.length; u += 1) {
                            var p = h[u],
                                _ = i.createNS("http://www.w3.org/2000/svg", "ellipse");
                            _.setAttributeNS(null, "opacity", "0.04"), _.setAttributeNS(null, "cx", "10.5"), _.setAttributeNS(null, "cy", "5.80029008"), _.setAttributeNS(null, "rx", p.rx), _.setAttributeNS(null, "ry", p.ry), c.appendChild(_);
                        }
                        var m = i.createNS("http://www.w3.org/2000/svg", "g");
                        m.setAttributeNS(null, "fill", this._color);
                        var d = i.createNS("http://www.w3.org/2000/svg", "path");
                        d.setAttributeNS(null, "d", "M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"), m.appendChild(d);
                        var f = i.createNS("http://www.w3.org/2000/svg", "g");
                        f.setAttributeNS(null, "opacity", "0.25"), f.setAttributeNS(null, "fill", "#000000");
                        var g = i.createNS("http://www.w3.org/2000/svg", "path");
                        g.setAttributeNS(null, "d", "M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"), f.appendChild(g);
                        var v = i.createNS("http://www.w3.org/2000/svg", "g");
                        v.setAttributeNS(null, "transform", "translate(6.0, 7.0)"), v.setAttributeNS(null, "fill", "#FFFFFF");
                        var y = i.createNS("http://www.w3.org/2000/svg", "g");
                        y.setAttributeNS(null, "transform", "translate(8.0, 8.0)");
                        var x = i.createNS("http://www.w3.org/2000/svg", "circle");
                        x.setAttributeNS(null, "fill", "#000000"), x.setAttributeNS(null, "opacity", "0.25"), x.setAttributeNS(null, "cx", "5.5"), x.setAttributeNS(null, "cy", "5.5"), x.setAttributeNS(null, "r", "5.4999962");
                        var w = i.createNS("http://www.w3.org/2000/svg", "circle");
                        w.setAttributeNS(null, "fill", "#FFFFFF"), w.setAttributeNS(null, "cx", "5.5"), w.setAttributeNS(null, "cy", "5.5"), w.setAttributeNS(null, "r", "5.4999962"), y.appendChild(x), y.appendChild(w), l.appendChild(c), l.appendChild(m), l.appendChild(f), l.appendChild(v), l.appendChild(y), n.appendChild(l), n.setAttributeNS(null, "height", 41 * this._scale + "px"), n.setAttributeNS(null, "width", 27 * this._scale + "px"), this._element.appendChild(n), this._offset = t.Point.convert(o && o.offset || [-13.5 * this._scale, -35 * this._scale]);
                    }
                    o && o.extData && (this._element = o.extData, this._offset = t.Point.convert(o && o.offset || [0, 0])), this._element.classList.add("minemap-marker"), this._element.addEventListener("dragstart", (function (t) {
                            t.preventDefault();
                        })), this._element.addEventListener("mousedown", (function (t) {
                            t.preventDefault();
                        })), this._element.addEventListener("focus", (function () {
                            var t = r._map.getContainer();
                            t.scrollTop = 0, t.scrollLeft = 0;
                        })), Ar(this._element, this._anchor, "marker"), this._popup = null, this._element.appendChild(this._titleLabel), this._titleLabel.style.left = this._titleOffset[0] + "px", this._titleLabel.style.top = this._titleOffset[1] - 15 + "px", this._titleLabel.innerText = this._title, o && o.title && (this._titleLabel.className = "marker_title"), this._popup = null, this._element.style.cursor = "pointer", o && o.position && this.setLngLat(o.position),
                        function (t) {
                            for (var e = 0, i = Object.getOwnPropertyNames(t.constructor.prototype); e < i.length; e += 1) {
                                var o = i[e],
                                    a = t[o];
                                "constructor" !== o && "function" == typeof a && (t[o] = a.bind(t));
                            }
                        }(this);
                }
                return e && (o.__proto__ = e), (o.prototype = Object.create(e && e.prototype)).constructor = o, o.prototype.addTo = function (t) {
                    return this.remove(), this._map = t, t.getCanvasContainer().appendChild(this._element), t.on("move", this._update), t.on("moveend", this._update), this.setDraggable(this._draggable), this._update(), this._map.on("click", this._onMapClick), this
                }, o.prototype.remove = function () {
                    return this._map && (this._map.off("click", this._onMapClick), this._map.off("move", this._update), this._map.off("moveend", this._update), this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler), this._map.off("mouseup", this._onUp), this._map.off("touchend", this._onUp), this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), delete this._map), i.remove(this._element), this._popup && this._popup.remove(), this
                }, o.prototype.getLngLat = function () {
                    return this._lngLat
                }, o.prototype.setLngLat = function (e) {
                    return this._lngLat = t.LngLat.convert(e), this._pos = null, this._popup && this._popup.setLngLat(this._lngLat), this._update(), this
                }, o.prototype.getElement = function () {
                    return this._element
                }, o.prototype.setPopup = function (t) {
                    if (this._popup && (this._popup.remove(), this._popup = null, this._element.removeEventListener("keypress", this._onKeyPress), this._originalTabIndex || this._element.removeAttribute("tabindex")), t) {
                        if (!("offset" in t.options)) {
                            var e = Math.sqrt(Math.pow(13.5, 2) / 2);
                            t.options.offset = this._defaultMarker ? {
                                top: [0, 0],
                                "top-left": [0, 0],
                                "top-right": [0, 0],
                                bottom: [0, -38.1],
                                "bottom-left": [e, -1 * (24.6 + e)],
                                "bottom-right": [-e, -1 * (24.6 + e)],
                                left: [13.5, -24.6],
                                right: [-13.5, -24.6]
                            } : this._offset;
                        }
                        this._popup = t, this._lngLat && this._popup.setLngLat(this._lngLat), this._originalTabIndex = this._element.getAttribute("tabindex"), this._originalTabIndex || this._element.setAttribute("tabindex", "0"), this._element.addEventListener("keypress", this._onKeyPress);
                    }
                    return this
                }, o.prototype._onKeyPress = function (t) {
                    var e = t.code,
                        i = t.charCode || t.keyCode;
                    "Space" !== e && "Enter" !== e && 32 !== i && 13 !== i || this.togglePopup();
                }, o.prototype._onMapClick = function (t) {
                    var e = t.originalEvent.target,
                        i = this._element;
                    this._popup && (e === i || i.contains(e)) && this.togglePopup();
                }, o.prototype.getPopup = function () {
                    return this._popup
                }, o.prototype.togglePopup = function () {
                    var t = this._popup;
                    return t ? (t.isOpen() ? t.remove() : t.addTo(this._map), this) : this
                }, o.prototype._update = function (t) {
                    if (this._map) {
                        this._map.transform.renderWorldCopies && (this._lngLat = Pr(this._lngLat, this._pos, this._map.transform)), this._pos = this._map.project(this._lngLat)._add(this._offset);
                        var e = "",
                            o = {
                                x: 0,
                                y: 0
                            };
                        "viewport" === this._rotationAlignment || "auto" === this._rotationAlignment ? (o = this._offset, e = "rotateZ(" + this._rotation + "deg)") : "map" === this._rotationAlignment && (o = this._offset, e = "rotateZ(" + (this._rotation - this._map.getBearing()) + "deg)");
                        var a = "";
                        "viewport" === this._pitchAlignment || "auto" === this._pitchAlignment ? a = "rotateX(0deg)" : "map" === this._pitchAlignment && (o = this._offset, a = "rotateX(" + this._map.getPitch() + "deg)"), t && "moveend" !== t.type || this._pos && (this._pos = this._pos.round());
                        var r = Math.abs(o.x) / parseFloat(i.getAllStyle(this._element).width) * 100,
                            n = Math.abs(o.y) / parseFloat(i.getAllStyle(this._element).height) * 100;
                        i.setTransformOrigin(this._element, r + "% " + n + "%"), this._pos && i.setTransform(this._element, Lr[this._anchor] + " translate(" + this._pos.x + "px, " + this._pos.y + "px) " + a + " " + e);
                    }
                }, o.prototype.getOffset = function () {
                    return this._offset
                }, o.prototype.setOffset = function (e) {
                    return this._offset = t.Point.convert(e), this._update(), this
                }, o.prototype._onMove = function (e) {
                    this._pos = e.point.sub(this._positionDelta), this._lngLat = this._map.unproject(this._pos), this.setLngLat(this._lngLat), this._element.style.pointerEvents = "none", "pending" === this._state && (this._state = "active", this.fire(new t.Event("dragstart"))), this.fire(new t.Event("drag"));
                }, o.prototype._onUp = function () {
                    this._element.style.pointerEvents = "auto", this._positionDelta = null, this._map.off("mousemove", this._onMove), this._map.off("touchmove", this._onMove), "active" === this._state && this.fire(new t.Event("dragend")), this._state = "inactive";
                }, o.prototype._addDragHandler = function (t) {
                    this._element.contains(t.originalEvent.target) && (t.preventDefault(), this._positionDelta = t.point.sub(this._pos).add(this._offset), this._state = "pending", this._map.on("mousemove", this._onMove), this._map.on("touchmove", this._onMove), this._map.once("mouseup", this._onUp), this._map.once("touchend", this._onUp));
                }, o.prototype.setDraggable = function (t) {
                    return this._draggable = !!t, this._map && (t ? (this._map.on("mousedown", this._addDragHandler), this._map.on("touchstart", this._addDragHandler)) : (this._map.off("mousedown", this._addDragHandler), this._map.off("touchstart", this._addDragHandler))), this
                }, o.prototype.enableDragging = function () {
                    return this.setDraggable(!0), this
                }, o.prototype.disableDragging = function () {
                    return this.setDraggable(!1), this
                }, o.prototype.isDraggable = function () {
                    return this._draggable
                }, o.prototype.getDraggable = function () {
                    return this.isDraggable()
                }, o.prototype.setRotation = function (t) {
                    return this._rotation = t || 0, this._update(), this
                }, o.prototype.getRotation = function () {
                    return this._rotation
                }, o.prototype.setRotationAlignment = function (t) {
                    return this._rotationAlignment = t || "auto", this._update(), this
                }, o.prototype.getRotationAlignment = function () {
                    return this._rotationAlignment
                }, o.prototype.setPitchAlignment = function (t) {
                    return this._pitchAlignment = t && "auto" !== t ? t : this._rotationAlignment, this._update(), this
                }, o.prototype.getPitchAlignment = function () {
                    return this._pitchAlignment
                }, o.prototype.setExtData = function (t) {
                    var e = this;
                    return i.remove(this._element), i.remove(this._titleLabel), this._element = t, this._element.classList.add("minemap-marker"), this._element.addEventListener("dragstart", (function (t) {
                        t.preventDefault();
                    })), this._element.addEventListener("mousedown", (function (t) {
                        t.preventDefault();
                    })), this._element.addEventListener("focus", (function () {
                        var t = e._map.getContainer();
                        t.scrollTop = 0, t.scrollLeft = 0;
                    })), Ar(this._element, this._anchor, "marker"), this._element.style.cursor = "pointer", this._element.appendChild(this._titleLabel), this.addTo(this._map), this
                }, o.prototype.getExtData = function () {
                    return this._element
                }, o.prototype.setZIndex = function (t) {
                    return this._element.style.zIndex = "" + t, this
                }, o.prototype.getMap = function () {
                    return this._map
                }, o.prototype.setTitle = function (t) {
                    return this._title = t, "string" == typeof t && (this._titleLabel.innerText = this._title, this._titleLabel.className = "marker_title"), this
                }, o.prototype.getTitle = function () {
                    return this._title
                }, o.prototype.setTitleFontSize = function (t) {
                    return this._titleLabel.style.fontSize = t + "px", this
                }, o.prototype.setTitleColor = function (t) {
                    return this._titleLabel.style.color = t, this
                }, o.prototype.setTitlePosition = function (t) {
                    return this._titleOffset = t, this._titleLabel.style.left = t[0] + "px", this._titleLabel.style.top = t[1] - 15 + "px", this
                }, o.prototype.setAnimation = function (t) {
                    var e = this;
                    this._element.addEventListener("mouseover", (function () {
                        "bounce" === t && e._element.classList.add("bounceMarker");
                    })), this._element.addEventListener("mouseout", (function () {
                        e._element.classList.remove("bounceMarker");
                    }));
                }, o
            }(t.Evented),
            Rr = {
                positionOptions: {
                    enableHighAccuracy: !1,
                    maximumAge: 0,
                    timeout: 6e3
                },
                fitBoundsOptions: {
                    maxZoom: 15
                },
                trackUserLocation: !1,
                showAccuracyCircle: !0,
                showUserLocation: !0
            },
            kr = 0,
            Or = !1,
            Br = function (e) {
                function o(i) {
                    e.call(this), this.options = t.extend({}, Rr, i), t.bindAll(["_onSuccess", "_onError", "_onZoom", "_finish", "_setupUI", "_updateCamera", "_updateMarker"], this);
                }
                return e && (o.__proto__ = e), (o.prototype = Object.create(e && e.prototype)).constructor = o, o.prototype.onAdd = function (e) {
                    var o;
                    return this._map = e, this._container = i.create("div", "minemap-ctrl minemap-ctrl-group"), o = this._setupUI, void 0 !== Mr ? o(Mr) : void 0 !== t.window.navigator.permissions ? t.window.navigator.permissions.query({
                        name: "geolocation"
                    }).then((function (t) {
                        o(Mr = "denied" !== t.state);
                    })) : o(Mr = !!t.window.navigator.geolocation), this._container
                }, o.prototype.onRemove = function () {
                    void 0 !== this._geolocationWatchID && (t.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0), this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(), this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(), i.remove(this._container), this._map.off("zoom", this._onZoom), this._map = void 0, kr = 0, Or = !1;
                }, o.prototype._isOutOfMapMaxBounds = function (t) {
                    var e = this._map.getMaxBounds(),
                        i = t.coords;
                    return e && (i.longitude < e.getWest() || i.longitude > e.getEast() || i.latitude < e.getSouth() || i.latitude > e.getNorth())
                }, o.prototype._setErrorState = function () {
                    switch (this._watchState) {
                        case "WAITING_ACTIVE":
                            this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-active"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-active-error");
                            break;
                        case "ACTIVE_LOCK":
                            this._watchState = "ACTIVE_ERROR", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-active"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-waiting");
                            break;
                        case "BACKGROUND":
                            this._watchState = "BACKGROUND_ERROR", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-background"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-waiting");
                    }
                }, o.prototype._onSuccess = function (e) {
                    if (this._map) {
                        if (this._isOutOfMapMaxBounds(e)) return this._setErrorState(), this.fire(new t.Event("outofmaxbounds", e)), this._updateMarker(), void this._finish();
                        if (this.options.trackUserLocation) switch (this._lastKnownPosition = e, this._watchState) {
                            case "WAITING_ACTIVE":
                            case "ACTIVE_LOCK":
                            case "ACTIVE_ERROR":
                                this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-active-error"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-active");
                                break;
                            case "BACKGROUND":
                            case "BACKGROUND_ERROR":
                                this._watchState = "BACKGROUND", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-background-error"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-background");
                        }
                        this.options.showUserLocation && "OFF" !== this._watchState && this._updateMarker(e), this.options.trackUserLocation && "ACTIVE_LOCK" !== this._watchState || this._updateCamera(e), this.options.showUserLocation && this._dotElement.classList.remove("minemap-user-location-dot-stale"), this.fire(new t.Event("geolocate", e)), this._finish();
                    }
                }, o.prototype._updateCamera = function (e) {
                    var i = new t.LngLat(e.coords.longitude, e.coords.latitude),
                        o = e.coords.accuracy,
                        a = this._map.getBearing(),
                        r = t.extend({
                            bearing: a
                        }, this.options.fitBoundsOptions);
                    this._map.fitBounds(i.toBounds(o), r, {
                        geolocateSource: !0
                    });
                }, o.prototype._updateMarker = function (e) {
                    if (e) {
                        var i = new t.LngLat(e.coords.longitude, e.coords.latitude);
                        this._accuracyCircleMarker.setLngLat(i).addTo(this._map), this._userLocationDotMarker.setLngLat(i).addTo(this._map), this._accuracy = e.coords.accuracy, this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
                    } else this._userLocationDotMarker.remove(), this._accuracyCircleMarker.remove();
                }, o.prototype._updateCircleRadius = function () {
                    var t = this._map._container.clientHeight / 2,
                        e = this._map.unproject([0, t]),
                        i = this._map.unproject([1, t]),
                        o = e.distanceTo(i),
                        a = Math.ceil(2 * this._accuracy / o);
                    this._circleElement.style.width = a + "px", this._circleElement.style.height = a + "px";
                }, o.prototype._onZoom = function () {
                    this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();
                }, o.prototype._onError = function (e) {
                    if (this._map) {
                        if (this.options.trackUserLocation)
                            if (1 === e.code) {
                                this._watchState = "OFF", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-active"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-background"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-background-error"), this._geolocateButton.disabled = !0;
                                var i = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                                this._geolocateButton.title = i, this._geolocateButton.setAttribute("aria-label", i), void 0 !== this._geolocationWatchID && this._clearWatch();
                            } else {
                                if (3 === e.code && Or) return;
                                this._setErrorState();
                            }
                        "OFF" !== this._watchState && this.options.showUserLocation && this._dotElement.classList.add("minemap-user-location-dot-stale"), this.fire(new t.Event("error", e)), this._finish();
                    }
                }, o.prototype._finish = function () {
                    this._timeoutId && clearTimeout(this._timeoutId), this._timeoutId = void 0;
                }, o.prototype._setupUI = function (e) {
                    var o = this;
                    if (this._container.addEventListener("contextmenu", (function (t) {
                            return t.preventDefault()
                        })), this._geolocateButton = i.create("button", "minemap-ctrl-geolocate", this._container), i.create("span", "minemap-ctrl-icon", this._geolocateButton).setAttribute("aria-hidden", !0), this._geolocateButton.type = "button", !1 === e) {
                        t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");
                        var a = this._map._getUIString("GeolocateControl.LocationNotAvailable");
                        this._geolocateButton.disabled = !0, this._geolocateButton.title = a, this._geolocateButton.setAttribute("aria-label", a);
                    } else {
                        var r = this._map._getUIString("GeolocateControl.FindMyLocation");
                        this._geolocateButton.title = r, this._geolocateButton.setAttribute("aria-label", r);
                    }
                    this.options.trackUserLocation && (this._geolocateButton.setAttribute("aria-pressed", "false"), this._watchState = "OFF"), this.options.showUserLocation && (this._dotElement = i.create("div", "minemap-user-location-dot"), this._userLocationDotMarker = new Dr(this._dotElement), this._circleElement = i.create("div", "minemap-user-location-accuracy-circle"), this._accuracyCircleMarker = new Dr({
                        element: this._circleElement,
                        pitchAlignment: "map"
                    }), this.options.trackUserLocation && (this._watchState = "OFF"), this._map.on("zoom", this._onZoom)), this._geolocateButton.addEventListener("click", this.trigger.bind(this)), this._setup = !0, this.options.trackUserLocation && this._map.on("movestart", (function (e) {
                        e.geolocateSource || "ACTIVE_LOCK" !== o._watchState || e.originalEvent && "resize" === e.originalEvent.type || (o._watchState = "BACKGROUND", o._geolocateButton.classList.add("minemap-ctrl-geolocate-background"), o._geolocateButton.classList.remove("minemap-ctrl-geolocate-active"), o.fire(new t.Event("trackuserlocationend")));
                    }));
                }, o.prototype.trigger = function () {
                    if (!this._setup) return t.warnOnce("Geolocate control triggered before added to a map"), !1;
                    if (this.options.trackUserLocation) {
                        switch (this._watchState) {
                            case "OFF":
                                this._watchState = "WAITING_ACTIVE", this.fire(new t.Event("trackuserlocationstart"));
                                break;
                            case "WAITING_ACTIVE":
                            case "ACTIVE_LOCK":
                            case "ACTIVE_ERROR":
                            case "BACKGROUND_ERROR":
                                kr--, Or = !1, this._watchState = "OFF", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-waiting"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-active"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-active-error"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-background"), this._geolocateButton.classList.remove("minemap-ctrl-geolocate-background-error"), this.fire(new t.Event("trackuserlocationend"));
                                break;
                            case "BACKGROUND":
                                this._watchState = "ACTIVE_LOCK", this._geolocateButton.classList.remove("minemap-ctrl-geolocate-background"), this._lastKnownPosition && this._updateCamera(this._lastKnownPosition), this.fire(new t.Event("trackuserlocationstart"));
                        }
                        switch (this._watchState) {
                            case "WAITING_ACTIVE":
                                this._geolocateButton.classList.add("minemap-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-active");
                                break;
                            case "ACTIVE_LOCK":
                                this._geolocateButton.classList.add("minemap-ctrl-geolocate-active");
                                break;
                            case "ACTIVE_ERROR":
                                this._geolocateButton.classList.add("minemap-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-active-error");
                                break;
                            case "BACKGROUND":
                                this._geolocateButton.classList.add("minemap-ctrl-geolocate-background");
                                break;
                            case "BACKGROUND_ERROR":
                                this._geolocateButton.classList.add("minemap-ctrl-geolocate-waiting"), this._geolocateButton.classList.add("minemap-ctrl-geolocate-background-error");
                        }
                        if ("OFF" === this._watchState && void 0 !== this._geolocationWatchID) this._clearWatch();
                        else if (void 0 === this._geolocationWatchID) {
                            var e;
                            this._geolocateButton.classList.add("minemap-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "true"), ++kr > 1 ? (e = {
                                maximumAge: 6e5,
                                timeout: 0
                            }, Or = !0) : (e = this.options.positionOptions, Or = !1), this._geolocationWatchID = t.window.navigator.geolocation.watchPosition(this._onSuccess, this._onError, e);
                        }
                    } else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions), this._timeoutId = setTimeout(this._finish, 1e4);
                    return !0
                }, o.prototype._clearWatch = function () {
                    t.window.navigator.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0, this._geolocateButton.classList.remove("minemap-ctrl-geolocate-waiting"), this._geolocateButton.setAttribute("aria-pressed", "false"), this.options.showUserLocation && this._updateMarker(null);
                }, o
            }(t.Evented),
            Ur = {
                maxWidth: 100,
                unit: "metric"
            },
            Fr = function (e) {
                this.options = t.extend({}, Ur, e), t.bindAll(["_onMove", "setUnit"], this);
            };

        function Nr(t, e, i) {
            var o = i && i.maxWidth || 100,
                a = t._container.clientHeight / 2,
                r = t.unproject([0, a]),
                n = t.unproject([o, a]),
                s = r.distanceTo(n);
            if (i && "imperial" === i.unit) {
                var l = 3.2808 * s;
                l > 5280 ? qr(e, o, l / 5280, t._getUIString("ScaleControl.Miles")) : qr(e, o, l, t._getUIString("ScaleControl.Feet"));
            } else i && "nautical" === i.unit ? qr(e, o, s / 1852, t._getUIString("ScaleControl.NauticalMiles")) : s >= 1e3 ? qr(e, o, s / 1e3, t._getUIString("ScaleControl.Kilometers")) : qr(e, o, s, t._getUIString("ScaleControl.Meters"));
        }

        function qr(t, e, i, o) {
            var a, r, n, s = (a = i, (r = Math.pow(10, ("" + Math.floor(a)).length - 1)) * (n = (n = a / r) >= 10 ? 10 : n >= 5 ? 5 : n >= 3 ? 3 : n >= 2 ? 2 : n >= 1 ? 1 : function (t) {
                var e = Math.pow(10, Math.ceil(-Math.log(t) / Math.LN10));
                return Math.round(t * e) / e
            }(n)));
            t.style.width = e * (s / i) + "px", t.innerHTML = s + "&nbsp;" + o;
        }
        Fr.prototype.getDefaultPosition = function () {
            return "bottom-left"
        }, Fr.prototype._onMove = function () {
            Nr(this._map, this._container, this.options);
        }, Fr.prototype.onAdd = function (t) {
            return this._map = t, this._container = i.create("div", "minemap-ctrl minemap-ctrl-scale", t.getContainer()), this._map.on("move", this._onMove), this._onMove(), this._container
        }, Fr.prototype.onRemove = function () {
            i.remove(this._container), this._map.off("move", this._onMove), this._map = void 0;
        }, Fr.prototype.setUnit = function (t) {
            this.options.unit = t, Nr(this._map, this._container, this.options);
        };
        var jr = function (e) {
            this._fullscreen = !1, e && e.container && (e.container instanceof t.window.HTMLElement ? this._container = e.container : t.warnOnce("Full screen control 'container' must be a DOM element.")), t.bindAll(["_onClickFullscreen", "_changeIcon"], this), "onfullscreenchange" in t.window.document ? this._fullscreenchange = "fullscreenchange" : "onmozfullscreenchange" in t.window.document ? this._fullscreenchange = "mozfullscreenchange" : "onwebkitfullscreenchange" in t.window.document ? this._fullscreenchange = "webkitfullscreenchange" : "onmsfullscreenchange" in t.window.document && (this._fullscreenchange = "MSFullscreenChange");
        };
        jr.prototype.onAdd = function (e) {
            return this._map = e, this._container || (this._container = this._map.getContainer()), this._controlContainer = i.create("div", "minemap-ctrl minemap-ctrl-group"), this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = "none", t.warnOnce("This device does not support fullscreen mode.")), this._controlContainer
        }, jr.prototype.onRemove = function () {
            i.remove(this._controlContainer), this._map = null, t.window.document.removeEventListener(this._fullscreenchange, this._changeIcon);
        }, jr.prototype._checkFullscreenSupport = function () {
            return !!(t.window.document.fullscreenEnabled || t.window.document.mozFullScreenEnabled || t.window.document.msFullscreenEnabled || t.window.document.webkitFullscreenEnabled)
        }, jr.prototype._setupUI = function () {
            var e = this._fullscreenButton = i.create("button", "minemap-ctrl-fullscreen", this._controlContainer);
            i.create("span", "minemap-ctrl-icon", e).setAttribute("aria-hidden", !0), e.type = "button", this._updateTitle(), this._fullscreenButton.addEventListener("click", this._onClickFullscreen), t.window.document.addEventListener(this._fullscreenchange, this._changeIcon);
        }, jr.prototype._updateTitle = function () {
            var t = this._getTitle();
            this._fullscreenButton.setAttribute("aria-label", t), this._fullscreenButton.title = t;
        }, jr.prototype._getTitle = function () {
            return this._map._getUIString(this._isFullscreen() ? "FullscreenControl.Exit" : "FullscreenControl.Enter")
        }, jr.prototype._isFullscreen = function () {
            return this._fullscreen
        }, jr.prototype._changeIcon = function () {
            (t.window.document.fullscreenElement || t.window.document.mozFullScreenElement || t.window.document.webkitFullscreenElement || t.window.document.msFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen, this._fullscreenButton.classList.toggle("minemap-ctrl-shrink"), this._fullscreenButton.classList.toggle("minemap-ctrl-fullscreen"), this._updateTitle());
        }, jr.prototype._onClickFullscreen = function () {
            this._isFullscreen() ? t.window.document.exitFullscreen ? t.window.document.exitFullscreen() : t.window.document.mozCancelFullScreen ? t.window.document.mozCancelFullScreen() : t.window.document.msExitFullscreen ? t.window.document.msExitFullscreen() : t.window.document.webkitCancelFullScreen && t.window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.mozRequestFullScreen ? this._container.mozRequestFullScreen() : this._container.msRequestFullscreen ? this._container.msRequestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen();
        };
        var Zr = {
                closeButton: !0,
                closeOnClick: !0,
                className: "",
                maxWidth: "240px"
            },
            Vr = function (e) {
                function o(i) {
                    e.call(this), this.options = t.extend(Object.create(Zr), i), t.bindAll(["_update", "_onClose", "remove", "_onMouseMove", "_onMouseUp", "_onDrag"], this), this._autoMoving = !0;
                }
                return e && (o.__proto__ = e), (o.prototype = Object.create(e && e.prototype)).constructor = o, o.prototype.addTo = function (e) {
                    return this._map && this.remove(), this._map = e, this.options.closeOnClick && this._map.on("click", this._onClose), this.options.closeOnMove && this._map.on("move", this._onClose), this._map.on("remove", this.remove), this._update(), this._trackPointer ? (this._map.on("mousemove", this._onMouseMove), this._map.on("mouseup", this._onMouseUp), this._container && this._container.classList.add("minemap-popup-track-pointer"), this._map._canvasContainer.classList.add("minemap-track-pointer")) : this._map.on("move", this._update), this.fire(new t.Event("open")), this
                }, o.prototype.isOpen = function () {
                    return !!this._map
                }, o.prototype.remove = function () {
                    return this._content && i.remove(this._content), this._container && (i.remove(this._container), delete this._container), this._map && (this._map.off("move", this._update), this._map.off("move", this._onClose), this._map.off("click", this._onClose), this._map.off("remove", this.remove), this._map.off("mousemove", this._onMouseMove), this._map.off("mouseup", this._onMouseUp), this._map.off("drag", this._onDrag), delete this._map), this.fire(new t.Event("close")), this
                }, o.prototype.getLngLat = function () {
                    return this._lngLat
                }, o.prototype.setLngLat = function (e) {
                    return this._lngLat = t.LngLat.convert(e), this._pos = null, this._trackPointer = !1, this._update(), this._map && (this._map.on("move", this._update), this._map.off("mousemove", this._onMouseMove), this._container && this._container.classList.remove("minemap-popup-track-pointer"), this._map._canvasContainer.classList.remove("minemap-track-pointer")), this
                }, o.prototype.trackPointer = function () {
                    return this._trackPointer = !0, this._pos = null, this._update(), this._map && (this._map.off("move", this._update), this._map.on("mousemove", this._onMouseMove), this._map.on("drag", this._onDrag), this._container && this._container.classList.add("minemap-popup-track-pointer"), this._map._canvasContainer.classList.add("minemap-track-pointer")), this
                }, o.prototype.getElement = function () {
                    return this._container
                }, o.prototype.setText = function (e) {
                    return this.setDOMContent(t.window.document.createTextNode(e))
                }, o.prototype.setHTML = function (e) {
                    var i, o = t.window.document.createDocumentFragment(),
                        a = t.window.document.createElement("body");
                    for (a.innerHTML = e; i = a.firstChild;) o.appendChild(i);
                    return this.setDOMContent(o)
                }, o.prototype.getMaxWidth = function () {
                    return this._content && this._content.style.maxWidth
                }, o.prototype.setMaxWidth = function (t) {
                    return this.options.maxWidth = t, this._update(), this
                }, o.prototype.setDOMContent = function (t) {
                    return this._createContent(), this._content.appendChild(t), this._update(), this
                }, o.prototype.addClassName = function (t) {
                    this._container && this._container.classList.add(t);
                }, o.prototype.removeClassName = function (t) {
                    this._container && this._container.classList.remove(t);
                }, o.prototype.toggleClassName = function (t) {
                    if (this._container) return this._container.classList.toggle(t)
                }, o.prototype._createContent = function () {
                    this._content && i.remove(this._content), this._content = i.create("div", "minemap-popup-content", this._container), this.options.closeButton && (this._closeButton = i.create("button", "minemap-popup-close-button", this._content), this._closeButton.type = "button", this._closeButton.setAttribute("aria-label", "Close popup"), this._closeButton.innerHTML = "&#215;", this._closeButton.addEventListener("click", this._onClose));
                }, o.prototype._onMouseUp = function (t) {
                    this._update(t.point);
                }, o.prototype._onMouseMove = function (t) {
                    this._update(t.point);
                }, o.prototype._onDrag = function (t) {
                    this._update(t.point);
                }, o.prototype._update = function (t) {
                    var e = this;
                    if (this._map && (this._lngLat || this._trackPointer) && this._content && (this._container || (this._container = i.create("div", "minemap-popup", this._map.getContainer()), this._tip = i.create("div", "minemap-popup-tip", this._container), this._container.appendChild(this._content), this.options.className && this.options.className.split(" ").forEach((function (t) {
                            return e._container.classList.add(t)
                        })), this._trackPointer && this._container.classList.add("minemap-popup-track-pointer")), this.options.maxWidth && this._content.style.maxWidth !== this.options.maxWidth && (this._content.style.maxWidth = this.options.maxWidth, this._content.style.overflow = "auto"), this.options.maxHeight && this._content.style.maxHeight !== this.options.maxHeight && (this._content.style.maxHeight = this.options.maxHeight, this._content.style.overflow = "auto"), this.options.minWidth && this._content.style.minWidth !== this.options.minWidth && (this._content.style.minWidth = this.options.minWidth, this._content.style.overflow = "auto"), this._map.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = Pr(this._lngLat, this._pos, this._map.transform)), !this._trackPointer || t)) {
                        var o = this._pos = this._trackPointer && t ? t : this._map.project(this._lngLat),
                            a = this.options.anchor,
                            r = Gr(this.options.offset);
                        if (!a) {
                            var n, s = this._container.offsetWidth,
                                l = this._container.offsetHeight;
                            n = o.y + r.bottom.y < l ? ["top"] : o.y > this._map.transform.height - l ? ["bottom"] : [], o.x < s / 2 ? n.push("left") : o.x > this._map.transform.width - s / 2 && n.push("right"), a = 0 === n.length ? "bottom" : n.join("-");
                        }
                        this._anchor = a;
                        var c = o.add(r[a]).round();
                        i.setTransform(this._container, Lr[a] + " translate(" + c.x + "px," + c.y + "px)"), Ar(this._container, a, "popup"), this._autoMoving && this.autoMove();
                    }
                }, o.prototype._onClose = function () {
                    this.remove();
                }, o.prototype._updateAutoMove = function () {
                    this._autoMoving = !0;
                }, o.prototype.autoMove = function () {
                    if (this._container) {
                        var t = this._anchor;
                        if (this.options.autoPan && this._map) {
                            var e = Gr(this.options.offset),
                                i = this._pos.round(),
                                o = this._container.offsetWidth,
                                a = this._container.offsetHeight;
                            if ("bottom" === t || "bottom-left" === t || "bottom-right" === t) {
                                var r = 0,
                                    n = 0;
                                "bottom-left" === t && (r = o), "bottom-right" === t && (n = o), i.y + e.bottom.y < 1.2 * a ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, 1.2 * -a + i.y + e.bottom.y - 10], {
                                    duration: 100
                                })) : i.x < .6 * o - .4 * r + .5 * n ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([.7 * -o + .4 * r - .5 * n + i.x - 5, 0], {
                                    duration: 100
                                })) : i.x > this._map.transform.width - .6 * o - .5 * r + .5 * n ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), console.log("移动"), this._map.panBy([i.x - this._map.transform.width + .7 * o + .5 * r - .5 * n + 5, 0], {
                                    duration: 100
                                })) : i.y > this._map.transform.height - .2 * a && (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, i.y - this._map.transform.height + .3 * a + 10], {
                                    duration: 100
                                }));
                            }
                            if ("top" === t || "top-left" === t || "top-right" === t) {
                                var s = 0,
                                    l = 0;
                                "top-left" === t && (s = o), "top-right" === t && (l = o), i.y + e.bottom.y < .2 * a ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, .2 * -a + i.y + e.bottom.y - 10], {
                                    duration: 100
                                })) : i.x < .6 * o - .4 * s + .5 * l ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([.7 * -o + .4 * s - .5 * l + i.x - 5, 0], {
                                    duration: 100
                                })) : i.x > this._map.transform.width - .6 * o - .5 * s + .5 * l ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([i.x - this._map.transform.width + .7 * o + .5 * s - .5 * l + 5, 0], {
                                    duration: 100
                                })) : i.y > this._map.transform.height - 1.2 * a && (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, i.y - this._map.transform.height + 1.3 * a + 10], {
                                    duration: 100
                                }));
                            }
                            "left" === t && (i.y + e.bottom.y < a ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, -a + i.y + e.bottom.y - 10], {
                                duration: 100
                            })) : i.x < o / 20 ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([-o / 2 + i.x - 5, 0], {
                                duration: 100
                            })) : i.x > this._map.transform.width - 1.1 * o ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([i.x - this._map.transform.width + 1.2 * o + 5, 0], {
                                duration: 100
                            })) : i.y > this._map.transform.height - a / 1.1 && (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, i.y - this._map.transform.height + 1.1 * a + 10], {
                                duration: 100
                            }))), "right" === t && (i.y + e.bottom.y < a ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, -a + i.y + e.bottom.y - 10], {
                                duration: 100
                            })) : i.x < 1.1 * o ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([1.2 * -o + i.x - 5, 0], {
                                duration: 100
                            })) : i.x > this._map.transform.width - .1 * o ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([i.x - this._map.transform.width + .2 * o + 5, 0], {
                                duration: 100
                            })) : i.y > this._map.transform.height - a / 1.1 && (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, i.y - this._map.transform.height + 1.1 * a + 10], {
                                duration: 100
                            }))), "center" === t && (i.y + e.bottom.y < .8 * a ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, -a + i.y + e.bottom.y - 10], {
                                duration: 100
                            })) : i.x < .6 * o ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([.7 * -o + i.x - 5, 0], {
                                duration: 100
                            })) : i.x > this._map.transform.width - .6 * o ? (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([i.x - this._map.transform.width + .7 * o + 5, 0], {
                                duration: 100
                            })) : i.y > this._map.transform.height - .8 * a && (this._autoMoving = !1, this._map.once("moveend", this._updateAutoMove.bind(this)), this._map.panBy([0, i.y - this._map.transform.height + 1 * a + 10], {
                                duration: 100
                            })));
                        }
                    }
                }, o.prototype.getMap = function () {
                    return this._map
                }, o
            }(t.Evented);

        function Gr(e) {
            if (e) {
                if ("number" == typeof e) {
                    var i = Math.round(Math.sqrt(.5 * Math.pow(e, 2)));
                    return {
                        center: new t.Point(0, 0),
                        top: new t.Point(0, e),
                        "top-left": new t.Point(i, i),
                        "top-right": new t.Point(-i, i),
                        bottom: new t.Point(0, -e),
                        "bottom-left": new t.Point(i, -i),
                        "bottom-right": new t.Point(-i, -i),
                        left: new t.Point(e, 0),
                        right: new t.Point(-e, 0)
                    }
                }
                if (e instanceof t.Point || Array.isArray(e)) {
                    var o = t.Point.convert(e);
                    return {
                        center: o,
                        top: o,
                        "top-left": o,
                        "top-right": o,
                        bottom: o,
                        "bottom-left": o,
                        "bottom-right": o,
                        left: o,
                        right: o
                    }
                }
                return {
                    center: t.Point.convert(e.center || [0, 0]),
                    top: t.Point.convert(e.top || [0, 0]),
                    "top-left": t.Point.convert(e["top-left"] || [0, 0]),
                    "top-right": t.Point.convert(e["top-right"] || [0, 0]),
                    bottom: t.Point.convert(e.bottom || [0, 0]),
                    "bottom-left": t.Point.convert(e["bottom-left"] || [0, 0]),
                    "bottom-right": t.Point.convert(e["bottom-right"] || [0, 0]),
                    left: t.Point.convert(e.left || [0, 0]),
                    right: t.Point.convert(e.right || [0, 0])
                }
            }
            return Gr(new t.Point(0, 0))
        }
        var Wr = {
            version: "2.1.0",
            supported: e,
            setRTLTextPlugin: t.setRTLTextPlugin,
            getRTLTextPluginStatus: t.getRTLTextPluginStatus,
            Map: Er,
            Navigation: zr,
            Geolocate: Br,
            Attribution: _r,
            Scale: Fr,
            Fullscreen: jr,
            Popup: Vr,
            Marker: Dr,
            Style: ri,
            LngLat: t.LngLat,
            LngLatBounds: t.LngLatBounds,
            Point: t.Point,
            MercatorCoordinate: t.MercatorCoordinate,
            Evented: t.Evented,
            config: t.config,
            prewarm: function () {
                te().acquire("minemap_preloaded_worker_pool");
            },
            clearPrewarmedResources: function () {
                var t = Qt;
                t && (t.isPreloaded() && 1 === t.numActive() ? (t.release("minemap_preloaded_worker_pool"), Qt = null) : console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"));
            },
            util: {
                getJSON: t.getJSON,
                getArrayBuffer: t.getArrayBuffer
            },
            ProjectionType: {
                LATLON: "LATLON",
                MERCATOR: "MERCATOR"
            },
            get accessToken() {
                return t.config.ACCESS_TOKEN
            },
            set accessToken(e) {
                t.config.ACCESS_TOKEN = e;
            },
            get appKey() {
                return t.config.APP_KEY
            },
            set appKey(e) {
                t.config.APP_KEY = e;
            },
            get solution() {
                return t.config.SOLU
            },
            set solution(e) {
                t.config.SOLU = e;
            },
            get dataVersion() {
                return t.config.DATA_VERSION
            },
            set dataVersion(e) {
                t.config.DATA_VERSION = e;
            },
            get spriteUrl() {
                return t.config.spriteUrl
            },
            set spriteUrl(e) {
                t.config.spriteUrl = e;
            },
            get fontsUrl() {
                return t.config.fontsUrl
            },
            set fontsUrl(e) {
                t.config.fontsUrl = e;
            },
            get serviceUrl() {
                return t.config.SERVICE_URL
            },
            set serviceUrl(e) {
                t.config.SERVICE_URL = e;
            },
            get domainUrl() {
                return t.config.DOMAIN
            },
            set domainUrl(e) {
                t.config.DOMAIN = e, t.config.SRC_URL = t.config.DOMAIN + t.config.SRC_BASE, t.config.SERVICE_URL = t.config.DOMAIN + t.config.SERVICE_BASE;
            },
            get dataDomainUrl() {
                return t.config.DATA_DOMAIN
            },
            set dataDomainUrl(e) {
                t.config.DATA_DOMAIN = e, Array.isArray(e) ? (t.config.API_URL = t.config.DATA_DOMAIN.map((function (e) {
                    return e + t.config.API_BASE
                })), t.config.DYN_URL = t.config.DATA_DOMAIN.map((function (e) {
                    return e + t.config.DYN_BASE
                })), t.config.MERGE_URL = t.config.DATA_DOMAIN.map((function (e) {
                    return e + t.config.MERGE_BASE
                })), t.config.OTHER_URL = t.config.DATA_DOMAIN.map((function (e) {
                    return e + t.config.OTHER_BASE
                }))) : (t.config.API_URL = t.config.DATA_DOMAIN + t.config.API_BASE, t.config.DYN_URL = t.config.DATA_DOMAIN + t.config.DYN_BASE, t.config.MERGE_URL = t.config.DATA_DOMAIN + t.config.MERGE_BASE, t.config.OTHER_URL = t.config.DATA_DOMAIN + t.config.OTHER_BASE);
            },
            get workerCount() {
                return Jt.workerCount
            },
            set workerCount(t) {
                Jt.workerCount = t;
            },
            get maxParallelImageRequests() {
                return t.config.MAX_PARALLEL_IMAGE_REQUESTS
            },
            set maxParallelImageRequests(e) {
                t.config.MAX_PARALLEL_IMAGE_REQUESTS = e;
            },
            clearStorage: function (e) {
                t.clearTileCache(e);
            },
            workerUrl: ""
        };
        return Wr
    }));

    //

    return minemap;

})));